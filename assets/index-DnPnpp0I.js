import{r as D,a as _u,g as xa,R as Z,c as ks}from"./vendor-wpXbf5jk.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const c of s)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function r(s){const c={};return s.integrity&&(c.integrity=s.integrity),s.referrerPolicy&&(c.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?c.credentials="include":s.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(s){if(s.ep)return;s.ep=!0;const c=r(s);fetch(s.href,c)}})();var ba={exports:{}},xo={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Eu=D,Su=Symbol.for("react.element"),ku=Symbol.for("react.fragment"),Nu=Object.prototype.hasOwnProperty,Cu=Eu.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Au={key:!0,ref:!0,__self:!0,__source:!0};function _a(e,t,r){var o,s={},c=null,u=null;r!==void 0&&(c=""+r),t.key!==void 0&&(c=""+t.key),t.ref!==void 0&&(u=t.ref);for(o in t)Nu.call(t,o)&&!Au.hasOwnProperty(o)&&(s[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps,t)s[o]===void 0&&(s[o]=t[o]);return{$$typeof:Su,type:e,key:c,ref:u,props:s,_owner:Cu.current}}xo.Fragment=ku;xo.jsx=_a;xo.jsxs=_a;ba.exports=xo;var F=ba.exports,Ea,Ns=_u;Ea=Ns.createRoot,Ns.hydrateRoot;function et(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let r=0,o;r<e.length;r++)(o=et(e[r]))!==""&&(t+=(t&&" ")+o);else for(let r in e)e[r]&&(t+=(t&&" ")+r);return t}var Sa={exports:{}},ka={},Na={exports:{}},Ca={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vn=D;function Tu(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Mu=typeof Object.is=="function"?Object.is:Tu,Iu=Vn.useState,$u=Vn.useEffect,Pu=Vn.useLayoutEffect,Ru=Vn.useDebugValue;function Du(e,t){var r=t(),o=Iu({inst:{value:r,getSnapshot:t}}),s=o[0].inst,c=o[1];return Pu(function(){s.value=r,s.getSnapshot=t,ai(s)&&c({inst:s})},[e,r,t]),$u(function(){return ai(s)&&c({inst:s}),e(function(){ai(s)&&c({inst:s})})},[e]),Ru(r),r}function ai(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Mu(e,r)}catch{return!0}}function Ou(e,t){return t()}var ju=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Ou:Du;Ca.useSyncExternalStore=Vn.useSyncExternalStore!==void 0?Vn.useSyncExternalStore:ju;Na.exports=Ca;var Bu=Na.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bo=D,zu=Bu;function Ku(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Fu=typeof Object.is=="function"?Object.is:Ku,Hu=zu.useSyncExternalStore,Lu=bo.useRef,qu=bo.useEffect,Vu=bo.useMemo,Wu=bo.useDebugValue;ka.useSyncExternalStoreWithSelector=function(e,t,r,o,s){var c=Lu(null);if(c.current===null){var u={hasValue:!1,value:null};c.current=u}else u=c.current;c=Vu(function(){function h(g){if(!p){if(p=!0,m=g,g=o(g),s!==void 0&&u.hasValue){var k=u.value;if(s(k,g))return v=k}return v=g}if(k=v,Fu(m,g))return k;var N=o(g);return s!==void 0&&s(k,N)?k:(m=g,v=N)}var p=!1,m,v,w=r===void 0?null:r;return[function(){return h(t())},w===null?void 0:function(){return h(w())}]},[t,r,o,s]);var f=Hu(e,c[0],c[1]);return qu(function(){u.hasValue=!0,u.value=f},[f]),Wu(f),f};Sa.exports=ka;var Yu=Sa.exports;const Xu=xa(Yu),Uu={BASE_URL:"./",DEV:!1,MODE:"production",PROD:!0,SSR:!1},Cs=e=>{let t;const r=new Set,o=(m,v)=>{const w=typeof m=="function"?m(t):m;if(!Object.is(w,t)){const g=t;t=v??(typeof w!="object"||w===null)?w:Object.assign({},t,w),r.forEach(k=>k(t,g))}},s=()=>t,h={setState:o,getState:s,getInitialState:()=>p,subscribe:m=>(r.add(m),()=>r.delete(m)),destroy:()=>{(Uu?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},p=t=e(o,s,h);return h},Zu=e=>e?Cs(e):Cs,{useDebugValue:Gu}=Z,{useSyncExternalStoreWithSelector:Qu}=Xu,Ju=e=>e;function Aa(e,t=Ju,r){const o=Qu(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return Gu(o),o}const As=(e,t)=>{const r=Zu(e),o=(s,c=t)=>Aa(r,s,c);return Object.assign(o,r),o},el=(e,t)=>e?As(e,t):As;function Qe(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[o,s]of e)if(!Object.is(s,t.get(o)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const o of e)if(!t.has(o))return!1;return!0}const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!1;for(const o of r)if(!Object.prototype.hasOwnProperty.call(t,o)||!Object.is(e[o],t[o]))return!1;return!0}var tl={value:()=>{}};function _o(){for(var e=0,t=arguments.length,r={},o;e<t;++e){if(!(o=arguments[e]+"")||o in r||/[\s.]/.test(o))throw new Error("illegal type: "+o);r[o]=[]}return new io(r)}function io(e){this._=e}function nl(e,t){return e.trim().split(/^|\s+/).map(function(r){var o="",s=r.indexOf(".");if(s>=0&&(o=r.slice(s+1),r=r.slice(0,s)),r&&!t.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:o}})}io.prototype=_o.prototype={constructor:io,on:function(e,t){var r=this._,o=nl(e+"",r),s,c=-1,u=o.length;if(arguments.length<2){for(;++c<u;)if((s=(e=o[c]).type)&&(s=rl(r[s],e.name)))return s;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++c<u;)if(s=(e=o[c]).type)r[s]=Ts(r[s],e.name,t);else if(t==null)for(s in r)r[s]=Ts(r[s],e.name,null);return this},copy:function(){var e={},t=this._;for(var r in t)e[r]=t[r].slice();return new io(e)},call:function(e,t){if((s=arguments.length-2)>0)for(var r=new Array(s),o=0,s,c;o<s;++o)r[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(c=this._[e],o=0,s=c.length;o<s;++o)c[o].value.apply(t,r)},apply:function(e,t,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var o=this._[e],s=0,c=o.length;s<c;++s)o[s].value.apply(t,r)}};function rl(e,t){for(var r=0,o=e.length,s;r<o;++r)if((s=e[r]).name===t)return s.value}function Ts(e,t,r){for(var o=0,s=e.length;o<s;++o)if(e[o].name===t){e[o]=tl,e=e.slice(0,o).concat(e.slice(o+1));break}return r!=null&&e.push({name:t,value:r}),e}var vi="http://www.w3.org/1999/xhtml";const Ms={svg:"http://www.w3.org/2000/svg",xhtml:vi,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Eo(e){var t=e+="",r=t.indexOf(":");return r>=0&&(t=e.slice(0,r))!=="xmlns"&&(e=e.slice(r+1)),Ms.hasOwnProperty(t)?{space:Ms[t],local:e}:e}function ol(e){return function(){var t=this.ownerDocument,r=this.namespaceURI;return r===vi&&t.documentElement.namespaceURI===vi?t.createElement(e):t.createElementNS(r,e)}}function il(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Ta(e){var t=Eo(e);return(t.local?il:ol)(t)}function sl(){}function Bi(e){return e==null?sl:function(){return this.querySelector(e)}}function al(e){typeof e!="function"&&(e=Bi(e));for(var t=this._groups,r=t.length,o=new Array(r),s=0;s<r;++s)for(var c=t[s],u=c.length,f=o[s]=new Array(u),h,p,m=0;m<u;++m)(h=c[m])&&(p=e.call(h,h.__data__,m,c))&&("__data__"in h&&(p.__data__=h.__data__),f[m]=p);return new mt(o,this._parents)}function cl(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function ul(){return[]}function Ma(e){return e==null?ul:function(){return this.querySelectorAll(e)}}function ll(e){return function(){return cl(e.apply(this,arguments))}}function fl(e){typeof e=="function"?e=ll(e):e=Ma(e);for(var t=this._groups,r=t.length,o=[],s=[],c=0;c<r;++c)for(var u=t[c],f=u.length,h,p=0;p<f;++p)(h=u[p])&&(o.push(e.call(h,h.__data__,p,u)),s.push(h));return new mt(o,s)}function Ia(e){return function(){return this.matches(e)}}function $a(e){return function(t){return t.matches(e)}}var dl=Array.prototype.find;function hl(e){return function(){return dl.call(this.children,e)}}function pl(){return this.firstElementChild}function ml(e){return this.select(e==null?pl:hl(typeof e=="function"?e:$a(e)))}var yl=Array.prototype.filter;function gl(){return Array.from(this.children)}function vl(e){return function(){return yl.call(this.children,e)}}function wl(e){return this.selectAll(e==null?gl:vl(typeof e=="function"?e:$a(e)))}function xl(e){typeof e!="function"&&(e=Ia(e));for(var t=this._groups,r=t.length,o=new Array(r),s=0;s<r;++s)for(var c=t[s],u=c.length,f=o[s]=[],h,p=0;p<u;++p)(h=c[p])&&e.call(h,h.__data__,p,c)&&f.push(h);return new mt(o,this._parents)}function Pa(e){return new Array(e.length)}function bl(){return new mt(this._enter||this._groups.map(Pa),this._parents)}function uo(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}uo.prototype={constructor:uo,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function _l(e){return function(){return e}}function El(e,t,r,o,s,c){for(var u=0,f,h=t.length,p=c.length;u<p;++u)(f=t[u])?(f.__data__=c[u],o[u]=f):r[u]=new uo(e,c[u]);for(;u<h;++u)(f=t[u])&&(s[u]=f)}function Sl(e,t,r,o,s,c,u){var f,h,p=new Map,m=t.length,v=c.length,w=new Array(m),g;for(f=0;f<m;++f)(h=t[f])&&(w[f]=g=u.call(h,h.__data__,f,t)+"",p.has(g)?s[f]=h:p.set(g,h));for(f=0;f<v;++f)g=u.call(e,c[f],f,c)+"",(h=p.get(g))?(o[f]=h,h.__data__=c[f],p.delete(g)):r[f]=new uo(e,c[f]);for(f=0;f<m;++f)(h=t[f])&&p.get(w[f])===h&&(s[f]=h)}function kl(e){return e.__data__}function Nl(e,t){if(!arguments.length)return Array.from(this,kl);var r=t?Sl:El,o=this._parents,s=this._groups;typeof e!="function"&&(e=_l(e));for(var c=s.length,u=new Array(c),f=new Array(c),h=new Array(c),p=0;p<c;++p){var m=o[p],v=s[p],w=v.length,g=Cl(e.call(m,m&&m.__data__,p,o)),k=g.length,N=f[p]=new Array(k),P=u[p]=new Array(k),S=h[p]=new Array(w);r(m,v,N,P,S,g,t);for(var H=0,K=0,C,U;H<k;++H)if(C=N[H]){for(H>=K&&(K=H+1);!(U=P[K])&&++K<k;);C._next=U||null}}return u=new mt(u,o),u._enter=f,u._exit=h,u}function Cl(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Al(){return new mt(this._exit||this._groups.map(Pa),this._parents)}function Tl(e,t,r){var o=this.enter(),s=this,c=this.exit();return typeof e=="function"?(o=e(o),o&&(o=o.selection())):o=o.append(e+""),t!=null&&(s=t(s),s&&(s=s.selection())),r==null?c.remove():r(c),o&&s?o.merge(s).order():s}function Ml(e){for(var t=e.selection?e.selection():e,r=this._groups,o=t._groups,s=r.length,c=o.length,u=Math.min(s,c),f=new Array(s),h=0;h<u;++h)for(var p=r[h],m=o[h],v=p.length,w=f[h]=new Array(v),g,k=0;k<v;++k)(g=p[k]||m[k])&&(w[k]=g);for(;h<s;++h)f[h]=r[h];return new mt(f,this._parents)}function Il(){for(var e=this._groups,t=-1,r=e.length;++t<r;)for(var o=e[t],s=o.length-1,c=o[s],u;--s>=0;)(u=o[s])&&(c&&u.compareDocumentPosition(c)^4&&c.parentNode.insertBefore(u,c),c=u);return this}function $l(e){e||(e=Pl);function t(v,w){return v&&w?e(v.__data__,w.__data__):!v-!w}for(var r=this._groups,o=r.length,s=new Array(o),c=0;c<o;++c){for(var u=r[c],f=u.length,h=s[c]=new Array(f),p,m=0;m<f;++m)(p=u[m])&&(h[m]=p);h.sort(t)}return new mt(s,this._parents).order()}function Pl(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Rl(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Dl(){return Array.from(this)}function Ol(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var o=e[t],s=0,c=o.length;s<c;++s){var u=o[s];if(u)return u}return null}function jl(){let e=0;for(const t of this)++e;return e}function Bl(){return!this.node()}function zl(e){for(var t=this._groups,r=0,o=t.length;r<o;++r)for(var s=t[r],c=0,u=s.length,f;c<u;++c)(f=s[c])&&e.call(f,f.__data__,c,s);return this}function Kl(e){return function(){this.removeAttribute(e)}}function Fl(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Hl(e,t){return function(){this.setAttribute(e,t)}}function Ll(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function ql(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttribute(e):this.setAttribute(e,r)}}function Vl(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}}function Wl(e,t){var r=Eo(e);if(arguments.length<2){var o=this.node();return r.local?o.getAttributeNS(r.space,r.local):o.getAttribute(r)}return this.each((t==null?r.local?Fl:Kl:typeof t=="function"?r.local?Vl:ql:r.local?Ll:Hl)(r,t))}function Ra(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Yl(e){return function(){this.style.removeProperty(e)}}function Xl(e,t,r){return function(){this.style.setProperty(e,t,r)}}function Ul(e,t,r){return function(){var o=t.apply(this,arguments);o==null?this.style.removeProperty(e):this.style.setProperty(e,o,r)}}function Zl(e,t,r){return arguments.length>1?this.each((t==null?Yl:typeof t=="function"?Ul:Xl)(e,t,r??"")):Wn(this.node(),e)}function Wn(e,t){return e.style.getPropertyValue(t)||Ra(e).getComputedStyle(e,null).getPropertyValue(t)}function Gl(e){return function(){delete this[e]}}function Ql(e,t){return function(){this[e]=t}}function Jl(e,t){return function(){var r=t.apply(this,arguments);r==null?delete this[e]:this[e]=r}}function ef(e,t){return arguments.length>1?this.each((t==null?Gl:typeof t=="function"?Jl:Ql)(e,t)):this.node()[e]}function Da(e){return e.trim().split(/^|\s+/)}function zi(e){return e.classList||new Oa(e)}function Oa(e){this._node=e,this._names=Da(e.getAttribute("class")||"")}Oa.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function ja(e,t){for(var r=zi(e),o=-1,s=t.length;++o<s;)r.add(t[o])}function Ba(e,t){for(var r=zi(e),o=-1,s=t.length;++o<s;)r.remove(t[o])}function tf(e){return function(){ja(this,e)}}function nf(e){return function(){Ba(this,e)}}function rf(e,t){return function(){(t.apply(this,arguments)?ja:Ba)(this,e)}}function of(e,t){var r=Da(e+"");if(arguments.length<2){for(var o=zi(this.node()),s=-1,c=r.length;++s<c;)if(!o.contains(r[s]))return!1;return!0}return this.each((typeof t=="function"?rf:t?tf:nf)(r,t))}function sf(){this.textContent=""}function af(e){return function(){this.textContent=e}}function cf(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function uf(e){return arguments.length?this.each(e==null?sf:(typeof e=="function"?cf:af)(e)):this.node().textContent}function lf(){this.innerHTML=""}function ff(e){return function(){this.innerHTML=e}}function df(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function hf(e){return arguments.length?this.each(e==null?lf:(typeof e=="function"?df:ff)(e)):this.node().innerHTML}function pf(){this.nextSibling&&this.parentNode.appendChild(this)}function mf(){return this.each(pf)}function yf(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function gf(){return this.each(yf)}function vf(e){var t=typeof e=="function"?e:Ta(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function wf(){return null}function xf(e,t){var r=typeof e=="function"?e:Ta(e),o=t==null?wf:typeof t=="function"?t:Bi(t);return this.select(function(){return this.insertBefore(r.apply(this,arguments),o.apply(this,arguments)||null)})}function bf(){var e=this.parentNode;e&&e.removeChild(this)}function _f(){return this.each(bf)}function Ef(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Sf(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function kf(e){return this.select(e?Sf:Ef)}function Nf(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Cf(e){return function(t){e.call(this,t,this.__data__)}}function Af(e){return e.trim().split(/^|\s+/).map(function(t){var r="",o=t.indexOf(".");return o>=0&&(r=t.slice(o+1),t=t.slice(0,o)),{type:t,name:r}})}function Tf(e){return function(){var t=this.__on;if(t){for(var r=0,o=-1,s=t.length,c;r<s;++r)c=t[r],(!e.type||c.type===e.type)&&c.name===e.name?this.removeEventListener(c.type,c.listener,c.options):t[++o]=c;++o?t.length=o:delete this.__on}}}function Mf(e,t,r){return function(){var o=this.__on,s,c=Cf(t);if(o){for(var u=0,f=o.length;u<f;++u)if((s=o[u]).type===e.type&&s.name===e.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=c,s.options=r),s.value=t;return}}this.addEventListener(e.type,c,r),s={type:e.type,name:e.name,value:t,listener:c,options:r},o?o.push(s):this.__on=[s]}}function If(e,t,r){var o=Af(e+""),s,c=o.length,u;if(arguments.length<2){var f=this.node().__on;if(f){for(var h=0,p=f.length,m;h<p;++h)for(s=0,m=f[h];s<c;++s)if((u=o[s]).type===m.type&&u.name===m.name)return m.value}return}for(f=t?Mf:Tf,s=0;s<c;++s)this.each(f(o[s],t,r));return this}function za(e,t,r){var o=Ra(e),s=o.CustomEvent;typeof s=="function"?s=new s(t,r):(s=o.document.createEvent("Event"),r?(s.initEvent(t,r.bubbles,r.cancelable),s.detail=r.detail):s.initEvent(t,!1,!1)),e.dispatchEvent(s)}function $f(e,t){return function(){return za(this,e,t)}}function Pf(e,t){return function(){return za(this,e,t.apply(this,arguments))}}function Rf(e,t){return this.each((typeof t=="function"?Pf:$f)(e,t))}function*Df(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var o=e[t],s=0,c=o.length,u;s<c;++s)(u=o[s])&&(yield u)}var Ka=[null];function mt(e,t){this._groups=e,this._parents=t}function kr(){return new mt([[document.documentElement]],Ka)}function Of(){return this}mt.prototype=kr.prototype={constructor:mt,select:al,selectAll:fl,selectChild:ml,selectChildren:wl,filter:xl,data:Nl,enter:bl,exit:Al,join:Tl,merge:Ml,selection:Of,order:Il,sort:$l,call:Rl,nodes:Dl,node:Ol,size:jl,empty:Bl,each:zl,attr:Wl,style:Zl,property:ef,classed:of,text:uf,html:hf,raise:mf,lower:gf,append:vf,insert:xf,remove:_f,clone:kf,datum:Nf,on:If,dispatch:Rf,[Symbol.iterator]:Df};function bt(e){return typeof e=="string"?new mt([[document.querySelector(e)]],[document.documentElement]):new mt([[e]],Ka)}function jf(e){let t;for(;t=e.sourceEvent;)e=t;return e}function Ct(e,t){if(e=jf(e),t===void 0&&(t=e.currentTarget),t){var r=t.ownerSVGElement||t;if(r.createSVGPoint){var o=r.createSVGPoint();return o.x=e.clientX,o.y=e.clientY,o=o.matrixTransform(t.getScreenCTM().inverse()),[o.x,o.y]}if(t.getBoundingClientRect){var s=t.getBoundingClientRect();return[e.clientX-s.left-t.clientLeft,e.clientY-s.top-t.clientTop]}}return[e.pageX,e.pageY]}const Bf={passive:!1},gr={capture:!0,passive:!1};function ci(e){e.stopImmediatePropagation()}function Hn(e){e.preventDefault(),e.stopImmediatePropagation()}function Fa(e){var t=e.document.documentElement,r=bt(e).on("dragstart.drag",Hn,gr);"onselectstart"in t?r.on("selectstart.drag",Hn,gr):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Ha(e,t){var r=e.document.documentElement,o=bt(e).on("dragstart.drag",null);t&&(o.on("click.drag",Hn,gr),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in r?o.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}const Ur=e=>()=>e;function wi(e,{sourceEvent:t,subject:r,target:o,identifier:s,active:c,x:u,y:f,dx:h,dy:p,dispatch:m}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:c,enumerable:!0,configurable:!0},x:{value:u,enumerable:!0,configurable:!0},y:{value:f,enumerable:!0,configurable:!0},dx:{value:h,enumerable:!0,configurable:!0},dy:{value:p,enumerable:!0,configurable:!0},_:{value:m}})}wi.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function zf(e){return!e.ctrlKey&&!e.button}function Kf(){return this.parentNode}function Ff(e,t){return t??{x:e.x,y:e.y}}function Hf(){return navigator.maxTouchPoints||"ontouchstart"in this}function Lf(){var e=zf,t=Kf,r=Ff,o=Hf,s={},c=_o("start","drag","end"),u=0,f,h,p,m,v=0;function w(C){C.on("mousedown.drag",g).filter(o).on("touchstart.drag",P).on("touchmove.drag",S,Bf).on("touchend.drag touchcancel.drag",H).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function g(C,U){if(!(m||!e.call(this,C,U))){var Q=K(this,t.call(this,C,U),C,U,"mouse");Q&&(bt(C.view).on("mousemove.drag",k,gr).on("mouseup.drag",N,gr),Fa(C.view),ci(C),p=!1,f=C.clientX,h=C.clientY,Q("start",C))}}function k(C){if(Hn(C),!p){var U=C.clientX-f,Q=C.clientY-h;p=U*U+Q*Q>v}s.mouse("drag",C)}function N(C){bt(C.view).on("mousemove.drag mouseup.drag",null),Ha(C.view,p),Hn(C),s.mouse("end",C)}function P(C,U){if(e.call(this,C,U)){var Q=C.changedTouches,X=t.call(this,C,U),ee=Q.length,G,oe;for(G=0;G<ee;++G)(oe=K(this,X,C,U,Q[G].identifier,Q[G]))&&(ci(C),oe("start",C,Q[G]))}}function S(C){var U=C.changedTouches,Q=U.length,X,ee;for(X=0;X<Q;++X)(ee=s[U[X].identifier])&&(Hn(C),ee("drag",C,U[X]))}function H(C){var U=C.changedTouches,Q=U.length,X,ee;for(m&&clearTimeout(m),m=setTimeout(function(){m=null},500),X=0;X<Q;++X)(ee=s[U[X].identifier])&&(ci(C),ee("end",C,U[X]))}function K(C,U,Q,X,ee,G){var oe=c.copy(),ne=Ct(G||Q,U),le,se,b;if((b=r.call(C,new wi("beforestart",{sourceEvent:Q,target:w,identifier:ee,active:u,x:ne[0],y:ne[1],dx:0,dy:0,dispatch:oe}),X))!=null)return le=b.x-ne[0]||0,se=b.y-ne[1]||0,function L(j,W,re){var z=ne,J;switch(j){case"start":s[ee]=L,J=u++;break;case"end":delete s[ee],--u;case"drag":ne=Ct(re||W,U),J=u;break}oe.call(j,C,new wi(j,{sourceEvent:W,subject:b,target:w,identifier:ee,active:J,x:ne[0]+le,y:ne[1]+se,dx:ne[0]-z[0],dy:ne[1]-z[1],dispatch:oe}),X)}}return w.filter=function(C){return arguments.length?(e=typeof C=="function"?C:Ur(!!C),w):e},w.container=function(C){return arguments.length?(t=typeof C=="function"?C:Ur(C),w):t},w.subject=function(C){return arguments.length?(r=typeof C=="function"?C:Ur(C),w):r},w.touchable=function(C){return arguments.length?(o=typeof C=="function"?C:Ur(!!C),w):o},w.on=function(){var C=c.on.apply(c,arguments);return C===c?w:C},w.clickDistance=function(C){return arguments.length?(v=(C=+C)*C,w):Math.sqrt(v)},w}function Ki(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function La(e,t){var r=Object.create(e.prototype);for(var o in t)r[o]=t[o];return r}function Nr(){}var vr=.7,lo=1/vr,Ln="\\s*([+-]?\\d+)\\s*",wr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ft="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",qf=/^#([0-9a-f]{3,8})$/,Vf=new RegExp(`^rgb\\(${Ln},${Ln},${Ln}\\)$`),Wf=new RegExp(`^rgb\\(${Ft},${Ft},${Ft}\\)$`),Yf=new RegExp(`^rgba\\(${Ln},${Ln},${Ln},${wr}\\)$`),Xf=new RegExp(`^rgba\\(${Ft},${Ft},${Ft},${wr}\\)$`),Uf=new RegExp(`^hsl\\(${wr},${Ft},${Ft}\\)$`),Zf=new RegExp(`^hsla\\(${wr},${Ft},${Ft},${wr}\\)$`),Is={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Ki(Nr,xr,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:$s,formatHex:$s,formatHex8:Gf,formatHsl:Qf,formatRgb:Ps,toString:Ps});function $s(){return this.rgb().formatHex()}function Gf(){return this.rgb().formatHex8()}function Qf(){return qa(this).formatHsl()}function Ps(){return this.rgb().formatRgb()}function xr(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=qf.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?Rs(t):r===3?new ft(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Zr(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Zr(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Vf.exec(e))?new ft(t[1],t[2],t[3],1):(t=Wf.exec(e))?new ft(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Yf.exec(e))?Zr(t[1],t[2],t[3],t[4]):(t=Xf.exec(e))?Zr(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Uf.exec(e))?js(t[1],t[2]/100,t[3]/100,1):(t=Zf.exec(e))?js(t[1],t[2]/100,t[3]/100,t[4]):Is.hasOwnProperty(e)?Rs(Is[e]):e==="transparent"?new ft(NaN,NaN,NaN,0):null}function Rs(e){return new ft(e>>16&255,e>>8&255,e&255,1)}function Zr(e,t,r,o){return o<=0&&(e=t=r=NaN),new ft(e,t,r,o)}function Jf(e){return e instanceof Nr||(e=xr(e)),e?(e=e.rgb(),new ft(e.r,e.g,e.b,e.opacity)):new ft}function xi(e,t,r,o){return arguments.length===1?Jf(e):new ft(e,t,r,o??1)}function ft(e,t,r,o){this.r=+e,this.g=+t,this.b=+r,this.opacity=+o}Ki(ft,xi,La(Nr,{brighter(e){return e=e==null?lo:Math.pow(lo,e),new ft(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?vr:Math.pow(vr,e),new ft(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ft(bn(this.r),bn(this.g),bn(this.b),fo(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ds,formatHex:Ds,formatHex8:ed,formatRgb:Os,toString:Os}));function Ds(){return`#${wn(this.r)}${wn(this.g)}${wn(this.b)}`}function ed(){return`#${wn(this.r)}${wn(this.g)}${wn(this.b)}${wn((isNaN(this.opacity)?1:this.opacity)*255)}`}function Os(){const e=fo(this.opacity);return`${e===1?"rgb(":"rgba("}${bn(this.r)}, ${bn(this.g)}, ${bn(this.b)}${e===1?")":`, ${e})`}`}function fo(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function bn(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function wn(e){return e=bn(e),(e<16?"0":"")+e.toString(16)}function js(e,t,r,o){return o<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new At(e,t,r,o)}function qa(e){if(e instanceof At)return new At(e.h,e.s,e.l,e.opacity);if(e instanceof Nr||(e=xr(e)),!e)return new At;if(e instanceof At)return e;e=e.rgb();var t=e.r/255,r=e.g/255,o=e.b/255,s=Math.min(t,r,o),c=Math.max(t,r,o),u=NaN,f=c-s,h=(c+s)/2;return f?(t===c?u=(r-o)/f+(r<o)*6:r===c?u=(o-t)/f+2:u=(t-r)/f+4,f/=h<.5?c+s:2-c-s,u*=60):f=h>0&&h<1?0:u,new At(u,f,h,e.opacity)}function td(e,t,r,o){return arguments.length===1?qa(e):new At(e,t,r,o??1)}function At(e,t,r,o){this.h=+e,this.s=+t,this.l=+r,this.opacity=+o}Ki(At,td,La(Nr,{brighter(e){return e=e==null?lo:Math.pow(lo,e),new At(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?vr:Math.pow(vr,e),new At(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,o=r+(r<.5?r:1-r)*t,s=2*r-o;return new ft(ui(e>=240?e-240:e+120,s,o),ui(e,s,o),ui(e<120?e+240:e-120,s,o),this.opacity)},clamp(){return new At(Bs(this.h),Gr(this.s),Gr(this.l),fo(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=fo(this.opacity);return`${e===1?"hsl(":"hsla("}${Bs(this.h)}, ${Gr(this.s)*100}%, ${Gr(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Bs(e){return e=(e||0)%360,e<0?e+360:e}function Gr(e){return Math.max(0,Math.min(1,e||0))}function ui(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const Va=e=>()=>e;function nd(e,t){return function(r){return e+r*t}}function rd(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(o){return Math.pow(e+o*t,r)}}function od(e){return(e=+e)==1?Wa:function(t,r){return r-t?rd(t,r,e):Va(isNaN(t)?r:t)}}function Wa(e,t){var r=t-e;return r?nd(e,r):Va(isNaN(e)?t:e)}const zs=function e(t){var r=od(t);function o(s,c){var u=r((s=xi(s)).r,(c=xi(c)).r),f=r(s.g,c.g),h=r(s.b,c.b),p=Wa(s.opacity,c.opacity);return function(m){return s.r=u(m),s.g=f(m),s.b=h(m),s.opacity=p(m),s+""}}return o.gamma=e,o}(1);function cn(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}var bi=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,li=new RegExp(bi.source,"g");function id(e){return function(){return e}}function sd(e){return function(t){return e(t)+""}}function ad(e,t){var r=bi.lastIndex=li.lastIndex=0,o,s,c,u=-1,f=[],h=[];for(e=e+"",t=t+"";(o=bi.exec(e))&&(s=li.exec(t));)(c=s.index)>r&&(c=t.slice(r,c),f[u]?f[u]+=c:f[++u]=c),(o=o[0])===(s=s[0])?f[u]?f[u]+=s:f[++u]=s:(f[++u]=null,h.push({i:u,x:cn(o,s)})),r=li.lastIndex;return r<t.length&&(c=t.slice(r),f[u]?f[u]+=c:f[++u]=c),f.length<2?h[0]?sd(h[0].x):id(t):(t=h.length,function(p){for(var m=0,v;m<t;++m)f[(v=h[m]).i]=v.x(p);return f.join("")})}var Ks=180/Math.PI,_i={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Ya(e,t,r,o,s,c){var u,f,h;return(u=Math.sqrt(e*e+t*t))&&(e/=u,t/=u),(h=e*r+t*o)&&(r-=e*h,o-=t*h),(f=Math.sqrt(r*r+o*o))&&(r/=f,o/=f,h/=f),e*o<t*r&&(e=-e,t=-t,h=-h,u=-u),{translateX:s,translateY:c,rotate:Math.atan2(t,e)*Ks,skewX:Math.atan(h)*Ks,scaleX:u,scaleY:f}}var Qr;function cd(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?_i:Ya(t.a,t.b,t.c,t.d,t.e,t.f)}function ud(e){return e==null||(Qr||(Qr=document.createElementNS("http://www.w3.org/2000/svg","g")),Qr.setAttribute("transform",e),!(e=Qr.transform.baseVal.consolidate()))?_i:(e=e.matrix,Ya(e.a,e.b,e.c,e.d,e.e,e.f))}function Xa(e,t,r,o){function s(p){return p.length?p.pop()+" ":""}function c(p,m,v,w,g,k){if(p!==v||m!==w){var N=g.push("translate(",null,t,null,r);k.push({i:N-4,x:cn(p,v)},{i:N-2,x:cn(m,w)})}else(v||w)&&g.push("translate("+v+t+w+r)}function u(p,m,v,w){p!==m?(p-m>180?m+=360:m-p>180&&(p+=360),w.push({i:v.push(s(v)+"rotate(",null,o)-2,x:cn(p,m)})):m&&v.push(s(v)+"rotate("+m+o)}function f(p,m,v,w){p!==m?w.push({i:v.push(s(v)+"skewX(",null,o)-2,x:cn(p,m)}):m&&v.push(s(v)+"skewX("+m+o)}function h(p,m,v,w,g,k){if(p!==v||m!==w){var N=g.push(s(g)+"scale(",null,",",null,")");k.push({i:N-4,x:cn(p,v)},{i:N-2,x:cn(m,w)})}else(v!==1||w!==1)&&g.push(s(g)+"scale("+v+","+w+")")}return function(p,m){var v=[],w=[];return p=e(p),m=e(m),c(p.translateX,p.translateY,m.translateX,m.translateY,v,w),u(p.rotate,m.rotate,v,w),f(p.skewX,m.skewX,v,w),h(p.scaleX,p.scaleY,m.scaleX,m.scaleY,v,w),p=m=null,function(g){for(var k=-1,N=w.length,P;++k<N;)v[(P=w[k]).i]=P.x(g);return v.join("")}}}var ld=Xa(cd,"px, ","px)","deg)"),fd=Xa(ud,", ",")",")"),dd=1e-12;function Fs(e){return((e=Math.exp(e))+1/e)/2}function hd(e){return((e=Math.exp(e))-1/e)/2}function pd(e){return((e=Math.exp(2*e))-1)/(e+1)}const md=function e(t,r,o){function s(c,u){var f=c[0],h=c[1],p=c[2],m=u[0],v=u[1],w=u[2],g=m-f,k=v-h,N=g*g+k*k,P,S;if(N<dd)S=Math.log(w/p)/t,P=function(X){return[f+X*g,h+X*k,p*Math.exp(t*X*S)]};else{var H=Math.sqrt(N),K=(w*w-p*p+o*N)/(2*p*r*H),C=(w*w-p*p-o*N)/(2*w*r*H),U=Math.log(Math.sqrt(K*K+1)-K),Q=Math.log(Math.sqrt(C*C+1)-C);S=(Q-U)/t,P=function(X){var ee=X*S,G=Fs(U),oe=p/(r*H)*(G*pd(t*ee+U)-hd(U));return[f+oe*g,h+oe*k,p*G/Fs(t*ee+U)]}}return P.duration=S*1e3*t/Math.SQRT2,P}return s.rho=function(c){var u=Math.max(.001,+c),f=u*u,h=f*f;return e(u,f,h)},s}(Math.SQRT2,2,4);var Yn=0,pr=0,ur=0,Ua=1e3,ho,mr,po=0,En=0,So=0,br=typeof performance=="object"&&performance.now?performance:Date,Za=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Fi(){return En||(Za(yd),En=br.now()+So)}function yd(){En=0}function mo(){this._call=this._time=this._next=null}mo.prototype=Ga.prototype={constructor:mo,restart:function(e,t,r){if(typeof e!="function")throw new TypeError("callback is not a function");r=(r==null?Fi():+r)+(t==null?0:+t),!this._next&&mr!==this&&(mr?mr._next=this:ho=this,mr=this),this._call=e,this._time=r,Ei()},stop:function(){this._call&&(this._call=null,this._time=1/0,Ei())}};function Ga(e,t,r){var o=new mo;return o.restart(e,t,r),o}function gd(){Fi(),++Yn;for(var e=ho,t;e;)(t=En-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Yn}function Hs(){En=(po=br.now())+So,Yn=pr=0;try{gd()}finally{Yn=0,wd(),En=0}}function vd(){var e=br.now(),t=e-po;t>Ua&&(So-=t,po=e)}function wd(){for(var e,t=ho,r,o=1/0;t;)t._call?(o>t._time&&(o=t._time),e=t,t=t._next):(r=t._next,t._next=null,t=e?e._next=r:ho=r);mr=e,Ei(o)}function Ei(e){if(!Yn){pr&&(pr=clearTimeout(pr));var t=e-En;t>24?(e<1/0&&(pr=setTimeout(Hs,e-br.now()-So)),ur&&(ur=clearInterval(ur))):(ur||(po=br.now(),ur=setInterval(vd,Ua)),Yn=1,Za(Hs))}}function Ls(e,t,r){var o=new mo;return t=t==null?0:+t,o.restart(s=>{o.stop(),e(s+t)},t,r),o}var xd=_o("start","end","cancel","interrupt"),bd=[],Qa=0,qs=1,Si=2,so=3,Vs=4,ki=5,ao=6;function ko(e,t,r,o,s,c){var u=e.__transition;if(!u)e.__transition={};else if(r in u)return;_d(e,r,{name:t,index:o,group:s,on:xd,tween:bd,time:c.time,delay:c.delay,duration:c.duration,ease:c.ease,timer:null,state:Qa})}function Hi(e,t){var r=Mt(e,t);if(r.state>Qa)throw new Error("too late; already scheduled");return r}function Ht(e,t){var r=Mt(e,t);if(r.state>so)throw new Error("too late; already running");return r}function Mt(e,t){var r=e.__transition;if(!r||!(r=r[t]))throw new Error("transition not found");return r}function _d(e,t,r){var o=e.__transition,s;o[t]=r,r.timer=Ga(c,0,r.time);function c(p){r.state=qs,r.timer.restart(u,r.delay,r.time),r.delay<=p&&u(p-r.delay)}function u(p){var m,v,w,g;if(r.state!==qs)return h();for(m in o)if(g=o[m],g.name===r.name){if(g.state===so)return Ls(u);g.state===Vs?(g.state=ao,g.timer.stop(),g.on.call("interrupt",e,e.__data__,g.index,g.group),delete o[m]):+m<t&&(g.state=ao,g.timer.stop(),g.on.call("cancel",e,e.__data__,g.index,g.group),delete o[m])}if(Ls(function(){r.state===so&&(r.state=Vs,r.timer.restart(f,r.delay,r.time),f(p))}),r.state=Si,r.on.call("start",e,e.__data__,r.index,r.group),r.state===Si){for(r.state=so,s=new Array(w=r.tween.length),m=0,v=-1;m<w;++m)(g=r.tween[m].value.call(e,e.__data__,r.index,r.group))&&(s[++v]=g);s.length=v+1}}function f(p){for(var m=p<r.duration?r.ease.call(null,p/r.duration):(r.timer.restart(h),r.state=ki,1),v=-1,w=s.length;++v<w;)s[v].call(e,m);r.state===ki&&(r.on.call("end",e,e.__data__,r.index,r.group),h())}function h(){r.state=ao,r.timer.stop(),delete o[t];for(var p in o)return;delete e.__transition}}function co(e,t){var r=e.__transition,o,s,c=!0,u;if(r){t=t==null?null:t+"";for(u in r){if((o=r[u]).name!==t){c=!1;continue}s=o.state>Si&&o.state<ki,o.state=ao,o.timer.stop(),o.on.call(s?"interrupt":"cancel",e,e.__data__,o.index,o.group),delete r[u]}c&&delete e.__transition}}function Ed(e){return this.each(function(){co(this,e)})}function Sd(e,t){var r,o;return function(){var s=Ht(this,e),c=s.tween;if(c!==r){o=r=c;for(var u=0,f=o.length;u<f;++u)if(o[u].name===t){o=o.slice(),o.splice(u,1);break}}s.tween=o}}function kd(e,t,r){var o,s;if(typeof r!="function")throw new Error;return function(){var c=Ht(this,e),u=c.tween;if(u!==o){s=(o=u).slice();for(var f={name:t,value:r},h=0,p=s.length;h<p;++h)if(s[h].name===t){s[h]=f;break}h===p&&s.push(f)}c.tween=s}}function Nd(e,t){var r=this._id;if(e+="",arguments.length<2){for(var o=Mt(this.node(),r).tween,s=0,c=o.length,u;s<c;++s)if((u=o[s]).name===e)return u.value;return null}return this.each((t==null?Sd:kd)(r,e,t))}function Li(e,t,r){var o=e._id;return e.each(function(){var s=Ht(this,o);(s.value||(s.value={}))[t]=r.apply(this,arguments)}),function(s){return Mt(s,o).value[t]}}function Ja(e,t){var r;return(typeof t=="number"?cn:t instanceof xr?zs:(r=xr(t))?(t=r,zs):ad)(e,t)}function Cd(e){return function(){this.removeAttribute(e)}}function Ad(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Td(e,t,r){var o,s=r+"",c;return function(){var u=this.getAttribute(e);return u===s?null:u===o?c:c=t(o=u,r)}}function Md(e,t,r){var o,s=r+"",c;return function(){var u=this.getAttributeNS(e.space,e.local);return u===s?null:u===o?c:c=t(o=u,r)}}function Id(e,t,r){var o,s,c;return function(){var u,f=r(this),h;return f==null?void this.removeAttribute(e):(u=this.getAttribute(e),h=f+"",u===h?null:u===o&&h===s?c:(s=h,c=t(o=u,f)))}}function $d(e,t,r){var o,s,c;return function(){var u,f=r(this),h;return f==null?void this.removeAttributeNS(e.space,e.local):(u=this.getAttributeNS(e.space,e.local),h=f+"",u===h?null:u===o&&h===s?c:(s=h,c=t(o=u,f)))}}function Pd(e,t){var r=Eo(e),o=r==="transform"?fd:Ja;return this.attrTween(e,typeof t=="function"?(r.local?$d:Id)(r,o,Li(this,"attr."+e,t)):t==null?(r.local?Ad:Cd)(r):(r.local?Md:Td)(r,o,t))}function Rd(e,t){return function(r){this.setAttribute(e,t.call(this,r))}}function Dd(e,t){return function(r){this.setAttributeNS(e.space,e.local,t.call(this,r))}}function Od(e,t){var r,o;function s(){var c=t.apply(this,arguments);return c!==o&&(r=(o=c)&&Dd(e,c)),r}return s._value=t,s}function jd(e,t){var r,o;function s(){var c=t.apply(this,arguments);return c!==o&&(r=(o=c)&&Rd(e,c)),r}return s._value=t,s}function Bd(e,t){var r="attr."+e;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;var o=Eo(e);return this.tween(r,(o.local?Od:jd)(o,t))}function zd(e,t){return function(){Hi(this,e).delay=+t.apply(this,arguments)}}function Kd(e,t){return t=+t,function(){Hi(this,e).delay=t}}function Fd(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?zd:Kd)(t,e)):Mt(this.node(),t).delay}function Hd(e,t){return function(){Ht(this,e).duration=+t.apply(this,arguments)}}function Ld(e,t){return t=+t,function(){Ht(this,e).duration=t}}function qd(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Hd:Ld)(t,e)):Mt(this.node(),t).duration}function Vd(e,t){if(typeof t!="function")throw new Error;return function(){Ht(this,e).ease=t}}function Wd(e){var t=this._id;return arguments.length?this.each(Vd(t,e)):Mt(this.node(),t).ease}function Yd(e,t){return function(){var r=t.apply(this,arguments);if(typeof r!="function")throw new Error;Ht(this,e).ease=r}}function Xd(e){if(typeof e!="function")throw new Error;return this.each(Yd(this._id,e))}function Ud(e){typeof e!="function"&&(e=Ia(e));for(var t=this._groups,r=t.length,o=new Array(r),s=0;s<r;++s)for(var c=t[s],u=c.length,f=o[s]=[],h,p=0;p<u;++p)(h=c[p])&&e.call(h,h.__data__,p,c)&&f.push(h);return new Gt(o,this._parents,this._name,this._id)}function Zd(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,r=e._groups,o=t.length,s=r.length,c=Math.min(o,s),u=new Array(o),f=0;f<c;++f)for(var h=t[f],p=r[f],m=h.length,v=u[f]=new Array(m),w,g=0;g<m;++g)(w=h[g]||p[g])&&(v[g]=w);for(;f<o;++f)u[f]=t[f];return new Gt(u,this._parents,this._name,this._id)}function Gd(e){return(e+"").trim().split(/^|\s+/).every(function(t){var r=t.indexOf(".");return r>=0&&(t=t.slice(0,r)),!t||t==="start"})}function Qd(e,t,r){var o,s,c=Gd(t)?Hi:Ht;return function(){var u=c(this,e),f=u.on;f!==o&&(s=(o=f).copy()).on(t,r),u.on=s}}function Jd(e,t){var r=this._id;return arguments.length<2?Mt(this.node(),r).on.on(e):this.each(Qd(r,e,t))}function eh(e){return function(){var t=this.parentNode;for(var r in this.__transition)if(+r!==e)return;t&&t.removeChild(this)}}function th(){return this.on("end.remove",eh(this._id))}function nh(e){var t=this._name,r=this._id;typeof e!="function"&&(e=Bi(e));for(var o=this._groups,s=o.length,c=new Array(s),u=0;u<s;++u)for(var f=o[u],h=f.length,p=c[u]=new Array(h),m,v,w=0;w<h;++w)(m=f[w])&&(v=e.call(m,m.__data__,w,f))&&("__data__"in m&&(v.__data__=m.__data__),p[w]=v,ko(p[w],t,r,w,p,Mt(m,r)));return new Gt(c,this._parents,t,r)}function rh(e){var t=this._name,r=this._id;typeof e!="function"&&(e=Ma(e));for(var o=this._groups,s=o.length,c=[],u=[],f=0;f<s;++f)for(var h=o[f],p=h.length,m,v=0;v<p;++v)if(m=h[v]){for(var w=e.call(m,m.__data__,v,h),g,k=Mt(m,r),N=0,P=w.length;N<P;++N)(g=w[N])&&ko(g,t,r,N,w,k);c.push(w),u.push(m)}return new Gt(c,u,t,r)}var oh=kr.prototype.constructor;function ih(){return new oh(this._groups,this._parents)}function sh(e,t){var r,o,s;return function(){var c=Wn(this,e),u=(this.style.removeProperty(e),Wn(this,e));return c===u?null:c===r&&u===o?s:s=t(r=c,o=u)}}function ec(e){return function(){this.style.removeProperty(e)}}function ah(e,t,r){var o,s=r+"",c;return function(){var u=Wn(this,e);return u===s?null:u===o?c:c=t(o=u,r)}}function ch(e,t,r){var o,s,c;return function(){var u=Wn(this,e),f=r(this),h=f+"";return f==null&&(h=f=(this.style.removeProperty(e),Wn(this,e))),u===h?null:u===o&&h===s?c:(s=h,c=t(o=u,f))}}function uh(e,t){var r,o,s,c="style."+t,u="end."+c,f;return function(){var h=Ht(this,e),p=h.on,m=h.value[c]==null?f||(f=ec(t)):void 0;(p!==r||s!==m)&&(o=(r=p).copy()).on(u,s=m),h.on=o}}function lh(e,t,r){var o=(e+="")=="transform"?ld:Ja;return t==null?this.styleTween(e,sh(e,o)).on("end.style."+e,ec(e)):typeof t=="function"?this.styleTween(e,ch(e,o,Li(this,"style."+e,t))).each(uh(this._id,e)):this.styleTween(e,ah(e,o,t),r).on("end.style."+e,null)}function fh(e,t,r){return function(o){this.style.setProperty(e,t.call(this,o),r)}}function dh(e,t,r){var o,s;function c(){var u=t.apply(this,arguments);return u!==s&&(o=(s=u)&&fh(e,u,r)),o}return c._value=t,c}function hh(e,t,r){var o="style."+(e+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(t==null)return this.tween(o,null);if(typeof t!="function")throw new Error;return this.tween(o,dh(e,t,r??""))}function ph(e){return function(){this.textContent=e}}function mh(e){return function(){var t=e(this);this.textContent=t??""}}function yh(e){return this.tween("text",typeof e=="function"?mh(Li(this,"text",e)):ph(e==null?"":e+""))}function gh(e){return function(t){this.textContent=e.call(this,t)}}function vh(e){var t,r;function o(){var s=e.apply(this,arguments);return s!==r&&(t=(r=s)&&gh(s)),t}return o._value=e,o}function wh(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,vh(e))}function xh(){for(var e=this._name,t=this._id,r=tc(),o=this._groups,s=o.length,c=0;c<s;++c)for(var u=o[c],f=u.length,h,p=0;p<f;++p)if(h=u[p]){var m=Mt(h,t);ko(h,e,r,p,u,{time:m.time+m.delay+m.duration,delay:0,duration:m.duration,ease:m.ease})}return new Gt(o,this._parents,e,r)}function bh(){var e,t,r=this,o=r._id,s=r.size();return new Promise(function(c,u){var f={value:u},h={value:function(){--s===0&&c()}};r.each(function(){var p=Ht(this,o),m=p.on;m!==e&&(t=(e=m).copy(),t._.cancel.push(f),t._.interrupt.push(f),t._.end.push(h)),p.on=t}),s===0&&c()})}var _h=0;function Gt(e,t,r,o){this._groups=e,this._parents=t,this._name=r,this._id=o}function tc(){return++_h}var Xt=kr.prototype;Gt.prototype={constructor:Gt,select:nh,selectAll:rh,selectChild:Xt.selectChild,selectChildren:Xt.selectChildren,filter:Ud,merge:Zd,selection:ih,transition:xh,call:Xt.call,nodes:Xt.nodes,node:Xt.node,size:Xt.size,empty:Xt.empty,each:Xt.each,on:Jd,attr:Pd,attrTween:Bd,style:lh,styleTween:hh,text:yh,textTween:wh,remove:th,tween:Nd,delay:Fd,duration:qd,ease:Wd,easeVarying:Xd,end:bh,[Symbol.iterator]:Xt[Symbol.iterator]};function Eh(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Sh={time:null,delay:0,duration:250,ease:Eh};function kh(e,t){for(var r;!(r=e.__transition)||!(r=r[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return r}function Nh(e){var t,r;e instanceof Gt?(t=e._id,e=e._name):(t=tc(),(r=Sh).time=Fi(),e=e==null?null:e+"");for(var o=this._groups,s=o.length,c=0;c<s;++c)for(var u=o[c],f=u.length,h,p=0;p<f;++p)(h=u[p])&&ko(h,e,t,p,u,r||kh(h,t));return new Gt(o,this._parents,e,t)}kr.prototype.interrupt=Ed;kr.prototype.transition=Nh;const Jr=e=>()=>e;function Ch(e,{sourceEvent:t,target:r,transform:o,dispatch:s}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:s}})}function Ut(e,t,r){this.k=e,this.x=t,this.y=r}Ut.prototype={constructor:Ut,scale:function(e){return e===1?this:new Ut(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Ut(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Zt=new Ut(1,0,0);Ut.prototype;function fi(e){e.stopImmediatePropagation()}function lr(e){e.preventDefault(),e.stopImmediatePropagation()}function Ah(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Th(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Ws(){return this.__zoom||Zt}function Mh(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Ih(){return navigator.maxTouchPoints||"ontouchstart"in this}function $h(e,t,r){var o=e.invertX(t[0][0])-r[0][0],s=e.invertX(t[1][0])-r[1][0],c=e.invertY(t[0][1])-r[0][1],u=e.invertY(t[1][1])-r[1][1];return e.translate(s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s),u>c?(c+u)/2:Math.min(0,c)||Math.max(0,u))}function nc(){var e=Ah,t=Th,r=$h,o=Mh,s=Ih,c=[0,1/0],u=[[-1/0,-1/0],[1/0,1/0]],f=250,h=md,p=_o("start","zoom","end"),m,v,w,g=500,k=150,N=0,P=10;function S(b){b.property("__zoom",Ws).on("wheel.zoom",ee,{passive:!1}).on("mousedown.zoom",G).on("dblclick.zoom",oe).filter(s).on("touchstart.zoom",ne).on("touchmove.zoom",le).on("touchend.zoom touchcancel.zoom",se).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}S.transform=function(b,L,j,W){var re=b.selection?b.selection():b;re.property("__zoom",Ws),b!==re?U(b,L,j,W):re.interrupt().each(function(){Q(this,arguments).event(W).start().zoom(null,typeof L=="function"?L.apply(this,arguments):L).end()})},S.scaleBy=function(b,L,j,W){S.scaleTo(b,function(){var re=this.__zoom.k,z=typeof L=="function"?L.apply(this,arguments):L;return re*z},j,W)},S.scaleTo=function(b,L,j,W){S.transform(b,function(){var re=t.apply(this,arguments),z=this.__zoom,J=j==null?C(re):typeof j=="function"?j.apply(this,arguments):j,ie=z.invert(J),ae=typeof L=="function"?L.apply(this,arguments):L;return r(K(H(z,ae),J,ie),re,u)},j,W)},S.translateBy=function(b,L,j,W){S.transform(b,function(){return r(this.__zoom.translate(typeof L=="function"?L.apply(this,arguments):L,typeof j=="function"?j.apply(this,arguments):j),t.apply(this,arguments),u)},null,W)},S.translateTo=function(b,L,j,W,re){S.transform(b,function(){var z=t.apply(this,arguments),J=this.__zoom,ie=W==null?C(z):typeof W=="function"?W.apply(this,arguments):W;return r(Zt.translate(ie[0],ie[1]).scale(J.k).translate(typeof L=="function"?-L.apply(this,arguments):-L,typeof j=="function"?-j.apply(this,arguments):-j),z,u)},W,re)};function H(b,L){return L=Math.max(c[0],Math.min(c[1],L)),L===b.k?b:new Ut(L,b.x,b.y)}function K(b,L,j){var W=L[0]-j[0]*b.k,re=L[1]-j[1]*b.k;return W===b.x&&re===b.y?b:new Ut(b.k,W,re)}function C(b){return[(+b[0][0]+ +b[1][0])/2,(+b[0][1]+ +b[1][1])/2]}function U(b,L,j,W){b.on("start.zoom",function(){Q(this,arguments).event(W).start()}).on("interrupt.zoom end.zoom",function(){Q(this,arguments).event(W).end()}).tween("zoom",function(){var re=this,z=arguments,J=Q(re,z).event(W),ie=t.apply(re,z),ae=j==null?C(ie):typeof j=="function"?j.apply(re,z):j,ge=Math.max(ie[1][0]-ie[0][0],ie[1][1]-ie[0][1]),ve=re.__zoom,be=typeof L=="function"?L.apply(re,z):L,ke=h(ve.invert(ae).concat(ge/ve.k),be.invert(ae).concat(ge/be.k));return function(Ae){if(Ae===1)Ae=be;else{var De=ke(Ae),de=ge/De[2];Ae=new Ut(de,ae[0]-De[0]*de,ae[1]-De[1]*de)}J.zoom(null,Ae)}})}function Q(b,L,j){return!j&&b.__zooming||new X(b,L)}function X(b,L){this.that=b,this.args=L,this.active=0,this.sourceEvent=null,this.extent=t.apply(b,L),this.taps=0}X.prototype={event:function(b){return b&&(this.sourceEvent=b),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(b,L){return this.mouse&&b!=="mouse"&&(this.mouse[1]=L.invert(this.mouse[0])),this.touch0&&b!=="touch"&&(this.touch0[1]=L.invert(this.touch0[0])),this.touch1&&b!=="touch"&&(this.touch1[1]=L.invert(this.touch1[0])),this.that.__zoom=L,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(b){var L=bt(this.that).datum();p.call(b,this.that,new Ch(b,{sourceEvent:this.sourceEvent,target:S,type:b,transform:this.that.__zoom,dispatch:p}),L)}};function ee(b,...L){if(!e.apply(this,arguments))return;var j=Q(this,L).event(b),W=this.__zoom,re=Math.max(c[0],Math.min(c[1],W.k*Math.pow(2,o.apply(this,arguments)))),z=Ct(b);if(j.wheel)(j.mouse[0][0]!==z[0]||j.mouse[0][1]!==z[1])&&(j.mouse[1]=W.invert(j.mouse[0]=z)),clearTimeout(j.wheel);else{if(W.k===re)return;j.mouse=[z,W.invert(z)],co(this),j.start()}lr(b),j.wheel=setTimeout(J,k),j.zoom("mouse",r(K(H(W,re),j.mouse[0],j.mouse[1]),j.extent,u));function J(){j.wheel=null,j.end()}}function G(b,...L){if(w||!e.apply(this,arguments))return;var j=b.currentTarget,W=Q(this,L,!0).event(b),re=bt(b.view).on("mousemove.zoom",ae,!0).on("mouseup.zoom",ge,!0),z=Ct(b,j),J=b.clientX,ie=b.clientY;Fa(b.view),fi(b),W.mouse=[z,this.__zoom.invert(z)],co(this),W.start();function ae(ve){if(lr(ve),!W.moved){var be=ve.clientX-J,ke=ve.clientY-ie;W.moved=be*be+ke*ke>N}W.event(ve).zoom("mouse",r(K(W.that.__zoom,W.mouse[0]=Ct(ve,j),W.mouse[1]),W.extent,u))}function ge(ve){re.on("mousemove.zoom mouseup.zoom",null),Ha(ve.view,W.moved),lr(ve),W.event(ve).end()}}function oe(b,...L){if(e.apply(this,arguments)){var j=this.__zoom,W=Ct(b.changedTouches?b.changedTouches[0]:b,this),re=j.invert(W),z=j.k*(b.shiftKey?.5:2),J=r(K(H(j,z),W,re),t.apply(this,L),u);lr(b),f>0?bt(this).transition().duration(f).call(U,J,W,b):bt(this).call(S.transform,J,W,b)}}function ne(b,...L){if(e.apply(this,arguments)){var j=b.touches,W=j.length,re=Q(this,L,b.changedTouches.length===W).event(b),z,J,ie,ae;for(fi(b),J=0;J<W;++J)ie=j[J],ae=Ct(ie,this),ae=[ae,this.__zoom.invert(ae),ie.identifier],re.touch0?!re.touch1&&re.touch0[2]!==ae[2]&&(re.touch1=ae,re.taps=0):(re.touch0=ae,z=!0,re.taps=1+!!m);m&&(m=clearTimeout(m)),z&&(re.taps<2&&(v=ae[0],m=setTimeout(function(){m=null},g)),co(this),re.start())}}function le(b,...L){if(this.__zooming){var j=Q(this,L).event(b),W=b.changedTouches,re=W.length,z,J,ie,ae;for(lr(b),z=0;z<re;++z)J=W[z],ie=Ct(J,this),j.touch0&&j.touch0[2]===J.identifier?j.touch0[0]=ie:j.touch1&&j.touch1[2]===J.identifier&&(j.touch1[0]=ie);if(J=j.that.__zoom,j.touch1){var ge=j.touch0[0],ve=j.touch0[1],be=j.touch1[0],ke=j.touch1[1],Ae=(Ae=be[0]-ge[0])*Ae+(Ae=be[1]-ge[1])*Ae,De=(De=ke[0]-ve[0])*De+(De=ke[1]-ve[1])*De;J=H(J,Math.sqrt(Ae/De)),ie=[(ge[0]+be[0])/2,(ge[1]+be[1])/2],ae=[(ve[0]+ke[0])/2,(ve[1]+ke[1])/2]}else if(j.touch0)ie=j.touch0[0],ae=j.touch0[1];else return;j.zoom("touch",r(K(J,ie,ae),j.extent,u))}}function se(b,...L){if(this.__zooming){var j=Q(this,L).event(b),W=b.changedTouches,re=W.length,z,J;for(fi(b),w&&clearTimeout(w),w=setTimeout(function(){w=null},g),z=0;z<re;++z)J=W[z],j.touch0&&j.touch0[2]===J.identifier?delete j.touch0:j.touch1&&j.touch1[2]===J.identifier&&delete j.touch1;if(j.touch1&&!j.touch0&&(j.touch0=j.touch1,delete j.touch1),j.touch0)j.touch0[1]=this.__zoom.invert(j.touch0[0]);else if(j.end(),j.taps===2&&(J=Ct(J,this),Math.hypot(v[0]-J[0],v[1]-J[1])<P)){var ie=bt(this).on("dblclick.zoom");ie&&ie.apply(this,arguments)}}}return S.wheelDelta=function(b){return arguments.length?(o=typeof b=="function"?b:Jr(+b),S):o},S.filter=function(b){return arguments.length?(e=typeof b=="function"?b:Jr(!!b),S):e},S.touchable=function(b){return arguments.length?(s=typeof b=="function"?b:Jr(!!b),S):s},S.extent=function(b){return arguments.length?(t=typeof b=="function"?b:Jr([[+b[0][0],+b[0][1]],[+b[1][0],+b[1][1]]]),S):t},S.scaleExtent=function(b){return arguments.length?(c[0]=+b[0],c[1]=+b[1],S):[c[0],c[1]]},S.translateExtent=function(b){return arguments.length?(u[0][0]=+b[0][0],u[1][0]=+b[1][0],u[0][1]=+b[0][1],u[1][1]=+b[1][1],S):[[u[0][0],u[0][1]],[u[1][0],u[1][1]]]},S.constrain=function(b){return arguments.length?(r=b,S):r},S.duration=function(b){return arguments.length?(f=+b,S):f},S.interpolate=function(b){return arguments.length?(h=b,S):h},S.on=function(){var b=p.on.apply(p,arguments);return b===p?S:b},S.clickDistance=function(b){return arguments.length?(N=(b=+b)*b,S):Math.sqrt(N)},S.tapDistance=function(b){return arguments.length?(P=+b,S):P},S}const No=D.createContext(null),Ph=No.Provider,Qt={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},rc=Qt.error001();function ze(e,t){const r=D.useContext(No);if(r===null)throw new Error(rc);return Aa(r,e,t)}const Xe=()=>{const e=D.useContext(No);if(e===null)throw new Error(rc);return D.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},Rh=e=>e.userSelectionActive?"none":"all";function Co({position:e,children:t,className:r,style:o,...s}){const c=ze(Rh),u=`${e}`.split("-");return Z.createElement("div",{className:et(["react-flow__panel",r,...u]),style:{...o,pointerEvents:c},...s},t)}function Dh({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:Z.createElement(Co,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},Z.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const Oh=({x:e,y:t,label:r,labelStyle:o={},labelShowBg:s=!0,labelBgStyle:c={},labelBgPadding:u=[2,4],labelBgBorderRadius:f=2,children:h,className:p,...m})=>{const v=D.useRef(null),[w,g]=D.useState({x:0,y:0,width:0,height:0}),k=et(["react-flow__edge-textwrapper",p]);return D.useEffect(()=>{if(v.current){const N=v.current.getBBox();g({x:N.x,y:N.y,width:N.width,height:N.height})}},[r]),typeof r>"u"||!r?null:Z.createElement("g",{transform:`translate(${e-w.width/2} ${t-w.height/2})`,className:k,visibility:w.width?"visible":"hidden",...m},s&&Z.createElement("rect",{width:w.width+2*u[0],x:-u[0],y:-u[1],height:w.height+2*u[1],className:"react-flow__edge-textbg",style:c,rx:f,ry:f}),Z.createElement("text",{className:"react-flow__edge-text",y:w.height/2,dy:"0.3em",ref:v,style:o},r),h)};var jh=D.memo(Oh);const qi=e=>({width:e.offsetWidth,height:e.offsetHeight}),Xn=(e,t=0,r=1)=>Math.min(Math.max(e,t),r),Vi=(e={x:0,y:0},t)=>({x:Xn(e.x,t[0][0],t[1][0]),y:Xn(e.y,t[0][1],t[1][1])}),Ys=(e,t,r)=>e<t?Xn(Math.abs(e-t),1,50)/50:e>r?-Xn(Math.abs(e-r),1,50)/50:0,oc=(e,t)=>{const r=Ys(e.x,35,t.width-35)*20,o=Ys(e.y,35,t.height-35)*20;return[r,o]},ic=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},sc=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),_r=({x:e,y:t,width:r,height:o})=>({x:e,y:t,x2:e+r,y2:t+o}),ac=({x:e,y:t,x2:r,y2:o})=>({x:e,y:t,width:r-e,height:o-t}),Xs=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),Bh=(e,t)=>ac(sc(_r(e),_r(t))),Ni=(e,t)=>{const r=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),o=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(r*o)},zh=e=>_t(e.width)&&_t(e.height)&&_t(e.x)&&_t(e.y),_t=e=>!isNaN(e)&&isFinite(e),qe=Symbol.for("internals"),cc=["Enter"," ","Escape"],Kh=(e,t)=>{},Fh=e=>"nativeEvent"in e;function Ci(e){var s,c;const t=Fh(e)?e.nativeEvent:e,r=((c=(s=t.composedPath)==null?void 0:s.call(t))==null?void 0:c[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(r==null?void 0:r.nodeName)||(r==null?void 0:r.hasAttribute("contenteditable"))||!!(r!=null&&r.closest(".nokey"))}const uc=e=>"clientX"in e,dn=(e,t)=>{var c,u;const r=uc(e),o=r?e.clientX:(c=e.touches)==null?void 0:c[0].clientX,s=r?e.clientY:(u=e.touches)==null?void 0:u[0].clientY;return{x:o-((t==null?void 0:t.left)??0),y:s-((t==null?void 0:t.top)??0)}},yo=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0},Cr=({id:e,path:t,labelX:r,labelY:o,label:s,labelStyle:c,labelShowBg:u,labelBgStyle:f,labelBgPadding:h,labelBgBorderRadius:p,style:m,markerEnd:v,markerStart:w,interactionWidth:g=20})=>Z.createElement(Z.Fragment,null,Z.createElement("path",{id:e,style:m,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:v,markerStart:w}),g&&Z.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:g,className:"react-flow__edge-interaction"}),s&&_t(r)&&_t(o)?Z.createElement(jh,{x:r,y:o,label:s,labelStyle:c,labelShowBg:u,labelBgStyle:f,labelBgPadding:h,labelBgBorderRadius:p}):null);Cr.displayName="BaseEdge";function fr(e,t,r){return r===void 0?r:o=>{const s=t().edges.find(c=>c.id===e);s&&r(o,{...s})}}function lc({sourceX:e,sourceY:t,targetX:r,targetY:o}){const s=Math.abs(r-e)/2,c=r<e?r+s:r-s,u=Math.abs(o-t)/2,f=o<t?o+u:o-u;return[c,f,s,u]}function fc({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:s,sourceControlY:c,targetControlX:u,targetControlY:f}){const h=e*.125+s*.375+u*.375+r*.125,p=t*.125+c*.375+f*.375+o*.125,m=Math.abs(h-e),v=Math.abs(p-t);return[h,p,m,v]}var Sn;(function(e){e.Strict="strict",e.Loose="loose"})(Sn||(Sn={}));var xn;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(xn||(xn={}));var Er;(function(e){e.Partial="partial",e.Full="full"})(Er||(Er={}));var ln;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(ln||(ln={}));var go;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(go||(go={}));var _e;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(_e||(_e={}));function Us({pos:e,x1:t,y1:r,x2:o,y2:s}){return e===_e.Left||e===_e.Right?[.5*(t+o),r]:[t,.5*(r+s)]}function dc({sourceX:e,sourceY:t,sourcePosition:r=_e.Bottom,targetX:o,targetY:s,targetPosition:c=_e.Top}){const[u,f]=Us({pos:r,x1:e,y1:t,x2:o,y2:s}),[h,p]=Us({pos:c,x1:o,y1:s,x2:e,y2:t}),[m,v,w,g]=fc({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:u,sourceControlY:f,targetControlX:h,targetControlY:p});return[`M${e},${t} C${u},${f} ${h},${p} ${o},${s}`,m,v,w,g]}const Wi=D.memo(({sourceX:e,sourceY:t,targetX:r,targetY:o,sourcePosition:s=_e.Bottom,targetPosition:c=_e.Top,label:u,labelStyle:f,labelShowBg:h,labelBgStyle:p,labelBgPadding:m,labelBgBorderRadius:v,style:w,markerEnd:g,markerStart:k,interactionWidth:N})=>{const[P,S,H]=dc({sourceX:e,sourceY:t,sourcePosition:s,targetX:r,targetY:o,targetPosition:c});return Z.createElement(Cr,{path:P,labelX:S,labelY:H,label:u,labelStyle:f,labelShowBg:h,labelBgStyle:p,labelBgPadding:m,labelBgBorderRadius:v,style:w,markerEnd:g,markerStart:k,interactionWidth:N})});Wi.displayName="SimpleBezierEdge";const Zs={[_e.Left]:{x:-1,y:0},[_e.Right]:{x:1,y:0},[_e.Top]:{x:0,y:-1},[_e.Bottom]:{x:0,y:1}},Hh=({source:e,sourcePosition:t=_e.Bottom,target:r})=>t===_e.Left||t===_e.Right?e.x<r.x?{x:1,y:0}:{x:-1,y:0}:e.y<r.y?{x:0,y:1}:{x:0,y:-1},Gs=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Lh({source:e,sourcePosition:t=_e.Bottom,target:r,targetPosition:o=_e.Top,center:s,offset:c}){const u=Zs[t],f=Zs[o],h={x:e.x+u.x*c,y:e.y+u.y*c},p={x:r.x+f.x*c,y:r.y+f.y*c},m=Hh({source:h,sourcePosition:t,target:p}),v=m.x!==0?"x":"y",w=m[v];let g=[],k,N;const P={x:0,y:0},S={x:0,y:0},[H,K,C,U]=lc({sourceX:e.x,sourceY:e.y,targetX:r.x,targetY:r.y});if(u[v]*f[v]===-1){k=s.x??H,N=s.y??K;const X=[{x:k,y:h.y},{x:k,y:p.y}],ee=[{x:h.x,y:N},{x:p.x,y:N}];u[v]===w?g=v==="x"?X:ee:g=v==="x"?ee:X}else{const X=[{x:h.x,y:p.y}],ee=[{x:p.x,y:h.y}];if(v==="x"?g=u.x===w?ee:X:g=u.y===w?X:ee,t===o){const se=Math.abs(e[v]-r[v]);if(se<=c){const b=Math.min(c-1,c-se);u[v]===w?P[v]=(h[v]>e[v]?-1:1)*b:S[v]=(p[v]>r[v]?-1:1)*b}}if(t!==o){const se=v==="x"?"y":"x",b=u[v]===f[se],L=h[se]>p[se],j=h[se]<p[se];(u[v]===1&&(!b&&L||b&&j)||u[v]!==1&&(!b&&j||b&&L))&&(g=v==="x"?X:ee)}const G={x:h.x+P.x,y:h.y+P.y},oe={x:p.x+S.x,y:p.y+S.y},ne=Math.max(Math.abs(G.x-g[0].x),Math.abs(oe.x-g[0].x)),le=Math.max(Math.abs(G.y-g[0].y),Math.abs(oe.y-g[0].y));ne>=le?(k=(G.x+oe.x)/2,N=g[0].y):(k=g[0].x,N=(G.y+oe.y)/2)}return[[e,{x:h.x+P.x,y:h.y+P.y},...g,{x:p.x+S.x,y:p.y+S.y},r],k,N,C,U]}function qh(e,t,r,o){const s=Math.min(Gs(e,t)/2,Gs(t,r)/2,o),{x:c,y:u}=t;if(e.x===c&&c===r.x||e.y===u&&u===r.y)return`L${c} ${u}`;if(e.y===u){const p=e.x<r.x?-1:1,m=e.y<r.y?1:-1;return`L ${c+s*p},${u}Q ${c},${u} ${c},${u+s*m}`}const f=e.x<r.x?1:-1,h=e.y<r.y?-1:1;return`L ${c},${u+s*h}Q ${c},${u} ${c+s*f},${u}`}function Ai({sourceX:e,sourceY:t,sourcePosition:r=_e.Bottom,targetX:o,targetY:s,targetPosition:c=_e.Top,borderRadius:u=5,centerX:f,centerY:h,offset:p=20}){const[m,v,w,g,k]=Lh({source:{x:e,y:t},sourcePosition:r,target:{x:o,y:s},targetPosition:c,center:{x:f,y:h},offset:p});return[m.reduce((P,S,H)=>{let K="";return H>0&&H<m.length-1?K=qh(m[H-1],S,m[H+1],u):K=`${H===0?"M":"L"}${S.x} ${S.y}`,P+=K,P},""),v,w,g,k]}const Ao=D.memo(({sourceX:e,sourceY:t,targetX:r,targetY:o,label:s,labelStyle:c,labelShowBg:u,labelBgStyle:f,labelBgPadding:h,labelBgBorderRadius:p,style:m,sourcePosition:v=_e.Bottom,targetPosition:w=_e.Top,markerEnd:g,markerStart:k,pathOptions:N,interactionWidth:P})=>{const[S,H,K]=Ai({sourceX:e,sourceY:t,sourcePosition:v,targetX:r,targetY:o,targetPosition:w,borderRadius:N==null?void 0:N.borderRadius,offset:N==null?void 0:N.offset});return Z.createElement(Cr,{path:S,labelX:H,labelY:K,label:s,labelStyle:c,labelShowBg:u,labelBgStyle:f,labelBgPadding:h,labelBgBorderRadius:p,style:m,markerEnd:g,markerStart:k,interactionWidth:P})});Ao.displayName="SmoothStepEdge";const Yi=D.memo(e=>{var t;return Z.createElement(Ao,{...e,pathOptions:D.useMemo(()=>{var r;return{borderRadius:0,offset:(r=e.pathOptions)==null?void 0:r.offset}},[(t=e.pathOptions)==null?void 0:t.offset])})});Yi.displayName="StepEdge";function Vh({sourceX:e,sourceY:t,targetX:r,targetY:o}){const[s,c,u,f]=lc({sourceX:e,sourceY:t,targetX:r,targetY:o});return[`M ${e},${t}L ${r},${o}`,s,c,u,f]}const Xi=D.memo(({sourceX:e,sourceY:t,targetX:r,targetY:o,label:s,labelStyle:c,labelShowBg:u,labelBgStyle:f,labelBgPadding:h,labelBgBorderRadius:p,style:m,markerEnd:v,markerStart:w,interactionWidth:g})=>{const[k,N,P]=Vh({sourceX:e,sourceY:t,targetX:r,targetY:o});return Z.createElement(Cr,{path:k,labelX:N,labelY:P,label:s,labelStyle:c,labelShowBg:u,labelBgStyle:f,labelBgPadding:h,labelBgBorderRadius:p,style:m,markerEnd:v,markerStart:w,interactionWidth:g})});Xi.displayName="StraightEdge";function eo(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Qs({pos:e,x1:t,y1:r,x2:o,y2:s,c}){switch(e){case _e.Left:return[t-eo(t-o,c),r];case _e.Right:return[t+eo(o-t,c),r];case _e.Top:return[t,r-eo(r-s,c)];case _e.Bottom:return[t,r+eo(s-r,c)]}}function hc({sourceX:e,sourceY:t,sourcePosition:r=_e.Bottom,targetX:o,targetY:s,targetPosition:c=_e.Top,curvature:u=.25}){const[f,h]=Qs({pos:r,x1:e,y1:t,x2:o,y2:s,c:u}),[p,m]=Qs({pos:c,x1:o,y1:s,x2:e,y2:t,c:u}),[v,w,g,k]=fc({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:f,sourceControlY:h,targetControlX:p,targetControlY:m});return[`M${e},${t} C${f},${h} ${p},${m} ${o},${s}`,v,w,g,k]}const vo=D.memo(({sourceX:e,sourceY:t,targetX:r,targetY:o,sourcePosition:s=_e.Bottom,targetPosition:c=_e.Top,label:u,labelStyle:f,labelShowBg:h,labelBgStyle:p,labelBgPadding:m,labelBgBorderRadius:v,style:w,markerEnd:g,markerStart:k,pathOptions:N,interactionWidth:P})=>{const[S,H,K]=hc({sourceX:e,sourceY:t,sourcePosition:s,targetX:r,targetY:o,targetPosition:c,curvature:N==null?void 0:N.curvature});return Z.createElement(Cr,{path:S,labelX:H,labelY:K,label:u,labelStyle:f,labelShowBg:h,labelBgStyle:p,labelBgPadding:m,labelBgBorderRadius:v,style:w,markerEnd:g,markerStart:k,interactionWidth:P})});vo.displayName="BezierEdge";const Ui=D.createContext(null),Wh=Ui.Provider;Ui.Consumer;const Yh=()=>D.useContext(Ui),Xh=e=>"id"in e&&"source"in e&&"target"in e,Uh=({source:e,sourceHandle:t,target:r,targetHandle:o})=>`reactflow__edge-${e}${t||""}-${r}${o||""}`,Ti=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(o=>`${o}=${e[o]}`).join("&")}`,Zh=(e,t)=>t.some(r=>r.source===e.source&&r.target===e.target&&(r.sourceHandle===e.sourceHandle||!r.sourceHandle&&!e.sourceHandle)&&(r.targetHandle===e.targetHandle||!r.targetHandle&&!e.targetHandle)),Gh=(e,t)=>{if(!e.source||!e.target)return t;let r;return Xh(e)?r={...e}:r={...e,id:Uh(e)},Zh(r,t)?t:t.concat(r)},Mi=({x:e,y:t},[r,o,s],c,[u,f])=>{const h={x:(e-r)/s,y:(t-o)/s};return c?{x:u*Math.round(h.x/u),y:f*Math.round(h.y/f)}:h},pc=({x:e,y:t},[r,o,s])=>({x:e*s+r,y:t*s+o}),_n=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const r=(e.width??0)*t[0],o=(e.height??0)*t[1],s={x:e.position.x-r,y:e.position.y-o};return{...s,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-r,y:e.positionAbsolute.y-o}:s}},To=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const r=e.reduce((o,s)=>{const{x:c,y:u}=_n(s,t).positionAbsolute;return sc(o,_r({x:c,y:u,width:s.width||0,height:s.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return ac(r)},mc=(e,t,[r,o,s]=[0,0,1],c=!1,u=!1,f=[0,0])=>{const h={x:(t.x-r)/s,y:(t.y-o)/s,width:t.width/s,height:t.height/s},p=[];return e.forEach(m=>{const{width:v,height:w,selectable:g=!0,hidden:k=!1}=m;if(u&&!g||k)return!1;const{positionAbsolute:N}=_n(m,f),P={x:N.x,y:N.y,width:v||0,height:w||0},S=Ni(h,P),H=typeof v>"u"||typeof w>"u"||v===null||w===null,K=c&&S>0,C=(v||0)*(w||0);(H||K||S>=C||m.dragging)&&p.push(m)}),p},yc=(e,t)=>{const r=e.map(o=>o.id);return t.filter(o=>r.includes(o.source)||r.includes(o.target))},gc=(e,t,r,o,s,c=.1)=>{const u=t/(e.width*(1+c)),f=r/(e.height*(1+c)),h=Math.min(u,f),p=Xn(h,o,s),m=e.x+e.width/2,v=e.y+e.height/2,w=t/2-m*p,g=r/2-v*p;return{x:w,y:g,zoom:p}},gn=(e,t=0)=>e.transition().duration(t);function Js(e,t,r,o){return(t[r]||[]).reduce((s,c)=>{var u,f;return`${e.id}-${c.id}-${r}`!==o&&s.push({id:c.id||null,type:r,nodeId:e.id,x:(((u=e.positionAbsolute)==null?void 0:u.x)??0)+c.x+c.width/2,y:(((f=e.positionAbsolute)==null?void 0:f.y)??0)+c.y+c.height/2}),s},[])}function Qh(e,t,r,o,s,c){const{x:u,y:f}=dn(e),p=t.elementsFromPoint(u,f).find(k=>k.classList.contains("react-flow__handle"));if(p){const k=p.getAttribute("data-nodeid");if(k){const N=Zi(void 0,p),P=p.getAttribute("data-handleid"),S=c({nodeId:k,id:P,type:N});if(S){const H=s.find(K=>K.nodeId===k&&K.type===N&&K.id===P);return{handle:{id:P,type:N,nodeId:k,x:(H==null?void 0:H.x)||r.x,y:(H==null?void 0:H.y)||r.y},validHandleResult:S}}}}let m=[],v=1/0;if(s.forEach(k=>{const N=Math.sqrt((k.x-r.x)**2+(k.y-r.y)**2);if(N<=o){const P=c(k);N<=v&&(N<v?m=[{handle:k,validHandleResult:P}]:N===v&&m.push({handle:k,validHandleResult:P}),v=N)}}),!m.length)return{handle:null,validHandleResult:vc()};if(m.length===1)return m[0];const w=m.some(({validHandleResult:k})=>k.isValid),g=m.some(({handle:k})=>k.type==="target");return m.find(({handle:k,validHandleResult:N})=>g?k.type==="target":w?N.isValid:!0)||m[0]}const Jh={source:null,target:null,sourceHandle:null,targetHandle:null},vc=()=>({handleDomNode:null,isValid:!1,connection:Jh,endHandle:null});function wc(e,t,r,o,s,c,u){const f=s==="target",h=u.querySelector(`.react-flow__handle[data-id="${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`),p={...vc(),handleDomNode:h};if(h){const m=Zi(void 0,h),v=h.getAttribute("data-nodeid"),w=h.getAttribute("data-handleid"),g=h.classList.contains("connectable"),k=h.classList.contains("connectableend"),N={source:f?v:r,sourceHandle:f?w:o,target:f?r:v,targetHandle:f?o:w};p.connection=N,g&&k&&(t===Sn.Strict?f&&m==="source"||!f&&m==="target":v!==r||w!==o)&&(p.endHandle={nodeId:v,handleId:w,type:m},p.isValid=c(N))}return p}function ep({nodes:e,nodeId:t,handleId:r,handleType:o}){return e.reduce((s,c)=>{if(c[qe]){const{handleBounds:u}=c[qe];let f=[],h=[];u&&(f=Js(c,u,"source",`${t}-${r}-${o}`),h=Js(c,u,"target",`${t}-${r}-${o}`)),s.push(...f,...h)}return s},[])}function Zi(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function di(e){e==null||e.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function tp(e,t){let r=null;return t?r="valid":e&&!t&&(r="invalid"),r}function xc({event:e,handleId:t,nodeId:r,onConnect:o,isTarget:s,getState:c,setState:u,isValidConnection:f,edgeUpdaterType:h,onReconnectEnd:p}){const m=ic(e.target),{connectionMode:v,domNode:w,autoPanOnConnect:g,connectionRadius:k,onConnectStart:N,panBy:P,getNodes:S,cancelConnection:H}=c();let K=0,C;const{x:U,y:Q}=dn(e),X=m==null?void 0:m.elementFromPoint(U,Q),ee=Zi(h,X),G=w==null?void 0:w.getBoundingClientRect();if(!G||!ee)return;let oe,ne=dn(e,G),le=!1,se=null,b=!1,L=null;const j=ep({nodes:S(),nodeId:r,handleId:t,handleType:ee}),W=()=>{if(!g)return;const[J,ie]=oc(ne,G);P({x:J,y:ie}),K=requestAnimationFrame(W)};u({connectionPosition:ne,connectionStatus:null,connectionNodeId:r,connectionHandleId:t,connectionHandleType:ee,connectionStartHandle:{nodeId:r,handleId:t,type:ee},connectionEndHandle:null}),N==null||N(e,{nodeId:r,handleId:t,handleType:ee});function re(J){const{transform:ie}=c();ne=dn(J,G);const{handle:ae,validHandleResult:ge}=Qh(J,m,Mi(ne,ie,!1,[1,1]),k,j,ve=>wc(ve,v,r,t,s?"target":"source",f,m));if(C=ae,le||(W(),le=!0),L=ge.handleDomNode,se=ge.connection,b=ge.isValid,u({connectionPosition:C&&b?pc({x:C.x,y:C.y},ie):ne,connectionStatus:tp(!!C,b),connectionEndHandle:ge.endHandle}),!C&&!b&&!L)return di(oe);se.source!==se.target&&L&&(di(oe),oe=L,L.classList.add("connecting","react-flow__handle-connecting"),L.classList.toggle("valid",b),L.classList.toggle("react-flow__handle-valid",b))}function z(J){var ie,ae;(C||L)&&se&&b&&(o==null||o(se)),(ae=(ie=c()).onConnectEnd)==null||ae.call(ie,J),h&&(p==null||p(J)),di(oe),H(),cancelAnimationFrame(K),le=!1,b=!1,se=null,L=null,m.removeEventListener("mousemove",re),m.removeEventListener("mouseup",z),m.removeEventListener("touchmove",re),m.removeEventListener("touchend",z)}m.addEventListener("mousemove",re),m.addEventListener("mouseup",z),m.addEventListener("touchmove",re),m.addEventListener("touchend",z)}const ea=()=>!0,np=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),rp=(e,t,r)=>o=>{const{connectionStartHandle:s,connectionEndHandle:c,connectionClickStartHandle:u}=o;return{connecting:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.handleId)===t&&(s==null?void 0:s.type)===r||(c==null?void 0:c.nodeId)===e&&(c==null?void 0:c.handleId)===t&&(c==null?void 0:c.type)===r,clickConnecting:(u==null?void 0:u.nodeId)===e&&(u==null?void 0:u.handleId)===t&&(u==null?void 0:u.type)===r}},bc=D.forwardRef(({type:e="source",position:t=_e.Top,isValidConnection:r,isConnectable:o=!0,isConnectableStart:s=!0,isConnectableEnd:c=!0,id:u,onConnect:f,children:h,className:p,onMouseDown:m,onTouchStart:v,...w},g)=>{var G,oe;const k=u||null,N=e==="target",P=Xe(),S=Yh(),{connectOnClick:H,noPanClassName:K}=ze(np,Qe),{connecting:C,clickConnecting:U}=ze(rp(S,k,e),Qe);S||(oe=(G=P.getState()).onError)==null||oe.call(G,"010",Qt.error010());const Q=ne=>{const{defaultEdgeOptions:le,onConnect:se,hasDefaultEdges:b}=P.getState(),L={...le,...ne};if(b){const{edges:j,setEdges:W}=P.getState();W(Gh(L,j))}se==null||se(L),f==null||f(L)},X=ne=>{if(!S)return;const le=uc(ne);s&&(le&&ne.button===0||!le)&&xc({event:ne,handleId:k,nodeId:S,onConnect:Q,isTarget:N,getState:P.getState,setState:P.setState,isValidConnection:r||P.getState().isValidConnection||ea}),le?m==null||m(ne):v==null||v(ne)},ee=ne=>{const{onClickConnectStart:le,onClickConnectEnd:se,connectionClickStartHandle:b,connectionMode:L,isValidConnection:j}=P.getState();if(!S||!b&&!s)return;if(!b){le==null||le(ne,{nodeId:S,handleId:k,handleType:e}),P.setState({connectionClickStartHandle:{nodeId:S,type:e,handleId:k}});return}const W=ic(ne.target),re=r||j||ea,{connection:z,isValid:J}=wc({nodeId:S,id:k,type:e},L,b.nodeId,b.handleId||null,b.type,re,W);J&&Q(z),se==null||se(ne),P.setState({connectionClickStartHandle:null})};return Z.createElement("div",{"data-handleid":k,"data-nodeid":S,"data-handlepos":t,"data-id":`${S}-${k}-${e}`,className:et(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",K,p,{source:!N,target:N,connectable:o,connectablestart:s,connectableend:c,connecting:U,connectionindicator:o&&(s&&!C||c&&C)}]),onMouseDown:X,onTouchStart:X,onClick:H?ee:void 0,ref:g,...w},h)});bc.displayName="Handle";var fn=D.memo(bc);const _c=({data:e,isConnectable:t,targetPosition:r=_e.Top,sourcePosition:o=_e.Bottom})=>Z.createElement(Z.Fragment,null,Z.createElement(fn,{type:"target",position:r,isConnectable:t}),e==null?void 0:e.label,Z.createElement(fn,{type:"source",position:o,isConnectable:t}));_c.displayName="DefaultNode";var Ii=D.memo(_c);const Ec=({data:e,isConnectable:t,sourcePosition:r=_e.Bottom})=>Z.createElement(Z.Fragment,null,e==null?void 0:e.label,Z.createElement(fn,{type:"source",position:r,isConnectable:t}));Ec.displayName="InputNode";var Sc=D.memo(Ec);const kc=({data:e,isConnectable:t,targetPosition:r=_e.Top})=>Z.createElement(Z.Fragment,null,Z.createElement(fn,{type:"target",position:r,isConnectable:t}),e==null?void 0:e.label);kc.displayName="OutputNode";var Nc=D.memo(kc);const Gi=()=>null;Gi.displayName="GroupNode";const op=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>({...t}))}),to=e=>e.id;function ip(e,t){return Qe(e.selectedNodes.map(to),t.selectedNodes.map(to))&&Qe(e.selectedEdges.map(to),t.selectedEdges.map(to))}const Cc=D.memo(({onSelectionChange:e})=>{const t=Xe(),{selectedNodes:r,selectedEdges:o}=ze(op,ip);return D.useEffect(()=>{const s={nodes:r,edges:o};e==null||e(s),t.getState().onSelectionChange.forEach(c=>c(s))},[r,o,e]),null});Cc.displayName="SelectionListener";const sp=e=>!!e.onSelectionChange;function ap({onSelectionChange:e}){const t=ze(sp);return e||t?Z.createElement(Cc,{onSelectionChange:e}):null}const cp=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function jn(e,t){D.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function $e(e,t,r){D.useEffect(()=>{typeof t<"u"&&r({[e]:t})},[t])}const up=({nodes:e,edges:t,defaultNodes:r,defaultEdges:o,onConnect:s,onConnectStart:c,onConnectEnd:u,onClickConnectStart:f,onClickConnectEnd:h,nodesDraggable:p,nodesConnectable:m,nodesFocusable:v,edgesFocusable:w,edgesUpdatable:g,elevateNodesOnSelect:k,minZoom:N,maxZoom:P,nodeExtent:S,onNodesChange:H,onEdgesChange:K,elementsSelectable:C,connectionMode:U,snapGrid:Q,snapToGrid:X,translateExtent:ee,connectOnClick:G,defaultEdgeOptions:oe,fitView:ne,fitViewOptions:le,onNodesDelete:se,onEdgesDelete:b,onNodeDrag:L,onNodeDragStart:j,onNodeDragStop:W,onSelectionDrag:re,onSelectionDragStart:z,onSelectionDragStop:J,noPanClassName:ie,nodeOrigin:ae,rfId:ge,autoPanOnConnect:ve,autoPanOnNodeDrag:be,onError:ke,connectionRadius:Ae,isValidConnection:De,nodeDragThreshold:de})=>{const{setNodes:Pe,setEdges:Le,setDefaultNodesAndEdges:Se,setMinZoom:Ve,setMaxZoom:Ue,setTranslateExtent:je,setNodeExtent:at,reset:Oe}=ze(cp,Qe),Ee=Xe();return D.useEffect(()=>{const Je=o==null?void 0:o.map(dt=>({...dt,...oe}));return Se(r,Je),()=>{Oe()}},[]),$e("defaultEdgeOptions",oe,Ee.setState),$e("connectionMode",U,Ee.setState),$e("onConnect",s,Ee.setState),$e("onConnectStart",c,Ee.setState),$e("onConnectEnd",u,Ee.setState),$e("onClickConnectStart",f,Ee.setState),$e("onClickConnectEnd",h,Ee.setState),$e("nodesDraggable",p,Ee.setState),$e("nodesConnectable",m,Ee.setState),$e("nodesFocusable",v,Ee.setState),$e("edgesFocusable",w,Ee.setState),$e("edgesUpdatable",g,Ee.setState),$e("elementsSelectable",C,Ee.setState),$e("elevateNodesOnSelect",k,Ee.setState),$e("snapToGrid",X,Ee.setState),$e("snapGrid",Q,Ee.setState),$e("onNodesChange",H,Ee.setState),$e("onEdgesChange",K,Ee.setState),$e("connectOnClick",G,Ee.setState),$e("fitViewOnInit",ne,Ee.setState),$e("fitViewOnInitOptions",le,Ee.setState),$e("onNodesDelete",se,Ee.setState),$e("onEdgesDelete",b,Ee.setState),$e("onNodeDrag",L,Ee.setState),$e("onNodeDragStart",j,Ee.setState),$e("onNodeDragStop",W,Ee.setState),$e("onSelectionDrag",re,Ee.setState),$e("onSelectionDragStart",z,Ee.setState),$e("onSelectionDragStop",J,Ee.setState),$e("noPanClassName",ie,Ee.setState),$e("nodeOrigin",ae,Ee.setState),$e("rfId",ge,Ee.setState),$e("autoPanOnConnect",ve,Ee.setState),$e("autoPanOnNodeDrag",be,Ee.setState),$e("onError",ke,Ee.setState),$e("connectionRadius",Ae,Ee.setState),$e("isValidConnection",De,Ee.setState),$e("nodeDragThreshold",de,Ee.setState),jn(e,Pe),jn(t,Le),jn(N,Ve),jn(P,Ue),jn(ee,je),jn(S,at),null},ta={display:"none"},lp={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Ac="react-flow__node-desc",Tc="react-flow__edge-desc",fp="react-flow__aria-live",dp=e=>e.ariaLiveMessage;function hp({rfId:e}){const t=ze(dp);return Z.createElement("div",{id:`${fp}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:lp},t)}function pp({rfId:e,disableKeyboardA11y:t}){return Z.createElement(Z.Fragment,null,Z.createElement("div",{id:`${Ac}-${e}`,style:ta},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),Z.createElement("div",{id:`${Tc}-${e}`,style:ta},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&Z.createElement(hp,{rfId:e}))}var Sr=(e=null,t={actInsideInputWithModifier:!0})=>{const[r,o]=D.useState(!1),s=D.useRef(!1),c=D.useRef(new Set([])),[u,f]=D.useMemo(()=>{if(e!==null){const p=(Array.isArray(e)?e:[e]).filter(v=>typeof v=="string").map(v=>v.split("+")),m=p.reduce((v,w)=>v.concat(...w),[]);return[p,m]}return[[],[]]},[e]);return D.useEffect(()=>{const h=typeof document<"u"?document:null,p=(t==null?void 0:t.target)||h;if(e!==null){const m=g=>{if(s.current=g.ctrlKey||g.metaKey||g.shiftKey,(!s.current||s.current&&!t.actInsideInputWithModifier)&&Ci(g))return!1;const N=ra(g.code,f);c.current.add(g[N]),na(u,c.current,!1)&&(g.preventDefault(),o(!0))},v=g=>{if((!s.current||s.current&&!t.actInsideInputWithModifier)&&Ci(g))return!1;const N=ra(g.code,f);na(u,c.current,!0)?(o(!1),c.current.clear()):c.current.delete(g[N]),g.key==="Meta"&&c.current.clear(),s.current=!1},w=()=>{c.current.clear(),o(!1)};return p==null||p.addEventListener("keydown",m),p==null||p.addEventListener("keyup",v),window.addEventListener("blur",w),()=>{p==null||p.removeEventListener("keydown",m),p==null||p.removeEventListener("keyup",v),window.removeEventListener("blur",w)}}},[e,o]),r};function na(e,t,r){return e.filter(o=>r||o.length===t.size).some(o=>o.every(s=>t.has(s)))}function ra(e,t){return t.includes(e)?"code":"key"}function Mc(e,t,r,o){var f,h;const s=e.parentNode||e.parentId;if(!s)return r;const c=t.get(s),u=_n(c,o);return Mc(c,t,{x:(r.x??0)+u.x,y:(r.y??0)+u.y,z:(((f=c[qe])==null?void 0:f.z)??0)>(r.z??0)?((h=c[qe])==null?void 0:h.z)??0:r.z??0},o)}function Ic(e,t,r){e.forEach(o=>{var c;const s=o.parentNode||o.parentId;if(s&&!e.has(s))throw new Error(`Parent node ${s} not found`);if(s||r!=null&&r[o.id]){const{x:u,y:f,z:h}=Mc(o,e,{...o.position,z:((c=o[qe])==null?void 0:c.z)??0},t);o.positionAbsolute={x:u,y:f},o[qe].z=h,r!=null&&r[o.id]&&(o[qe].isParent=!0)}})}function hi(e,t,r,o){const s=new Map,c={},u=o?1e3:0;return e.forEach(f=>{var g;const h=(_t(f.zIndex)?f.zIndex:0)+(f.selected?u:0),p=t.get(f.id),m={...f,positionAbsolute:{x:f.position.x,y:f.position.y}},v=f.parentNode||f.parentId;v&&(c[v]=!0);const w=(p==null?void 0:p.type)&&(p==null?void 0:p.type)!==f.type;Object.defineProperty(m,qe,{enumerable:!1,value:{handleBounds:w||(g=p==null?void 0:p[qe])==null?void 0:g.handleBounds,z:h}}),s.set(f.id,m)}),Ic(s,r,c),s}function $c(e,t={}){const{getNodes:r,width:o,height:s,minZoom:c,maxZoom:u,d3Zoom:f,d3Selection:h,fitViewOnInitDone:p,fitViewOnInit:m,nodeOrigin:v}=e(),w=t.initial&&!p&&m;if(f&&h&&(w||!t.initial)){const k=r().filter(P=>{var H;const S=t.includeHiddenNodes?P.width&&P.height:!P.hidden;return(H=t.nodes)!=null&&H.length?S&&t.nodes.some(K=>K.id===P.id):S}),N=k.every(P=>P.width&&P.height);if(k.length>0&&N){const P=To(k,v),{x:S,y:H,zoom:K}=gc(P,o,s,t.minZoom??c,t.maxZoom??u,t.padding??.1),C=Zt.translate(S,H).scale(K);return typeof t.duration=="number"&&t.duration>0?f.transform(gn(h,t.duration),C):f.transform(h,C),!0}}return!1}function mp(e,t){return e.forEach(r=>{const o=t.get(r.id);o&&t.set(o.id,{...o,[qe]:o[qe],selected:r.selected})}),new Map(t)}function yp(e,t){return t.map(r=>{const o=e.find(s=>s.id===r.id);return o&&(r.selected=o.selected),r})}function no({changedNodes:e,changedEdges:t,get:r,set:o}){const{nodeInternals:s,edges:c,onNodesChange:u,onEdgesChange:f,hasDefaultNodes:h,hasDefaultEdges:p}=r();e!=null&&e.length&&(h&&o({nodeInternals:mp(e,s)}),u==null||u(e)),t!=null&&t.length&&(p&&o({edges:yp(t,c)}),f==null||f(t))}const Bn=()=>{},gp={zoomIn:Bn,zoomOut:Bn,zoomTo:Bn,getZoom:()=>1,setViewport:Bn,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:Bn,fitBounds:Bn,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},vp=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),wp=()=>{const e=Xe(),{d3Zoom:t,d3Selection:r}=ze(vp,Qe);return D.useMemo(()=>r&&t?{zoomIn:s=>t.scaleBy(gn(r,s==null?void 0:s.duration),1.2),zoomOut:s=>t.scaleBy(gn(r,s==null?void 0:s.duration),1/1.2),zoomTo:(s,c)=>t.scaleTo(gn(r,c==null?void 0:c.duration),s),getZoom:()=>e.getState().transform[2],setViewport:(s,c)=>{const[u,f,h]=e.getState().transform,p=Zt.translate(s.x??u,s.y??f).scale(s.zoom??h);t.transform(gn(r,c==null?void 0:c.duration),p)},getViewport:()=>{const[s,c,u]=e.getState().transform;return{x:s,y:c,zoom:u}},fitView:s=>$c(e.getState,s),setCenter:(s,c,u)=>{const{width:f,height:h,maxZoom:p}=e.getState(),m=typeof(u==null?void 0:u.zoom)<"u"?u.zoom:p,v=f/2-s*m,w=h/2-c*m,g=Zt.translate(v,w).scale(m);t.transform(gn(r,u==null?void 0:u.duration),g)},fitBounds:(s,c)=>{const{width:u,height:f,minZoom:h,maxZoom:p}=e.getState(),{x:m,y:v,zoom:w}=gc(s,u,f,h,p,(c==null?void 0:c.padding)??.1),g=Zt.translate(m,v).scale(w);t.transform(gn(r,c==null?void 0:c.duration),g)},project:s=>{const{transform:c,snapToGrid:u,snapGrid:f}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),Mi(s,c,u,f)},screenToFlowPosition:s=>{const{transform:c,snapToGrid:u,snapGrid:f,domNode:h}=e.getState();if(!h)return s;const{x:p,y:m}=h.getBoundingClientRect(),v={x:s.x-p,y:s.y-m};return Mi(v,c,u,f)},flowToScreenPosition:s=>{const{transform:c,domNode:u}=e.getState();if(!u)return s;const{x:f,y:h}=u.getBoundingClientRect(),p=pc(s,c);return{x:p.x+f,y:p.y+h}},viewportInitialized:!0}:gp,[t,r])};function Qi(){const e=wp(),t=Xe(),r=D.useCallback(()=>t.getState().getNodes().map(N=>({...N})),[]),o=D.useCallback(N=>t.getState().nodeInternals.get(N),[]),s=D.useCallback(()=>{const{edges:N=[]}=t.getState();return N.map(P=>({...P}))},[]),c=D.useCallback(N=>{const{edges:P=[]}=t.getState();return P.find(S=>S.id===N)},[]),u=D.useCallback(N=>{const{getNodes:P,setNodes:S,hasDefaultNodes:H,onNodesChange:K}=t.getState(),C=P(),U=typeof N=="function"?N(C):N;if(H)S(U);else if(K){const Q=U.length===0?C.map(X=>({type:"remove",id:X.id})):U.map(X=>({item:X,type:"reset"}));K(Q)}},[]),f=D.useCallback(N=>{const{edges:P=[],setEdges:S,hasDefaultEdges:H,onEdgesChange:K}=t.getState(),C=typeof N=="function"?N(P):N;if(H)S(C);else if(K){const U=C.length===0?P.map(Q=>({type:"remove",id:Q.id})):C.map(Q=>({item:Q,type:"reset"}));K(U)}},[]),h=D.useCallback(N=>{const P=Array.isArray(N)?N:[N],{getNodes:S,setNodes:H,hasDefaultNodes:K,onNodesChange:C}=t.getState();if(K){const Q=[...S(),...P];H(Q)}else if(C){const U=P.map(Q=>({item:Q,type:"add"}));C(U)}},[]),p=D.useCallback(N=>{const P=Array.isArray(N)?N:[N],{edges:S=[],setEdges:H,hasDefaultEdges:K,onEdgesChange:C}=t.getState();if(K)H([...S,...P]);else if(C){const U=P.map(Q=>({item:Q,type:"add"}));C(U)}},[]),m=D.useCallback(()=>{const{getNodes:N,edges:P=[],transform:S}=t.getState(),[H,K,C]=S;return{nodes:N().map(U=>({...U})),edges:P.map(U=>({...U})),viewport:{x:H,y:K,zoom:C}}},[]),v=D.useCallback(({nodes:N,edges:P})=>{const{nodeInternals:S,getNodes:H,edges:K,hasDefaultNodes:C,hasDefaultEdges:U,onNodesDelete:Q,onEdgesDelete:X,onNodesChange:ee,onEdgesChange:G}=t.getState(),oe=(N||[]).map(L=>L.id),ne=(P||[]).map(L=>L.id),le=H().reduce((L,j)=>{const W=j.parentNode||j.parentId,re=!oe.includes(j.id)&&W&&L.find(J=>J.id===W);return(typeof j.deletable=="boolean"?j.deletable:!0)&&(oe.includes(j.id)||re)&&L.push(j),L},[]),se=K.filter(L=>typeof L.deletable=="boolean"?L.deletable:!0),b=se.filter(L=>ne.includes(L.id));if(le||b){const L=yc(le,se),j=[...b,...L],W=j.reduce((re,z)=>(re.includes(z.id)||re.push(z.id),re),[]);if((U||C)&&(U&&t.setState({edges:K.filter(re=>!W.includes(re.id))}),C&&(le.forEach(re=>{S.delete(re.id)}),t.setState({nodeInternals:new Map(S)}))),W.length>0&&(X==null||X(j),G&&G(W.map(re=>({id:re,type:"remove"})))),le.length>0&&(Q==null||Q(le),ee)){const re=le.map(z=>({id:z.id,type:"remove"}));ee(re)}}},[]),w=D.useCallback(N=>{const P=zh(N),S=P?null:t.getState().nodeInternals.get(N.id);return!P&&!S?[null,null,P]:[P?N:Xs(S),S,P]},[]),g=D.useCallback((N,P=!0,S)=>{const[H,K,C]=w(N);return H?(S||t.getState().getNodes()).filter(U=>{if(!C&&(U.id===K.id||!U.positionAbsolute))return!1;const Q=Xs(U),X=Ni(Q,H);return P&&X>0||X>=H.width*H.height}):[]},[]),k=D.useCallback((N,P,S=!0)=>{const[H]=w(N);if(!H)return!1;const K=Ni(H,P);return S&&K>0||K>=H.width*H.height},[]);return D.useMemo(()=>({...e,getNodes:r,getNode:o,getEdges:s,getEdge:c,setNodes:u,setEdges:f,addNodes:h,addEdges:p,toObject:m,deleteElements:v,getIntersectingNodes:g,isNodeIntersecting:k}),[e,r,o,s,c,u,f,h,p,m,v,g,k])}const xp={actInsideInputWithModifier:!1};var bp=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const r=Xe(),{deleteElements:o}=Qi(),s=Sr(e,xp),c=Sr(t);D.useEffect(()=>{if(s){const{edges:u,getNodes:f}=r.getState(),h=f().filter(m=>m.selected),p=u.filter(m=>m.selected);o({nodes:h,edges:p}),r.setState({nodesSelectionActive:!1})}},[s]),D.useEffect(()=>{r.setState({multiSelectionActive:c})},[c])};function _p(e){const t=Xe();D.useEffect(()=>{let r;const o=()=>{var c,u;if(!e.current)return;const s=qi(e.current);(s.height===0||s.width===0)&&((u=(c=t.getState()).onError)==null||u.call(c,"004",Qt.error004())),t.setState({width:s.width||500,height:s.height||500})};return o(),window.addEventListener("resize",o),e.current&&(r=new ResizeObserver(()=>o()),r.observe(e.current)),()=>{window.removeEventListener("resize",o),r&&e.current&&r.unobserve(e.current)}},[])}const Ji={position:"absolute",width:"100%",height:"100%",top:0,left:0},Ep=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,ro=e=>({x:e.x,y:e.y,zoom:e.k}),zn=(e,t)=>e.target.closest(`.${t}`),oa=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),ia=e=>{const t=e.ctrlKey&&yo()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},Sp=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),kp=({onMove:e,onMoveStart:t,onMoveEnd:r,onPaneContextMenu:o,zoomOnScroll:s=!0,zoomOnPinch:c=!0,panOnScroll:u=!1,panOnScrollSpeed:f=.5,panOnScrollMode:h=xn.Free,zoomOnDoubleClick:p=!0,elementsSelectable:m,panOnDrag:v=!0,defaultViewport:w,translateExtent:g,minZoom:k,maxZoom:N,zoomActivationKeyCode:P,preventScrolling:S=!0,children:H,noWheelClassName:K,noPanClassName:C})=>{const U=D.useRef(),Q=Xe(),X=D.useRef(!1),ee=D.useRef(!1),G=D.useRef(null),oe=D.useRef({x:0,y:0,zoom:0}),{d3Zoom:ne,d3Selection:le,d3ZoomHandler:se,userSelectionActive:b}=ze(Sp,Qe),L=Sr(P),j=D.useRef(0),W=D.useRef(!1),re=D.useRef();return _p(G),D.useEffect(()=>{if(G.current){const z=G.current.getBoundingClientRect(),J=nc().scaleExtent([k,N]).translateExtent(g),ie=bt(G.current).call(J),ae=Zt.translate(w.x,w.y).scale(Xn(w.zoom,k,N)),ge=[[0,0],[z.width,z.height]],ve=J.constrain()(ae,ge,g);J.transform(ie,ve),J.wheelDelta(ia),Q.setState({d3Zoom:J,d3Selection:ie,d3ZoomHandler:ie.on("wheel.zoom"),transform:[ve.x,ve.y,ve.k],domNode:G.current.closest(".react-flow")})}},[]),D.useEffect(()=>{le&&ne&&(u&&!L&&!b?le.on("wheel.zoom",z=>{if(zn(z,K))return!1;z.preventDefault(),z.stopImmediatePropagation();const J=le.property("__zoom").k||1;if(z.ctrlKey&&c){const De=Ct(z),de=ia(z),Pe=J*Math.pow(2,de);ne.scaleTo(le,Pe,De,z);return}const ie=z.deltaMode===1?20:1;let ae=h===xn.Vertical?0:z.deltaX*ie,ge=h===xn.Horizontal?0:z.deltaY*ie;!yo()&&z.shiftKey&&h!==xn.Vertical&&(ae=z.deltaY*ie,ge=0),ne.translateBy(le,-(ae/J)*f,-(ge/J)*f,{internal:!0});const ve=ro(le.property("__zoom")),{onViewportChangeStart:be,onViewportChange:ke,onViewportChangeEnd:Ae}=Q.getState();clearTimeout(re.current),W.current||(W.current=!0,t==null||t(z,ve),be==null||be(ve)),W.current&&(e==null||e(z,ve),ke==null||ke(ve),re.current=setTimeout(()=>{r==null||r(z,ve),Ae==null||Ae(ve),W.current=!1},150))},{passive:!1}):typeof se<"u"&&le.on("wheel.zoom",function(z,J){if(!S&&z.type==="wheel"&&!z.ctrlKey||zn(z,K))return null;z.preventDefault(),se.call(this,z,J)},{passive:!1}))},[b,u,h,le,ne,se,L,c,S,K,t,e,r]),D.useEffect(()=>{ne&&ne.on("start",z=>{var ae,ge;if(!z.sourceEvent||z.sourceEvent.internal)return null;j.current=(ae=z.sourceEvent)==null?void 0:ae.button;const{onViewportChangeStart:J}=Q.getState(),ie=ro(z.transform);X.current=!0,oe.current=ie,((ge=z.sourceEvent)==null?void 0:ge.type)==="mousedown"&&Q.setState({paneDragging:!0}),J==null||J(ie),t==null||t(z.sourceEvent,ie)})},[ne,t]),D.useEffect(()=>{ne&&(b&&!X.current?ne.on("zoom",null):b||ne.on("zoom",z=>{var ie;const{onViewportChange:J}=Q.getState();if(Q.setState({transform:[z.transform.x,z.transform.y,z.transform.k]}),ee.current=!!(o&&oa(v,j.current??0)),(e||J)&&!((ie=z.sourceEvent)!=null&&ie.internal)){const ae=ro(z.transform);J==null||J(ae),e==null||e(z.sourceEvent,ae)}}))},[b,ne,e,v,o]),D.useEffect(()=>{ne&&ne.on("end",z=>{if(!z.sourceEvent||z.sourceEvent.internal)return null;const{onViewportChangeEnd:J}=Q.getState();if(X.current=!1,Q.setState({paneDragging:!1}),o&&oa(v,j.current??0)&&!ee.current&&o(z.sourceEvent),ee.current=!1,(r||J)&&Ep(oe.current,z.transform)){const ie=ro(z.transform);oe.current=ie,clearTimeout(U.current),U.current=setTimeout(()=>{J==null||J(ie),r==null||r(z.sourceEvent,ie)},u?150:0)}})},[ne,u,v,r,o]),D.useEffect(()=>{ne&&ne.filter(z=>{const J=L||s,ie=c&&z.ctrlKey;if((v===!0||Array.isArray(v)&&v.includes(1))&&z.button===1&&z.type==="mousedown"&&(zn(z,"react-flow__node")||zn(z,"react-flow__edge")))return!0;if(!v&&!J&&!u&&!p&&!c||b||!p&&z.type==="dblclick"||zn(z,K)&&z.type==="wheel"||zn(z,C)&&(z.type!=="wheel"||u&&z.type==="wheel"&&!L)||!c&&z.ctrlKey&&z.type==="wheel"||!J&&!u&&!ie&&z.type==="wheel"||!v&&(z.type==="mousedown"||z.type==="touchstart")||Array.isArray(v)&&!v.includes(z.button)&&z.type==="mousedown")return!1;const ae=Array.isArray(v)&&v.includes(z.button)||!z.button||z.button<=1;return(!z.ctrlKey||z.type==="wheel")&&ae})},[b,ne,s,c,u,p,v,m,L]),Z.createElement("div",{className:"react-flow__renderer",ref:G,style:Ji},H)},Np=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function Cp(){const{userSelectionActive:e,userSelectionRect:t}=ze(Np,Qe);return e&&t?Z.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function sa(e,t){const r=t.parentNode||t.parentId,o=e.find(s=>s.id===r);if(o){const s=t.position.x+t.width-o.width,c=t.position.y+t.height-o.height;if(s>0||c>0||t.position.x<0||t.position.y<0){if(o.style={...o.style},o.style.width=o.style.width??o.width,o.style.height=o.style.height??o.height,s>0&&(o.style.width+=s),c>0&&(o.style.height+=c),t.position.x<0){const u=Math.abs(t.position.x);o.position.x=o.position.x-u,o.style.width+=u,t.position.x=0}if(t.position.y<0){const u=Math.abs(t.position.y);o.position.y=o.position.y-u,o.style.height+=u,t.position.y=0}o.width=o.style.width,o.height=o.style.height}}}function Ap(e,t){if(e.some(o=>o.type==="reset"))return e.filter(o=>o.type==="reset").map(o=>o.item);const r=e.filter(o=>o.type==="add").map(o=>o.item);return t.reduce((o,s)=>{const c=e.filter(f=>f.id===s.id);if(c.length===0)return o.push(s),o;const u={...s};for(const f of c)if(f)switch(f.type){case"select":{u.selected=f.selected;break}case"position":{typeof f.position<"u"&&(u.position=f.position),typeof f.positionAbsolute<"u"&&(u.positionAbsolute=f.positionAbsolute),typeof f.dragging<"u"&&(u.dragging=f.dragging),u.expandParent&&sa(o,u);break}case"dimensions":{typeof f.dimensions<"u"&&(u.width=f.dimensions.width,u.height=f.dimensions.height),typeof f.updateStyle<"u"&&(u.style={...u.style||{},...f.dimensions}),typeof f.resizing=="boolean"&&(u.resizing=f.resizing),u.expandParent&&sa(o,u);break}case"remove":return o}return o.push(u),o},r)}function Pc(e,t){return Ap(e,t)}const un=(e,t)=>({id:e,type:"select",selected:t});function Fn(e,t){return e.reduce((r,o)=>{const s=t.includes(o.id);return!o.selected&&s?(o.selected=!0,r.push(un(o.id,!0))):o.selected&&!s&&(o.selected=!1,r.push(un(o.id,!1))),r},[])}const pi=(e,t)=>r=>{r.target===t.current&&(e==null||e(r))},Tp=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),Rc=D.memo(({isSelecting:e,selectionMode:t=Er.Full,panOnDrag:r,onSelectionStart:o,onSelectionEnd:s,onPaneClick:c,onPaneContextMenu:u,onPaneScroll:f,onPaneMouseEnter:h,onPaneMouseMove:p,onPaneMouseLeave:m,children:v})=>{const w=D.useRef(null),g=Xe(),k=D.useRef(0),N=D.useRef(0),P=D.useRef(),{userSelectionActive:S,elementsSelectable:H,dragging:K}=ze(Tp,Qe),C=()=>{g.setState({userSelectionActive:!1,userSelectionRect:null}),k.current=0,N.current=0},U=se=>{c==null||c(se),g.getState().resetSelectedElements(),g.setState({nodesSelectionActive:!1})},Q=se=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){se.preventDefault();return}u==null||u(se)},X=f?se=>f(se):void 0,ee=se=>{const{resetSelectedElements:b,domNode:L}=g.getState();if(P.current=L==null?void 0:L.getBoundingClientRect(),!H||!e||se.button!==0||se.target!==w.current||!P.current)return;const{x:j,y:W}=dn(se,P.current);b(),g.setState({userSelectionRect:{width:0,height:0,startX:j,startY:W,x:j,y:W}}),o==null||o(se)},G=se=>{const{userSelectionRect:b,nodeInternals:L,edges:j,transform:W,onNodesChange:re,onEdgesChange:z,nodeOrigin:J,getNodes:ie}=g.getState();if(!e||!P.current||!b)return;g.setState({userSelectionActive:!0,nodesSelectionActive:!1});const ae=dn(se,P.current),ge=b.startX??0,ve=b.startY??0,be={...b,x:ae.x<ge?ae.x:ge,y:ae.y<ve?ae.y:ve,width:Math.abs(ae.x-ge),height:Math.abs(ae.y-ve)},ke=ie(),Ae=mc(L,be,W,t===Er.Partial,!0,J),De=yc(Ae,j).map(Pe=>Pe.id),de=Ae.map(Pe=>Pe.id);if(k.current!==de.length){k.current=de.length;const Pe=Fn(ke,de);Pe.length&&(re==null||re(Pe))}if(N.current!==De.length){N.current=De.length;const Pe=Fn(j,De);Pe.length&&(z==null||z(Pe))}g.setState({userSelectionRect:be})},oe=se=>{if(se.button!==0)return;const{userSelectionRect:b}=g.getState();!S&&b&&se.target===w.current&&(U==null||U(se)),g.setState({nodesSelectionActive:k.current>0}),C(),s==null||s(se)},ne=se=>{S&&(g.setState({nodesSelectionActive:k.current>0}),s==null||s(se)),C()},le=H&&(e||S);return Z.createElement("div",{className:et(["react-flow__pane",{dragging:K,selection:e}]),onClick:le?void 0:pi(U,w),onContextMenu:pi(Q,w),onWheel:pi(X,w),onMouseEnter:le?void 0:h,onMouseDown:le?ee:void 0,onMouseMove:le?G:p,onMouseUp:le?oe:void 0,onMouseLeave:le?ne:m,ref:w,style:Ji},v,Z.createElement(Cp,null))});Rc.displayName="Pane";function Dc(e,t){const r=e.parentNode||e.parentId;if(!r)return!1;const o=t.get(r);return o?o.selected?!0:Dc(o,t):!1}function aa(e,t,r){let o=e;do{if(o!=null&&o.matches(t))return!0;if(o===r.current)return!1;o=o.parentElement}while(o);return!1}function Mp(e,t,r,o){return Array.from(e.values()).filter(s=>(s.selected||s.id===o)&&(!s.parentNode||s.parentId||!Dc(s,e))&&(s.draggable||t&&typeof s.draggable>"u")).map(s=>{var c,u;return{id:s.id,position:s.position||{x:0,y:0},positionAbsolute:s.positionAbsolute||{x:0,y:0},distance:{x:r.x-(((c=s.positionAbsolute)==null?void 0:c.x)??0),y:r.y-(((u=s.positionAbsolute)==null?void 0:u.y)??0)},delta:{x:0,y:0},extent:s.extent,parentNode:s.parentNode||s.parentId,parentId:s.parentNode||s.parentId,width:s.width,height:s.height,expandParent:s.expandParent}})}function Ip(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function Oc(e,t,r,o,s=[0,0],c){const u=Ip(e,e.extent||o);let f=u;const h=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(h&&e.width&&e.height){const v=r.get(h),{x:w,y:g}=_n(v,s).positionAbsolute;f=v&&_t(w)&&_t(g)&&_t(v.width)&&_t(v.height)?[[w+e.width*s[0],g+e.height*s[1]],[w+v.width-e.width+e.width*s[0],g+v.height-e.height+e.height*s[1]]]:f}else c==null||c("005",Qt.error005()),f=u;else if(e.extent&&h&&e.extent!=="parent"){const v=r.get(h),{x:w,y:g}=_n(v,s).positionAbsolute;f=[[e.extent[0][0]+w,e.extent[0][1]+g],[e.extent[1][0]+w,e.extent[1][1]+g]]}let p={x:0,y:0};if(h){const v=r.get(h);p=_n(v,s).positionAbsolute}const m=f&&f!=="parent"?Vi(t,f):t;return{position:{x:m.x-p.x,y:m.y-p.y},positionAbsolute:m}}function mi({nodeId:e,dragItems:t,nodeInternals:r}){const o=t.map(s=>({...r.get(s.id),position:s.position,positionAbsolute:s.positionAbsolute}));return[e?o.find(s=>s.id===e):o[0],o]}const ca=(e,t,r,o)=>{const s=t.querySelectorAll(e);if(!s||!s.length)return null;const c=Array.from(s),u=t.getBoundingClientRect(),f={x:u.width*o[0],y:u.height*o[1]};return c.map(h=>{const p=h.getBoundingClientRect();return{id:h.getAttribute("data-handleid"),position:h.getAttribute("data-handlepos"),x:(p.left-u.left-f.x)/r,y:(p.top-u.top-f.y)/r,...qi(h)}})};function dr(e,t,r){return r===void 0?r:o=>{const s=t().nodeInternals.get(e);s&&r(o,{...s})}}function $i({id:e,store:t,unselect:r=!1,nodeRef:o}){const{addSelectedNodes:s,unselectNodesAndEdges:c,multiSelectionActive:u,nodeInternals:f,onError:h}=t.getState(),p=f.get(e);if(!p){h==null||h("012",Qt.error012(e));return}t.setState({nodesSelectionActive:!1}),p.selected?(r||p.selected&&u)&&(c({nodes:[p],edges:[]}),requestAnimationFrame(()=>{var m;return(m=o==null?void 0:o.current)==null?void 0:m.blur()})):s([e])}function $p(){const e=Xe();return D.useCallback(({sourceEvent:r})=>{const{transform:o,snapGrid:s,snapToGrid:c}=e.getState(),u=r.touches?r.touches[0].clientX:r.clientX,f=r.touches?r.touches[0].clientY:r.clientY,h={x:(u-o[0])/o[2],y:(f-o[1])/o[2]};return{xSnapped:c?s[0]*Math.round(h.x/s[0]):h.x,ySnapped:c?s[1]*Math.round(h.y/s[1]):h.y,...h}},[])}function yi(e){return(t,r,o)=>e==null?void 0:e(t,o)}function jc({nodeRef:e,disabled:t=!1,noDragClassName:r,handleSelector:o,nodeId:s,isSelectable:c,selectNodesOnDrag:u}){const f=Xe(),[h,p]=D.useState(!1),m=D.useRef([]),v=D.useRef({x:null,y:null}),w=D.useRef(0),g=D.useRef(null),k=D.useRef({x:0,y:0}),N=D.useRef(null),P=D.useRef(!1),S=D.useRef(!1),H=D.useRef(!1),K=$p();return D.useEffect(()=>{if(e!=null&&e.current){const C=bt(e.current),U=({x:ee,y:G})=>{const{nodeInternals:oe,onNodeDrag:ne,onSelectionDrag:le,updateNodePositions:se,nodeExtent:b,snapGrid:L,snapToGrid:j,nodeOrigin:W,onError:re}=f.getState();v.current={x:ee,y:G};let z=!1,J={x:0,y:0,x2:0,y2:0};if(m.current.length>1&&b){const ae=To(m.current,W);J=_r(ae)}if(m.current=m.current.map(ae=>{const ge={x:ee-ae.distance.x,y:G-ae.distance.y};j&&(ge.x=L[0]*Math.round(ge.x/L[0]),ge.y=L[1]*Math.round(ge.y/L[1]));const ve=[[b[0][0],b[0][1]],[b[1][0],b[1][1]]];m.current.length>1&&b&&!ae.extent&&(ve[0][0]=ae.positionAbsolute.x-J.x+b[0][0],ve[1][0]=ae.positionAbsolute.x+(ae.width??0)-J.x2+b[1][0],ve[0][1]=ae.positionAbsolute.y-J.y+b[0][1],ve[1][1]=ae.positionAbsolute.y+(ae.height??0)-J.y2+b[1][1]);const be=Oc(ae,ge,oe,ve,W,re);return z=z||ae.position.x!==be.position.x||ae.position.y!==be.position.y,ae.position=be.position,ae.positionAbsolute=be.positionAbsolute,ae}),!z)return;se(m.current,!0,!0),p(!0);const ie=s?ne:yi(le);if(ie&&N.current){const[ae,ge]=mi({nodeId:s,dragItems:m.current,nodeInternals:oe});ie(N.current,ae,ge)}},Q=()=>{if(!g.current)return;const[ee,G]=oc(k.current,g.current);if(ee!==0||G!==0){const{transform:oe,panBy:ne}=f.getState();v.current.x=(v.current.x??0)-ee/oe[2],v.current.y=(v.current.y??0)-G/oe[2],ne({x:ee,y:G})&&U(v.current)}w.current=requestAnimationFrame(Q)},X=ee=>{var W;const{nodeInternals:G,multiSelectionActive:oe,nodesDraggable:ne,unselectNodesAndEdges:le,onNodeDragStart:se,onSelectionDragStart:b}=f.getState();S.current=!0;const L=s?se:yi(b);(!u||!c)&&!oe&&s&&((W=G.get(s))!=null&&W.selected||le()),s&&c&&u&&$i({id:s,store:f,nodeRef:e});const j=K(ee);if(v.current=j,m.current=Mp(G,ne,j,s),L&&m.current){const[re,z]=mi({nodeId:s,dragItems:m.current,nodeInternals:G});L(ee.sourceEvent,re,z)}};if(t)C.on(".drag",null);else{const ee=Lf().on("start",G=>{const{domNode:oe,nodeDragThreshold:ne}=f.getState();ne===0&&X(G),H.current=!1;const le=K(G);v.current=le,g.current=(oe==null?void 0:oe.getBoundingClientRect())||null,k.current=dn(G.sourceEvent,g.current)}).on("drag",G=>{var se,b;const oe=K(G),{autoPanOnNodeDrag:ne,nodeDragThreshold:le}=f.getState();if(G.sourceEvent.type==="touchmove"&&G.sourceEvent.touches.length>1&&(H.current=!0),!H.current){if(!P.current&&S.current&&ne&&(P.current=!0,Q()),!S.current){const L=oe.xSnapped-(((se=v==null?void 0:v.current)==null?void 0:se.x)??0),j=oe.ySnapped-(((b=v==null?void 0:v.current)==null?void 0:b.y)??0);Math.sqrt(L*L+j*j)>le&&X(G)}(v.current.x!==oe.xSnapped||v.current.y!==oe.ySnapped)&&m.current&&S.current&&(N.current=G.sourceEvent,k.current=dn(G.sourceEvent,g.current),U(oe))}}).on("end",G=>{if(!(!S.current||H.current)&&(p(!1),P.current=!1,S.current=!1,cancelAnimationFrame(w.current),m.current)){const{updateNodePositions:oe,nodeInternals:ne,onNodeDragStop:le,onSelectionDragStop:se}=f.getState(),b=s?le:yi(se);if(oe(m.current,!1,!1),b){const[L,j]=mi({nodeId:s,dragItems:m.current,nodeInternals:ne});b(G.sourceEvent,L,j)}}}).filter(G=>{const oe=G.target;return!G.button&&(!r||!aa(oe,`.${r}`,e))&&(!o||aa(oe,o,e))});return C.call(ee),()=>{C.on(".drag",null)}}}},[e,t,r,o,c,f,s,u,K]),h}function Bc(){const e=Xe();return D.useCallback(r=>{const{nodeInternals:o,nodeExtent:s,updateNodePositions:c,getNodes:u,snapToGrid:f,snapGrid:h,onError:p,nodesDraggable:m}=e.getState(),v=u().filter(H=>H.selected&&(H.draggable||m&&typeof H.draggable>"u")),w=f?h[0]:5,g=f?h[1]:5,k=r.isShiftPressed?4:1,N=r.x*w*k,P=r.y*g*k,S=v.map(H=>{if(H.positionAbsolute){const K={x:H.positionAbsolute.x+N,y:H.positionAbsolute.y+P};f&&(K.x=h[0]*Math.round(K.x/h[0]),K.y=h[1]*Math.round(K.y/h[1]));const{positionAbsolute:C,position:U}=Oc(H,K,o,s,void 0,p);H.position=U,H.positionAbsolute=C}return H});c(S,!0,!1)},[])}const qn={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var hr=e=>{const t=({id:r,type:o,data:s,xPos:c,yPos:u,xPosOrigin:f,yPosOrigin:h,selected:p,onClick:m,onMouseEnter:v,onMouseMove:w,onMouseLeave:g,onContextMenu:k,onDoubleClick:N,style:P,className:S,isDraggable:H,isSelectable:K,isConnectable:C,isFocusable:U,selectNodesOnDrag:Q,sourcePosition:X,targetPosition:ee,hidden:G,resizeObserver:oe,dragHandle:ne,zIndex:le,isParent:se,noDragClassName:b,noPanClassName:L,initialized:j,disableKeyboardA11y:W,ariaLabel:re,rfId:z,hasHandleBounds:J})=>{const ie=Xe(),ae=D.useRef(null),ge=D.useRef(null),ve=D.useRef(X),be=D.useRef(ee),ke=D.useRef(o),Ae=K||H||m||v||w||g,De=Bc(),de=dr(r,ie.getState,v),Pe=dr(r,ie.getState,w),Le=dr(r,ie.getState,g),Se=dr(r,ie.getState,k),Ve=dr(r,ie.getState,N),Ue=Oe=>{const{nodeDragThreshold:Ee}=ie.getState();if(K&&(!Q||!H||Ee>0)&&$i({id:r,store:ie,nodeRef:ae}),m){const Je=ie.getState().nodeInternals.get(r);Je&&m(Oe,{...Je})}},je=Oe=>{if(!Ci(Oe)&&!W)if(cc.includes(Oe.key)&&K){const Ee=Oe.key==="Escape";$i({id:r,store:ie,unselect:Ee,nodeRef:ae})}else H&&p&&Object.prototype.hasOwnProperty.call(qn,Oe.key)&&(ie.setState({ariaLiveMessage:`Moved selected node ${Oe.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~c}, y: ${~~u}`}),De({x:qn[Oe.key].x,y:qn[Oe.key].y,isShiftPressed:Oe.shiftKey}))};D.useEffect(()=>()=>{ge.current&&(oe==null||oe.unobserve(ge.current),ge.current=null)},[]),D.useEffect(()=>{if(ae.current&&!G){const Oe=ae.current;(!j||!J||ge.current!==Oe)&&(ge.current&&(oe==null||oe.unobserve(ge.current)),oe==null||oe.observe(Oe),ge.current=Oe)}},[G,j,J]),D.useEffect(()=>{const Oe=ke.current!==o,Ee=ve.current!==X,Je=be.current!==ee;ae.current&&(Oe||Ee||Je)&&(Oe&&(ke.current=o),Ee&&(ve.current=X),Je&&(be.current=ee),ie.getState().updateNodeDimensions([{id:r,nodeElement:ae.current,forceUpdate:!0}]))},[r,o,X,ee]);const at=jc({nodeRef:ae,disabled:G||!H,noDragClassName:b,handleSelector:ne,nodeId:r,isSelectable:K,selectNodesOnDrag:Q});return G?null:Z.createElement("div",{className:et(["react-flow__node",`react-flow__node-${o}`,{[L]:H},S,{selected:p,selectable:K,parent:se,dragging:at}]),ref:ae,style:{zIndex:le,transform:`translate(${f}px,${h}px)`,pointerEvents:Ae?"all":"none",visibility:j?"visible":"hidden",...P},"data-id":r,"data-testid":`rf__node-${r}`,onMouseEnter:de,onMouseMove:Pe,onMouseLeave:Le,onContextMenu:Se,onClick:Ue,onDoubleClick:Ve,onKeyDown:U?je:void 0,tabIndex:U?0:void 0,role:U?"button":void 0,"aria-describedby":W?void 0:`${Ac}-${z}`,"aria-label":re},Z.createElement(Wh,{value:r},Z.createElement(e,{id:r,data:s,type:o,xPos:c,yPos:u,selected:p,isConnectable:C,sourcePosition:X,targetPosition:ee,dragging:at,dragHandle:ne,zIndex:le})))};return t.displayName="NodeWrapper",D.memo(t)};const Pp=e=>{const t=e.getNodes().filter(r=>r.selected);return{...To(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function Rp({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:r}){const o=Xe(),{width:s,height:c,x:u,y:f,transformString:h,userSelectionActive:p}=ze(Pp,Qe),m=Bc(),v=D.useRef(null);if(D.useEffect(()=>{var k;r||(k=v.current)==null||k.focus({preventScroll:!0})},[r]),jc({nodeRef:v}),p||!s||!c)return null;const w=e?k=>{const N=o.getState().getNodes().filter(P=>P.selected);e(k,N)}:void 0,g=k=>{Object.prototype.hasOwnProperty.call(qn,k.key)&&m({x:qn[k.key].x,y:qn[k.key].y,isShiftPressed:k.shiftKey})};return Z.createElement("div",{className:et(["react-flow__nodesselection","react-flow__container",t]),style:{transform:h}},Z.createElement("div",{ref:v,className:"react-flow__nodesselection-rect",onContextMenu:w,tabIndex:r?void 0:-1,onKeyDown:r?void 0:g,style:{width:s,height:c,top:f,left:u}}))}var Dp=D.memo(Rp);const Op=e=>e.nodesSelectionActive,zc=({children:e,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:c,onPaneScroll:u,deleteKeyCode:f,onMove:h,onMoveStart:p,onMoveEnd:m,selectionKeyCode:v,selectionOnDrag:w,selectionMode:g,onSelectionStart:k,onSelectionEnd:N,multiSelectionKeyCode:P,panActivationKeyCode:S,zoomActivationKeyCode:H,elementsSelectable:K,zoomOnScroll:C,zoomOnPinch:U,panOnScroll:Q,panOnScrollSpeed:X,panOnScrollMode:ee,zoomOnDoubleClick:G,panOnDrag:oe,defaultViewport:ne,translateExtent:le,minZoom:se,maxZoom:b,preventScrolling:L,onSelectionContextMenu:j,noWheelClassName:W,noPanClassName:re,disableKeyboardA11y:z})=>{const J=ze(Op),ie=Sr(v),ae=Sr(S),ge=ae||oe,ve=ae||Q,be=ie||w&&ge!==!0;return bp({deleteKeyCode:f,multiSelectionKeyCode:P}),Z.createElement(kp,{onMove:h,onMoveStart:p,onMoveEnd:m,onPaneContextMenu:c,elementsSelectable:K,zoomOnScroll:C,zoomOnPinch:U,panOnScroll:ve,panOnScrollSpeed:X,panOnScrollMode:ee,zoomOnDoubleClick:G,panOnDrag:!ie&&ge,defaultViewport:ne,translateExtent:le,minZoom:se,maxZoom:b,zoomActivationKeyCode:H,preventScrolling:L,noWheelClassName:W,noPanClassName:re},Z.createElement(Rc,{onSelectionStart:k,onSelectionEnd:N,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:c,onPaneScroll:u,panOnDrag:ge,isSelecting:!!be,selectionMode:g},e,J&&Z.createElement(Dp,{onSelectionContextMenu:j,noPanClassName:re,disableKeyboardA11y:z})))};zc.displayName="FlowRenderer";var jp=D.memo(zc);function Bp(e){return ze(D.useCallback(r=>e?mc(r.nodeInternals,{x:0,y:0,width:r.width,height:r.height},r.transform,!0):r.getNodes(),[e]))}function zp(e){const t={input:hr(e.input||Sc),default:hr(e.default||Ii),output:hr(e.output||Nc),group:hr(e.group||Gi)},r={},o=Object.keys(e).filter(s=>!["input","default","output","group"].includes(s)).reduce((s,c)=>(s[c]=hr(e[c]||Ii),s),r);return{...t,...o}}const Kp=({x:e,y:t,width:r,height:o,origin:s})=>!r||!o?{x:e,y:t}:s[0]<0||s[1]<0||s[0]>1||s[1]>1?{x:e,y:t}:{x:e-r*s[0],y:t-o*s[1]},Fp=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),Kc=e=>{const{nodesDraggable:t,nodesConnectable:r,nodesFocusable:o,elementsSelectable:s,updateNodeDimensions:c,onError:u}=ze(Fp,Qe),f=Bp(e.onlyRenderVisibleElements),h=D.useRef(),p=D.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const m=new ResizeObserver(v=>{const w=v.map(g=>({id:g.target.getAttribute("data-id"),nodeElement:g.target,forceUpdate:!0}));c(w)});return h.current=m,m},[]);return D.useEffect(()=>()=>{var m;(m=h==null?void 0:h.current)==null||m.disconnect()},[]),Z.createElement("div",{className:"react-flow__nodes",style:Ji},f.map(m=>{var U,Q,X;let v=m.type||"default";e.nodeTypes[v]||(u==null||u("003",Qt.error003(v)),v="default");const w=e.nodeTypes[v]||e.nodeTypes.default,g=!!(m.draggable||t&&typeof m.draggable>"u"),k=!!(m.selectable||s&&typeof m.selectable>"u"),N=!!(m.connectable||r&&typeof m.connectable>"u"),P=!!(m.focusable||o&&typeof m.focusable>"u"),S=e.nodeExtent?Vi(m.positionAbsolute,e.nodeExtent):m.positionAbsolute,H=(S==null?void 0:S.x)??0,K=(S==null?void 0:S.y)??0,C=Kp({x:H,y:K,width:m.width??0,height:m.height??0,origin:e.nodeOrigin});return Z.createElement(w,{key:m.id,id:m.id,className:m.className,style:m.style,type:v,data:m.data,sourcePosition:m.sourcePosition||_e.Bottom,targetPosition:m.targetPosition||_e.Top,hidden:m.hidden,xPos:H,yPos:K,xPosOrigin:C.x,yPosOrigin:C.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!m.selected,isDraggable:g,isSelectable:k,isConnectable:N,isFocusable:P,resizeObserver:p,dragHandle:m.dragHandle,zIndex:((U=m[qe])==null?void 0:U.z)??0,isParent:!!((Q=m[qe])!=null&&Q.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!m.width&&!!m.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:m.ariaLabel,hasHandleBounds:!!((X=m[qe])!=null&&X.handleBounds)})}))};Kc.displayName="NodeRenderer";var Hp=D.memo(Kc);const Lp=(e,t,r)=>r===_e.Left?e-t:r===_e.Right?e+t:e,qp=(e,t,r)=>r===_e.Top?e-t:r===_e.Bottom?e+t:e,ua="react-flow__edgeupdater",la=({position:e,centerX:t,centerY:r,radius:o=10,onMouseDown:s,onMouseEnter:c,onMouseOut:u,type:f})=>Z.createElement("circle",{onMouseDown:s,onMouseEnter:c,onMouseOut:u,className:et([ua,`${ua}-${f}`]),cx:Lp(t,o,e),cy:qp(r,o,e),r:o,stroke:"transparent",fill:"transparent"}),Vp=()=>!0;var Kn=e=>{const t=({id:r,className:o,type:s,data:c,onClick:u,onEdgeDoubleClick:f,selected:h,animated:p,label:m,labelStyle:v,labelShowBg:w,labelBgStyle:g,labelBgPadding:k,labelBgBorderRadius:N,style:P,source:S,target:H,sourceX:K,sourceY:C,targetX:U,targetY:Q,sourcePosition:X,targetPosition:ee,elementsSelectable:G,hidden:oe,sourceHandleId:ne,targetHandleId:le,onContextMenu:se,onMouseEnter:b,onMouseMove:L,onMouseLeave:j,reconnectRadius:W,onReconnect:re,onReconnectStart:z,onReconnectEnd:J,markerEnd:ie,markerStart:ae,rfId:ge,ariaLabel:ve,isFocusable:be,isReconnectable:ke,pathOptions:Ae,interactionWidth:De,disableKeyboardA11y:de})=>{const Pe=D.useRef(null),[Le,Se]=D.useState(!1),[Ve,Ue]=D.useState(!1),je=Xe(),at=D.useMemo(()=>`url('#${Ti(ae,ge)}')`,[ae,ge]),Oe=D.useMemo(()=>`url('#${Ti(ie,ge)}')`,[ie,ge]);if(oe)return null;const Ee=Fe=>{var Ze;const{edges:nt,addSelectedEdges:St,unselectNodesAndEdges:rt,multiSelectionActive:xe}=je.getState(),ut=nt.find(Pt=>Pt.id===r);ut&&(G&&(je.setState({nodesSelectionActive:!1}),ut.selected&&xe?(rt({nodes:[],edges:[ut]}),(Ze=Pe.current)==null||Ze.blur()):St([r])),u&&u(Fe,ut))},Je=fr(r,je.getState,f),dt=fr(r,je.getState,se),tt=fr(r,je.getState,b),Lt=fr(r,je.getState,L),yt=fr(r,je.getState,j),gt=(Fe,nt)=>{if(Fe.button!==0)return;const{edges:St,isValidConnection:rt}=je.getState(),xe=nt?H:S,ut=(nt?le:ne)||null,Ze=nt?"target":"source",Pt=rt||Vp,me=nt,qt=St.find(Rt=>Rt.id===r);Ue(!0),z==null||z(Fe,qt,Ze);const kn=Rt=>{Ue(!1),J==null||J(Rt,qt,Ze)};xc({event:Fe,handleId:ut,nodeId:xe,onConnect:Rt=>re==null?void 0:re(qt,Rt),isTarget:me,getState:je.getState,setState:je.setState,isValidConnection:Pt,edgeUpdaterType:Ze,onReconnectEnd:kn})},vt=Fe=>gt(Fe,!0),ct=Fe=>gt(Fe,!1),Et=()=>Se(!0),wt=()=>Se(!1),It=!G&&!u,$t=Fe=>{var nt;if(!de&&cc.includes(Fe.key)&&G){const{unselectNodesAndEdges:St,addSelectedEdges:rt,edges:xe}=je.getState();Fe.key==="Escape"?((nt=Pe.current)==null||nt.blur(),St({edges:[xe.find(Ze=>Ze.id===r)]})):rt([r])}};return Z.createElement("g",{className:et(["react-flow__edge",`react-flow__edge-${s}`,o,{selected:h,animated:p,inactive:It,updating:Le}]),onClick:Ee,onDoubleClick:Je,onContextMenu:dt,onMouseEnter:tt,onMouseMove:Lt,onMouseLeave:yt,onKeyDown:be?$t:void 0,tabIndex:be?0:void 0,role:be?"button":"img","data-testid":`rf__edge-${r}`,"aria-label":ve===null?void 0:ve||`Edge from ${S} to ${H}`,"aria-describedby":be?`${Tc}-${ge}`:void 0,ref:Pe},!Ve&&Z.createElement(e,{id:r,source:S,target:H,selected:h,animated:p,label:m,labelStyle:v,labelShowBg:w,labelBgStyle:g,labelBgPadding:k,labelBgBorderRadius:N,data:c,style:P,sourceX:K,sourceY:C,targetX:U,targetY:Q,sourcePosition:X,targetPosition:ee,sourceHandleId:ne,targetHandleId:le,markerStart:at,markerEnd:Oe,pathOptions:Ae,interactionWidth:De}),ke&&Z.createElement(Z.Fragment,null,(ke==="source"||ke===!0)&&Z.createElement(la,{position:X,centerX:K,centerY:C,radius:W,onMouseDown:vt,onMouseEnter:Et,onMouseOut:wt,type:"source"}),(ke==="target"||ke===!0)&&Z.createElement(la,{position:ee,centerX:U,centerY:Q,radius:W,onMouseDown:ct,onMouseEnter:Et,onMouseOut:wt,type:"target"})))};return t.displayName="EdgeWrapper",D.memo(t)};function Wp(e){const t={default:Kn(e.default||vo),straight:Kn(e.bezier||Xi),step:Kn(e.step||Yi),smoothstep:Kn(e.step||Ao),simplebezier:Kn(e.simplebezier||Wi)},r={},o=Object.keys(e).filter(s=>!["default","bezier"].includes(s)).reduce((s,c)=>(s[c]=Kn(e[c]||vo),s),r);return{...t,...o}}function fa(e,t,r=null){const o=((r==null?void 0:r.x)||0)+t.x,s=((r==null?void 0:r.y)||0)+t.y,c=(r==null?void 0:r.width)||t.width,u=(r==null?void 0:r.height)||t.height;switch(e){case _e.Top:return{x:o+c/2,y:s};case _e.Right:return{x:o+c,y:s+u/2};case _e.Bottom:return{x:o+c/2,y:s+u};case _e.Left:return{x:o,y:s+u/2}}}function da(e,t){return e?e.length===1||!t?e[0]:t&&e.find(r=>r.id===t)||null:null}const Yp=(e,t,r,o,s,c)=>{const u=fa(r,e,t),f=fa(c,o,s);return{sourceX:u.x,sourceY:u.y,targetX:f.x,targetY:f.y}};function Xp({sourcePos:e,targetPos:t,sourceWidth:r,sourceHeight:o,targetWidth:s,targetHeight:c,width:u,height:f,transform:h}){const p={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+r,t.x+s),y2:Math.max(e.y+o,t.y+c)};p.x===p.x2&&(p.x2+=1),p.y===p.y2&&(p.y2+=1);const m=_r({x:(0-h[0])/h[2],y:(0-h[1])/h[2],width:u/h[2],height:f/h[2]}),v=Math.max(0,Math.min(m.x2,p.x2)-Math.max(m.x,p.x)),w=Math.max(0,Math.min(m.y2,p.y2)-Math.max(m.y,p.y));return Math.ceil(v*w)>0}function ha(e){var o,s,c,u,f;const t=((o=e==null?void 0:e[qe])==null?void 0:o.handleBounds)||null,r=t&&(e==null?void 0:e.width)&&(e==null?void 0:e.height)&&typeof((s=e==null?void 0:e.positionAbsolute)==null?void 0:s.x)<"u"&&typeof((c=e==null?void 0:e.positionAbsolute)==null?void 0:c.y)<"u";return[{x:((u=e==null?void 0:e.positionAbsolute)==null?void 0:u.x)||0,y:((f=e==null?void 0:e.positionAbsolute)==null?void 0:f.y)||0,width:(e==null?void 0:e.width)||0,height:(e==null?void 0:e.height)||0},t,!!r]}const Up=[{level:0,isMaxLevel:!0,edges:[]}];function Zp(e,t,r=!1){let o=-1;const s=e.reduce((u,f)=>{var m,v;const h=_t(f.zIndex);let p=h?f.zIndex:0;if(r){const w=t.get(f.target),g=t.get(f.source),k=f.selected||(w==null?void 0:w.selected)||(g==null?void 0:g.selected),N=Math.max(((m=g==null?void 0:g[qe])==null?void 0:m.z)||0,((v=w==null?void 0:w[qe])==null?void 0:v.z)||0,1e3);p=(h?f.zIndex:0)+(k?N:0)}return u[p]?u[p].push(f):u[p]=[f],o=p>o?p:o,u},{}),c=Object.entries(s).map(([u,f])=>{const h=+u;return{edges:f,level:h,isMaxLevel:h===o}});return c.length===0?Up:c}function Gp(e,t,r){const o=ze(D.useCallback(s=>e?s.edges.filter(c=>{const u=t.get(c.source),f=t.get(c.target);return(u==null?void 0:u.width)&&(u==null?void 0:u.height)&&(f==null?void 0:f.width)&&(f==null?void 0:f.height)&&Xp({sourcePos:u.positionAbsolute||{x:0,y:0},targetPos:f.positionAbsolute||{x:0,y:0},sourceWidth:u.width,sourceHeight:u.height,targetWidth:f.width,targetHeight:f.height,width:s.width,height:s.height,transform:s.transform})}):s.edges,[e,t]));return Zp(o,t,r)}const Qp=({color:e="none",strokeWidth:t=1})=>Z.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),Jp=({color:e="none",strokeWidth:t=1})=>Z.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),pa={[go.Arrow]:Qp,[go.ArrowClosed]:Jp};function em(e){const t=Xe();return D.useMemo(()=>{var s,c;return Object.prototype.hasOwnProperty.call(pa,e)?pa[e]:((c=(s=t.getState()).onError)==null||c.call(s,"009",Qt.error009(e)),null)},[e])}const tm=({id:e,type:t,color:r,width:o=12.5,height:s=12.5,markerUnits:c="strokeWidth",strokeWidth:u,orient:f="auto-start-reverse"})=>{const h=em(t);return h?Z.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${o}`,markerHeight:`${s}`,viewBox:"-10 -10 20 20",markerUnits:c,orient:f,refX:"0",refY:"0"},Z.createElement(h,{color:r,strokeWidth:u})):null},nm=({defaultColor:e,rfId:t})=>r=>{const o=[];return r.edges.reduce((s,c)=>([c.markerStart,c.markerEnd].forEach(u=>{if(u&&typeof u=="object"){const f=Ti(u,t);o.includes(f)||(s.push({id:f,color:u.color||e,...u}),o.push(f))}}),s),[]).sort((s,c)=>s.id.localeCompare(c.id))},Fc=({defaultColor:e,rfId:t})=>{const r=ze(D.useCallback(nm({defaultColor:e,rfId:t}),[e,t]),(o,s)=>!(o.length!==s.length||o.some((c,u)=>c.id!==s[u].id)));return Z.createElement("defs",null,r.map(o=>Z.createElement(tm,{id:o.id,key:o.id,type:o.type,color:o.color,width:o.width,height:o.height,markerUnits:o.markerUnits,strokeWidth:o.strokeWidth,orient:o.orient})))};Fc.displayName="MarkerDefinitions";var rm=D.memo(Fc);const om=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),Hc=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:r,rfId:o,edgeTypes:s,noPanClassName:c,onEdgeContextMenu:u,onEdgeMouseEnter:f,onEdgeMouseMove:h,onEdgeMouseLeave:p,onEdgeClick:m,onEdgeDoubleClick:v,onReconnect:w,onReconnectStart:g,onReconnectEnd:k,reconnectRadius:N,children:P,disableKeyboardA11y:S})=>{const{edgesFocusable:H,edgesUpdatable:K,elementsSelectable:C,width:U,height:Q,connectionMode:X,nodeInternals:ee,onError:G}=ze(om,Qe),oe=Gp(t,ee,r);return U?Z.createElement(Z.Fragment,null,oe.map(({level:ne,edges:le,isMaxLevel:se})=>Z.createElement("svg",{key:ne,style:{zIndex:ne},width:U,height:Q,className:"react-flow__edges react-flow__container"},se&&Z.createElement(rm,{defaultColor:e,rfId:o}),Z.createElement("g",null,le.map(b=>{const[L,j,W]=ha(ee.get(b.source)),[re,z,J]=ha(ee.get(b.target));if(!W||!J)return null;let ie=b.type||"default";s[ie]||(G==null||G("011",Qt.error011(ie)),ie="default");const ae=s[ie]||s.default,ge=X===Sn.Strict?z.target:(z.target??[]).concat(z.source??[]),ve=da(j.source,b.sourceHandle),be=da(ge,b.targetHandle),ke=(ve==null?void 0:ve.position)||_e.Bottom,Ae=(be==null?void 0:be.position)||_e.Top,De=!!(b.focusable||H&&typeof b.focusable>"u"),de=b.reconnectable||b.updatable,Pe=typeof w<"u"&&(de||K&&typeof de>"u");if(!ve||!be)return G==null||G("008",Qt.error008(ve,b)),null;const{sourceX:Le,sourceY:Se,targetX:Ve,targetY:Ue}=Yp(L,ve,ke,re,be,Ae);return Z.createElement(ae,{key:b.id,id:b.id,className:et([b.className,c]),type:ie,data:b.data,selected:!!b.selected,animated:!!b.animated,hidden:!!b.hidden,label:b.label,labelStyle:b.labelStyle,labelShowBg:b.labelShowBg,labelBgStyle:b.labelBgStyle,labelBgPadding:b.labelBgPadding,labelBgBorderRadius:b.labelBgBorderRadius,style:b.style,source:b.source,target:b.target,sourceHandleId:b.sourceHandle,targetHandleId:b.targetHandle,markerEnd:b.markerEnd,markerStart:b.markerStart,sourceX:Le,sourceY:Se,targetX:Ve,targetY:Ue,sourcePosition:ke,targetPosition:Ae,elementsSelectable:C,onContextMenu:u,onMouseEnter:f,onMouseMove:h,onMouseLeave:p,onClick:m,onEdgeDoubleClick:v,onReconnect:w,onReconnectStart:g,onReconnectEnd:k,reconnectRadius:N,rfId:o,ariaLabel:b.ariaLabel,isFocusable:De,isReconnectable:Pe,pathOptions:"pathOptions"in b?b.pathOptions:void 0,interactionWidth:b.interactionWidth,disableKeyboardA11y:S})})))),P):null};Hc.displayName="EdgeRenderer";var im=D.memo(Hc);const sm=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function am({children:e}){const t=ze(sm);return Z.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function cm(e){const t=Qi(),r=D.useRef(!1);D.useEffect(()=>{!r.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),r.current=!0)},[e,t.viewportInitialized])}const um={[_e.Left]:_e.Right,[_e.Right]:_e.Left,[_e.Top]:_e.Bottom,[_e.Bottom]:_e.Top},Lc=({nodeId:e,handleType:t,style:r,type:o=ln.Bezier,CustomComponent:s,connectionStatus:c})=>{var Q,X,ee;const{fromNode:u,handleId:f,toX:h,toY:p,connectionMode:m}=ze(D.useCallback(G=>({fromNode:G.nodeInternals.get(e),handleId:G.connectionHandleId,toX:(G.connectionPosition.x-G.transform[0])/G.transform[2],toY:(G.connectionPosition.y-G.transform[1])/G.transform[2],connectionMode:G.connectionMode}),[e]),Qe),v=(Q=u==null?void 0:u[qe])==null?void 0:Q.handleBounds;let w=v==null?void 0:v[t];if(m===Sn.Loose&&(w=w||(v==null?void 0:v[t==="source"?"target":"source"])),!u||!w)return null;const g=f?w.find(G=>G.id===f):w[0],k=g?g.x+g.width/2:(u.width??0)/2,N=g?g.y+g.height/2:u.height??0,P=(((X=u.positionAbsolute)==null?void 0:X.x)??0)+k,S=(((ee=u.positionAbsolute)==null?void 0:ee.y)??0)+N,H=g==null?void 0:g.position,K=H?um[H]:null;if(!H||!K)return null;if(s)return Z.createElement(s,{connectionLineType:o,connectionLineStyle:r,fromNode:u,fromHandle:g,fromX:P,fromY:S,toX:h,toY:p,fromPosition:H,toPosition:K,connectionStatus:c});let C="";const U={sourceX:P,sourceY:S,sourcePosition:H,targetX:h,targetY:p,targetPosition:K};return o===ln.Bezier?[C]=hc(U):o===ln.Step?[C]=Ai({...U,borderRadius:0}):o===ln.SmoothStep?[C]=Ai(U):o===ln.SimpleBezier?[C]=dc(U):C=`M${P},${S} ${h},${p}`,Z.createElement("path",{d:C,fill:"none",className:"react-flow__connection-path",style:r})};Lc.displayName="ConnectionLine";const lm=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function fm({containerStyle:e,style:t,type:r,component:o}){const{nodeId:s,handleType:c,nodesConnectable:u,width:f,height:h,connectionStatus:p}=ze(lm,Qe);return!(s&&c&&f&&u)?null:Z.createElement("svg",{style:e,width:f,height:h,className:"react-flow__edges react-flow__connectionline react-flow__container"},Z.createElement("g",{className:et(["react-flow__connection",p])},Z.createElement(Lc,{nodeId:s,handleType:c,style:t,type:r,CustomComponent:o,connectionStatus:p})))}function ma(e,t){return D.useRef(null),Xe(),D.useMemo(()=>t(e),[e])}const qc=({nodeTypes:e,edgeTypes:t,onMove:r,onMoveStart:o,onMoveEnd:s,onInit:c,onNodeClick:u,onEdgeClick:f,onNodeDoubleClick:h,onEdgeDoubleClick:p,onNodeMouseEnter:m,onNodeMouseMove:v,onNodeMouseLeave:w,onNodeContextMenu:g,onSelectionContextMenu:k,onSelectionStart:N,onSelectionEnd:P,connectionLineType:S,connectionLineStyle:H,connectionLineComponent:K,connectionLineContainerStyle:C,selectionKeyCode:U,selectionOnDrag:Q,selectionMode:X,multiSelectionKeyCode:ee,panActivationKeyCode:G,zoomActivationKeyCode:oe,deleteKeyCode:ne,onlyRenderVisibleElements:le,elementsSelectable:se,selectNodesOnDrag:b,defaultViewport:L,translateExtent:j,minZoom:W,maxZoom:re,preventScrolling:z,defaultMarkerColor:J,zoomOnScroll:ie,zoomOnPinch:ae,panOnScroll:ge,panOnScrollSpeed:ve,panOnScrollMode:be,zoomOnDoubleClick:ke,panOnDrag:Ae,onPaneClick:De,onPaneMouseEnter:de,onPaneMouseMove:Pe,onPaneMouseLeave:Le,onPaneScroll:Se,onPaneContextMenu:Ve,onEdgeContextMenu:Ue,onEdgeMouseEnter:je,onEdgeMouseMove:at,onEdgeMouseLeave:Oe,onReconnect:Ee,onReconnectStart:Je,onReconnectEnd:dt,reconnectRadius:tt,noDragClassName:Lt,noWheelClassName:yt,noPanClassName:gt,elevateEdgesOnSelect:vt,disableKeyboardA11y:ct,nodeOrigin:Et,nodeExtent:wt,rfId:It})=>{const $t=ma(e,zp),Fe=ma(t,Wp);return cm(c),Z.createElement(jp,{onPaneClick:De,onPaneMouseEnter:de,onPaneMouseMove:Pe,onPaneMouseLeave:Le,onPaneContextMenu:Ve,onPaneScroll:Se,deleteKeyCode:ne,selectionKeyCode:U,selectionOnDrag:Q,selectionMode:X,onSelectionStart:N,onSelectionEnd:P,multiSelectionKeyCode:ee,panActivationKeyCode:G,zoomActivationKeyCode:oe,elementsSelectable:se,onMove:r,onMoveStart:o,onMoveEnd:s,zoomOnScroll:ie,zoomOnPinch:ae,zoomOnDoubleClick:ke,panOnScroll:ge,panOnScrollSpeed:ve,panOnScrollMode:be,panOnDrag:Ae,defaultViewport:L,translateExtent:j,minZoom:W,maxZoom:re,onSelectionContextMenu:k,preventScrolling:z,noDragClassName:Lt,noWheelClassName:yt,noPanClassName:gt,disableKeyboardA11y:ct},Z.createElement(am,null,Z.createElement(im,{edgeTypes:Fe,onEdgeClick:f,onEdgeDoubleClick:p,onlyRenderVisibleElements:le,onEdgeContextMenu:Ue,onEdgeMouseEnter:je,onEdgeMouseMove:at,onEdgeMouseLeave:Oe,onReconnect:Ee,onReconnectStart:Je,onReconnectEnd:dt,reconnectRadius:tt,defaultMarkerColor:J,noPanClassName:gt,elevateEdgesOnSelect:!!vt,disableKeyboardA11y:ct,rfId:It},Z.createElement(fm,{style:H,type:S,component:K,containerStyle:C})),Z.createElement("div",{className:"react-flow__edgelabel-renderer"}),Z.createElement(Hp,{nodeTypes:$t,onNodeClick:u,onNodeDoubleClick:h,onNodeMouseEnter:m,onNodeMouseMove:v,onNodeMouseLeave:w,onNodeContextMenu:g,selectNodesOnDrag:b,onlyRenderVisibleElements:le,noPanClassName:gt,noDragClassName:Lt,disableKeyboardA11y:ct,nodeOrigin:Et,nodeExtent:wt,rfId:It})))};qc.displayName="GraphView";var dm=D.memo(qc);const Pi=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],an={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:Pi,nodeExtent:Pi,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:Sn.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:Kh,isValidConnection:void 0},hm=()=>el((e,t)=>({...an,setNodes:r=>{const{nodeInternals:o,nodeOrigin:s,elevateNodesOnSelect:c}=t();e({nodeInternals:hi(r,o,s,c)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:r=>{const{defaultEdgeOptions:o={}}=t();e({edges:r.map(s=>({...o,...s}))})},setDefaultNodesAndEdges:(r,o)=>{const s=typeof r<"u",c=typeof o<"u",u=s?hi(r,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:u,edges:c?o:[],hasDefaultNodes:s,hasDefaultEdges:c})},updateNodeDimensions:r=>{const{onNodesChange:o,nodeInternals:s,fitViewOnInit:c,fitViewOnInitDone:u,fitViewOnInitOptions:f,domNode:h,nodeOrigin:p}=t(),m=h==null?void 0:h.querySelector(".react-flow__viewport");if(!m)return;const v=window.getComputedStyle(m),{m22:w}=new window.DOMMatrixReadOnly(v.transform),g=r.reduce((N,P)=>{const S=s.get(P.id);if(S!=null&&S.hidden)s.set(S.id,{...S,[qe]:{...S[qe],handleBounds:void 0}});else if(S){const H=qi(P.nodeElement);!!(H.width&&H.height&&(S.width!==H.width||S.height!==H.height||P.forceUpdate))&&(s.set(S.id,{...S,[qe]:{...S[qe],handleBounds:{source:ca(".source",P.nodeElement,w,p),target:ca(".target",P.nodeElement,w,p)}},...H}),N.push({id:S.id,type:"dimensions",dimensions:H}))}return N},[]);Ic(s,p);const k=u||c&&!u&&$c(t,{initial:!0,...f});e({nodeInternals:new Map(s),fitViewOnInitDone:k}),(g==null?void 0:g.length)>0&&(o==null||o(g))},updateNodePositions:(r,o=!0,s=!1)=>{const{triggerNodeChanges:c}=t(),u=r.map(f=>{const h={id:f.id,type:"position",dragging:s};return o&&(h.positionAbsolute=f.positionAbsolute,h.position=f.position),h});c(u)},triggerNodeChanges:r=>{const{onNodesChange:o,nodeInternals:s,hasDefaultNodes:c,nodeOrigin:u,getNodes:f,elevateNodesOnSelect:h}=t();if(r!=null&&r.length){if(c){const p=Pc(r,f()),m=hi(p,s,u,h);e({nodeInternals:m})}o==null||o(r)}},addSelectedNodes:r=>{const{multiSelectionActive:o,edges:s,getNodes:c}=t();let u,f=null;o?u=r.map(h=>un(h,!0)):(u=Fn(c(),r),f=Fn(s,[])),no({changedNodes:u,changedEdges:f,get:t,set:e})},addSelectedEdges:r=>{const{multiSelectionActive:o,edges:s,getNodes:c}=t();let u,f=null;o?u=r.map(h=>un(h,!0)):(u=Fn(s,r),f=Fn(c(),[])),no({changedNodes:f,changedEdges:u,get:t,set:e})},unselectNodesAndEdges:({nodes:r,edges:o}={})=>{const{edges:s,getNodes:c}=t(),u=r||c(),f=o||s,h=u.map(m=>(m.selected=!1,un(m.id,!1))),p=f.map(m=>un(m.id,!1));no({changedNodes:h,changedEdges:p,get:t,set:e})},setMinZoom:r=>{const{d3Zoom:o,maxZoom:s}=t();o==null||o.scaleExtent([r,s]),e({minZoom:r})},setMaxZoom:r=>{const{d3Zoom:o,minZoom:s}=t();o==null||o.scaleExtent([s,r]),e({maxZoom:r})},setTranslateExtent:r=>{var o;(o=t().d3Zoom)==null||o.translateExtent(r),e({translateExtent:r})},resetSelectedElements:()=>{const{edges:r,getNodes:o}=t(),c=o().filter(f=>f.selected).map(f=>un(f.id,!1)),u=r.filter(f=>f.selected).map(f=>un(f.id,!1));no({changedNodes:c,changedEdges:u,get:t,set:e})},setNodeExtent:r=>{const{nodeInternals:o}=t();o.forEach(s=>{s.positionAbsolute=Vi(s.position,r)}),e({nodeExtent:r,nodeInternals:new Map(o)})},panBy:r=>{const{transform:o,width:s,height:c,d3Zoom:u,d3Selection:f,translateExtent:h}=t();if(!u||!f||!r.x&&!r.y)return!1;const p=Zt.translate(o[0]+r.x,o[1]+r.y).scale(o[2]),m=[[0,0],[s,c]],v=u==null?void 0:u.constrain()(p,m,h);return u.transform(f,v),o[0]!==v.x||o[1]!==v.y||o[2]!==v.k},cancelConnection:()=>e({connectionNodeId:an.connectionNodeId,connectionHandleId:an.connectionHandleId,connectionHandleType:an.connectionHandleType,connectionStatus:an.connectionStatus,connectionStartHandle:an.connectionStartHandle,connectionEndHandle:an.connectionEndHandle}),reset:()=>e({...an})}),Object.is),Vc=({children:e})=>{const t=D.useRef(null);return t.current||(t.current=hm()),Z.createElement(Ph,{value:t.current},e)};Vc.displayName="ReactFlowProvider";const Wc=({children:e})=>D.useContext(No)?Z.createElement(Z.Fragment,null,e):Z.createElement(Vc,null,e);Wc.displayName="ReactFlowWrapper";const pm={input:Sc,default:Ii,output:Nc,group:Gi},mm={default:vo,straight:Xi,step:Yi,smoothstep:Ao,simplebezier:Wi},ym=[0,0],gm=[15,15],vm={x:0,y:0,zoom:1},wm={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},Yc=D.forwardRef(({nodes:e,edges:t,defaultNodes:r,defaultEdges:o,className:s,nodeTypes:c=pm,edgeTypes:u=mm,onNodeClick:f,onEdgeClick:h,onInit:p,onMove:m,onMoveStart:v,onMoveEnd:w,onConnect:g,onConnectStart:k,onConnectEnd:N,onClickConnectStart:P,onClickConnectEnd:S,onNodeMouseEnter:H,onNodeMouseMove:K,onNodeMouseLeave:C,onNodeContextMenu:U,onNodeDoubleClick:Q,onNodeDragStart:X,onNodeDrag:ee,onNodeDragStop:G,onNodesDelete:oe,onEdgesDelete:ne,onSelectionChange:le,onSelectionDragStart:se,onSelectionDrag:b,onSelectionDragStop:L,onSelectionContextMenu:j,onSelectionStart:W,onSelectionEnd:re,connectionMode:z=Sn.Strict,connectionLineType:J=ln.Bezier,connectionLineStyle:ie,connectionLineComponent:ae,connectionLineContainerStyle:ge,deleteKeyCode:ve="Backspace",selectionKeyCode:be="Shift",selectionOnDrag:ke=!1,selectionMode:Ae=Er.Full,panActivationKeyCode:De="Space",multiSelectionKeyCode:de=yo()?"Meta":"Control",zoomActivationKeyCode:Pe=yo()?"Meta":"Control",snapToGrid:Le=!1,snapGrid:Se=gm,onlyRenderVisibleElements:Ve=!1,selectNodesOnDrag:Ue=!0,nodesDraggable:je,nodesConnectable:at,nodesFocusable:Oe,nodeOrigin:Ee=ym,edgesFocusable:Je,edgesUpdatable:dt,elementsSelectable:tt,defaultViewport:Lt=vm,minZoom:yt=.5,maxZoom:gt=2,translateExtent:vt=Pi,preventScrolling:ct=!0,nodeExtent:Et,defaultMarkerColor:wt="#b1b1b7",zoomOnScroll:It=!0,zoomOnPinch:$t=!0,panOnScroll:Fe=!1,panOnScrollSpeed:nt=.5,panOnScrollMode:St=xn.Free,zoomOnDoubleClick:rt=!0,panOnDrag:xe=!0,onPaneClick:ut,onPaneMouseEnter:Ze,onPaneMouseMove:Pt,onPaneMouseLeave:me,onPaneScroll:qt,onPaneContextMenu:kn,children:Nn,onEdgeContextMenu:Rt,onEdgeDoubleClick:Un,onEdgeMouseEnter:Io,onEdgeMouseMove:$o,onEdgeMouseLeave:Jt,onEdgeUpdate:en,onEdgeUpdateStart:Zn,onEdgeUpdateEnd:Cn,onReconnect:Be,onReconnectStart:Ye,onReconnectEnd:Po,reconnectRadius:An=10,edgeUpdaterRadius:Tn=10,onNodesChange:Mn,onEdgesChange:Ro,noDragClassName:Dt="nodrag",noWheelClassName:tn="nowheel",noPanClassName:kt="nopan",fitView:In=!1,fitViewOptions:Do,connectOnClick:Ot=!0,attributionPosition:Ar,proOptions:Vt,defaultEdgeOptions:Tr,elevateNodesOnSelect:Gn=!0,elevateEdgesOnSelect:He=!1,disableKeyboardA11y:jt=!1,autoPanOnConnect:Nt=!0,autoPanOnNodeDrag:Mr=!0,connectionRadius:nn=20,isValidConnection:$n,onError:Qn,style:Jn,id:Bt,nodeDragThreshold:Ir,...Pn},$r)=>{const Te=Bt||"1";return Z.createElement("div",{...Pn,style:{...Jn,...wm},ref:$r,className:et(["react-flow",s]),"data-testid":"rf__wrapper",id:Bt},Z.createElement(Wc,null,Z.createElement(dm,{onInit:p,onMove:m,onMoveStart:v,onMoveEnd:w,onNodeClick:f,onEdgeClick:h,onNodeMouseEnter:H,onNodeMouseMove:K,onNodeMouseLeave:C,onNodeContextMenu:U,onNodeDoubleClick:Q,nodeTypes:c,edgeTypes:u,connectionLineType:J,connectionLineStyle:ie,connectionLineComponent:ae,connectionLineContainerStyle:ge,selectionKeyCode:be,selectionOnDrag:ke,selectionMode:Ae,deleteKeyCode:ve,multiSelectionKeyCode:de,panActivationKeyCode:De,zoomActivationKeyCode:Pe,onlyRenderVisibleElements:Ve,selectNodesOnDrag:Ue,defaultViewport:Lt,translateExtent:vt,minZoom:yt,maxZoom:gt,preventScrolling:ct,zoomOnScroll:It,zoomOnPinch:$t,zoomOnDoubleClick:rt,panOnScroll:Fe,panOnScrollSpeed:nt,panOnScrollMode:St,panOnDrag:xe,onPaneClick:ut,onPaneMouseEnter:Ze,onPaneMouseMove:Pt,onPaneMouseLeave:me,onPaneScroll:qt,onPaneContextMenu:kn,onSelectionContextMenu:j,onSelectionStart:W,onSelectionEnd:re,onEdgeContextMenu:Rt,onEdgeDoubleClick:Un,onEdgeMouseEnter:Io,onEdgeMouseMove:$o,onEdgeMouseLeave:Jt,onReconnect:Be??en,onReconnectStart:Ye??Zn,onReconnectEnd:Po??Cn,reconnectRadius:An??Tn,defaultMarkerColor:wt,noDragClassName:Dt,noWheelClassName:tn,noPanClassName:kt,elevateEdgesOnSelect:He,rfId:Te,disableKeyboardA11y:jt,nodeOrigin:Ee,nodeExtent:Et}),Z.createElement(up,{nodes:e,edges:t,defaultNodes:r,defaultEdges:o,onConnect:g,onConnectStart:k,onConnectEnd:N,onClickConnectStart:P,onClickConnectEnd:S,nodesDraggable:je,nodesConnectable:at,nodesFocusable:Oe,edgesFocusable:Je,edgesUpdatable:dt,elementsSelectable:tt,elevateNodesOnSelect:Gn,minZoom:yt,maxZoom:gt,nodeExtent:Et,onNodesChange:Mn,onEdgesChange:Ro,snapToGrid:Le,snapGrid:Se,connectionMode:z,translateExtent:vt,connectOnClick:Ot,defaultEdgeOptions:Tr,fitView:In,fitViewOptions:Do,onNodesDelete:oe,onEdgesDelete:ne,onNodeDragStart:X,onNodeDrag:ee,onNodeDragStop:G,onSelectionDrag:b,onSelectionDragStart:se,onSelectionDragStop:L,noPanClassName:kt,nodeOrigin:Ee,rfId:Te,autoPanOnConnect:Nt,autoPanOnNodeDrag:Mr,onError:Qn,connectionRadius:nn,isValidConnection:$n,nodeDragThreshold:Ir}),Z.createElement(ap,{onSelectionChange:le}),Nn,Z.createElement(Dh,{proOptions:Vt,position:Ar}),Z.createElement(pp,{rfId:Te,disableKeyboardA11y:jt})))});Yc.displayName="ReactFlow";const Xc=({id:e,x:t,y:r,width:o,height:s,style:c,color:u,strokeColor:f,strokeWidth:h,className:p,borderRadius:m,shapeRendering:v,onClick:w,selected:g})=>{const{background:k,backgroundColor:N}=c||{},P=u||k||N;return Z.createElement("rect",{className:et(["react-flow__minimap-node",{selected:g},p]),x:t,y:r,rx:m,ry:m,width:o,height:s,fill:P,stroke:f,strokeWidth:h,shapeRendering:v,onClick:w?S=>w(S,e):void 0})};Xc.displayName="MiniMapNode";var xm=D.memo(Xc);const bm=e=>e.nodeOrigin,_m=e=>e.getNodes().filter(t=>!t.hidden&&t.width&&t.height),gi=e=>e instanceof Function?e:()=>e;function Em({nodeStrokeColor:e="transparent",nodeColor:t="#e2e2e2",nodeClassName:r="",nodeBorderRadius:o=5,nodeStrokeWidth:s=2,nodeComponent:c=xm,onClick:u}){const f=ze(_m,Qe),h=ze(bm),p=gi(t),m=gi(e),v=gi(r),w=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return Z.createElement(Z.Fragment,null,f.map(g=>{const{x:k,y:N}=_n(g,h).positionAbsolute;return Z.createElement(c,{key:g.id,x:k,y:N,width:g.width,height:g.height,style:g.style,selected:g.selected,className:v(g),color:p(g),borderRadius:o,strokeColor:m(g),strokeWidth:s,shapeRendering:w,onClick:u,id:g.id})}))}var Sm=D.memo(Em);const km=200,Nm=150,Cm=e=>{const t=e.getNodes(),r={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:r,boundingRect:t.length>0?Bh(To(t,e.nodeOrigin),r):r,rfId:e.rfId}},Am="react-flow__minimap-desc";function Uc({style:e,className:t,nodeStrokeColor:r="transparent",nodeColor:o="#e2e2e2",nodeClassName:s="",nodeBorderRadius:c=5,nodeStrokeWidth:u=2,nodeComponent:f,maskColor:h="rgb(240, 240, 240, 0.6)",maskStrokeColor:p="none",maskStrokeWidth:m=1,position:v="bottom-right",onClick:w,onNodeClick:g,pannable:k=!1,zoomable:N=!1,ariaLabel:P="React Flow mini map",inversePan:S=!1,zoomStep:H=10,offsetScale:K=5}){const C=Xe(),U=D.useRef(null),{boundingRect:Q,viewBB:X,rfId:ee}=ze(Cm,Qe),G=(e==null?void 0:e.width)??km,oe=(e==null?void 0:e.height)??Nm,ne=Q.width/G,le=Q.height/oe,se=Math.max(ne,le),b=se*G,L=se*oe,j=K*se,W=Q.x-(b-Q.width)/2-j,re=Q.y-(L-Q.height)/2-j,z=b+j*2,J=L+j*2,ie=`${Am}-${ee}`,ae=D.useRef(0);ae.current=se,D.useEffect(()=>{if(U.current){const be=bt(U.current),ke=de=>{const{transform:Pe,d3Selection:Le,d3Zoom:Se}=C.getState();if(de.sourceEvent.type!=="wheel"||!Le||!Se)return;const Ve=-de.sourceEvent.deltaY*(de.sourceEvent.deltaMode===1?.05:de.sourceEvent.deltaMode?1:.002)*H,Ue=Pe[2]*Math.pow(2,Ve);Se.scaleTo(Le,Ue)},Ae=de=>{const{transform:Pe,d3Selection:Le,d3Zoom:Se,translateExtent:Ve,width:Ue,height:je}=C.getState();if(de.sourceEvent.type!=="mousemove"||!Le||!Se)return;const at=ae.current*Math.max(1,Pe[2])*(S?-1:1),Oe={x:Pe[0]-de.sourceEvent.movementX*at,y:Pe[1]-de.sourceEvent.movementY*at},Ee=[[0,0],[Ue,je]],Je=Zt.translate(Oe.x,Oe.y).scale(Pe[2]),dt=Se.constrain()(Je,Ee,Ve);Se.transform(Le,dt)},De=nc().on("zoom",k?Ae:null).on("zoom.wheel",N?ke:null);return be.call(De),()=>{be.on("zoom",null)}}},[k,N,S,H]);const ge=w?be=>{const ke=Ct(be);w(be,{x:ke[0],y:ke[1]})}:void 0,ve=g?(be,ke)=>{const Ae=C.getState().nodeInternals.get(ke);g(be,Ae)}:void 0;return Z.createElement(Co,{position:v,style:e,className:et(["react-flow__minimap",t]),"data-testid":"rf__minimap"},Z.createElement("svg",{width:G,height:oe,viewBox:`${W} ${re} ${z} ${J}`,role:"img","aria-labelledby":ie,ref:U,onClick:ge},P&&Z.createElement("title",{id:ie},P),Z.createElement(Sm,{onClick:ve,nodeColor:o,nodeStrokeColor:r,nodeBorderRadius:c,nodeClassName:s,nodeStrokeWidth:u,nodeComponent:f}),Z.createElement("path",{className:"react-flow__minimap-mask",d:`M${W-j},${re-j}h${z+j*2}v${J+j*2}h${-z-j*2}z
        M${X.x},${X.y}h${X.width}v${X.height}h${-X.width}z`,fill:h,fillRule:"evenodd",stroke:p,strokeWidth:m,pointerEvents:"none"})))}Uc.displayName="MiniMap";var Tm=D.memo(Uc);function Mm(){return Z.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},Z.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function Im(){return Z.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},Z.createElement("path",{d:"M0 0h32v4.2H0z"}))}function $m(){return Z.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},Z.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function Pm(){return Z.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},Z.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function Rm(){return Z.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},Z.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}const yr=({children:e,className:t,...r})=>Z.createElement("button",{type:"button",className:et(["react-flow__controls-button",t]),...r},e);yr.displayName="ControlButton";const Dm=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom}),Zc=({style:e,showZoom:t=!0,showFitView:r=!0,showInteractive:o=!0,fitViewOptions:s,onZoomIn:c,onZoomOut:u,onFitView:f,onInteractiveChange:h,className:p,children:m,position:v="bottom-left"})=>{const w=Xe(),[g,k]=D.useState(!1),{isInteractive:N,minZoomReached:P,maxZoomReached:S}=ze(Dm,Qe),{zoomIn:H,zoomOut:K,fitView:C}=Qi();if(D.useEffect(()=>{k(!0)},[]),!g)return null;const U=()=>{H(),c==null||c()},Q=()=>{K(),u==null||u()},X=()=>{C(s),f==null||f()},ee=()=>{w.setState({nodesDraggable:!N,nodesConnectable:!N,elementsSelectable:!N}),h==null||h(!N)};return Z.createElement(Co,{className:et(["react-flow__controls",p]),position:v,style:e,"data-testid":"rf__controls"},t&&Z.createElement(Z.Fragment,null,Z.createElement(yr,{onClick:U,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:S},Z.createElement(Mm,null)),Z.createElement(yr,{onClick:Q,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:P},Z.createElement(Im,null))),r&&Z.createElement(yr,{className:"react-flow__controls-fitview",onClick:X,title:"fit view","aria-label":"fit view"},Z.createElement($m,null)),o&&Z.createElement(yr,{className:"react-flow__controls-interactive",onClick:ee,title:"toggle interactivity","aria-label":"toggle interactivity"},N?Z.createElement(Rm,null):Z.createElement(Pm,null)),m)};Zc.displayName="Controls";var Om=D.memo(Zc),Tt;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(Tt||(Tt={}));function jm({color:e,dimensions:t,lineWidth:r}){return Z.createElement("path",{stroke:e,strokeWidth:r,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`})}function Bm({color:e,radius:t}){return Z.createElement("circle",{cx:t,cy:t,r:t,fill:e})}const zm={[Tt.Dots]:"#91919a",[Tt.Lines]:"#eee",[Tt.Cross]:"#e2e2e2"},Km={[Tt.Dots]:1,[Tt.Lines]:1,[Tt.Cross]:6},Fm=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function Gc({id:e,variant:t=Tt.Dots,gap:r=20,size:o,lineWidth:s=1,offset:c=2,color:u,style:f,className:h}){const p=D.useRef(null),{transform:m,patternId:v}=ze(Fm,Qe),w=u||zm[t],g=o||Km[t],k=t===Tt.Dots,N=t===Tt.Cross,P=Array.isArray(r)?r:[r,r],S=[P[0]*m[2]||1,P[1]*m[2]||1],H=g*m[2],K=N?[H,H]:S,C=k?[H/c,H/c]:[K[0]/c,K[1]/c];return Z.createElement("svg",{className:et(["react-flow__background",h]),style:{...f,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:p,"data-testid":"rf__background"},Z.createElement("pattern",{id:v+e,x:m[0]%S[0],y:m[1]%S[1],width:S[0],height:S[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${C[0]},-${C[1]})`},k?Z.createElement(Bm,{color:w,radius:H/c}):Z.createElement(jm,{dimensions:K,color:w,lineWidth:s})),Z.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${v+e})`}))}Gc.displayName="Background";var Hm=D.memo(Gc);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Lm={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qm=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),es=(e,t)=>{const r=D.forwardRef(({color:o="currentColor",size:s=24,strokeWidth:c=2,absoluteStrokeWidth:u,className:f="",children:h,...p},m)=>D.createElement("svg",{ref:m,...Lm,width:s,height:s,stroke:o,strokeWidth:u?Number(c)*24/Number(s):c,className:["lucide",`lucide-${qm(e)}`,f].join(" "),...p},[...t.map(([v,w])=>D.createElement(v,w)),...Array.isArray(h)?h:[h]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vm=es("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wm=es("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mo=es("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function Qc(e){var t,r,o="";if(typeof e=="string"||typeof e=="number")o+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(r=Qc(e[t]))&&(o&&(o+=" "),o+=r)}else for(r in e)e[r]&&(o&&(o+=" "),o+=r);return o}function vn(){for(var e,t,r=0,o="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=Qc(e))&&(o&&(o+=" "),o+=t);return o}const Ym=e=>e.nonCompletedStatusExists?"border-red-500 border-5":e.type==="workflow"||e.type=="childWorkflow"?"border-blue-500":"border-green-500",Xm=(e,t=40)=>e?e.length<=t?e:e.slice(0,t)+"...":"",Um=e=>{switch(e==null?void 0:e.toLowerCase()){case"completed":return"text-green-600 bg-green-50";case"running":return"text-orange-600 bg-orange-50";case"failed":return"text-red-600 bg-red-50";default:return"text-gray-600 bg-gray-50"}};function Zm({id:e,data:t,expandChildWorkflowNode:r,collapseChildWorkflowNode:o,onShowNodeData:s,onSpreadBatchNodes:c}){var h;const u=t.type==="workflow"||t.type==="childWorkflow",f=`${e}-${t.type}-${t.workflowId||""}-${t.runId||""}`;return F.jsxs("div",{className:"relative",children:[F.jsx(fn,{type:"source",position:_e.Right,id:`${e}-right`,style:{top:"50%",transform:"translateY(-50%)"}}),F.jsx(fn,{type:"target",position:_e.Left,id:`${e}-left`,style:{top:"50%",transform:"translateY(-50%)"}}),F.jsx(fn,{type:"source",position:_e.Bottom,id:`${e}-bottom`,style:{left:"25px"}}),F.jsx(fn,{type:"target",position:_e.Top,id:`${e}-top`,style:{left:"25px"}}),F.jsx("div",{className:vn("rounded-lg shadow-lg border-2 transition-all duration-300",Ym(t)),children:F.jsxs("div",{className:vn("p-4 cursor-pointer relative","bg-white"),onClick:async()=>{u&&(t.isExpanded?await o(e):await r(e))},children:[F.jsxs("div",{className:"absolute -top-2.5 -right-2.5 flex gap-1",children:[t.count&&t.count>1&&F.jsx("div",{onClick:async p=>{p.stopPropagation(),await(c==null?void 0:c(e))},className:"w-6 h-6 flex items-center justify-center bg-blue-500 hover:bg-blue-600 rounded-full text-white shadow-lg z-10 cursor-pointer",children:F.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",strokeWidth:2,viewBox:"0 0 24 24",children:F.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11 4.5a6.5 6.5 0 1 0 4.135 11.286l3.572 3.572a1 1 0 0 0 1.414-1.414l-3.572-3.572A6.5 6.5 0 0 0 11 4.5z"})})}),F.jsx("div",{onClick:p=>{p.stopPropagation(),s(t)},className:"w-6 h-6 flex items-center justify-center bg-gray-500 hover:bg-gray-600 rounded-full text-white shadow-lg z-10 cursor-pointer",children:F.jsx(Vm,{className:"w-3 h-3"})})]}),F.jsxs("div",{className:"flex items-center gap-3",children:[F.jsx("div",{className:vn("w-8 h-8 rounded flex items-center justify-center flex-shrink-0",u?"bg-blue-50":"bg-green-50"),children:F.jsx("span",{className:vn("font-semibold text-sm",u?"text-blue-600":"text-green-600"),children:u?"W":"A"})}),F.jsxs("div",{className:vn("min-w-0",u?"":"flex items-center h-[2.5rem]"),children:[F.jsx("h3",{className:"font-semibold text-gray-800 truncate",children:t.title}),u&&F.jsx("p",{className:"text-xs text-gray-500 overflow-hidden text-ellipsis",children:Xm(e)})]})]}),F.jsxs("div",{className:"absolute -top-3 left-3 flex gap-2",children:[F.jsx("div",{className:"px-2 py-0.5 rounded text-xs font-medium shadow-sm z-10",style:{backgroundColor:u?"rgba(239, 246, 255, 0.9)":"rgba(240, 253, 244, 0.9)",color:u?"#1e40af":"#166534"},children:u?"workflow":"activity"}),F.jsx("div",{className:vn("px-2 py-0.5 rounded text-xs font-medium shadow-sm z-10",Um(t.status)),children:((h=t.status)==null?void 0:h.toLowerCase())||"unknown"}),t.count&&t.count>1&&F.jsxs("div",{className:"px-2 py-0.5 rounded text-xs font-medium shadow-sm z-10",style:{backgroundColor:"rgba(240, 253, 244, 0.9)",color:"#166534"},children:["batch: ",t.count]})]})]})})]},f)}function Gm({nodes:e,onFocusChange:t,selectedWorkflow:r,onReset:o,onClose:s}){const[c,u]=D.useState(288),f=D.useRef(null),h=D.useRef(null),p=D.useRef(!1),m=e.filter(g=>g.data.type==="workflow"||g.data.type==="childWorkflow"),v=g=>{t(r===g?null:g)};D.useEffect(()=>{const g=N=>{if(!p.current||!h.current)return;const P=N.clientX-h.current.getBoundingClientRect().left;P>200&&P<600&&u(P)},k=()=>{p.current&&(p.current=!1,document.body.style.cursor="default")};return window.addEventListener("mousemove",g),window.addEventListener("mouseup",k),()=>{window.removeEventListener("mousemove",g),window.removeEventListener("mouseup",k)}},[]);const w=g=>{g.preventDefault(),p.current=!0,document.body.style.cursor="col-resize"};return F.jsxs("div",{ref:h,className:"absolute left-0 top-0 bottom-0 bg-white shadow-lg border-r z-10",style:{width:`${c}px`},children:[F.jsxs("div",{className:"p-4 border-b flex items-center justify-between bg-gray-50",children:[F.jsx("h3",{className:"font-semibold text-gray-800",children:"Focus Workflow"}),F.jsx("button",{onClick:s,className:"p-1 hover:bg-gray-200 rounded-full transition-colors",children:F.jsx(Mo,{className:"w-5 h-5 text-gray-600"})})]}),F.jsxs("div",{className:"p-4 overflow-y-auto",children:[F.jsx("button",{onClick:o,className:"w-full mb-4 px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-md transition-colors",children:"Reset View"}),F.jsx("div",{className:"space-y-2",children:m.map(g=>F.jsx("button",{onClick:()=>v(g.id),className:vn("w-full px-3 py-2 text-left rounded-md transition-colors","text-sm",r===g.id?"bg-blue-50 text-blue-700 font-medium":"text-gray-700 hover:bg-gray-50"),children:g.data.title},g.id))})]}),F.jsx("div",{ref:f,onMouseDown:w,className:"w-1 cursor-col-resize hover:bg-gray-300 absolute top-0 right-0 bottom-0"})]})}const Qm=({showFocus:e,setShowFocus:t,autoZoomEnabled:r,setAutoZoomEnabled:o,setIsTemporalModalOpen:s,refreshWorkflowData:c,isRefreshing:u=!1,currentWorkflowId:f})=>{const h=()=>{if(console.log("Refreshing root workflow",f),!c){console.log("No refresh function provided");return}if(!f){console.log("No workflow ID provided");return}c(f)};return F.jsxs("div",{className:"flex gap-2 items-center",children:[F.jsx("button",{onClick:h,className:"p-2",title:"Refresh workflow data from Temporal",children:F.jsx(Wm,{className:"h-4 w-4"})}),F.jsx("button",{className:"px-3 py-1 rounded bg-green-500 text-white hover:bg-green-600",onClick:()=>s(!0),children:"Temporal"}),F.jsxs("button",{className:`px-3 py-1 rounded ${r?"bg-green-500 text-white":"bg-gray-200 text-gray-700"}`,onClick:()=>o(!r),children:["Auto Zoom ",r?"On":"Off"]}),F.jsxs("button",{className:`px-3 py-1 rounded ${e?"bg-green-500 text-white":"bg-gray-200 text-gray-700"}`,onClick:()=>t(!e),children:[e?"Hide":"Show"," Focus"]})]})};function Jm({data:e,onClose:t}){const r=D.useRef(null),[o,s]=D.useState(300),[c,u]=D.useState(!1),f=D.useRef(0),h=D.useRef(0);D.useEffect(()=>{const g=r.current;g&&(g.style.display="none",g.scrollTop=0,g.offsetHeight,g.style.display="")},[e]);const p=g=>{u(!0),f.current=g.clientY,h.current=o,document.body.style.userSelect="none",g.preventDefault()};if(D.useEffect(()=>{const g=N=>{if(!c)return;const P=f.current-N.clientY,S=Math.min(Math.max(h.current+P,300),window.innerHeight*.5);requestAnimationFrame(()=>{s(S)})},k=()=>{u(!1),document.body.style.userSelect=""};return c&&(window.addEventListener("mousemove",g),window.addEventListener("mouseup",k)),()=>{window.removeEventListener("mousemove",g),window.removeEventListener("mouseup",k)}},[c]),!e)return null;const m=(g,k)=>k?F.jsxs("div",{children:[F.jsx("h4",{className:"font-medium text-gray-700",children:g}),F.jsx("p",{className:"text-gray-600",children:k})]}):null,v=(g,k)=>{if(!g||!k)return null;const N=new Date(g),S=new Date(k).getTime()-N.getTime(),H=Math.floor(S/1e3),K=Math.floor(H/60),C=Math.floor(K/60),U=[];return C>0&&U.push(`${C}h`),K%60>0&&U.push(`${K%60}m`),H%60>0&&U.push(`${H%60}s`),S%1e3>0&&U.push(`${S%1e3}ms`),U.join(" ")},w=g=>{var k;return g?F.jsxs("div",{children:[F.jsx("h4",{className:"font-medium text-gray-700",children:"Retry Policy"}),F.jsxs("div",{className:"pl-4 space-y-2",children:[F.jsxs("p",{className:"text-gray-600",children:["Initial Interval: ",g.initialInterval]}),F.jsxs("p",{className:"text-gray-600",children:["Backoff Coefficient: ",g.backoffCoefficient]}),F.jsxs("p",{className:"text-gray-600",children:["Maximum Interval: ",g.maximumInterval]}),F.jsxs("p",{className:"text-gray-600",children:["Maximum Attempts: ",g.maximumAttempts]}),((k=g.nonRetryableErrorTypes)==null?void 0:k.length)>0&&F.jsxs("div",{children:[F.jsx("p",{className:"text-gray-600",children:"Non-retryable Error Types:"}),F.jsx("ul",{className:"list-disc pl-4",children:g.nonRetryableErrorTypes.map((N,P)=>F.jsx("li",{className:"text-gray-600",children:N},P))})]})]})]}):null};return F.jsxs("div",{ref:r,className:"fixed bottom-0 left-0 right-0 bg-white shadow-lg overflow-y-auto scroll-top",style:{height:`${o}px`,scrollBehavior:"instant",transition:c?"none":"height 0.1s ease-out"},children:[F.jsx("div",{className:`absolute -top-2 left-0 right-0 h-4 cursor-ns-resize ${c?"bg-blue-100":"hover:bg-gray-100"} z-50`,onMouseDown:p}),F.jsxs("div",{className:"border-t-2 border-black p-4 bg-gray-50 flex justify-between items-center sticky top-0 z-10",children:[F.jsx("h3",{className:"font-semibold text-gray-800",children:"Node Details"}),F.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-200 rounded-full transition-colors",children:F.jsx(Mo,{className:"w-5 h-5 text-gray-600"})})]}),F.jsx("div",{className:"p-4 overflow-y-auto",style:{height:"calc(100% - 57px)"},children:F.jsxs("div",{className:"space-y-4",children:[F.jsxs("div",{children:[F.jsx("h4",{className:"font-medium text-gray-700",children:"Title"}),F.jsx("p",{className:"text-gray-600",children:e.title})]}),F.jsxs("div",{children:[F.jsx("h4",{className:"font-medium text-gray-700",children:"Type"}),F.jsx("p",{className:"text-gray-600",children:e.type})]}),e.type==="activity"?F.jsxs("div",{children:[F.jsx("h4",{className:"font-medium text-gray-700",children:"Activity ID"}),F.jsx("p",{className:"text-gray-600",children:e.activityId}),e.activityType&&F.jsxs("div",{children:[F.jsx("h4",{className:"font-medium text-gray-700",children:"Activity Type"}),F.jsx("p",{className:"text-gray-600",children:e.activityType})]})]}):F.jsxs("div",{children:[F.jsx("h4",{className:"font-medium text-gray-700",children:"Workflow ID"}),F.jsx("p",{className:"text-gray-600",children:e.workflowId}),e.workflowType&&F.jsxs("div",{children:[F.jsx("h4",{className:"font-medium text-gray-700",children:"Workflow Type"}),F.jsx("p",{className:"text-gray-600",children:e.workflowType})]})]}),m("Schedule Time",e.scheduleTime),m("Start Time",e.startTime),m("End Time",e.endTime),e.startTime&&e.endTime&&m("Duration",v(e.startTime,e.endTime)),e.status&&F.jsxs("div",{children:[F.jsx("h4",{className:"font-medium text-gray-700",children:"Status"}),F.jsx("p",{className:"text-gray-600",children:e.status})]}),e.taskQueue&&F.jsxs("div",{children:[F.jsx("h4",{className:"font-medium text-gray-700",children:"Task Queue"}),F.jsxs("p",{className:"text-gray-600",children:["Name: ",e.taskQueue.name]}),F.jsxs("p",{className:"text-gray-600",children:["Kind: ",e.taskQueue.kind]})]}),e.input&&F.jsxs("div",{children:[F.jsx("h4",{className:"font-medium text-gray-700",children:"Input"}),F.jsx("pre",{className:"text-xs text-gray-600 whitespace-pre-wrap bg-gray-50 p-2 rounded",children:JSON.stringify(JSON.parse(e.input),null,2)})]}),e.result&&F.jsxs("div",{children:[F.jsx("h4",{className:"font-medium text-gray-700",children:"Result"}),F.jsx("pre",{className:"text-xs text-gray-600 whitespace-pre-wrap bg-gray-50 p-2 rounded",children:JSON.stringify(JSON.parse(e.result),null,2)})]}),e.header&&Object.keys(e.header).length>0&&F.jsxs("div",{children:[F.jsx("h4",{className:"font-medium text-gray-700",children:"Headers"}),F.jsx("pre",{className:"text-xs text-gray-600 whitespace-pre-wrap bg-gray-50 p-2 rounded",children:JSON.stringify(e.header,null,2)})]}),w(e.retryPolicy),e.heartbeatTimeout&&F.jsxs("div",{children:[F.jsx("h4",{className:"font-medium text-gray-700",children:"Timeouts"}),F.jsxs("div",{className:"pl-4 space-y-2",children:[F.jsxs("p",{className:"text-gray-600",children:["Heartbeat: ",e.heartbeatTimeout]}),e.scheduleToCloseTimeout&&F.jsxs("p",{className:"text-gray-600",children:["Schedule to Close: ",e.scheduleToCloseTimeout]}),e.scheduleToStartTimeout&&F.jsxs("p",{className:"text-gray-600",children:["Schedule to Start: ",e.scheduleToStartTimeout]}),e.startToCloseTimeout&&F.jsxs("p",{className:"text-gray-600",children:["Start to Close: ",e.startToCloseTimeout]})]})]}),e.type==="workflow"&&F.jsxs(F.Fragment,{children:[e.namespace&&F.jsxs("div",{children:[F.jsx("h4",{className:"font-medium text-gray-700",children:"Namespace"}),F.jsx("p",{className:"text-gray-600",children:e.namespace})]}),e.memo&&Object.keys(e.memo).length>0&&F.jsxs("div",{children:[F.jsx("h4",{className:"font-medium text-gray-700",children:"Memo"}),F.jsx("pre",{className:"text-xs text-gray-600 whitespace-pre-wrap bg-gray-50 p-2 rounded",children:JSON.stringify(e.memo,null,2)})]}),e.searchAttributes&&Object.keys(e.searchAttributes).length>0&&F.jsxs("div",{children:[F.jsx("h4",{className:"font-medium text-gray-700",children:"Search Attributes"}),F.jsx("pre",{className:"text-xs text-gray-600 whitespace-pre-wrap bg-gray-50 p-2 rounded",children:JSON.stringify(e.searchAttributes,null,2)})]})]}),e.workflowTaskCompletedEventId&&F.jsxs("div",{children:[F.jsx("h4",{className:"font-medium text-gray-700",children:"Workflow Task Completed Event ID"}),F.jsx("p",{className:"text-gray-600",children:e.workflowTaskCompletedEventId})]}),e.attempts!==void 0&&F.jsxs("div",{children:[F.jsx("h4",{className:"font-medium text-gray-700",children:"Attempts"}),F.jsx("p",{className:"text-gray-600",children:e.attempts})]}),e.payload&&e.payload.length>0&&F.jsxs("div",{children:[F.jsx("h4",{className:"font-medium text-gray-700",children:"Payloads"}),F.jsx("div",{className:"space-y-2 mt-1",children:e.payload.map((g,k)=>F.jsx("div",{className:"bg-gray-50 p-2 rounded",children:F.jsx("pre",{className:"text-xs text-gray-600 whitespace-pre-wrap",children:g?JSON.stringify(JSON.parse(g),null,2):"No payload data"})},k))})]})]})},`${e.id}-${Date.now()}`)]})}const oo=500,Ri=200,ya=8,ey=80;function Di(e){var f,h,p;const t=((f=e.data)==null?void 0:f.title)||"",r=e.id||"",o=r.length>40?r.slice(0,37)+"...":r,s=t.length*ya,c=o.length*(ya*.8),u=Math.max(s,c)+ey;return((h=e.data)==null?void 0:h.type)==="workflow"||((p=e.data)==null?void 0:p.type)==="childWorkflow",Math.max(Math.min(Math.max(u,oo*.75),oo),Ri)}function ty(e,t=800,r=100){const o=Di(e),s=(t-o)/2-r;return e.position={x:s,y:0},e.style={...e.style,width:o},e}function ga(e,t,r,o,s=200,c=40){var v,w;const u=[...e],f=[...t],h=u.find(g=>g.id===r);if(!h)return console.warn(`Parent node ${r} not found for layout.`),{nodes:u,edges:f};(v=h.style)!=null&&v.width||(h.style={...h.style,width:Di(h)});const p=h.position.x+(((w=h.style)==null?void 0:w.width)||Ri);let m=h.position.y;return o.forEach((g,k)=>{const N=Di(g);if(g.style={...g.style,width:N},g.position={x:p+s,y:m},u.push(g),k===0)f.push({id:`${r}->${g.id}`,source:r,sourceHandle:`${r}-right`,target:g.id,targetHandle:`${g.id}-left`});else{const P=o[k-1];f.push({id:`${P.id}->${g.id}`,source:P.id,sourceHandle:`${P.id}-bottom`,target:g.id,targetHandle:`${g.id}-top`,type:"step",animated:!0})}m+=(g.height||80)+c}),{nodes:u,edges:f}}function ny(e,t,r,o,s=100){const c=[...e],u=[...t],f=e.find(w=>w.id===r);if(!f)return{nodes:c,edges:u};const h=o.map((w,g)=>{var k;return{...w,position:{x:f.position.x,y:f.position.y+(g+1)*s},style:{...w.style,width:(k=f.style)==null?void 0:k.width}}}),p=t.find(w=>w.source===r),m=p==null?void 0:p.target,v=h.map((w,g)=>({id:g===0?`${r}->${w.id}`:`${h[g-1].id}->${w.id}`,source:g===0?r:h[g-1].id,target:w.id,sourceHandle:g===0?`${r}-bottom`:`${h[g-1].id}-bottom`,targetHandle:`${w.id}-top`,type:"step",animated:!0}));if(m){const w=h[h.length-1];v.push({id:`${w.id}->${m}`,source:w.id,target:m,sourceHandle:`${w.id}-bottom`,targetHandle:`${m}-top`,type:"step",animated:!0});const g=u.findIndex(k=>k.id===p.id);g!==-1&&u.splice(g,1)}return c.push(...h),u.push(...v),{nodes:c,edges:u}}const ry=async e=>{var r,o;const t={nodes:[],edges:[]};for(const s of e)if(s.type==="activity")t.nodes.push({id:`${s.activityId}-${s.workflowId}`,position:{x:0,y:0},type:"workflowNode",data:{...s,title:s.activityType,description:"",type:"activity",parentNodeId:s.workflowId,payload:(r=s.payload)==null?void 0:r.map(c=>c.data?atob(c.data):void 0)}});else if(s.type==="workflow"||s.type==="childWorkflow")t.nodes.push({id:s.workflowId,position:{x:0,y:0},type:"workflowNode",data:{...s,title:s.workflowType,description:"",type:s.type,parentNodeId:s.parentWorkflowId,payload:(o=s.payload)==null?void 0:o.map(c=>c.data?atob(c.data):void 0)}});else throw new Error("Invalid item type "+s.type);return oy(t),t};function oy(e){const t={};for(const o of e.nodes){const s=o.data,c=s.type;let u=iy(c,s);const f=s.title,h=`${u}::${f}`;t[h]||(t[h]={batchKey:u,title:f,nodes:[]}),t[h].nodes.push(o)}const r=[];for(const o in t){const s=t[o],{batchKey:c,title:u,nodes:f}=s,h=f.length;let p=null;for(const g of f){const k=g.data,N=k.startTime??k.scheduleTime;N&&(p===null||N<p)&&(p=N)}const m=f[0],v=m.data,w={...m,position:{...m.position},data:{count:h,batchKey:c,groupComponentIds:s.nodes.map(g=>({type:g.data.type,id:g.data.workflowId||g.data.activityId})),nonCompletedStatusExists:s.nodes.some(g=>g.data.status!=="COMPLETED"),...v}};w._earliestTime=p,r.push(w)}r.sort((o,s)=>{const c=o._earliestTime,u=s._earliestTime;return!c&&!u?0:c?u?c.localeCompare(u):-1:1});for(const o of r)delete o._earliestTime;e.nodes=r}function iy(e,t){if(e==="workflow"||e==="childWorkflow"){if(!t.workflowId)throw new Error("Workflow node missing workflowId");return t.workflowTaskCompletedEventId?parseInt(t.workflowTaskCompletedEventId,10).toString().padStart(10,"0"):`WF-${t.workflowId}`}else{if(!t.workflowTaskCompletedEventId)throw new Error("Activity node missing workflowTaskCompletedEventId");return parseInt(t.workflowTaskCompletedEventId,10).toString().padStart(10,"0")}}var Jc={exports:{}};(function(e,t){(function(r,o){e.exports=o()})(ks,function(){var r=function(n,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,l){a.__proto__=l}||function(a,l){for(var d in l)Object.prototype.hasOwnProperty.call(l,d)&&(a[d]=l[d])})(n,i)},o=function(){return(o=Object.assign||function(n){for(var i,a=1,l=arguments.length;a<l;a++)for(var d in i=arguments[a])Object.prototype.hasOwnProperty.call(i,d)&&(n[d]=i[d]);return n}).apply(this,arguments)};function s(n,i,a){for(var l,d=0,y=i.length;d<y;d++)!l&&d in i||((l=l||Array.prototype.slice.call(i,0,d))[d]=i[d]);return n.concat(l||Array.prototype.slice.call(i))}var c=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:ks,u=Object.keys,f=Array.isArray;function h(n,i){return typeof i!="object"||u(i).forEach(function(a){n[a]=i[a]}),n}typeof Promise>"u"||c.Promise||(c.Promise=Promise);var p=Object.getPrototypeOf,m={}.hasOwnProperty;function v(n,i){return m.call(n,i)}function w(n,i){typeof i=="function"&&(i=i(p(n))),(typeof Reflect>"u"?u:Reflect.ownKeys)(i).forEach(function(a){k(n,a,i[a])})}var g=Object.defineProperty;function k(n,i,a,l){g(n,i,h(a&&v(a,"get")&&typeof a.get=="function"?{get:a.get,set:a.set,configurable:!0}:{value:a,configurable:!0,writable:!0},l))}function N(n){return{from:function(i){return n.prototype=Object.create(i.prototype),k(n.prototype,"constructor",n),{extend:w.bind(null,n.prototype)}}}}var P=Object.getOwnPropertyDescriptor,S=[].slice;function H(n,i,a){return S.call(n,i,a)}function K(n,i){return i(n)}function C(n){if(!n)throw new Error("Assertion Failed")}function U(n){c.setImmediate?setImmediate(n):setTimeout(n,0)}function Q(n,i){if(typeof i=="string"&&v(n,i))return n[i];if(!i)return n;if(typeof i!="string"){for(var a=[],l=0,d=i.length;l<d;++l){var y=Q(n,i[l]);a.push(y)}return a}var x=i.indexOf(".");if(x!==-1){var _=n[i.substr(0,x)];return _==null?void 0:Q(_,i.substr(x+1))}}function X(n,i,a){if(n&&i!==void 0&&!("isFrozen"in Object&&Object.isFrozen(n)))if(typeof i!="string"&&"length"in i){C(typeof a!="string"&&"length"in a);for(var l=0,d=i.length;l<d;++l)X(n,i[l],a[l])}else{var y,x,_=i.indexOf(".");_!==-1?(y=i.substr(0,_),(x=i.substr(_+1))===""?a===void 0?f(n)&&!isNaN(parseInt(y))?n.splice(y,1):delete n[y]:n[y]=a:X(_=!(_=n[y])||!v(n,y)?n[y]={}:_,x,a)):a===void 0?f(n)&&!isNaN(parseInt(i))?n.splice(i,1):delete n[i]:n[i]=a}}function ee(n){var i,a={};for(i in n)v(n,i)&&(a[i]=n[i]);return a}var G=[].concat;function oe(n){return G.apply([],n)}var Wt="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(oe([8,16,32,64].map(function(n){return["Int","Uint","Float"].map(function(i){return i+n+"Array"})}))).filter(function(n){return c[n]}),ne=new Set(Wt.map(function(n){return c[n]})),le=null;function se(n){return le=new WeakMap,n=function i(a){if(!a||typeof a!="object")return a;var l=le.get(a);if(l)return l;if(f(a)){l=[],le.set(a,l);for(var d=0,y=a.length;d<y;++d)l.push(i(a[d]))}else if(ne.has(a.constructor))l=a;else{var x,_=p(a);for(x in l=_===Object.prototype?{}:Object.create(_),le.set(a,l),a)v(a,x)&&(l[x]=i(a[x]))}return l}(n),le=null,n}var b={}.toString;function L(n){return b.call(n).slice(8,-1)}var j=typeof Symbol<"u"?Symbol.iterator:"@@iterator",W=typeof j=="symbol"?function(n){var i;return n!=null&&(i=n[j])&&i.apply(n)}:function(){return null};function re(n,i){return i=n.indexOf(i),0<=i&&n.splice(i,1),0<=i}var z={};function J(n){var i,a,l,d;if(arguments.length===1){if(f(n))return n.slice();if(this===z&&typeof n=="string")return[n];if(d=W(n)){for(a=[];!(l=d.next()).done;)a.push(l.value);return a}if(n==null)return[n];if(typeof(i=n.length)!="number")return[n];for(a=new Array(i);i--;)a[i]=n[i];return a}for(i=arguments.length,a=new Array(i);i--;)a[i]=arguments[i];return a}var ie=typeof Symbol<"u"?function(n){return n[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},vt=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],xt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(vt),ae={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function ge(n,i){this.name=n,this.message=i}function ve(n,i){return n+". Errors: "+Object.keys(i).map(function(a){return i[a].toString()}).filter(function(a,l,d){return d.indexOf(a)===l}).join(`
`)}function be(n,i,a,l){this.failures=i,this.failedKeys=l,this.successCount=a,this.message=ve(n,i)}function ke(n,i){this.name="BulkError",this.failures=Object.keys(i).map(function(a){return i[a]}),this.failuresByPos=i,this.message=ve(n,this.failures)}N(ge).from(Error).extend({toString:function(){return this.name+": "+this.message}}),N(be).from(ge),N(ke).from(ge);var Ae=xt.reduce(function(n,i){return n[i]=i+"Error",n},{}),De=ge,de=xt.reduce(function(n,i){var a=i+"Error";function l(d,y){this.name=a,d?typeof d=="string"?(this.message="".concat(d).concat(y?`
 `+y:""),this.inner=y||null):typeof d=="object"&&(this.message="".concat(d.name," ").concat(d.message),this.inner=d):(this.message=ae[i]||a,this.inner=null)}return N(l).from(De),n[i]=l,n},{});de.Syntax=SyntaxError,de.Type=TypeError,de.Range=RangeError;var Pe=vt.reduce(function(n,i){return n[i+"Error"]=de[i],n},{}),Le=xt.reduce(function(n,i){return["Syntax","Type","Range"].indexOf(i)===-1&&(n[i+"Error"]=de[i]),n},{});function Se(){}function Ve(n){return n}function Ue(n,i){return n==null||n===Ve?i:function(a){return i(n(a))}}function je(n,i){return function(){n.apply(this,arguments),i.apply(this,arguments)}}function at(n,i){return n===Se?i:function(){var a=n.apply(this,arguments);a!==void 0&&(arguments[0]=a);var l=this.onsuccess,d=this.onerror;this.onsuccess=null,this.onerror=null;var y=i.apply(this,arguments);return l&&(this.onsuccess=this.onsuccess?je(l,this.onsuccess):l),d&&(this.onerror=this.onerror?je(d,this.onerror):d),y!==void 0?y:a}}function Oe(n,i){return n===Se?i:function(){n.apply(this,arguments);var a=this.onsuccess,l=this.onerror;this.onsuccess=this.onerror=null,i.apply(this,arguments),a&&(this.onsuccess=this.onsuccess?je(a,this.onsuccess):a),l&&(this.onerror=this.onerror?je(l,this.onerror):l)}}function Ee(n,i){return n===Se?i:function(a){var l=n.apply(this,arguments);h(a,l);var d=this.onsuccess,y=this.onerror;return this.onsuccess=null,this.onerror=null,a=i.apply(this,arguments),d&&(this.onsuccess=this.onsuccess?je(d,this.onsuccess):d),y&&(this.onerror=this.onerror?je(y,this.onerror):y),l===void 0?a===void 0?void 0:a:h(l,a)}}function Je(n,i){return n===Se?i:function(){return i.apply(this,arguments)!==!1&&n.apply(this,arguments)}}function dt(n,i){return n===Se?i:function(){var a=n.apply(this,arguments);if(a&&typeof a.then=="function"){for(var l=this,d=arguments.length,y=new Array(d);d--;)y[d]=arguments[d];return a.then(function(){return i.apply(l,y)})}return i.apply(this,arguments)}}Le.ModifyError=be,Le.DexieError=ge,Le.BulkError=ke;var tt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Lt(n){tt=n}var yt={},gt=100,Wt=typeof Promise>"u"?[]:function(){var n=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[n,p(n),n];var i=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[i,p(i),n]}(),vt=Wt[0],xt=Wt[1],Wt=Wt[2],xt=xt&&xt.then,ct=vt&&vt.constructor,Et=!!Wt,wt=function(n,i){ut.push([n,i]),$t&&(queueMicrotask($o),$t=!1)},It=!0,$t=!0,Fe=[],nt=[],St=Ve,rt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Se,pgp:!1,env:{},finalize:Se},xe=rt,ut=[],Ze=0,Pt=[];function me(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var i=this._PSD=xe;if(typeof n!="function"){if(n!==yt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Nn(this,this._value))}this._state=null,this._value=null,++i.ref,function a(l,d){try{d(function(y){if(l._state===null){if(y===l)throw new TypeError("A promise cannot be resolved with itself.");var x=l._lib&&Jt();y&&typeof y.then=="function"?a(l,function(_,A){y instanceof me?y._then(_,A):y.then(_,A)}):(l._state=!0,l._value=y,Rt(l)),x&&en()}},Nn.bind(null,l))}catch(y){Nn(l,y)}}(this,n)}var qt={get:function(){var n=xe,i=Mn;function a(l,d){var y=this,x=!n.global&&(n!==xe||i!==Mn),_=x&&!kt(),A=new me(function(M,R){Un(y,new kn(Tr(l,n,x,_),Tr(d,n,x,_),M,R,n))});return this._consoleTask&&(A._consoleTask=this._consoleTask),A}return a.prototype=yt,a},set:function(n){k(this,"then",n&&n.prototype===yt?qt:{get:function(){return n},set:qt.set})}};function kn(n,i,a,l,d){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof i=="function"?i:null,this.resolve=a,this.reject=l,this.psd=d}function Nn(n,i){var a,l;nt.push(i),n._state===null&&(a=n._lib&&Jt(),i=St(i),n._state=!1,n._value=i,l=n,Fe.some(function(d){return d._value===l._value})||Fe.push(l),Rt(n),a&&en())}function Rt(n){var i=n._listeners;n._listeners=[];for(var a=0,l=i.length;a<l;++a)Un(n,i[a]);var d=n._PSD;--d.ref||d.finalize(),Ze===0&&(++Ze,wt(function(){--Ze==0&&Zn()},[]))}function Un(n,i){if(n._state!==null){var a=n._state?i.onFulfilled:i.onRejected;if(a===null)return(n._state?i.resolve:i.reject)(n._value);++i.psd.ref,++Ze,wt(Io,[a,n,i])}else n._listeners.push(i)}function Io(n,i,a){try{var l,d=i._value;!i._state&&nt.length&&(nt=[]),l=tt&&i._consoleTask?i._consoleTask.run(function(){return n(d)}):n(d),i._state||nt.indexOf(d)!==-1||function(y){for(var x=Fe.length;x;)if(Fe[--x]._value===y._value)return Fe.splice(x,1)}(i),a.resolve(l)}catch(y){a.reject(y)}finally{--Ze==0&&Zn(),--a.psd.ref||a.psd.finalize()}}function $o(){Vt(rt,function(){Jt()&&en()})}function Jt(){var n=It;return $t=It=!1,n}function en(){var n,i,a;do for(;0<ut.length;)for(n=ut,ut=[],a=n.length,i=0;i<a;++i){var l=n[i];l[0].apply(null,l[1])}while(0<ut.length);$t=It=!0}function Zn(){var n=Fe;Fe=[],n.forEach(function(l){l._PSD.onunhandled.call(null,l._value,l)});for(var i=Pt.slice(0),a=i.length;a;)i[--a]()}function Cn(n){return new me(yt,!1,n)}function Be(n,i){var a=xe;return function(){var l=Jt(),d=xe;try{return Ot(a,!0),n.apply(this,arguments)}catch(y){i&&i(y)}finally{Ot(d,!1),l&&en()}}}w(me.prototype,{then:qt,_then:function(n,i){Un(this,new kn(null,null,n,i,xe))},catch:function(n){if(arguments.length===1)return this.then(null,n);var i=n,a=arguments[1];return typeof i=="function"?this.then(null,function(l){return(l instanceof i?a:Cn)(l)}):this.then(null,function(l){return(l&&l.name===i?a:Cn)(l)})},finally:function(n){return this.then(function(i){return me.resolve(n()).then(function(){return i})},function(i){return me.resolve(n()).then(function(){return Cn(i)})})},timeout:function(n,i){var a=this;return n<1/0?new me(function(l,d){var y=setTimeout(function(){return d(new de.Timeout(i))},n);a.then(l,d).finally(clearTimeout.bind(null,y))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&k(me.prototype,Symbol.toStringTag,"Dexie.Promise"),rt.env=Ar(),w(me,{all:function(){var n=J.apply(null,arguments).map(In);return new me(function(i,a){n.length===0&&i([]);var l=n.length;n.forEach(function(d,y){return me.resolve(d).then(function(x){n[y]=x,--l||i(n)},a)})})},resolve:function(n){return n instanceof me?n:n&&typeof n.then=="function"?new me(function(i,a){n.then(i,a)}):new me(yt,!0,n)},reject:Cn,race:function(){var n=J.apply(null,arguments).map(In);return new me(function(i,a){n.map(function(l){return me.resolve(l).then(i,a)})})},PSD:{get:function(){return xe},set:function(n){return xe=n}},totalEchoes:{get:function(){return Mn}},newPSD:Dt,usePSD:Vt,scheduler:{get:function(){return wt},set:function(n){wt=n}},rejectionMapper:{get:function(){return St},set:function(n){St=n}},follow:function(n,i){return new me(function(a,l){return Dt(function(d,y){var x=xe;x.unhandleds=[],x.onunhandled=y,x.finalize=je(function(){var _,A=this;_=function(){A.unhandleds.length===0?d():y(A.unhandleds[0])},Pt.push(function M(){_(),Pt.splice(Pt.indexOf(M),1)}),++Ze,wt(function(){--Ze==0&&Zn()},[])},x.finalize),n()},i,a,l)})}}),ct&&(ct.allSettled&&k(me,"allSettled",function(){var n=J.apply(null,arguments).map(In);return new me(function(i){n.length===0&&i([]);var a=n.length,l=new Array(a);n.forEach(function(d,y){return me.resolve(d).then(function(x){return l[y]={status:"fulfilled",value:x}},function(x){return l[y]={status:"rejected",reason:x}}).then(function(){return--a||i(l)})})})}),ct.any&&typeof AggregateError<"u"&&k(me,"any",function(){var n=J.apply(null,arguments).map(In);return new me(function(i,a){n.length===0&&a(new AggregateError([]));var l=n.length,d=new Array(l);n.forEach(function(y,x){return me.resolve(y).then(function(_){return i(_)},function(_){d[x]=_,--l||a(new AggregateError(d))})})})}),ct.withResolvers&&(me.withResolvers=ct.withResolvers));var Ye={awaits:0,echoes:0,id:0},Po=0,An=[],Tn=0,Mn=0,Ro=0;function Dt(n,i,a,l){var d=xe,y=Object.create(d);return y.parent=d,y.ref=0,y.global=!1,y.id=++Ro,rt.env,y.env=Et?{Promise:me,PromiseProp:{value:me,configurable:!0,writable:!0},all:me.all,race:me.race,allSettled:me.allSettled,any:me.any,resolve:me.resolve,reject:me.reject}:{},i&&h(y,i),++d.ref,y.finalize=function(){--this.parent.ref||this.parent.finalize()},l=Vt(y,n,a,l),y.ref===0&&y.finalize(),l}function tn(){return Ye.id||(Ye.id=++Po),++Ye.awaits,Ye.echoes+=gt,Ye.id}function kt(){return!!Ye.awaits&&(--Ye.awaits==0&&(Ye.id=0),Ye.echoes=Ye.awaits*gt,!0)}function In(n){return Ye.echoes&&n&&n.constructor===ct?(tn(),n.then(function(i){return kt(),i},function(i){return kt(),He(i)})):n}function Do(){var n=An[An.length-1];An.pop(),Ot(n,!1)}function Ot(n,i){var a,l=xe;(i?!Ye.echoes||Tn++&&n===xe:!Tn||--Tn&&n===xe)||queueMicrotask(i?(function(d){++Mn,Ye.echoes&&--Ye.echoes!=0||(Ye.echoes=Ye.awaits=Ye.id=0),An.push(xe),Ot(d,!0)}).bind(null,n):Do),n!==xe&&(xe=n,l===rt&&(rt.env=Ar()),Et&&(a=rt.env.Promise,i=n.env,(l.global||n.global)&&(Object.defineProperty(c,"Promise",i.PromiseProp),a.all=i.all,a.race=i.race,a.resolve=i.resolve,a.reject=i.reject,i.allSettled&&(a.allSettled=i.allSettled),i.any&&(a.any=i.any))))}function Ar(){var n=c.Promise;return Et?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(c,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject}:{}}function Vt(n,i,a,l,d){var y=xe;try{return Ot(n,!0),i(a,l,d)}finally{Ot(y,!1)}}function Tr(n,i,a,l){return typeof n!="function"?n:function(){var d=xe;a&&tn(),Ot(i,!0);try{return n.apply(this,arguments)}finally{Ot(d,!1),l&&queueMicrotask(kt)}}}function Gn(n){Promise===ct&&Ye.echoes===0?Tn===0?n():enqueueNativeMicroTask(n):setTimeout(n,0)}(""+xt).indexOf("[native code]")===-1&&(tn=kt=Se);var He=me.reject,jt="",Nt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Mr="String expected.",nn=[],$n="__dbnames",Qn="readonly",Jn="readwrite";function Bt(n,i){return n?i?function(){return n.apply(this,arguments)&&i.apply(this,arguments)}:n:i}var Ir={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Pn(n){return typeof n!="string"||/\./.test(n)?function(i){return i}:function(i){return i[n]===void 0&&n in i&&delete(i=se(i))[n],i}}function $r(){throw de.Type()}function Te(n,i){try{var a=ts(n),l=ts(i);if(a!==l)return a==="Array"?1:l==="Array"?-1:a==="binary"?1:l==="binary"?-1:a==="string"?1:l==="string"?-1:a==="Date"?1:l!=="Date"?NaN:-1;switch(a){case"number":case"Date":case"string":return i<n?1:n<i?-1:0;case"binary":return function(d,y){for(var x=d.length,_=y.length,A=x<_?x:_,M=0;M<A;++M)if(d[M]!==y[M])return d[M]<y[M]?-1:1;return x===_?0:x<_?-1:1}(ns(n),ns(i));case"Array":return function(d,y){for(var x=d.length,_=y.length,A=x<_?x:_,M=0;M<A;++M){var R=Te(d[M],y[M]);if(R!==0)return R}return x===_?0:x<_?-1:1}(n,i)}}catch{}return NaN}function ts(n){var i=typeof n;return i!="object"?i:ArrayBuffer.isView(n)?"binary":(n=L(n),n==="ArrayBuffer"?"binary":n)}function ns(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n)}var rs=(Ke.prototype._trans=function(n,i,a){var l=this._tx||xe.trans,d=this.name,y=tt&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(n==="readonly"?"read":"write"," ").concat(this.name));function x(M,R,E){if(!E.schema[d])throw new de.NotFound("Table "+d+" not part of transaction");return i(E.idbtrans,E)}var _=Jt();try{var A=l&&l.db._novip===this.db._novip?l===xe.trans?l._promise(n,x,a):Dt(function(){return l._promise(n,x,a)},{trans:l,transless:xe.transless||xe}):function M(R,E,B,T){if(R.idbdb&&(R._state.openComplete||xe.letThrough||R._vip)){var $=R._createTransaction(E,B,R._dbSchema);try{$.create(),R._state.PR1398_maxLoop=3}catch(O){return O.name===Ae.InvalidState&&R.isOpen()&&0<--R._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),R.close({disableAutoOpen:!1}),R.open().then(function(){return M(R,E,B,T)})):He(O)}return $._promise(E,function(O,I){return Dt(function(){return xe.trans=$,T(O,I,$)})}).then(function(O){if(E==="readwrite")try{$.idbtrans.commit()}catch{}return E==="readonly"?O:$._completion.then(function(){return O})})}if(R._state.openComplete)return He(new de.DatabaseClosed(R._state.dbOpenError));if(!R._state.isBeingOpened){if(!R._state.autoOpen)return He(new de.DatabaseClosed);R.open().catch(Se)}return R._state.dbReadyPromise.then(function(){return M(R,E,B,T)})}(this.db,n,[this.name],x);return y&&(A._consoleTask=y,A=A.catch(function(M){return console.trace(M),He(M)})),A}finally{_&&en()}},Ke.prototype.get=function(n,i){var a=this;return n&&n.constructor===Object?this.where(n).first(i):n==null?He(new de.Type("Invalid argument to Table.get()")):this._trans("readonly",function(l){return a.core.get({trans:l,key:n}).then(function(d){return a.hook.reading.fire(d)})}).then(i)},Ke.prototype.where=function(n){if(typeof n=="string")return new this.db.WhereClause(this,n);if(f(n))return new this.db.WhereClause(this,"[".concat(n.join("+"),"]"));var i=u(n);if(i.length===1)return this.where(i[0]).equals(n[i[0]]);var a=this.schema.indexes.concat(this.schema.primKey).filter(function(_){if(_.compound&&i.every(function(M){return 0<=_.keyPath.indexOf(M)})){for(var A=0;A<i.length;++A)if(i.indexOf(_.keyPath[A])===-1)return!1;return!0}return!1}).sort(function(_,A){return _.keyPath.length-A.keyPath.length})[0];if(a&&this.db._maxKey!==jt){var y=a.keyPath.slice(0,i.length);return this.where(y).equals(y.map(function(A){return n[A]}))}!a&&tt&&console.warn("The query ".concat(JSON.stringify(n)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(i.join("+"),"]"));var l=this.schema.idxByName;function d(_,A){return Te(_,A)===0}var x=i.reduce(function(E,A){var M=E[0],R=E[1],E=l[A],B=n[A];return[M||E,M||!E?Bt(R,E&&E.multi?function(T){return T=Q(T,A),f(T)&&T.some(function($){return d(B,$)})}:function(T){return d(B,Q(T,A))}):R]},[null,null]),y=x[0],x=x[1];return y?this.where(y.name).equals(n[y.keyPath]).filter(x):a?this.filter(x):this.where(i).equals("")},Ke.prototype.filter=function(n){return this.toCollection().and(n)},Ke.prototype.count=function(n){return this.toCollection().count(n)},Ke.prototype.offset=function(n){return this.toCollection().offset(n)},Ke.prototype.limit=function(n){return this.toCollection().limit(n)},Ke.prototype.each=function(n){return this.toCollection().each(n)},Ke.prototype.toArray=function(n){return this.toCollection().toArray(n)},Ke.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Ke.prototype.orderBy=function(n){return new this.db.Collection(new this.db.WhereClause(this,f(n)?"[".concat(n.join("+"),"]"):n))},Ke.prototype.reverse=function(){return this.toCollection().reverse()},Ke.prototype.mapToClass=function(n){var i,a=this.db,l=this.name;function d(){return i!==null&&i.apply(this,arguments)||this}(this.schema.mappedClass=n).prototype instanceof $r&&(function(A,M){if(typeof M!="function"&&M!==null)throw new TypeError("Class extends value "+String(M)+" is not a constructor or null");function R(){this.constructor=A}r(A,M),A.prototype=M===null?Object.create(M):(R.prototype=M.prototype,new R)}(d,i=n),Object.defineProperty(d.prototype,"db",{get:function(){return a},enumerable:!1,configurable:!0}),d.prototype.table=function(){return l},n=d);for(var y=new Set,x=n.prototype;x;x=p(x))Object.getOwnPropertyNames(x).forEach(function(A){return y.add(A)});function _(A){if(!A)return A;var M,R=Object.create(n.prototype);for(M in A)if(!y.has(M))try{R[M]=A[M]}catch{}return R}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=_,this.hook("reading",_),n},Ke.prototype.defineClass=function(){return this.mapToClass(function(n){h(this,n)})},Ke.prototype.add=function(n,i){var a=this,l=this.schema.primKey,d=l.auto,y=l.keyPath,x=n;return y&&d&&(x=Pn(y)(n)),this._trans("readwrite",function(_){return a.core.mutate({trans:_,type:"add",keys:i!=null?[i]:null,values:[x]})}).then(function(_){return _.numFailures?me.reject(_.failures[0]):_.lastResult}).then(function(_){if(y)try{X(n,y,_)}catch{}return _})},Ke.prototype.update=function(n,i){return typeof n!="object"||f(n)?this.where(":id").equals(n).modify(i):(n=Q(n,this.schema.primKey.keyPath),n===void 0?He(new de.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(i))},Ke.prototype.put=function(n,i){var a=this,l=this.schema.primKey,d=l.auto,y=l.keyPath,x=n;return y&&d&&(x=Pn(y)(n)),this._trans("readwrite",function(_){return a.core.mutate({trans:_,type:"put",values:[x],keys:i!=null?[i]:null})}).then(function(_){return _.numFailures?me.reject(_.failures[0]):_.lastResult}).then(function(_){if(y)try{X(n,y,_)}catch{}return _})},Ke.prototype.delete=function(n){var i=this;return this._trans("readwrite",function(a){return i.core.mutate({trans:a,type:"delete",keys:[n]})}).then(function(a){return a.numFailures?me.reject(a.failures[0]):void 0})},Ke.prototype.clear=function(){var n=this;return this._trans("readwrite",function(i){return n.core.mutate({trans:i,type:"deleteRange",range:Ir})}).then(function(i){return i.numFailures?me.reject(i.failures[0]):void 0})},Ke.prototype.bulkGet=function(n){var i=this;return this._trans("readonly",function(a){return i.core.getMany({keys:n,trans:a}).then(function(l){return l.map(function(d){return i.hook.reading.fire(d)})})})},Ke.prototype.bulkAdd=function(n,i,a){var l=this,d=Array.isArray(i)?i:void 0,y=(a=a||(d?void 0:i))?a.allKeys:void 0;return this._trans("readwrite",function(x){var M=l.schema.primKey,_=M.auto,M=M.keyPath;if(M&&d)throw new de.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(d&&d.length!==n.length)throw new de.InvalidArgument("Arguments objects and keys must have the same length");var A=n.length,M=M&&_?n.map(Pn(M)):n;return l.core.mutate({trans:x,type:"add",keys:d,values:M,wantResults:y}).then(function($){var E=$.numFailures,B=$.results,T=$.lastResult,$=$.failures;if(E===0)return y?B:T;throw new ke("".concat(l.name,".bulkAdd(): ").concat(E," of ").concat(A," operations failed"),$)})})},Ke.prototype.bulkPut=function(n,i,a){var l=this,d=Array.isArray(i)?i:void 0,y=(a=a||(d?void 0:i))?a.allKeys:void 0;return this._trans("readwrite",function(x){var M=l.schema.primKey,_=M.auto,M=M.keyPath;if(M&&d)throw new de.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(d&&d.length!==n.length)throw new de.InvalidArgument("Arguments objects and keys must have the same length");var A=n.length,M=M&&_?n.map(Pn(M)):n;return l.core.mutate({trans:x,type:"put",keys:d,values:M,wantResults:y}).then(function($){var E=$.numFailures,B=$.results,T=$.lastResult,$=$.failures;if(E===0)return y?B:T;throw new ke("".concat(l.name,".bulkPut(): ").concat(E," of ").concat(A," operations failed"),$)})})},Ke.prototype.bulkUpdate=function(n){var i=this,a=this.core,l=n.map(function(x){return x.key}),d=n.map(function(x){return x.changes}),y=[];return this._trans("readwrite",function(x){return a.getMany({trans:x,keys:l,cache:"clone"}).then(function(_){var A=[],M=[];n.forEach(function(E,B){var T=E.key,$=E.changes,O=_[B];if(O){for(var I=0,q=Object.keys($);I<q.length;I++){var V=q[I],Y=$[V];if(V===i.schema.primKey.keyPath){if(Te(Y,T)!==0)throw new de.Constraint("Cannot update primary key in bulkUpdate()")}else X(O,V,Y)}y.push(B),A.push(T),M.push(O)}});var R=A.length;return a.mutate({trans:x,type:"put",keys:A,values:M,updates:{keys:l,changeSpecs:d}}).then(function(E){var B=E.numFailures,T=E.failures;if(B===0)return R;for(var $=0,O=Object.keys(T);$<O.length;$++){var I,q=O[$],V=y[Number(q)];V!=null&&(I=T[q],delete T[q],T[V]=I)}throw new ke("".concat(i.name,".bulkUpdate(): ").concat(B," of ").concat(R," operations failed"),T)})})})},Ke.prototype.bulkDelete=function(n){var i=this,a=n.length;return this._trans("readwrite",function(l){return i.core.mutate({trans:l,type:"delete",keys:n})}).then(function(x){var d=x.numFailures,y=x.lastResult,x=x.failures;if(d===0)return y;throw new ke("".concat(i.name,".bulkDelete(): ").concat(d," of ").concat(a," operations failed"),x)})},Ke);function Ke(){}function er(n){function i(x,_){if(_){for(var A=arguments.length,M=new Array(A-1);--A;)M[A-1]=arguments[A];return a[x].subscribe.apply(null,M),n}if(typeof x=="string")return a[x]}var a={};i.addEventType=y;for(var l=1,d=arguments.length;l<d;++l)y(arguments[l]);return i;function y(x,_,A){if(typeof x!="object"){var M;_=_||Je;var R={subscribers:[],fire:A=A||Se,subscribe:function(E){R.subscribers.indexOf(E)===-1&&(R.subscribers.push(E),R.fire=_(R.fire,E))},unsubscribe:function(E){R.subscribers=R.subscribers.filter(function(B){return B!==E}),R.fire=R.subscribers.reduce(_,A)}};return a[x]=i[x]=R}u(M=x).forEach(function(E){var B=M[E];if(f(B))y(E,M[E][0],M[E][1]);else{if(B!=="asap")throw new de.InvalidArgument("Invalid event config");var T=y(E,Ve,function(){for(var $=arguments.length,O=new Array($);$--;)O[$]=arguments[$];T.subscribers.forEach(function(I){U(function(){I.apply(null,O)})})})}})}}function tr(n,i){return N(i).from({prototype:n}),i}function Rn(n,i){return!(n.filter||n.algorithm||n.or)&&(i?n.justLimit:!n.replayFilter)}function Oo(n,i){n.filter=Bt(n.filter,i)}function jo(n,i,a){var l=n.replayFilter;n.replayFilter=l?function(){return Bt(l(),i())}:i,n.justLimit=a&&!l}function Pr(n,i){if(n.isPrimKey)return i.primaryKey;var a=i.getIndexByKeyPath(n.index);if(!a)throw new de.Schema("KeyPath "+n.index+" on object store "+i.name+" is not indexed");return a}function os(n,i,a){var l=Pr(n,i.schema);return i.openCursor({trans:a,values:!n.keysOnly,reverse:n.dir==="prev",unique:!!n.unique,query:{index:l,range:n.range}})}function Rr(n,i,a,l){var d=n.replayFilter?Bt(n.filter,n.replayFilter()):n.filter;if(n.or){var y={},x=function(_,A,M){var R,E;d&&!d(A,M,function(B){return A.stop(B)},function(B){return A.fail(B)})||((E=""+(R=A.primaryKey))=="[object ArrayBuffer]"&&(E=""+new Uint8Array(R)),v(y,E)||(y[E]=!0,i(_,A,M)))};return Promise.all([n.or._iterate(x,a),is(os(n,l,a),n.algorithm,x,!n.keysOnly&&n.valueMapper)])}return is(os(n,l,a),Bt(n.algorithm,d),i,!n.keysOnly&&n.valueMapper)}function is(n,i,a,l){var d=Be(l?function(y,x,_){return a(l(y),x,_)}:a);return n.then(function(y){if(y)return y.start(function(){var x=function(){return y.continue()};i&&!i(y,function(_){return x=_},function(_){y.stop(_),x=Se},function(_){y.fail(_),x=Se})||d(y.value,y,function(_){return x=_}),x()})})}var Wt=Symbol(),nr=(ss.prototype.execute=function(n){if(this.add!==void 0){var i=this.add;if(f(i))return s(s([],f(n)?n:[],!0),i).sort();if(typeof i=="number")return(Number(n)||0)+i;if(typeof i=="bigint")try{return BigInt(n)+i}catch{return BigInt(0)+i}throw new TypeError("Invalid term ".concat(i))}if(this.remove!==void 0){var a=this.remove;if(f(a))return f(n)?n.filter(function(l){return!a.includes(l)}).sort():[];if(typeof a=="number")return Number(n)-a;if(typeof a=="bigint")try{return BigInt(n)-a}catch{return BigInt(0)-a}throw new TypeError("Invalid subtrahend ".concat(a))}return i=(i=this.replacePrefix)===null||i===void 0?void 0:i[0],i&&typeof n=="string"&&n.startsWith(i)?this.replacePrefix[1]+n.substring(i.length):n},ss);function ss(n){Object.assign(this,n)}var nu=(Re.prototype._read=function(n,i){var a=this._ctx;return a.error?a.table._trans(null,He.bind(null,a.error)):a.table._trans("readonly",n).then(i)},Re.prototype._write=function(n){var i=this._ctx;return i.error?i.table._trans(null,He.bind(null,i.error)):i.table._trans("readwrite",n,"locked")},Re.prototype._addAlgorithm=function(n){var i=this._ctx;i.algorithm=Bt(i.algorithm,n)},Re.prototype._iterate=function(n,i){return Rr(this._ctx,n,i,this._ctx.table.core)},Re.prototype.clone=function(n){var i=Object.create(this.constructor.prototype),a=Object.create(this._ctx);return n&&h(a,n),i._ctx=a,i},Re.prototype.raw=function(){return this._ctx.valueMapper=null,this},Re.prototype.each=function(n){var i=this._ctx;return this._read(function(a){return Rr(i,n,a,i.table.core)})},Re.prototype.count=function(n){var i=this;return this._read(function(a){var l=i._ctx,d=l.table.core;if(Rn(l,!0))return d.count({trans:a,query:{index:Pr(l,d.schema),range:l.range}}).then(function(x){return Math.min(x,l.limit)});var y=0;return Rr(l,function(){return++y,!1},a,d).then(function(){return y})}).then(n)},Re.prototype.sortBy=function(n,i){var a=n.split(".").reverse(),l=a[0],d=a.length-1;function y(A,M){return M?y(A[a[M]],M-1):A[l]}var x=this._ctx.dir==="next"?1:-1;function _(A,M){return Te(y(A,d),y(M,d))*x}return this.toArray(function(A){return A.sort(_)}).then(i)},Re.prototype.toArray=function(n){var i=this;return this._read(function(a){var l=i._ctx;if(l.dir==="next"&&Rn(l,!0)&&0<l.limit){var d=l.valueMapper,y=Pr(l,l.table.core.schema);return l.table.core.query({trans:a,limit:l.limit,values:!0,query:{index:y,range:l.range}}).then(function(_){return _=_.result,d?_.map(d):_})}var x=[];return Rr(l,function(_){return x.push(_)},a,l.table.core).then(function(){return x})},n)},Re.prototype.offset=function(n){var i=this._ctx;return n<=0||(i.offset+=n,Rn(i)?jo(i,function(){var a=n;return function(l,d){return a===0||(a===1?--a:d(function(){l.advance(a),a=0}),!1)}}):jo(i,function(){var a=n;return function(){return--a<0}})),this},Re.prototype.limit=function(n){return this._ctx.limit=Math.min(this._ctx.limit,n),jo(this._ctx,function(){var i=n;return function(a,l,d){return--i<=0&&l(d),0<=i}},!0),this},Re.prototype.until=function(n,i){return Oo(this._ctx,function(a,l,d){return!n(a.value)||(l(d),i)}),this},Re.prototype.first=function(n){return this.limit(1).toArray(function(i){return i[0]}).then(n)},Re.prototype.last=function(n){return this.reverse().first(n)},Re.prototype.filter=function(n){var i;return Oo(this._ctx,function(a){return n(a.value)}),(i=this._ctx).isMatch=Bt(i.isMatch,n),this},Re.prototype.and=function(n){return this.filter(n)},Re.prototype.or=function(n){return new this.db.WhereClause(this._ctx.table,n,this)},Re.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Re.prototype.desc=function(){return this.reverse()},Re.prototype.eachKey=function(n){var i=this._ctx;return i.keysOnly=!i.isMatch,this.each(function(a,l){n(l.key,l)})},Re.prototype.eachUniqueKey=function(n){return this._ctx.unique="unique",this.eachKey(n)},Re.prototype.eachPrimaryKey=function(n){var i=this._ctx;return i.keysOnly=!i.isMatch,this.each(function(a,l){n(l.primaryKey,l)})},Re.prototype.keys=function(n){var i=this._ctx;i.keysOnly=!i.isMatch;var a=[];return this.each(function(l,d){a.push(d.key)}).then(function(){return a}).then(n)},Re.prototype.primaryKeys=function(n){var i=this._ctx;if(i.dir==="next"&&Rn(i,!0)&&0<i.limit)return this._read(function(l){var d=Pr(i,i.table.core.schema);return i.table.core.query({trans:l,values:!1,limit:i.limit,query:{index:d,range:i.range}})}).then(function(l){return l.result}).then(n);i.keysOnly=!i.isMatch;var a=[];return this.each(function(l,d){a.push(d.primaryKey)}).then(function(){return a}).then(n)},Re.prototype.uniqueKeys=function(n){return this._ctx.unique="unique",this.keys(n)},Re.prototype.firstKey=function(n){return this.limit(1).keys(function(i){return i[0]}).then(n)},Re.prototype.lastKey=function(n){return this.reverse().firstKey(n)},Re.prototype.distinct=function(){var n=this._ctx,n=n.index&&n.table.schema.idxByName[n.index];if(!n||!n.multi)return this;var i={};return Oo(this._ctx,function(d){var l=d.primaryKey.toString(),d=v(i,l);return i[l]=!0,!d}),this},Re.prototype.modify=function(n){var i=this,a=this._ctx;return this._write(function(l){var d,y,x;x=typeof n=="function"?n:(d=u(n),y=d.length,function(I){for(var q=!1,V=0;V<y;++V){var Y=d[V],te=n[Y],ce=Q(I,Y);te instanceof nr?(X(I,Y,te.execute(ce)),q=!0):ce!==te&&(X(I,Y,te),q=!0)}return q});var _=a.table.core,E=_.schema.primaryKey,A=E.outbound,M=E.extractKey,R=200,E=i.db._options.modifyChunkSize;E&&(R=typeof E=="object"?E[_.name]||E["*"]||200:E);function B(I,Y){var V=Y.failures,Y=Y.numFailures;$+=I-Y;for(var te=0,ce=u(V);te<ce.length;te++){var pe=ce[te];T.push(V[pe])}}var T=[],$=0,O=[];return i.clone().primaryKeys().then(function(I){function q(Y){var te=Math.min(R,I.length-Y);return _.getMany({trans:l,keys:I.slice(Y,Y+te),cache:"immutable"}).then(function(ce){for(var pe=[],ue=[],fe=A?[]:null,ye=[],he=0;he<te;++he){var we=ce[he],Ce={value:se(we),primKey:I[Y+he]};x.call(Ce,Ce.value,Ce)!==!1&&(Ce.value==null?ye.push(I[Y+he]):A||Te(M(we),M(Ce.value))===0?(ue.push(Ce.value),A&&fe.push(I[Y+he])):(ye.push(I[Y+he]),pe.push(Ce.value)))}return Promise.resolve(0<pe.length&&_.mutate({trans:l,type:"add",values:pe}).then(function(Me){for(var Ie in Me.failures)ye.splice(parseInt(Ie),1);B(pe.length,Me)})).then(function(){return(0<ue.length||V&&typeof n=="object")&&_.mutate({trans:l,type:"put",keys:fe,values:ue,criteria:V,changeSpec:typeof n!="function"&&n,isAdditionalChunk:0<Y}).then(function(Me){return B(ue.length,Me)})}).then(function(){return(0<ye.length||V&&n===Bo)&&_.mutate({trans:l,type:"delete",keys:ye,criteria:V,isAdditionalChunk:0<Y}).then(function(Me){return B(ye.length,Me)})}).then(function(){return I.length>Y+te&&q(Y+R)})})}var V=Rn(a)&&a.limit===1/0&&(typeof n!="function"||n===Bo)&&{index:a.index,range:a.range};return q(0).then(function(){if(0<T.length)throw new be("Error modifying one or more objects",T,$,O);return I.length})})})},Re.prototype.delete=function(){var n=this._ctx,i=n.range;return Rn(n)&&(n.isPrimKey||i.type===3)?this._write(function(a){var l=n.table.core.schema.primaryKey,d=i;return n.table.core.count({trans:a,query:{index:l,range:d}}).then(function(y){return n.table.core.mutate({trans:a,type:"deleteRange",range:d}).then(function(x){var _=x.failures;if(x.lastResult,x.results,x=x.numFailures,x)throw new be("Could not delete some values",Object.keys(_).map(function(A){return _[A]}),y-x);return y-x})})}):this.modify(Bo)},Re);function Re(){}var Bo=function(n,i){return i.value=null};function ru(n,i){return n<i?-1:n===i?0:1}function ou(n,i){return i<n?-1:n===i?0:1}function ht(n,i,a){return n=n instanceof cs?new n.Collection(n):n,n._ctx.error=new(a||TypeError)(i),n}function Dn(n){return new n.Collection(n,function(){return as("")}).limit(0)}function Dr(n,i,a,l){var d,y,x,_,A,M,R,E=a.length;if(!a.every(function($){return typeof $=="string"}))return ht(n,Mr);function B($){d=$==="next"?function(I){return I.toUpperCase()}:function(I){return I.toLowerCase()},y=$==="next"?function(I){return I.toLowerCase()}:function(I){return I.toUpperCase()},x=$==="next"?ru:ou;var O=a.map(function(I){return{lower:y(I),upper:d(I)}}).sort(function(I,q){return x(I.lower,q.lower)});_=O.map(function(I){return I.upper}),A=O.map(function(I){return I.lower}),R=(M=$)==="next"?"":l}B("next"),n=new n.Collection(n,function(){return rn(_[0],A[E-1]+l)}),n._ondirectionchange=function($){B($)};var T=0;return n._addAlgorithm(function($,O,I){var q=$.key;if(typeof q!="string")return!1;var V=y(q);if(i(V,A,T))return!0;for(var Y=null,te=T;te<E;++te){var ce=function(pe,ue,fe,ye,he,we){for(var Ce=Math.min(pe.length,ye.length),Me=-1,Ie=0;Ie<Ce;++Ie){var pt=ue[Ie];if(pt!==ye[Ie])return he(pe[Ie],fe[Ie])<0?pe.substr(0,Ie)+fe[Ie]+fe.substr(Ie+1):he(pe[Ie],ye[Ie])<0?pe.substr(0,Ie)+ye[Ie]+fe.substr(Ie+1):0<=Me?pe.substr(0,Me)+ue[Me]+fe.substr(Me+1):null;he(pe[Ie],pt)<0&&(Me=Ie)}return Ce<ye.length&&we==="next"?pe+fe.substr(pe.length):Ce<pe.length&&we==="prev"?pe.substr(0,fe.length):Me<0?null:pe.substr(0,Me)+ye[Me]+fe.substr(Me+1)}(q,V,_[te],A[te],x,M);ce===null&&Y===null?T=te+1:(Y===null||0<x(Y,ce))&&(Y=ce)}return O(Y!==null?function(){$.continue(Y+R)}:I),!1}),n}function rn(n,i,a,l){return{type:2,lower:n,upper:i,lowerOpen:a,upperOpen:l}}function as(n){return{type:1,lower:n,upper:n}}var cs=(Object.defineProperty(Ge.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Ge.prototype.between=function(n,i,a,l){a=a!==!1,l=l===!0;try{return 0<this._cmp(n,i)||this._cmp(n,i)===0&&(a||l)&&(!a||!l)?Dn(this):new this.Collection(this,function(){return rn(n,i,!a,!l)})}catch{return ht(this,Nt)}},Ge.prototype.equals=function(n){return n==null?ht(this,Nt):new this.Collection(this,function(){return as(n)})},Ge.prototype.above=function(n){return n==null?ht(this,Nt):new this.Collection(this,function(){return rn(n,void 0,!0)})},Ge.prototype.aboveOrEqual=function(n){return n==null?ht(this,Nt):new this.Collection(this,function(){return rn(n,void 0,!1)})},Ge.prototype.below=function(n){return n==null?ht(this,Nt):new this.Collection(this,function(){return rn(void 0,n,!1,!0)})},Ge.prototype.belowOrEqual=function(n){return n==null?ht(this,Nt):new this.Collection(this,function(){return rn(void 0,n)})},Ge.prototype.startsWith=function(n){return typeof n!="string"?ht(this,Mr):this.between(n,n+jt,!0,!0)},Ge.prototype.startsWithIgnoreCase=function(n){return n===""?this.startsWith(n):Dr(this,function(i,a){return i.indexOf(a[0])===0},[n],jt)},Ge.prototype.equalsIgnoreCase=function(n){return Dr(this,function(i,a){return i===a[0]},[n],"")},Ge.prototype.anyOfIgnoreCase=function(){var n=J.apply(z,arguments);return n.length===0?Dn(this):Dr(this,function(i,a){return a.indexOf(i)!==-1},n,"")},Ge.prototype.startsWithAnyOfIgnoreCase=function(){var n=J.apply(z,arguments);return n.length===0?Dn(this):Dr(this,function(i,a){return a.some(function(l){return i.indexOf(l)===0})},n,jt)},Ge.prototype.anyOf=function(){var n=this,i=J.apply(z,arguments),a=this._cmp;try{i.sort(a)}catch{return ht(this,Nt)}if(i.length===0)return Dn(this);var l=new this.Collection(this,function(){return rn(i[0],i[i.length-1])});l._ondirectionchange=function(y){a=y==="next"?n._ascending:n._descending,i.sort(a)};var d=0;return l._addAlgorithm(function(y,x,_){for(var A=y.key;0<a(A,i[d]);)if(++d===i.length)return x(_),!1;return a(A,i[d])===0||(x(function(){y.continue(i[d])}),!1)}),l},Ge.prototype.notEqual=function(n){return this.inAnyRange([[-1/0,n],[n,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Ge.prototype.noneOf=function(){var n=J.apply(z,arguments);if(n.length===0)return new this.Collection(this);try{n.sort(this._ascending)}catch{return ht(this,Nt)}var i=n.reduce(function(a,l){return a?a.concat([[a[a.length-1][1],l]]):[[-1/0,l]]},null);return i.push([n[n.length-1],this.db._maxKey]),this.inAnyRange(i,{includeLowers:!1,includeUppers:!1})},Ge.prototype.inAnyRange=function(q,i){var a=this,l=this._cmp,d=this._ascending,y=this._descending,x=this._min,_=this._max;if(q.length===0)return Dn(this);if(!q.every(function(V){return V[0]!==void 0&&V[1]!==void 0&&d(V[0],V[1])<=0}))return ht(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",de.InvalidArgument);var A=!i||i.includeLowers!==!1,M=i&&i.includeUppers===!0,R,E=d;function B(V,Y){return E(V[0],Y[0])}try{(R=q.reduce(function(V,Y){for(var te=0,ce=V.length;te<ce;++te){var pe=V[te];if(l(Y[0],pe[1])<0&&0<l(Y[1],pe[0])){pe[0]=x(pe[0],Y[0]),pe[1]=_(pe[1],Y[1]);break}}return te===ce&&V.push(Y),V},[])).sort(B)}catch{return ht(this,Nt)}var T=0,$=M?function(V){return 0<d(V,R[T][1])}:function(V){return 0<=d(V,R[T][1])},O=A?function(V){return 0<y(V,R[T][0])}:function(V){return 0<=y(V,R[T][0])},I=$,q=new this.Collection(this,function(){return rn(R[0][0],R[R.length-1][1],!A,!M)});return q._ondirectionchange=function(V){E=V==="next"?(I=$,d):(I=O,y),R.sort(B)},q._addAlgorithm(function(V,Y,te){for(var ce,pe=V.key;I(pe);)if(++T===R.length)return Y(te),!1;return!$(ce=pe)&&!O(ce)||(a._cmp(pe,R[T][1])===0||a._cmp(pe,R[T][0])===0||Y(function(){E===d?V.continue(R[T][0]):V.continue(R[T][1])}),!1)}),q},Ge.prototype.startsWithAnyOf=function(){var n=J.apply(z,arguments);return n.every(function(i){return typeof i=="string"})?n.length===0?Dn(this):this.inAnyRange(n.map(function(i){return[i,i+jt]})):ht(this,"startsWithAnyOf() only works with strings")},Ge);function Ge(){}function zt(n){return Be(function(i){return rr(i),n(i.target.error),!1})}function rr(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}var or="storagemutated",zo="x-storagemutated-1",on=er(null,or),iu=(Kt.prototype._lock=function(){return C(!xe.global),++this._reculock,this._reculock!==1||xe.global||(xe.lockOwnerFor=this),this},Kt.prototype._unlock=function(){if(C(!xe.global),--this._reculock==0)for(xe.global||(xe.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var n=this._blockedFuncs.shift();try{Vt(n[1],n[0])}catch{}}return this},Kt.prototype._locked=function(){return this._reculock&&xe.lockOwnerFor!==this},Kt.prototype.create=function(n){var i=this;if(!this.mode)return this;var a=this.db.idbdb,l=this.db._state.dbOpenError;if(C(!this.idbtrans),!n&&!a)switch(l&&l.name){case"DatabaseClosedError":throw new de.DatabaseClosed(l);case"MissingAPIError":throw new de.MissingAPI(l.message,l);default:throw new de.OpenFailed(l)}if(!this.active)throw new de.TransactionInactive;return C(this._completion._state===null),(n=this.idbtrans=n||(this.db.core||a).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Be(function(d){rr(d),i._reject(n.error)}),n.onabort=Be(function(d){rr(d),i.active&&i._reject(new de.Abort(n.error)),i.active=!1,i.on("abort").fire(d)}),n.oncomplete=Be(function(){i.active=!1,i._resolve(),"mutatedParts"in n&&on.storagemutated.fire(n.mutatedParts)}),this},Kt.prototype._promise=function(n,i,a){var l=this;if(n==="readwrite"&&this.mode!=="readwrite")return He(new de.ReadOnly("Transaction is readonly"));if(!this.active)return He(new de.TransactionInactive);if(this._locked())return new me(function(y,x){l._blockedFuncs.push([function(){l._promise(n,i,a).then(y,x)},xe])});if(a)return Dt(function(){var y=new me(function(x,_){l._lock();var A=i(x,_,l);A&&A.then&&A.then(x,_)});return y.finally(function(){return l._unlock()}),y._lib=!0,y});var d=new me(function(y,x){var _=i(y,x,l);_&&_.then&&_.then(y,x)});return d._lib=!0,d},Kt.prototype._root=function(){return this.parent?this.parent._root():this},Kt.prototype.waitFor=function(n){var i,a=this._root(),l=me.resolve(n);a._waitingFor?a._waitingFor=a._waitingFor.then(function(){return l}):(a._waitingFor=l,a._waitingQueue=[],i=a.idbtrans.objectStore(a.storeNames[0]),function y(){for(++a._spinCount;a._waitingQueue.length;)a._waitingQueue.shift()();a._waitingFor&&(i.get(-1/0).onsuccess=y)}());var d=a._waitingFor;return new me(function(y,x){l.then(function(_){return a._waitingQueue.push(Be(y.bind(null,_)))},function(_){return a._waitingQueue.push(Be(x.bind(null,_)))}).finally(function(){a._waitingFor===d&&(a._waitingFor=null)})})},Kt.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new de.Abort))},Kt.prototype.table=function(n){var i=this._memoizedTables||(this._memoizedTables={});if(v(i,n))return i[n];var a=this.schema[n];if(!a)throw new de.NotFound("Table "+n+" not part of transaction");return a=new this.db.Table(n,a,this),a.core=this.db.core.table(n),i[n]=a},Kt);function Kt(){}function Ko(n,i,a,l,d,y,x){return{name:n,keyPath:i,unique:a,multi:l,auto:d,compound:y,src:(a&&!x?"&":"")+(l?"*":"")+(d?"++":"")+us(i)}}function us(n){return typeof n=="string"?n:n?"["+[].join.call(n,"+")+"]":""}function Fo(n,i,a){return{name:n,primKey:i,indexes:a,mappedClass:null,idxByName:(l=function(d){return[d.name,d]},a.reduce(function(d,y,x){return x=l(y,x),x&&(d[x[0]]=x[1]),d},{}))};var l}var ir=function(n){try{return n.only([[]]),ir=function(){return[[]]},[[]]}catch{return ir=function(){return jt},jt}};function Ho(n){return n==null?function(){}:typeof n=="string"?(i=n).split(".").length===1?function(a){return a[i]}:function(a){return Q(a,i)}:function(a){return Q(a,n)};var i}function ls(n){return[].slice.call(n)}var su=0;function sr(n){return n==null?":id":typeof n=="string"?n:"[".concat(n.join("+"),"]")}function au(n,i,A){function l(I){if(I.type===3)return null;if(I.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var T=I.lower,$=I.upper,O=I.lowerOpen,I=I.upperOpen;return T===void 0?$===void 0?null:i.upperBound($,!!I):$===void 0?i.lowerBound(T,!!O):i.bound(T,$,!!O,!!I)}function d(B){var T,$=B.name;return{name:$,schema:B,mutate:function(O){var I=O.trans,q=O.type,V=O.keys,Y=O.values,te=O.range;return new Promise(function(ce,pe){ce=Be(ce);var ue=I.objectStore($),fe=ue.keyPath==null,ye=q==="put"||q==="add";if(!ye&&q!=="delete"&&q!=="deleteRange")throw new Error("Invalid operation type: "+q);var he,we=(V||Y||{length:1}).length;if(V&&Y&&V.length!==Y.length)throw new Error("Given keys array must have same length as given values array.");if(we===0)return ce({numFailures:0,failures:{},results:[],lastResult:void 0});function Ce(lt){++pt,rr(lt)}var Me=[],Ie=[],pt=0;if(q==="deleteRange"){if(te.type===4)return ce({numFailures:pt,failures:Ie,results:[],lastResult:void 0});te.type===3?Me.push(he=ue.clear()):Me.push(he=ue.delete(l(te)))}else{var fe=ye?fe?[Y,V]:[Y,null]:[V,null],Ne=fe[0],it=fe[1];if(ye)for(var st=0;st<we;++st)Me.push(he=it&&it[st]!==void 0?ue[q](Ne[st],it[st]):ue[q](Ne[st])),he.onerror=Ce;else for(st=0;st<we;++st)Me.push(he=ue[q](Ne[st])),he.onerror=Ce}function Xr(lt){lt=lt.target.result,Me.forEach(function(yn,si){return yn.error!=null&&(Ie[si]=yn.error)}),ce({numFailures:pt,failures:Ie,results:q==="delete"?V:Me.map(function(yn){return yn.result}),lastResult:lt})}he.onerror=function(lt){Ce(lt),Xr(lt)},he.onsuccess=Xr})},getMany:function(O){var I=O.trans,q=O.keys;return new Promise(function(V,Y){V=Be(V);for(var te,ce=I.objectStore($),pe=q.length,ue=new Array(pe),fe=0,ye=0,he=function(Me){Me=Me.target,ue[Me._pos]=Me.result,++ye===fe&&V(ue)},we=zt(Y),Ce=0;Ce<pe;++Ce)q[Ce]!=null&&((te=ce.get(q[Ce]))._pos=Ce,te.onsuccess=he,te.onerror=we,++fe);fe===0&&V(ue)})},get:function(O){var I=O.trans,q=O.key;return new Promise(function(V,Y){V=Be(V);var te=I.objectStore($).get(q);te.onsuccess=function(ce){return V(ce.target.result)},te.onerror=zt(Y)})},query:(T=M,function(O){return new Promise(function(I,q){I=Be(I);var V,Y,te,fe=O.trans,ce=O.values,pe=O.limit,he=O.query,ue=pe===1/0?void 0:pe,ye=he.index,he=he.range,fe=fe.objectStore($),ye=ye.isPrimaryKey?fe:fe.index(ye.name),he=l(he);if(pe===0)return I({result:[]});T?((ue=ce?ye.getAll(he,ue):ye.getAllKeys(he,ue)).onsuccess=function(we){return I({result:we.target.result})},ue.onerror=zt(q)):(V=0,Y=!ce&&"openKeyCursor"in ye?ye.openKeyCursor(he):ye.openCursor(he),te=[],Y.onsuccess=function(we){var Ce=Y.result;return Ce?(te.push(ce?Ce.value:Ce.primaryKey),++V===pe?I({result:te}):void Ce.continue()):I({result:te})},Y.onerror=zt(q))})}),openCursor:function(O){var I=O.trans,q=O.values,V=O.query,Y=O.reverse,te=O.unique;return new Promise(function(ce,pe){ce=Be(ce);var ye=V.index,ue=V.range,fe=I.objectStore($),fe=ye.isPrimaryKey?fe:fe.index(ye.name),ye=Y?te?"prevunique":"prev":te?"nextunique":"next",he=!q&&"openKeyCursor"in fe?fe.openKeyCursor(l(ue),ye):fe.openCursor(l(ue),ye);he.onerror=zt(pe),he.onsuccess=Be(function(we){var Ce,Me,Ie,pt,Ne=he.result;Ne?(Ne.___id=++su,Ne.done=!1,Ce=Ne.continue.bind(Ne),Me=(Me=Ne.continuePrimaryKey)&&Me.bind(Ne),Ie=Ne.advance.bind(Ne),pt=function(){throw new Error("Cursor not stopped")},Ne.trans=I,Ne.stop=Ne.continue=Ne.continuePrimaryKey=Ne.advance=function(){throw new Error("Cursor not started")},Ne.fail=Be(pe),Ne.next=function(){var it=this,st=1;return this.start(function(){return st--?it.continue():it.stop()}).then(function(){return it})},Ne.start=function(it){function st(){if(he.result)try{it()}catch(lt){Ne.fail(lt)}else Ne.done=!0,Ne.start=function(){throw new Error("Cursor behind last entry")},Ne.stop()}var Xr=new Promise(function(lt,yn){lt=Be(lt),he.onerror=zt(yn),Ne.fail=yn,Ne.stop=function(si){Ne.stop=Ne.continue=Ne.continuePrimaryKey=Ne.advance=pt,lt(si)}});return he.onsuccess=Be(function(lt){he.onsuccess=st,st()}),Ne.continue=Ce,Ne.continuePrimaryKey=Me,Ne.advance=Ie,st(),Xr},ce(Ne)):ce(null)},pe)})},count:function(O){var I=O.query,q=O.trans,V=I.index,Y=I.range;return new Promise(function(te,ce){var pe=q.objectStore($),ue=V.isPrimaryKey?pe:pe.index(V.name),pe=l(Y),ue=pe?ue.count(pe):ue.count();ue.onsuccess=Be(function(fe){return te(fe.target.result)}),ue.onerror=zt(ce)})}}}var y,x,_,R=(x=A,_=ls((y=n).objectStoreNames),{schema:{name:y.name,tables:_.map(function(B){return x.objectStore(B)}).map(function(B){var T=B.keyPath,I=B.autoIncrement,$=f(T),O={},I={name:B.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:T==null,compound:$,keyPath:T,autoIncrement:I,unique:!0,extractKey:Ho(T)},indexes:ls(B.indexNames).map(function(q){return B.index(q)}).map(function(te){var V=te.name,Y=te.unique,ce=te.multiEntry,te=te.keyPath,ce={name:V,compound:f(te),keyPath:te,unique:Y,multiEntry:ce,extractKey:Ho(te)};return O[sr(te)]=ce}),getIndexByKeyPath:function(q){return O[sr(q)]}};return O[":id"]=I.primaryKey,T!=null&&(O[sr(T)]=I.primaryKey),I})},hasGetAll:0<_.length&&"getAll"in x.objectStore(_[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),A=R.schema,M=R.hasGetAll,R=A.tables.map(d),E={};return R.forEach(function(B){return E[B.name]=B}),{stack:"dbcore",transaction:n.transaction.bind(n),table:function(B){if(!E[B])throw new Error("Table '".concat(B,"' not found"));return E[B]},MIN_KEY:-1/0,MAX_KEY:ir(i),schema:A}}function cu(n,i,a,l){var d=a.IDBKeyRange;return a.indexedDB,{dbcore:(l=au(i,d,l),n.dbcore.reduce(function(y,x){return x=x.create,o(o({},y),x(y))},l))}}function Or(n,l){var a=l.db,l=cu(n._middlewares,a,n._deps,l);n.core=l.dbcore,n.tables.forEach(function(d){var y=d.name;n.core.schema.tables.some(function(x){return x.name===y})&&(d.core=n.core.table(y),n[y]instanceof n.Table&&(n[y].core=d.core))})}function jr(n,i,a,l){a.forEach(function(d){var y=l[d];i.forEach(function(x){var _=function A(M,R){return P(M,R)||(M=p(M))&&A(M,R)}(x,d);(!_||"value"in _&&_.value===void 0)&&(x===n.Transaction.prototype||x instanceof n.Transaction?k(x,d,{get:function(){return this.table(d)},set:function(A){g(this,d,{value:A,writable:!0,configurable:!0,enumerable:!0})}}):x[d]=new n.Table(d,y))})})}function Lo(n,i){i.forEach(function(a){for(var l in a)a[l]instanceof n.Table&&delete a[l]})}function uu(n,i){return n._cfg.version-i._cfg.version}function lu(n,i,a,l){var d=n._dbSchema;a.objectStoreNames.contains("$meta")&&!d.$meta&&(d.$meta=Fo("$meta",ds("")[0],[]),n._storeNames.push("$meta"));var y=n._createTransaction("readwrite",n._storeNames,d);y.create(a),y._completion.catch(l);var x=y._reject.bind(y),_=xe.transless||xe;Dt(function(){return xe.trans=y,xe.transless=_,i!==0?(Or(n,a),M=i,((A=y).storeNames.includes("$meta")?A.table("$meta").get("version").then(function(R){return R??M}):me.resolve(M)).then(function(R){return B=R,T=y,$=a,O=[],R=(E=n)._versions,I=E._dbSchema=zr(0,E.idbdb,$),(R=R.filter(function(q){return q._cfg.version>=B})).length!==0?(R.forEach(function(q){O.push(function(){var V=I,Y=q._cfg.dbschema;Kr(E,V,$),Kr(E,Y,$),I=E._dbSchema=Y;var te=qo(V,Y);te.add.forEach(function(ye){Vo($,ye[0],ye[1].primKey,ye[1].indexes)}),te.change.forEach(function(ye){if(ye.recreate)throw new de.Upgrade("Not yet support for changing primary key");var he=$.objectStore(ye.name);ye.add.forEach(function(we){return Br(he,we)}),ye.change.forEach(function(we){he.deleteIndex(we.name),Br(he,we)}),ye.del.forEach(function(we){return he.deleteIndex(we)})});var ce=q._cfg.contentUpgrade;if(ce&&q._cfg.version>B){Or(E,$),T._memoizedTables={};var pe=ee(Y);te.del.forEach(function(ye){pe[ye]=V[ye]}),Lo(E,[E.Transaction.prototype]),jr(E,[E.Transaction.prototype],u(pe),pe),T.schema=pe;var ue,fe=ie(ce);return fe&&tn(),te=me.follow(function(){var ye;(ue=ce(T))&&fe&&(ye=kt.bind(null,null),ue.then(ye,ye))}),ue&&typeof ue.then=="function"?me.resolve(ue):te.then(function(){return ue})}}),O.push(function(V){var Y,te,ce=q._cfg.dbschema;Y=ce,te=V,[].slice.call(te.db.objectStoreNames).forEach(function(pe){return Y[pe]==null&&te.db.deleteObjectStore(pe)}),Lo(E,[E.Transaction.prototype]),jr(E,[E.Transaction.prototype],E._storeNames,E._dbSchema),T.schema=E._dbSchema}),O.push(function(V){E.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(E.idbdb.version/10)===q._cfg.version?(E.idbdb.deleteObjectStore("$meta"),delete E._dbSchema.$meta,E._storeNames=E._storeNames.filter(function(Y){return Y!=="$meta"})):V.objectStore("$meta").put(q._cfg.version,"version"))})}),function q(){return O.length?me.resolve(O.shift()(T.idbtrans)).then(q):me.resolve()}().then(function(){fs(I,$)})):me.resolve();var E,B,T,$,O,I}).catch(x)):(u(d).forEach(function(R){Vo(a,R,d[R].primKey,d[R].indexes)}),Or(n,a),void me.follow(function(){return n.on.populate.fire(y)}).catch(x));var A,M})}function fu(n,i){fs(n._dbSchema,i),i.db.version%10!=0||i.objectStoreNames.contains("$meta")||i.db.createObjectStore("$meta").add(Math.ceil(i.db.version/10-1),"version");var a=zr(0,n.idbdb,i);Kr(n,n._dbSchema,i);for(var l=0,d=qo(a,n._dbSchema).change;l<d.length;l++){var y=function(x){if(x.change.length||x.recreate)return console.warn("Unable to patch indexes of table ".concat(x.name," because it has changes on the type of index or primary key.")),{value:void 0};var _=i.objectStore(x.name);x.add.forEach(function(A){tt&&console.debug("Dexie upgrade patch: Creating missing index ".concat(x.name,".").concat(A.src)),Br(_,A)})}(d[l]);if(typeof y=="object")return y.value}}function qo(n,i){var a,l={del:[],add:[],change:[]};for(a in n)i[a]||l.del.push(a);for(a in i){var d=n[a],y=i[a];if(d){var x={name:a,def:y,recreate:!1,del:[],add:[],change:[]};if(""+(d.primKey.keyPath||"")!=""+(y.primKey.keyPath||"")||d.primKey.auto!==y.primKey.auto)x.recreate=!0,l.change.push(x);else{var _=d.idxByName,A=y.idxByName,M=void 0;for(M in _)A[M]||x.del.push(M);for(M in A){var R=_[M],E=A[M];R?R.src!==E.src&&x.change.push(E):x.add.push(E)}(0<x.del.length||0<x.add.length||0<x.change.length)&&l.change.push(x)}}else l.add.push([a,y])}return l}function Vo(n,i,a,l){var d=n.db.createObjectStore(i,a.keyPath?{keyPath:a.keyPath,autoIncrement:a.auto}:{autoIncrement:a.auto});return l.forEach(function(y){return Br(d,y)}),d}function fs(n,i){u(n).forEach(function(a){i.db.objectStoreNames.contains(a)||(tt&&console.debug("Dexie: Creating missing table",a),Vo(i,a,n[a].primKey,n[a].indexes))})}function Br(n,i){n.createIndex(i.name,i.keyPath,{unique:i.unique,multiEntry:i.multi})}function zr(n,i,a){var l={};return H(i.objectStoreNames,0).forEach(function(d){for(var y=a.objectStore(d),x=Ko(us(M=y.keyPath),M||"",!0,!1,!!y.autoIncrement,M&&typeof M!="string",!0),_=[],A=0;A<y.indexNames.length;++A){var R=y.index(y.indexNames[A]),M=R.keyPath,R=Ko(R.name,M,!!R.unique,!!R.multiEntry,!1,M&&typeof M!="string",!1);_.push(R)}l[d]=Fo(d,x,_)}),l}function Kr(n,i,a){for(var l=a.db.objectStoreNames,d=0;d<l.length;++d){var y=l[d],x=a.objectStore(y);n._hasGetAll="getAll"in x;for(var _=0;_<x.indexNames.length;++_){var A=x.indexNames[_],M=x.index(A).keyPath,R=typeof M=="string"?M:"["+H(M).join("+")+"]";!i[y]||(M=i[y].idxByName[R])&&(M.name=A,delete i[y].idxByName[R],i[y].idxByName[A]=M)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&c.WorkerGlobalScope&&c instanceof c.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}function ds(n){return n.split(",").map(function(i,a){var l=(i=i.trim()).replace(/([&*]|\+\+)/g,""),d=/^\[/.test(l)?l.match(/^\[(.*)\]$/)[1].split("+"):l;return Ko(l,d||null,/\&/.test(i),/\*/.test(i),/\+\+/.test(i),f(d),a===0)})}var du=(Fr.prototype._parseStoresSpec=function(n,i){u(n).forEach(function(a){if(n[a]!==null){var l=ds(n[a]),d=l.shift();if(d.unique=!0,d.multi)throw new de.Schema("Primary key cannot be multi-valued");l.forEach(function(y){if(y.auto)throw new de.Schema("Only primary key can be marked as autoIncrement (++)");if(!y.keyPath)throw new de.Schema("Index must have a name and cannot be an empty string")}),i[a]=Fo(a,d,l)}})},Fr.prototype.stores=function(a){var i=this.db;this._cfg.storesSource=this._cfg.storesSource?h(this._cfg.storesSource,a):a;var a=i._versions,l={},d={};return a.forEach(function(y){h(l,y._cfg.storesSource),d=y._cfg.dbschema={},y._parseStoresSpec(l,d)}),i._dbSchema=d,Lo(i,[i._allTables,i,i.Transaction.prototype]),jr(i,[i._allTables,i,i.Transaction.prototype,this._cfg.tables],u(d),d),i._storeNames=u(d),this},Fr.prototype.upgrade=function(n){return this._cfg.contentUpgrade=dt(this._cfg.contentUpgrade||Se,n),this},Fr);function Fr(){}function Wo(n,i){var a=n._dbNamesDB;return a||(a=n._dbNamesDB=new Yt($n,{addons:[],indexedDB:n,IDBKeyRange:i})).version(1).stores({dbnames:"name"}),a.table("dbnames")}function Yo(n){return n&&typeof n.databases=="function"}function Xo(n){return Dt(function(){return xe.letThrough=!0,n()})}function Uo(n){return!("from"in n)}var ot=function(n,i){if(!this){var a=new ot;return n&&"d"in n&&h(a,n),a}h(this,arguments.length?{d:1,from:n,to:1<arguments.length?i:n}:{d:0})};function ar(n,i,a){var l=Te(i,a);if(!isNaN(l)){if(0<l)throw RangeError();if(Uo(n))return h(n,{from:i,to:a,d:1});var d=n.l,l=n.r;if(Te(a,n.from)<0)return d?ar(d,i,a):n.l={from:i,to:a,d:1,l:null,r:null},ps(n);if(0<Te(i,n.to))return l?ar(l,i,a):n.r={from:i,to:a,d:1,l:null,r:null},ps(n);Te(i,n.from)<0&&(n.from=i,n.l=null,n.d=l?l.d+1:1),0<Te(a,n.to)&&(n.to=a,n.r=null,n.d=n.l?n.l.d+1:1),a=!n.r,d&&!n.l&&cr(n,d),l&&a&&cr(n,l)}}function cr(n,i){Uo(i)||function a(l,A){var y=A.from,x=A.to,_=A.l,A=A.r;ar(l,y,x),_&&a(l,_),A&&a(l,A)}(n,i)}function hs(n,i){var a=Hr(i),l=a.next();if(l.done)return!1;for(var d=l.value,y=Hr(n),x=y.next(d.from),_=x.value;!l.done&&!x.done;){if(Te(_.from,d.to)<=0&&0<=Te(_.to,d.from))return!0;Te(d.from,_.from)<0?d=(l=a.next(_.from)).value:_=(x=y.next(d.from)).value}return!1}function Hr(n){var i=Uo(n)?null:{s:0,n};return{next:function(a){for(var l=0<arguments.length;i;)switch(i.s){case 0:if(i.s=1,l)for(;i.n.l&&Te(a,i.n.from)<0;)i={up:i,n:i.n.l,s:1};else for(;i.n.l;)i={up:i,n:i.n.l,s:1};case 1:if(i.s=2,!l||Te(a,i.n.to)<=0)return{value:i.n,done:!1};case 2:if(i.n.r){i.s=3,i={up:i,n:i.n.r,s:0};continue}case 3:i=i.up}return{done:!0}}}}function ps(n){var i,a,l=(((i=n.r)===null||i===void 0?void 0:i.d)||0)-(((a=n.l)===null||a===void 0?void 0:a.d)||0),d=1<l?"r":l<-1?"l":"";d&&(i=d=="r"?"l":"r",a=o({},n),l=n[d],n.from=l.from,n.to=l.to,n[d]=l[d],a[d]=l[i],(n[i]=a).d=ms(a)),n.d=ms(n)}function ms(a){var i=a.r,a=a.l;return(i?a?Math.max(i.d,a.d):i.d:a?a.d:0)+1}function Lr(n,i){return u(i).forEach(function(a){n[a]?cr(n[a],i[a]):n[a]=function l(d){var y,x,_={};for(y in d)v(d,y)&&(x=d[y],_[y]=!x||typeof x!="object"||ne.has(x.constructor)?x:l(x));return _}(i[a])}),n}function Zo(n,i){return n.all||i.all||Object.keys(n).some(function(a){return i[a]&&hs(i[a],n[a])})}w(ot.prototype,((xt={add:function(n){return cr(this,n),this},addKey:function(n){return ar(this,n,n),this},addKeys:function(n){var i=this;return n.forEach(function(a){return ar(i,a,a)}),this},hasKey:function(n){var i=Hr(this).next(n).value;return i&&Te(i.from,n)<=0&&0<=Te(i.to,n)}})[j]=function(){return Hr(this)},xt));var pn={},Go={},Qo=!1;function qr(n){Lr(Go,n),Qo||(Qo=!0,setTimeout(function(){Qo=!1,Jo(Go,!(Go={}))},0))}function Jo(n,i){i===void 0&&(i=!1);var a=new Set;if(n.all)for(var l=0,d=Object.values(pn);l<d.length;l++)ys(x=d[l],n,a,i);else for(var y in n){var x,_=/^idb\:\/\/(.*)\/(.*)\//.exec(y);_&&(y=_[1],_=_[2],(x=pn["idb://".concat(y,"/").concat(_)])&&ys(x,n,a,i))}a.forEach(function(A){return A()})}function ys(n,i,a,l){for(var d=[],y=0,x=Object.entries(n.queries.query);y<x.length;y++){for(var _=x[y],A=_[0],M=[],R=0,E=_[1];R<E.length;R++){var B=E[R];Zo(i,B.obsSet)?B.subscribers.forEach(function(I){return a.add(I)}):l&&M.push(B)}l&&d.push([A,M])}if(l)for(var T=0,$=d;T<$.length;T++){var O=$[T],A=O[0],M=O[1];n.queries.query[A]=M}}function hu(n){var i=n._state,a=n._deps.indexedDB;if(i.isBeingOpened||n.idbdb)return i.dbReadyPromise.then(function(){return i.dbOpenError?He(i.dbOpenError):n});i.isBeingOpened=!0,i.dbOpenError=null,i.openComplete=!1;var l=i.openCanceller,d=Math.round(10*n.verno),y=!1;function x(){if(i.openCanceller!==l)throw new de.DatabaseClosed("db.open() was cancelled")}function _(){return new me(function(B,T){if(x(),!a)throw new de.MissingAPI;var $=n.name,O=i.autoSchema||!d?a.open($):a.open($,d);if(!O)throw new de.MissingAPI;O.onerror=zt(T),O.onblocked=Be(n._fireOnBlocked),O.onupgradeneeded=Be(function(I){var q;R=O.transaction,i.autoSchema&&!n._options.allowEmptyDB?(O.onerror=rr,R.abort(),O.result.close(),(q=a.deleteDatabase($)).onsuccess=q.onerror=Be(function(){T(new de.NoSuchDatabase("Database ".concat($," doesnt exist")))})):(R.onerror=zt(T),I=I.oldVersion>Math.pow(2,62)?0:I.oldVersion,E=I<1,n.idbdb=O.result,y&&fu(n,R),lu(n,I/10,R,T))},T),O.onsuccess=Be(function(){R=null;var I,q,V,Y,te,ce=n.idbdb=O.result,pe=H(ce.objectStoreNames);if(0<pe.length)try{var ue=ce.transaction((Y=pe).length===1?Y[0]:Y,"readonly");if(i.autoSchema)q=ce,V=ue,(I=n).verno=q.version/10,V=I._dbSchema=zr(0,q,V),I._storeNames=H(q.objectStoreNames,0),jr(I,[I._allTables],u(V),V);else if(Kr(n,n._dbSchema,ue),((te=qo(zr(0,(te=n).idbdb,ue),te._dbSchema)).add.length||te.change.some(function(fe){return fe.add.length||fe.change.length}))&&!y)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),ce.close(),d=ce.version+1,y=!0,B(_());Or(n,ue)}catch{}nn.push(n),ce.onversionchange=Be(function(fe){i.vcFired=!0,n.on("versionchange").fire(fe)}),ce.onclose=Be(function(fe){n.on("close").fire(fe)}),E&&(te=n._deps,ue=$,ce=te.indexedDB,te=te.IDBKeyRange,Yo(ce)||ue===$n||Wo(ce,te).put({name:ue}).catch(Se)),B()},T)}).catch(function(B){switch(B==null?void 0:B.name){case"UnknownError":if(0<i.PR1398_maxLoop)return i.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),_();break;case"VersionError":if(0<d)return d=0,_()}return me.reject(B)})}var A,M=i.dbReadyResolve,R=null,E=!1;return me.race([l,(typeof navigator>"u"?me.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(B){function T(){return indexedDB.databases().finally(B)}A=setInterval(T,100),T()}).finally(function(){return clearInterval(A)}):Promise.resolve()).then(_)]).then(function(){return x(),i.onReadyBeingFired=[],me.resolve(Xo(function(){return n.on.ready.fire(n.vip)})).then(function B(){if(0<i.onReadyBeingFired.length){var T=i.onReadyBeingFired.reduce(dt,Se);return i.onReadyBeingFired=[],me.resolve(Xo(function(){return T(n.vip)})).then(B)}})}).finally(function(){i.openCanceller===l&&(i.onReadyBeingFired=null,i.isBeingOpened=!1)}).catch(function(B){i.dbOpenError=B;try{R&&R.abort()}catch{}return l===i.openCanceller&&n._close(),He(B)}).finally(function(){i.openComplete=!0,M()}).then(function(){var B;return E&&(B={},n.tables.forEach(function(T){T.schema.indexes.forEach(function($){$.name&&(B["idb://".concat(n.name,"/").concat(T.name,"/").concat($.name)]=new ot(-1/0,[[[]]]))}),B["idb://".concat(n.name,"/").concat(T.name,"/")]=B["idb://".concat(n.name,"/").concat(T.name,"/:dels")]=new ot(-1/0,[[[]]])}),on(or).fire(B),Jo(B,!0)),n})}function ei(n){function i(y){return n.next(y)}var a=d(i),l=d(function(y){return n.throw(y)});function d(y){return function(A){var _=y(A),A=_.value;return _.done?A:A&&typeof A.then=="function"?A.then(a,l):f(A)?Promise.all(A).then(a,l):a(A)}}return d(i)()}function Vr(n,i,a){for(var l=f(n)?n.slice():[n],d=0;d<a;++d)l.push(i);return l}var pu={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(n){return o(o({},n),{table:function(i){var a=n.table(i),l=a.schema,d={},y=[];function x(E,B,T){var $=sr(E),O=d[$]=d[$]||[],I=E==null?0:typeof E=="string"?1:E.length,q=0<B,q=o(o({},T),{name:q?"".concat($,"(virtual-from:").concat(T.name,")"):T.name,lowLevelIndex:T,isVirtual:q,keyTail:B,keyLength:I,extractKey:Ho(E),unique:!q&&T.unique});return O.push(q),q.isPrimaryKey||y.push(q),1<I&&x(I===2?E[0]:E.slice(0,I-1),B+1,T),O.sort(function(V,Y){return V.keyTail-Y.keyTail}),q}i=x(l.primaryKey.keyPath,0,l.primaryKey),d[":id"]=[i];for(var _=0,A=l.indexes;_<A.length;_++){var M=A[_];x(M.keyPath,0,M)}function R(E){var B,T=E.query.index;return T.isVirtual?o(o({},E),{query:{index:T.lowLevelIndex,range:(B=E.query.range,T=T.keyTail,{type:B.type===1?2:B.type,lower:Vr(B.lower,B.lowerOpen?n.MAX_KEY:n.MIN_KEY,T),lowerOpen:!0,upper:Vr(B.upper,B.upperOpen?n.MIN_KEY:n.MAX_KEY,T),upperOpen:!0})}}):E}return o(o({},a),{schema:o(o({},l),{primaryKey:i,indexes:y,getIndexByKeyPath:function(E){return(E=d[sr(E)])&&E[0]}}),count:function(E){return a.count(R(E))},query:function(E){return a.query(R(E))},openCursor:function(E){var B=E.query.index,T=B.keyTail,$=B.isVirtual,O=B.keyLength;return $?a.openCursor(R(E)).then(function(q){return q&&I(q)}):a.openCursor(E);function I(q){return Object.create(q,{continue:{value:function(V){V!=null?q.continue(Vr(V,E.reverse?n.MAX_KEY:n.MIN_KEY,T)):E.unique?q.continue(q.key.slice(0,O).concat(E.reverse?n.MIN_KEY:n.MAX_KEY,T)):q.continue()}},continuePrimaryKey:{value:function(V,Y){q.continuePrimaryKey(Vr(V,n.MAX_KEY,T),Y)}},primaryKey:{get:function(){return q.primaryKey}},key:{get:function(){var V=q.key;return O===1?V[0]:V.slice(0,O)}},value:{get:function(){return q.value}}})}}})}})}};function ti(n,i,a,l){return a=a||{},l=l||"",u(n).forEach(function(d){var y,x,_;v(i,d)?(y=n[d],x=i[d],typeof y=="object"&&typeof x=="object"&&y&&x?(_=L(y))!==L(x)?a[l+d]=i[d]:_==="Object"?ti(y,x,a,l+d+"."):y!==x&&(a[l+d]=i[d]):y!==x&&(a[l+d]=i[d])):a[l+d]=void 0}),u(i).forEach(function(d){v(n,d)||(a[l+d]=i[d])}),a}function ni(n,i){return i.type==="delete"?i.keys:i.keys||i.values.map(n.extractKey)}var mu={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(n){return o(o({},n),{table:function(i){var a=n.table(i),l=a.schema.primaryKey;return o(o({},a),{mutate:function(d){var y=xe.trans,x=y.table(i).hook,_=x.deleting,A=x.creating,M=x.updating;switch(d.type){case"add":if(A.fire===Se)break;return y._promise("readwrite",function(){return R(d)},!0);case"put":if(A.fire===Se&&M.fire===Se)break;return y._promise("readwrite",function(){return R(d)},!0);case"delete":if(_.fire===Se)break;return y._promise("readwrite",function(){return R(d)},!0);case"deleteRange":if(_.fire===Se)break;return y._promise("readwrite",function(){return function E(B,T,$){return a.query({trans:B,values:!1,query:{index:l,range:T},limit:$}).then(function(O){var I=O.result;return R({type:"delete",keys:I,trans:B}).then(function(q){return 0<q.numFailures?Promise.reject(q.failures[0]):I.length<$?{failures:[],numFailures:0,lastResult:void 0}:E(B,o(o({},T),{lower:I[I.length-1],lowerOpen:!0}),$)})})}(d.trans,d.range,1e4)},!0)}return a.mutate(d);function R(E){var B,T,$,O=xe.trans,I=E.keys||ni(l,E);if(!I)throw new Error("Keys missing");return(E=E.type==="add"||E.type==="put"?o(o({},E),{keys:I}):o({},E)).type!=="delete"&&(E.values=s([],E.values)),E.keys&&(E.keys=s([],E.keys)),B=a,$=I,((T=E).type==="add"?Promise.resolve([]):B.getMany({trans:T.trans,keys:$,cache:"immutable"})).then(function(q){var V=I.map(function(Y,te){var ce,pe,ue,fe=q[te],ye={onerror:null,onsuccess:null};return E.type==="delete"?_.fire.call(ye,Y,fe,O):E.type==="add"||fe===void 0?(ce=A.fire.call(ye,Y,E.values[te],O),Y==null&&ce!=null&&(E.keys[te]=Y=ce,l.outbound||X(E.values[te],l.keyPath,Y))):(ce=ti(fe,E.values[te]),(pe=M.fire.call(ye,ce,Y,fe,O))&&(ue=E.values[te],Object.keys(pe).forEach(function(he){v(ue,he)?ue[he]=pe[he]:X(ue,he,pe[he])}))),ye});return a.mutate(E).then(function(Y){for(var te=Y.failures,ce=Y.results,pe=Y.numFailures,Y=Y.lastResult,ue=0;ue<I.length;++ue){var fe=(ce||I)[ue],ye=V[ue];fe==null?ye.onerror&&ye.onerror(te[ue]):ye.onsuccess&&ye.onsuccess(E.type==="put"&&q[ue]?E.values[ue]:fe)}return{failures:te,results:ce,numFailures:pe,lastResult:Y}}).catch(function(Y){return V.forEach(function(te){return te.onerror&&te.onerror(Y)}),Promise.reject(Y)})})}}})}})}};function gs(n,i,a){try{if(!i||i.keys.length<n.length)return null;for(var l=[],d=0,y=0;d<i.keys.length&&y<n.length;++d)Te(i.keys[d],n[y])===0&&(l.push(a?se(i.values[d]):i.values[d]),++y);return l.length===n.length?l:null}catch{return null}}var yu={stack:"dbcore",level:-1,create:function(n){return{table:function(i){var a=n.table(i);return o(o({},a),{getMany:function(l){if(!l.cache)return a.getMany(l);var d=gs(l.keys,l.trans._cache,l.cache==="clone");return d?me.resolve(d):a.getMany(l).then(function(y){return l.trans._cache={keys:l.keys,values:l.cache==="clone"?se(y):y},y})},mutate:function(l){return l.type!=="add"&&(l.trans._cache=null),a.mutate(l)}})}}}};function vs(n,i){return n.trans.mode==="readonly"&&!!n.subscr&&!n.trans.explicit&&n.trans.db._options.cache!=="disabled"&&!i.schema.primaryKey.outbound}function ws(n,i){switch(n){case"query":return i.values&&!i.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var gu={stack:"dbcore",level:0,name:"Observability",create:function(n){var i=n.schema.name,a=new ot(n.MIN_KEY,n.MAX_KEY);return o(o({},n),{transaction:function(l,d,y){if(xe.subscr&&d!=="readonly")throw new de.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(xe.querier));return n.transaction(l,d,y)},table:function(l){var d=n.table(l),y=d.schema,x=y.primaryKey,E=y.indexes,_=x.extractKey,A=x.outbound,M=x.autoIncrement&&E.filter(function(T){return T.compound&&T.keyPath.includes(x.keyPath)}),R=o(o({},d),{mutate:function(T){function $(he){return he="idb://".concat(i,"/").concat(l,"/").concat(he),Y[he]||(Y[he]=new ot)}var O,I,q,V=T.trans,Y=T.mutatedParts||(T.mutatedParts={}),te=$(""),ce=$(":dels"),pe=T.type,ye=T.type==="deleteRange"?[T.range]:T.type==="delete"?[T.keys]:T.values.length<50?[ni(x,T).filter(function(he){return he}),T.values]:[],ue=ye[0],fe=ye[1],ye=T.trans._cache;return f(ue)?(te.addKeys(ue),(ye=pe==="delete"||ue.length===fe.length?gs(ue,ye):null)||ce.addKeys(ue),(ye||fe)&&(O=$,I=ye,q=fe,y.indexes.forEach(function(he){var we=O(he.name||"");function Ce(Ie){return Ie!=null?he.extractKey(Ie):null}function Me(Ie){return he.multiEntry&&f(Ie)?Ie.forEach(function(pt){return we.addKey(pt)}):we.addKey(Ie)}(I||q).forEach(function(Ie,it){var Ne=I&&Ce(I[it]),it=q&&Ce(q[it]);Te(Ne,it)!==0&&(Ne!=null&&Me(Ne),it!=null&&Me(it))})}))):ue?(fe={from:(fe=ue.lower)!==null&&fe!==void 0?fe:n.MIN_KEY,to:(fe=ue.upper)!==null&&fe!==void 0?fe:n.MAX_KEY},ce.add(fe),te.add(fe)):(te.add(a),ce.add(a),y.indexes.forEach(function(he){return $(he.name).add(a)})),d.mutate(T).then(function(he){return!ue||T.type!=="add"&&T.type!=="put"||(te.addKeys(he.results),M&&M.forEach(function(we){for(var Ce=T.values.map(function(Ne){return we.extractKey(Ne)}),Me=we.keyPath.findIndex(function(Ne){return Ne===x.keyPath}),Ie=0,pt=he.results.length;Ie<pt;++Ie)Ce[Ie][Me]=he.results[Ie];$(we.name).addKeys(Ce)})),V.mutatedParts=Lr(V.mutatedParts||{},Y),he})}}),E=function($){var O=$.query,$=O.index,O=O.range;return[$,new ot(($=O.lower)!==null&&$!==void 0?$:n.MIN_KEY,(O=O.upper)!==null&&O!==void 0?O:n.MAX_KEY)]},B={get:function(T){return[x,new ot(T.key)]},getMany:function(T){return[x,new ot().addKeys(T.keys)]},count:E,query:E,openCursor:E};return u(B).forEach(function(T){R[T]=function($){var O=xe.subscr,I=!!O,q=vs(xe,d)&&ws(T,$)?$.obsSet={}:O;if(I){var V=function(fe){return fe="idb://".concat(i,"/").concat(l,"/").concat(fe),q[fe]||(q[fe]=new ot)},Y=V(""),te=V(":dels"),O=B[T]($),I=O[0],O=O[1];if((T==="query"&&I.isPrimaryKey&&!$.values?te:V(I.name||"")).add(O),!I.isPrimaryKey){if(T!=="count"){var ce=T==="query"&&A&&$.values&&d.query(o(o({},$),{values:!1}));return d[T].apply(this,arguments).then(function(fe){if(T==="query"){if(A&&$.values)return ce.then(function(Ce){return Ce=Ce.result,Y.addKeys(Ce),fe});var ye=$.values?fe.result.map(_):fe.result;($.values?Y:te).addKeys(ye)}else if(T==="openCursor"){var he=fe,we=$.values;return he&&Object.create(he,{key:{get:function(){return te.addKey(he.primaryKey),he.key}},primaryKey:{get:function(){var Ce=he.primaryKey;return te.addKey(Ce),Ce}},value:{get:function(){return we&&Y.addKey(he.primaryKey),he.value}}})}return fe})}te.add(a)}}return d[T].apply(this,arguments)}}),R}})}};function xs(n,i,a){if(a.numFailures===0)return i;if(i.type==="deleteRange")return null;var l=i.keys?i.keys.length:"values"in i&&i.values?i.values.length:1;return a.numFailures===l?null:(i=o({},i),f(i.keys)&&(i.keys=i.keys.filter(function(d,y){return!(y in a.failures)})),"values"in i&&f(i.values)&&(i.values=i.values.filter(function(d,y){return!(y in a.failures)})),i)}function ri(n,i){return a=n,((l=i).lower===void 0||(l.lowerOpen?0<Te(a,l.lower):0<=Te(a,l.lower)))&&(n=n,(i=i).upper===void 0||(i.upperOpen?Te(n,i.upper)<0:Te(n,i.upper)<=0));var a,l}function bs(n,i,B,l,d,y){if(!B||B.length===0)return n;var x=i.query.index,_=x.multiEntry,A=i.query.range,M=l.schema.primaryKey.extractKey,R=x.extractKey,E=(x.lowLevelIndex||x).extractKey,B=B.reduce(function(T,$){var O=T,I=[];if($.type==="add"||$.type==="put")for(var q=new ot,V=$.values.length-1;0<=V;--V){var Y,te=$.values[V],ce=M(te);q.hasKey(ce)||(Y=R(te),(_&&f(Y)?Y.some(function(he){return ri(he,A)}):ri(Y,A))&&(q.addKey(ce),I.push(te)))}switch($.type){case"add":var pe=new ot().addKeys(i.values?T.map(function(we){return M(we)}):T),O=T.concat(i.values?I.filter(function(we){return we=M(we),!pe.hasKey(we)&&(pe.addKey(we),!0)}):I.map(function(we){return M(we)}).filter(function(we){return!pe.hasKey(we)&&(pe.addKey(we),!0)}));break;case"put":var ue=new ot().addKeys($.values.map(function(we){return M(we)}));O=T.filter(function(we){return!ue.hasKey(i.values?M(we):we)}).concat(i.values?I:I.map(function(we){return M(we)}));break;case"delete":var fe=new ot().addKeys($.keys);O=T.filter(function(we){return!fe.hasKey(i.values?M(we):we)});break;case"deleteRange":var ye=$.range;O=T.filter(function(we){return!ri(M(we),ye)})}return O},n);return B===n?n:(B.sort(function(T,$){return Te(E(T),E($))||Te(M(T),M($))}),i.limit&&i.limit<1/0&&(B.length>i.limit?B.length=i.limit:n.length===i.limit&&B.length<i.limit&&(d.dirty=!0)),y?Object.freeze(B):B)}function _s(n,i){return Te(n.lower,i.lower)===0&&Te(n.upper,i.upper)===0&&!!n.lowerOpen==!!i.lowerOpen&&!!n.upperOpen==!!i.upperOpen}function vu(n,i){return function(a,l,d,y){if(a===void 0)return l!==void 0?-1:0;if(l===void 0)return 1;if((l=Te(a,l))===0){if(d&&y)return 0;if(d)return 1;if(y)return-1}return l}(n.lower,i.lower,n.lowerOpen,i.lowerOpen)<=0&&0<=function(a,l,d,y){if(a===void 0)return l!==void 0?1:0;if(l===void 0)return-1;if((l=Te(a,l))===0){if(d&&y)return 0;if(d)return-1;if(y)return 1}return l}(n.upper,i.upper,n.upperOpen,i.upperOpen)}function wu(n,i,a,l){n.subscribers.add(a),l.addEventListener("abort",function(){var d,y;n.subscribers.delete(a),n.subscribers.size===0&&(d=n,y=i,setTimeout(function(){d.subscribers.size===0&&re(y,d)},3e3))})}var xu={stack:"dbcore",level:0,name:"Cache",create:function(n){var i=n.schema.name;return o(o({},n),{transaction:function(a,l,d){var y,x,_=n.transaction(a,l,d);return l==="readwrite"&&(x=(y=new AbortController).signal,d=function(A){return function(){if(y.abort(),l==="readwrite"){for(var M=new Set,R=0,E=a;R<E.length;R++){var B=E[R],T=pn["idb://".concat(i,"/").concat(B)];if(T){var $=n.table(B),O=T.optimisticOps.filter(function(we){return we.trans===_});if(_._explicit&&A&&_.mutatedParts)for(var I=0,q=Object.values(T.queries.query);I<q.length;I++)for(var V=0,Y=(pe=q[I]).slice();V<Y.length;V++)Zo((ue=Y[V]).obsSet,_.mutatedParts)&&(re(pe,ue),ue.subscribers.forEach(function(we){return M.add(we)}));else if(0<O.length){T.optimisticOps=T.optimisticOps.filter(function(we){return we.trans!==_});for(var te=0,ce=Object.values(T.queries.query);te<ce.length;te++)for(var pe,ue,fe,ye=0,he=(pe=ce[te]).slice();ye<he.length;ye++)(ue=he[ye]).res!=null&&_.mutatedParts&&(A&&!ue.dirty?(fe=Object.isFrozen(ue.res),fe=bs(ue.res,ue.req,O,$,ue,fe),ue.dirty?(re(pe,ue),ue.subscribers.forEach(function(we){return M.add(we)})):fe!==ue.res&&(ue.res=fe,ue.promise=me.resolve({result:fe}))):(ue.dirty&&re(pe,ue),ue.subscribers.forEach(function(we){return M.add(we)})))}}}M.forEach(function(we){return we()})}}},_.addEventListener("abort",d(!1),{signal:x}),_.addEventListener("error",d(!1),{signal:x}),_.addEventListener("complete",d(!0),{signal:x})),_},table:function(a){var l=n.table(a),d=l.schema.primaryKey;return o(o({},l),{mutate:function(y){var x=xe.trans;if(d.outbound||x.db._options.cache==="disabled"||x.explicit||x.idbtrans.mode!=="readwrite")return l.mutate(y);var _=pn["idb://".concat(i,"/").concat(a)];return _?(x=l.mutate(y),y.type!=="add"&&y.type!=="put"||!(50<=y.values.length||ni(d,y).some(function(A){return A==null}))?(_.optimisticOps.push(y),y.mutatedParts&&qr(y.mutatedParts),x.then(function(A){0<A.numFailures&&(re(_.optimisticOps,y),(A=xs(0,y,A))&&_.optimisticOps.push(A),y.mutatedParts&&qr(y.mutatedParts))}),x.catch(function(){re(_.optimisticOps,y),y.mutatedParts&&qr(y.mutatedParts)})):x.then(function(A){var M=xs(0,o(o({},y),{values:y.values.map(function(R,E){var B;return A.failures[E]?R:(R=(B=d.keyPath)!==null&&B!==void 0&&B.includes(".")?se(R):o({},R),X(R,d.keyPath,A.results[E]),R)})}),A);_.optimisticOps.push(M),queueMicrotask(function(){return y.mutatedParts&&qr(y.mutatedParts)})}),x):l.mutate(y)},query:function(y){if(!vs(xe,l)||!ws("query",y))return l.query(y);var x=((M=xe.trans)===null||M===void 0?void 0:M.db._options.cache)==="immutable",E=xe,_=E.requery,A=E.signal,M=function($,O,I,q){var V=pn["idb://".concat($,"/").concat(O)];if(!V)return[];if(!(O=V.queries[I]))return[null,!1,V,null];var Y=O[(q.query?q.query.index.name:null)||""];if(!Y)return[null,!1,V,null];switch(I){case"query":var te=Y.find(function(ce){return ce.req.limit===q.limit&&ce.req.values===q.values&&_s(ce.req.query.range,q.query.range)});return te?[te,!0,V,Y]:[Y.find(function(ce){return("limit"in ce.req?ce.req.limit:1/0)>=q.limit&&(!q.values||ce.req.values)&&vu(ce.req.query.range,q.query.range)}),!1,V,Y];case"count":return te=Y.find(function(ce){return _s(ce.req.query.range,q.query.range)}),[te,!!te,V,Y]}}(i,a,"query",y),R=M[0],E=M[1],B=M[2],T=M[3];return R&&E?R.obsSet=y.obsSet:(E=l.query(y).then(function($){var O=$.result;if(R&&(R.res=O),x){for(var I=0,q=O.length;I<q;++I)Object.freeze(O[I]);Object.freeze(O)}else $.result=se(O);return $}).catch(function($){return T&&R&&re(T,R),Promise.reject($)}),R={obsSet:y.obsSet,promise:E,subscribers:new Set,type:"query",req:y,dirty:!1},T?T.push(R):(T=[R],(B=B||(pn["idb://".concat(i,"/").concat(a)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[y.query.index.name||""]=T)),wu(R,T,_,A),R.promise.then(function($){return{result:bs($.result,y,B==null?void 0:B.optimisticOps,l,R,x)}})}})}})}};function Wr(n,i){return new Proxy(n,{get:function(a,l,d){return l==="db"?i:Reflect.get(a,l,d)}})}var Yt=(We.prototype.version=function(n){if(isNaN(n)||n<.1)throw new de.Type("Given version is not a positive number");if(n=Math.round(10*n)/10,this.idbdb||this._state.isBeingOpened)throw new de.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var i=this._versions,a=i.filter(function(l){return l._cfg.version===n})[0];return a||(a=new this.Version(n),i.push(a),i.sort(uu),a.stores({}),this._state.autoSchema=!1,a)},We.prototype._whenReady=function(n){var i=this;return this.idbdb&&(this._state.openComplete||xe.letThrough||this._vip)?n():new me(function(a,l){if(i._state.openComplete)return l(new de.DatabaseClosed(i._state.dbOpenError));if(!i._state.isBeingOpened){if(!i._state.autoOpen)return void l(new de.DatabaseClosed);i.open().catch(Se)}i._state.dbReadyPromise.then(a,l)}).then(n)},We.prototype.use=function(n){var i=n.stack,a=n.create,l=n.level,d=n.name;return d&&this.unuse({stack:i,name:d}),n=this._middlewares[i]||(this._middlewares[i]=[]),n.push({stack:i,create:a,level:l??10,name:d}),n.sort(function(y,x){return y.level-x.level}),this},We.prototype.unuse=function(n){var i=n.stack,a=n.name,l=n.create;return i&&this._middlewares[i]&&(this._middlewares[i]=this._middlewares[i].filter(function(d){return l?d.create!==l:!!a&&d.name!==a})),this},We.prototype.open=function(){var n=this;return Vt(rt,function(){return hu(n)})},We.prototype._close=function(){var n=this._state,i=nn.indexOf(this);if(0<=i&&nn.splice(i,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}n.isBeingOpened||(n.dbReadyPromise=new me(function(a){n.dbReadyResolve=a}),n.openCanceller=new me(function(a,l){n.cancelOpen=l}))},We.prototype.close=function(a){var i=(a===void 0?{disableAutoOpen:!0}:a).disableAutoOpen,a=this._state;i?(a.isBeingOpened&&a.cancelOpen(new de.DatabaseClosed),this._close(),a.autoOpen=!1,a.dbOpenError=new de.DatabaseClosed):(this._close(),a.autoOpen=this._options.autoOpen||a.isBeingOpened,a.openComplete=!1,a.dbOpenError=null)},We.prototype.delete=function(n){var i=this;n===void 0&&(n={disableAutoOpen:!0});var a=0<arguments.length&&typeof arguments[0]!="object",l=this._state;return new me(function(d,y){function x(){i.close(n);var _=i._deps.indexedDB.deleteDatabase(i.name);_.onsuccess=Be(function(){var A,M,R;A=i._deps,M=i.name,R=A.indexedDB,A=A.IDBKeyRange,Yo(R)||M===$n||Wo(R,A).delete(M).catch(Se),d()}),_.onerror=zt(y),_.onblocked=i._fireOnBlocked}if(a)throw new de.InvalidArgument("Invalid closeOptions argument to db.delete()");l.isBeingOpened?l.dbReadyPromise.then(x):x()})},We.prototype.backendDB=function(){return this.idbdb},We.prototype.isOpen=function(){return this.idbdb!==null},We.prototype.hasBeenClosed=function(){var n=this._state.dbOpenError;return n&&n.name==="DatabaseClosed"},We.prototype.hasFailed=function(){return this._state.dbOpenError!==null},We.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(We.prototype,"tables",{get:function(){var n=this;return u(this._allTables).map(function(i){return n._allTables[i]})},enumerable:!1,configurable:!0}),We.prototype.transaction=function(){var n=(function(i,a,l){var d=arguments.length;if(d<2)throw new de.InvalidArgument("Too few arguments");for(var y=new Array(d-1);--d;)y[d-1]=arguments[d];return l=y.pop(),[i,oe(y),l]}).apply(this,arguments);return this._transaction.apply(this,n)},We.prototype._transaction=function(n,i,a){var l=this,d=xe.trans;d&&d.db===this&&n.indexOf("!")===-1||(d=null);var y,x,_=n.indexOf("?")!==-1;n=n.replace("!","").replace("?","");try{if(x=i.map(function(M){if(M=M instanceof l.Table?M.name:M,typeof M!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return M}),n=="r"||n===Qn)y=Qn;else{if(n!="rw"&&n!=Jn)throw new de.InvalidArgument("Invalid transaction mode: "+n);y=Jn}if(d){if(d.mode===Qn&&y===Jn){if(!_)throw new de.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");d=null}d&&x.forEach(function(M){if(d&&d.storeNames.indexOf(M)===-1){if(!_)throw new de.SubTransaction("Table "+M+" not included in parent transaction.");d=null}}),_&&d&&!d.active&&(d=null)}}catch(M){return d?d._promise(null,function(R,E){E(M)}):He(M)}var A=(function M(R,E,B,T,$){return me.resolve().then(function(){var O=xe.transless||xe,I=R._createTransaction(E,B,R._dbSchema,T);if(I.explicit=!0,O={trans:I,transless:O},T)I.idbtrans=T.idbtrans;else try{I.create(),I.idbtrans._explicit=!0,R._state.PR1398_maxLoop=3}catch(Y){return Y.name===Ae.InvalidState&&R.isOpen()&&0<--R._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),R.close({disableAutoOpen:!1}),R.open().then(function(){return M(R,E,B,null,$)})):He(Y)}var q,V=ie($);return V&&tn(),O=me.follow(function(){var Y;(q=$.call(I,I))&&(V?(Y=kt.bind(null,null),q.then(Y,Y)):typeof q.next=="function"&&typeof q.throw=="function"&&(q=ei(q)))},O),(q&&typeof q.then=="function"?me.resolve(q).then(function(Y){return I.active?Y:He(new de.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):O.then(function(){return q})).then(function(Y){return T&&I._resolve(),I._completion.then(function(){return Y})}).catch(function(Y){return I._reject(Y),He(Y)})})}).bind(null,this,y,x,d,a);return d?d._promise(y,A,"lock"):xe.trans?Vt(xe.transless,function(){return l._whenReady(A)}):this._whenReady(A)},We.prototype.table=function(n){if(!v(this._allTables,n))throw new de.InvalidTable("Table ".concat(n," does not exist"));return this._allTables[n]},We);function We(n,i){var a=this;this._middlewares={},this.verno=0;var l=We.dependencies;this._options=i=o({addons:We.addons,autoOpen:!0,indexedDB:l.indexedDB,IDBKeyRange:l.IDBKeyRange,cache:"cloned"},i),this._deps={indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange},l=i.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var d,y,x,_,A,M={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Se,dbReadyPromise:null,cancelOpen:Se,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:i.autoOpen};M.dbReadyPromise=new me(function(E){M.dbReadyResolve=E}),M.openCanceller=new me(function(E,B){M.cancelOpen=B}),this._state=M,this.name=n,this.on=er(this,"populate","blocked","versionchange","close",{ready:[dt,Se]}),this.on.ready.subscribe=K(this.on.ready.subscribe,function(E){return function(B,T){We.vip(function(){var $,O=a._state;O.openComplete?(O.dbOpenError||me.resolve().then(B),T&&E(B)):O.onReadyBeingFired?(O.onReadyBeingFired.push(B),T&&E(B)):(E(B),$=a,T||E(function I(){$.on.ready.unsubscribe(B),$.on.ready.unsubscribe(I)}))})}}),this.Collection=(d=this,tr(nu.prototype,function(q,I){this.db=d;var T=Ir,$=null;if(I)try{T=I()}catch(V){$=V}var O=q._ctx,I=O.table,q=I.hook.reading.fire;this._ctx={table:I,index:O.index,isPrimKey:!O.index||I.schema.primKey.keyPath&&O.index===I.schema.primKey.name,range:T,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:$,or:O.or,valueMapper:q!==Ve?q:null}})),this.Table=(y=this,tr(rs.prototype,function(E,B,T){this.db=y,this._tx=T,this.name=E,this.schema=B,this.hook=y._allTables[E]?y._allTables[E].hook:er(null,{creating:[at,Se],reading:[Ue,Ve],updating:[Ee,Se],deleting:[Oe,Se]})})),this.Transaction=(x=this,tr(iu.prototype,function(E,B,T,$,O){var I=this;this.db=x,this.mode=E,this.storeNames=B,this.schema=T,this.chromeTransactionDurability=$,this.idbtrans=null,this.on=er(this,"complete","error","abort"),this.parent=O||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new me(function(q,V){I._resolve=q,I._reject=V}),this._completion.then(function(){I.active=!1,I.on.complete.fire()},function(q){var V=I.active;return I.active=!1,I.on.error.fire(q),I.parent?I.parent._reject(q):V&&I.idbtrans&&I.idbtrans.abort(),He(q)})})),this.Version=(_=this,tr(du.prototype,function(E){this.db=_,this._cfg={version:E,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(A=this,tr(cs.prototype,function(E,B,T){if(this.db=A,this._ctx={table:E,index:B===":id"?null:B,or:T},this._cmp=this._ascending=Te,this._descending=function($,O){return Te(O,$)},this._max=function($,O){return 0<Te($,O)?$:O},this._min=function($,O){return Te($,O)<0?$:O},this._IDBKeyRange=A._deps.IDBKeyRange,!this._IDBKeyRange)throw new de.MissingAPI})),this.on("versionchange",function(E){0<E.newVersion?console.warn("Another connection wants to upgrade database '".concat(a.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(a.name,"'. Closing db now to resume the delete request.")),a.close({disableAutoOpen:!1})}),this.on("blocked",function(E){!E.newVersion||E.newVersion<E.oldVersion?console.warn("Dexie.delete('".concat(a.name,"') was blocked")):console.warn("Upgrade '".concat(a.name,"' blocked by other connection holding version ").concat(E.oldVersion/10))}),this._maxKey=ir(i.IDBKeyRange),this._createTransaction=function(E,B,T,$){return new a.Transaction(E,B,T,a._options.chromeTransactionDurability,$)},this._fireOnBlocked=function(E){a.on("blocked").fire(E),nn.filter(function(B){return B.name===a.name&&B!==a&&!B._state.vcFired}).map(function(B){return B.on("versionchange").fire(E)})},this.use(yu),this.use(xu),this.use(gu),this.use(pu),this.use(mu);var R=new Proxy(this,{get:function(E,B,T){if(B==="_vip")return!0;if(B==="table")return function(O){return Wr(a.table(O),R)};var $=Reflect.get(E,B,T);return $ instanceof rs?Wr($,R):B==="tables"?$.map(function(O){return Wr(O,R)}):B==="_createTransaction"?function(){return Wr($.apply(this,arguments),R)}:$}});this.vip=R,l.forEach(function(E){return E(a)})}var Yr,xt=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",bu=(oi.prototype.subscribe=function(n,i,a){return this._subscribe(n&&typeof n!="function"?n:{next:n,error:i,complete:a})},oi.prototype[xt]=function(){return this},oi);function oi(n){this._subscribe=n}try{Yr={indexedDB:c.indexedDB||c.mozIndexedDB||c.webkitIndexedDB||c.msIndexedDB,IDBKeyRange:c.IDBKeyRange||c.webkitIDBKeyRange}}catch{Yr={indexedDB:null,IDBKeyRange:null}}function Es(n){var i,a=!1,l=new bu(function(d){var y=ie(n),x,_=!1,A={},M={},R={get closed(){return _},unsubscribe:function(){_||(_=!0,x&&x.abort(),E&&on.storagemutated.unsubscribe(T))}};d.start&&d.start(R);var E=!1,B=function(){return Gn($)},T=function(O){Lr(A,O),Zo(M,A)&&B()},$=function(){var O,I,q;!_&&Yr.indexedDB&&(A={},O={},x&&x.abort(),x=new AbortController,q=function(V){var Y=Jt();try{y&&tn();var te=Dt(n,V);return te=y?te.finally(kt):te}finally{Y&&en()}}(I={subscr:O,signal:x.signal,requery:B,querier:n,trans:null}),Promise.resolve(q).then(function(V){a=!0,i=V,_||I.signal.aborted||(A={},function(Y){for(var te in Y)if(v(Y,te))return;return 1}(M=O)||E||(on(or,T),E=!0),Gn(function(){return!_&&d.next&&d.next(V)}))},function(V){a=!1,["DatabaseClosedError","AbortError"].includes(V==null?void 0:V.name)||_||Gn(function(){_||d.error&&d.error(V)})}))};return setTimeout(B,0),R});return l.hasValue=function(){return a},l.getValue=function(){return i},l}var mn=Yt;function ii(n){var i=sn;try{sn=!0,on.storagemutated.fire(n),Jo(n,!0)}finally{sn=i}}w(mn,o(o({},Le),{delete:function(n){return new mn(n,{addons:[]}).delete()},exists:function(n){return new mn(n,{addons:[]}).open().then(function(i){return i.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(n){try{return i=mn.dependencies,a=i.indexedDB,i=i.IDBKeyRange,(Yo(a)?Promise.resolve(a.databases()).then(function(l){return l.map(function(d){return d.name}).filter(function(d){return d!==$n})}):Wo(a,i).toCollection().primaryKeys()).then(n)}catch{return He(new de.MissingAPI)}var i,a},defineClass:function(){return function(n){h(this,n)}},ignoreTransaction:function(n){return xe.trans?Vt(xe.transless,n):n()},vip:Xo,async:function(n){return function(){try{var i=ei(n.apply(this,arguments));return i&&typeof i.then=="function"?i:me.resolve(i)}catch(a){return He(a)}}},spawn:function(n,i,a){try{var l=ei(n.apply(a,i||[]));return l&&typeof l.then=="function"?l:me.resolve(l)}catch(d){return He(d)}},currentTransaction:{get:function(){return xe.trans||null}},waitFor:function(n,i){return i=me.resolve(typeof n=="function"?mn.ignoreTransaction(n):n).timeout(i||6e4),xe.trans?xe.trans.waitFor(i):i},Promise:me,debug:{get:function(){return tt},set:function(n){Lt(n)}},derive:N,extend:h,props:w,override:K,Events:er,on,liveQuery:Es,extendObservabilitySet:Lr,getByKeyPath:Q,setByKeyPath:X,delByKeyPath:function(n,i){typeof i=="string"?X(n,i,void 0):"length"in i&&[].map.call(i,function(a){X(n,a,void 0)})},shallowClone:ee,deepClone:se,getObjectDiff:ti,cmp:Te,asap:U,minKey:-1/0,addons:[],connections:nn,errnames:Ae,dependencies:Yr,cache:pn,semVer:"4.0.10",version:"4.0.10".split(".").map(function(n){return parseInt(n)}).reduce(function(n,i,a){return n+i/Math.pow(10,2*a)})})),mn.maxKey=ir(mn.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(on(or,function(n){sn||(n=new CustomEvent(zo,{detail:n}),sn=!0,dispatchEvent(n),sn=!1)}),addEventListener(zo,function(n){n=n.detail,sn||ii(n)}));var On,sn=!1,Ss=function(){};return typeof BroadcastChannel<"u"&&((Ss=function(){(On=new BroadcastChannel(zo)).onmessage=function(n){return n.data&&ii(n.data)}})(),typeof On.unref=="function"&&On.unref(),on(or,function(n){sn||On.postMessage(n)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(n){if(!Yt.disableBfCache&&n.persisted){tt&&console.debug("Dexie: handling persisted pagehide"),On!=null&&On.close();for(var i=0,a=nn;i<a.length;i++)a[i].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(n){!Yt.disableBfCache&&n.persisted&&(tt&&console.debug("Dexie: handling persisted pageshow"),Ss(),ii({all:new ot(-1/0,[[]])}))})),me.rejectionMapper=function(n,i){return!n||n instanceof ge||n instanceof TypeError||n instanceof SyntaxError||!n.name||!Pe[n.name]?n:(i=new Pe[n.name](i||n.message,n),"stack"in n&&k(i,"stack",{get:function(){return this.inner.stack}}),i)},Lt(tt),o(Yt,Object.freeze({__proto__:null,Dexie:Yt,liveQuery:Es,Entity:$r,cmp:Te,PropModSymbol:Wt,PropModification:nr,replacePrefix:function(n,i){return new nr({replacePrefix:[n,i]})},add:function(n){return new nr({add:n})},remove:function(n){return new nr({remove:n})},default:Yt,RangeSet:ot,mergeRanges:cr,rangesOverlap:hs}),{default:Yt}),Yt})})(Jc);var sy=Jc.exports;const Oi=xa(sy),va=Symbol.for("Dexie"),ji=globalThis[va]||(globalThis[va]=Oi);if(Oi.semVer!==ji.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Oi.semVer} and ${ji.semVer}`);class ay extends ji{constructor(){super("TemporalDB"),this.version(1).stores({workflows:"workflowId, parentWorkflowId",activities:"[activityId+workflowId], workflowId"})}}const hn=new ay;async function wa(e){try{await hn.workflows.put(e),console.debug("Workflow added successfully:",e)}catch(t){console.error("Failed to add workflow:",t,e)}}async function wo(e){try{const t=await hn.workflows.get(e);return console.debug("Retrieved Workflow:",t),t}catch(t){console.error("Failed to retrieve workflow:",t);return}}async function cy(e){try{await hn.workflows.delete(e),console.debug(`Deleted Workflow with ID: ${e}`)}catch(t){console.error("Failed to delete workflow:",t)}}async function uy(e){try{await hn.activities.put(e),console.debug("Activity added successfully:",e)}catch(t){console.error("Failed to add activity:",t,e)}}async function ly(e){try{const t=await hn.activities.get(e);return console.debug("Retrieved Activity:",t),t}catch(t){console.error("Failed to retrieve activity:",t);return}}async function fy(e){try{await hn.activities.delete(e),console.debug(`Deleted Activity with ID: ${e}`)}catch(t){console.error("Failed to delete activity:",t)}}async function eu(e){try{return await hn.activities.where("workflowId").equals(e).toArray()}catch(t){return console.error("Failed to retrieve activities by workflowId:",t),[]}}async function tu(e){try{return await hn.workflows.where("parentWorkflowId").equals(e).toArray()}catch(t){return console.error("Failed to retrieve child workflows:",t),[]}}async function dy(e){if(!e)return[];const t=[];for(const r of e)if(r.type==="workflow"||r.type==="childWorkflow"){const o=await wo(r.id);o&&t.push(o)}else if(r.type==="activity"){const o=await ly(r.id);o&&t.push(o)}return t}const hy=()=>{const[e,t]=D.useState(!0),r=D.useRef(null),o=D.useRef(!0),s=D.useCallback((p,m,v,w=.75,g=800)=>{!p||!o.current||p.setCenter(m,v,{zoom:w,duration:g})},[]),c=D.useCallback(p=>{!p||!o.current||p.fitView({padding:.2,duration:800,minZoom:.4})},[]),u=D.useCallback(p=>{r.current=p},[]),f=D.useCallback(()=>{!r.current||!o.current||r.current.fitView({padding:.2,duration:800,minZoom:.4})},[]),h=D.useCallback(p=>{o.current=p,t(p)},[]);return{autoZoomEnabled:e,setAutoZoomEnabled:h,handleZoom:s,fitView:c,onInit:u,onGraphLoad:f}};function py(){const[e,t]=D.useState({nodes:[],edges:[],rootWorkflowId:void 0}),[r,o]=Z.useState(!1),s=D.useRef(e),c=D.useRef(null),u=.4,{autoZoomEnabled:f,setAutoZoomEnabled:h,handleZoom:p,fitView:m,onInit:v,onGraphLoad:w}=hy();D.useEffect(()=>{s.current=e},[e]);const g=async K=>{const C=await S(K),U=C.nodes.find(oe=>oe.id===K);if(!U){console.error(`Root node ${K} not found in graph data.`);return}const Q=C.nodes.filter(oe=>oe.id!==K);U.data.isExpanded=!0;const X=ty(U),{nodes:ee,edges:G}=ga([X],[],K,Q,150,20);t({nodes:ee,edges:G,rootWorkflowId:K}),o(!0),setTimeout(w,100)};D.useCallback(K=>{m(c.current)},[m]);const k=D.useCallback(async K=>{const{nodes:C,edges:U}=await P(K);return new Promise(Q=>{t(X=>{const ee=X.nodes.filter(ne=>!C.includes(ne.id)).map(ne=>ne.id===K?{...ne,data:{...ne.data,isExpanded:!1}}:ne),G=X.edges.filter(ne=>!U.includes(ne.id)),oe={nodes:ee,edges:G};return s.current=oe,Q(oe),oe})})},[]),N=D.useCallback(async K=>{try{const C=s.current,U=C.nodes.find(ee=>ee.id===K);if(!U)return;const Q=C.nodes.filter(ee=>ee.data.parentNodeId===U.data.parentNodeId&&ee.id!==K&&!U.data.groupComponentIds.some(G=>G.id===ee.id)&&ee.data.isExpanded);for(const ee of Q)await k(ee.id);const X=await S(K);t(ee=>{const G=X.nodes.filter(W=>W.id!==K).map(W=>({...W,data:{...W.data,parentNodeId:K}})),oe=ee.nodes.map(W=>W.id===K?{...W,data:{...W.data,isExpanded:!0}}:W),{nodes:ne,edges:le}=ga(oe,ee.edges,K,G),se=X.edges.map(W=>({...W,id:`${W.id}-${Date.now()}`})),b={nodes:ne,edges:[...le,...se]};s.current=b;const L=ne.find(W=>W.id===K),j=ne.filter(W=>W.data.parentNodeId===K);return L&&setTimeout(()=>{const W=j.reduce((z,J)=>Math.max(z,J.position.x),L.position.x),re=(L.position.x+W)/2;p(c.current,re,L.position.y)},50),b})}catch(C){console.error("Error loading child workflow:",C)}},[p,k]),P=async K=>{const C=s.current.nodes.find(ee=>ee.id===K);if(!C)return console.error(`Root node ${K} not found in graph data.`),{nodes:[],edges:[]};const U=new Set,Q=new Set,X=ee=>{ee!==K&&U.add(ee),s.current.edges.forEach(G=>{var oe;if(G.source===ee){const ne=s.current.nodes.find(le=>le.id===G.target);if(!ne){console.error(`Target node ${G.target} not found in graph data.`);return}(ne.data.parentNodeId===K&&!((oe=C.data.groupComponentIds)!=null&&oe.some(le=>le.id===ne.id))||U.has(ne.data.parentNodeId))&&(Q.add(G.id),X(G.target))}})};return X(K),{nodes:Array.from(U),edges:Array.from(Q)}},S=async K=>{const C=await wo(K);if(!C)return console.error(`Workflow ${K} not found`),{nodes:[],edges:[]};const U=await eu(K),Q=await tu(K),X=[C,...U,...Q];return await ry(X)},H=D.useCallback(async K=>{try{const C=s.current.nodes.find(X=>X.id===K);if(!C||!C.data.count)return;const Q=(await dy(C.data.groupComponentIds)).map(X=>({id:X.workflowId||`${K}-batch-${X.id}`,type:"workflowNode",data:{...X,parentNodeId:K,parentWorkflowId:C.data.parentWorkflowId,type:C.data.type,title:X.title||X.workflowType,workflowId:X.workflowId,runId:X.runId,count:1,groupComponentIds:[]},position:{x:0,y:0}}));t(X=>{const ee=new Set,G=L=>{X.edges.forEach(j=>{j.source===L&&(ee.add(j.target),G(j.target))})};G(K);const oe=Q.length*100;C.data.count=1;const{nodes:ne,edges:le}=ny(X.nodes,X.edges,K,Q),b={nodes:ne.map(L=>ee.has(L.id)?{...L,position:{...L.position,y:L.position.y+oe+100}}:L),edges:le};return s.current=b,setTimeout(()=>{p(c.current,C.position.x,C.position.y)},100),b})}catch(C){console.error("Error spreading batch nodes:",C)}},[p]);return{graphData:e,setGraphData:t,onTemporalRootWorkflowDataCollected:g,expandChildWorkflowNode:N,collapseChildWorkflowNode:k,isRootLoaded:r,flowInstance:c,MIN_ZOOM:u,onSpreadBatchNodes:H,autoZoomEnabled:f,setAutoZoomEnabled:h,onInit:v}}const my=(e,t)=>{const r=new Set,o=s=>{r.add(s),e.edges.forEach(c=>{c.source===s&&!r.has(c.target)&&o(c.target)})};return t.forEach(o),Array.from(r)};function yy(e,t){const[r,o]=D.useState(!1),[s,c]=D.useState(null),u=D.useRef(null),f=.4,h=D.useCallback(w=>new Set(my(e,[w])),[e]),p=D.useCallback(w=>{if(!u.current||!w)return;const g=e.nodes.filter(ee=>ee.position.x>=w.position.x);if(g.length===0){u.current.setCenter(w.position.x,w.position.y,{zoom:1,duration:800});return}const k=g.reduce((ee,G)=>({minX:Math.min(ee.minX,G.position.x||0),minY:Math.min(ee.minY,G.position.y||0),maxX:Math.max(ee.maxX,G.position.x||0),maxY:Math.max(ee.maxY,G.position.y||0)}),{minX:w.position.x||0,minY:w.position.y||0,maxX:w.position.x||0,maxY:w.position.y||0});if(Object.values(k).some(isNaN)){console.warn("Invalid bounds detected, falling back to selected node"),u.current.setCenter(w.position.x,w.position.y,{zoom:1,duration:800});return}const N=(k.minX+k.maxX)/2,P=(k.minY+k.maxY)/2,S=100,H=Math.max(k.maxX-k.minX+S*2,100),K=Math.max(k.maxY-k.minY+S*2,100),C=u.current.getViewport(),U=C.width||1e3,Q=C.height||800;let X=Math.min(U/H,Q/K);X=Math.max(f,Math.min(isNaN(X)?1:X,1.5)),u.current.setCenter(isNaN(N)?w.position.x:N,isNaN(P)?w.position.y:P,{zoom:X,duration:800})},[e.nodes]),m=D.useCallback(w=>{if(c(w),!w){t(N=>({...N,nodes:N.nodes.map(P=>({...P,style:{...P.style,opacity:1}}))})),u.current&&u.current.fitView({padding:.2,minZoom:f,duration:800});return}const g=h(w),k=e.nodes.find(N=>N.id===w);t(N=>({...N,nodes:N.nodes.map(P=>({...P,style:{...P.style,opacity:g.has(P.id)?1:.2}}))})),u.current&&k&&setTimeout(()=>{p(k)},50)},[e,t,h,p]),v=D.useCallback(()=>{c(null),t(w=>({...w,nodes:w.nodes.map(g=>({...g,style:{...g.style,opacity:1}}))})),u.current&&u.current.fitView({padding:.2,minZoom:f,duration:800})},[t]);return{showFocus:r,setShowFocus:o,selectedFocusedWorkflow:s,handleFocusChange:m,handleFocusReset:v,flowInstance:u}}const gy=async(e,t)=>{const r=await fetch(`http://localhost:7531/workflow?namespace=${e}&id=${t}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return await r.json()},vy=async()=>{try{return(await fetch("http://localhost:7531/health",{method:"GET"})).status===200}catch{return!1}};function wy({onTemporalRootWorkflowDataCollected:e}){const[t,r]=D.useState(!1),[o,s]=D.useState(!1),c=async p=>{const m=await tu(p);for(const w of m)await c(w.workflowId);const v=await eu(p);for(const w of v)await fy(w.activityId);await cy(p)},u=async p=>{try{s(!0);const m=await wo(p);if(!m){console.error("Workflow not found for refresh");return}await c(p),await h(m.namespace,p),await e(p)}catch(m){console.error("Error refreshing workflow data:",m)}finally{s(!1)}},f=async p=>{if(!await vy())throw new Error("The server is not running. Please start the server and try again.");await h(p.namespace,p.workflowId),r(!1),await e(p.workflowId)},h=async(p,m,v,w,g)=>{if(await wo(m)&&!v){console.debug(`Workflow ${m} already exists in IndexedDB, skipping data collection`);return}const N=await gy(p,m),P=[];for(const S of N)if(S.type==="workflow")S.parentWorkflowId=v,S.workflowTaskCompletedEventId=w,g&&(S.startTime=g),await wa(S);else if(S.type==="childWorkflow"){const H={...S,type:"workflow",parentWorkflowId:m,workflowTaskCompletedEventId:S.workflowTaskCompletedEventId,status:S.status,isPlaceholder:!0,startTime:S.startTime};await wa(H),P.push({namespace:p,workflowId:S.workflowId,parentWorkflowId:m,workflowTaskCompletedEventId:S.workflowTaskCompletedEventId,startTime:S.startTime})}else S.type==="activity"&&await uy(S);for(const S of P)await h(S.namespace,S.workflowId,S.parentWorkflowId,S.workflowTaskCompletedEventId,S.startTime)};return{isTemporalModalOpen:t,setIsTemporalModalOpen:r,onTemporalModalSubmit:f,refreshWorkflowData:u,isRefreshing:o}}function xy({isOpen:e,onClose:t,onSubmit:r}){const[o,s]=D.useState({namespace:"",workflowId:""}),[c,u]=D.useState(!1),[f,h]=D.useState(null);if(!e)return null;const p=async m=>{m.preventDefault(),u(!0),h(null);try{await r(o),t()}catch(v){h(v instanceof Error?v.message:"An error occurred while fetching workflow data")}finally{u(!1)}};return F.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:F.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[F.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[F.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Temporal Workflow Data"}),F.jsx("button",{onClick:t,className:"p-1 hover:bg-gray-100 rounded-full transition-colors",children:F.jsx(Mo,{className:"w-5 h-5 text-gray-500"})})]}),F.jsxs("form",{onSubmit:p,className:"p-4 space-y-4",children:[f&&F.jsx("div",{className:"p-3 bg-red-100 text-red-700 rounded-md text-sm",children:f}),F.jsxs("div",{children:[F.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Namespace"}),F.jsx("input",{type:"text",value:o.namespace,onChange:m=>s(v=>({...v,namespace:m.target.value})),className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,disabled:c})]}),F.jsxs("div",{children:[F.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Workflow ID"}),F.jsx("input",{type:"text",value:o.workflowId,onChange:m=>s(v=>({...v,workflowId:m.target.value})),className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,disabled:c})]}),F.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t mt-4",children:[F.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",disabled:c,children:"Cancel"}),F.jsx("button",{type:"submit",className:"px-4 py-2 text-white bg-blue-500 rounded-md hover:bg-blue-600 transition-colors disabled:bg-blue-300",disabled:c,children:c?"Loading...":"Get Data"})]})]})]})})}function by(){const{graphData:e,setGraphData:t,onTemporalRootWorkflowDataCollected:r,expandChildWorkflowNode:o,collapseChildWorkflowNode:s,isRootLoaded:c,flowInstance:u,MIN_ZOOM:f,onSpreadBatchNodes:h,autoZoomEnabled:p,setAutoZoomEnabled:m,onInit:v}=py(),{showFocus:w,setShowFocus:g,selectedFocusedWorkflow:k,handleFocusChange:N,handleFocusReset:P,flowInstance:S}=yy(e,t),{isTemporalModalOpen:H,setIsTemporalModalOpen:K,onTemporalModalSubmit:C,refreshWorkflowData:U,isRefreshing:Q}=wy({onTemporalRootWorkflowDataCollected:r}),[X,ee]=Z.useState(),[G,oe]=Z.useState(!1),[ne,le]=Z.useState(null),se=W=>{ee(W),oe(!0)},b=()=>{oe(!1),ee(void 0)},L=D.useMemo(()=>({workflowNode:W=>F.jsx(Zm,{...W,expandChildWorkflowNode:o,collapseChildWorkflowNode:s,onSpreadBatchNodes:h,onShowNodeData:se})}),[c]),j=Z.useCallback(W=>{t(re=>({...re,nodes:Pc(W,re.nodes)}))},[t]);return Z.useEffect(()=>{const W=new URLSearchParams(window.location.search),re=W.get("id"),z=W.get("namespace");re&&z&&C({workflowId:re,namespace:z}).catch(J=>{console.error("Error loading workflow from URL params:",J),le(J instanceof Error?J.message:"An error occurred while loading the workflow")})},[]),F.jsxs("div",{className:"w-screen h-screen flex flex-col bg-gray-50",children:[ne&&F.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert",children:[F.jsx("strong",{className:"font-bold",children:"Error: "}),F.jsx("span",{className:"block sm:inline",children:ne}),F.jsxs("button",{className:"absolute top-0 bottom-0 right-0 px-4 py-3",onClick:()=>le(null),children:[F.jsx("span",{className:"sr-only",children:"Dismiss"}),F.jsx(Mo,{className:"h-5 w-5"})]})]}),F.jsx("div",{className:`flex-grow ${G?"h-[calc(100vh-300px)]":"h-full"}`,children:F.jsxs(Yc,{nodes:e.nodes,edges:e.edges,onNodesChange:j,nodeTypes:L,fitView:!1,minZoom:f,className:"bg-gray-50",onInit:W=>{u.current=W,S.current=W,v(W)},children:[F.jsx(Hm,{}),F.jsx(Om,{}),F.jsx(Tm,{}),F.jsx(Co,{position:"top-right",className:"bg-white p-2 rounded-lg shadow-lg",children:F.jsx(Qm,{showFocus:w,setShowFocus:g,autoZoomEnabled:p,setAutoZoomEnabled:m,setIsTemporalModalOpen:K,refreshWorkflowData:U,currentWorkflowId:e.rootWorkflowId,isRefreshing:Q})})]})}),F.jsx(Jm,{data:X,isOpen:G,onClose:b}),w&&F.jsx(Gm,{nodes:e.nodes,onFocusChange:N,selectedWorkflow:k,onReset:P,onClose:()=>g(!1)}),F.jsx(xy,{isOpen:H,onClose:()=>K(!1),onSubmit:C})]})}Ea(document.getElementById("root")).render(F.jsx(D.StrictMode,{children:F.jsx(by,{})}));
