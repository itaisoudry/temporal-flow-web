import{r as $,a as Au,g as ka,R as X,c as Is}from"./vendor-wpXbf5jk.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();var Sa={exports:{}},_o={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tu=$,Iu=Symbol.for("react.element"),Mu=Symbol.for("react.fragment"),Pu=Object.prototype.hasOwnProperty,Du=Tu.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ru={key:!0,ref:!0,__self:!0,__source:!0};function Na(e,t,r){var o,s={},a=null,u=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(u=t.ref);for(o in t)Pu.call(t,o)&&!Ru.hasOwnProperty(o)&&(s[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps,t)s[o]===void 0&&(s[o]=t[o]);return{$$typeof:Iu,type:e,key:a,ref:u,props:s,_owner:Du.current}}_o.Fragment=Mu;_o.jsx=Na;_o.jsxs=Na;Sa.exports=_o;var N=Sa.exports,Ca,Ms=Au;Ca=Ms.createRoot,Ms.hydrateRoot;function et(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let r=0,o;r<e.length;r++)(o=et(e[r]))!==""&&(t+=(t&&" ")+o);else for(let r in e)e[r]&&(t+=(t&&" ")+r);return t}var Aa={exports:{}},Ta={},Ia={exports:{}},Ma={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vn=$;function $u(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ou=typeof Object.is=="function"?Object.is:$u,ju=Vn.useState,Bu=Vn.useEffect,Fu=Vn.useLayoutEffect,zu=Vn.useDebugValue;function Lu(e,t){var r=t(),o=ju({inst:{value:r,getSnapshot:t}}),s=o[0].inst,a=o[1];return Fu(function(){s.value=r,s.getSnapshot=t,li(s)&&a({inst:s})},[e,r,t]),Bu(function(){return li(s)&&a({inst:s}),e(function(){li(s)&&a({inst:s})})},[e]),zu(r),r}function li(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Ou(e,r)}catch{return!0}}function Ku(e,t){return t()}var Hu=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Ku:Lu;Ma.useSyncExternalStore=Vn.useSyncExternalStore!==void 0?Vn.useSyncExternalStore:Hu;Ia.exports=Ma;var qu=Ia.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Eo=$,Wu=qu;function Vu(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Yu=typeof Object.is=="function"?Object.is:Vu,Uu=Wu.useSyncExternalStore,Xu=Eo.useRef,Gu=Eo.useEffect,Zu=Eo.useMemo,Qu=Eo.useDebugValue;Ta.useSyncExternalStoreWithSelector=function(e,t,r,o,s){var a=Xu(null);if(a.current===null){var u={hasValue:!1,value:null};a.current=u}else u=a.current;a=Zu(function(){function d(g){if(!p){if(p=!0,m=g,g=o(g),s!==void 0&&u.hasValue){var k=u.value;if(s(k,g))return v=k}return v=g}if(k=v,Yu(m,g))return k;var S=o(g);return s!==void 0&&s(k,S)?k:(m=g,v=S)}var p=!1,m,v,w=r===void 0?null:r;return[function(){return d(t())},w===null?void 0:function(){return d(w())}]},[t,r,o,s]);var l=Uu(e,a[0],a[1]);return Gu(function(){u.hasValue=!0,u.value=l},[l]),Qu(l),l};Aa.exports=Ta;var Ju=Aa.exports;const el=ka(Ju),tl={BASE_URL:"./",DEV:!1,MODE:"production",PROD:!0,SSR:!1},Ps=e=>{let t;const r=new Set,o=(m,v)=>{const w=typeof m=="function"?m(t):m;if(!Object.is(w,t)){const g=t;t=v??(typeof w!="object"||w===null)?w:Object.assign({},t,w),r.forEach(k=>k(t,g))}},s=()=>t,d={setState:o,getState:s,getInitialState:()=>p,subscribe:m=>(r.add(m),()=>r.delete(m)),destroy:()=>{(tl?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},p=t=e(o,s,d);return d},nl=e=>e?Ps(e):Ps,{useDebugValue:rl}=X,{useSyncExternalStoreWithSelector:ol}=el,il=e=>e;function Pa(e,t=il,r){const o=ol(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return rl(o),o}const Ds=(e,t)=>{const r=nl(e),o=(s,a=t)=>Pa(r,s,a);return Object.assign(o,r),o},sl=(e,t)=>e?Ds(e,t):Ds;function Qe(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[o,s]of e)if(!Object.is(s,t.get(o)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const o of e)if(!t.has(o))return!1;return!0}const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!1;for(const o of r)if(!Object.prototype.hasOwnProperty.call(t,o)||!Object.is(e[o],t[o]))return!1;return!0}var al={value:()=>{}};function ko(){for(var e=0,t=arguments.length,r={},o;e<t;++e){if(!(o=arguments[e]+"")||o in r||/[\s.]/.test(o))throw new Error("illegal type: "+o);r[o]=[]}return new co(r)}function co(e){this._=e}function cl(e,t){return e.trim().split(/^|\s+/).map(function(r){var o="",s=r.indexOf(".");if(s>=0&&(o=r.slice(s+1),r=r.slice(0,s)),r&&!t.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:o}})}co.prototype=ko.prototype={constructor:co,on:function(e,t){var r=this._,o=cl(e+"",r),s,a=-1,u=o.length;if(arguments.length<2){for(;++a<u;)if((s=(e=o[a]).type)&&(s=ul(r[s],e.name)))return s;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++a<u;)if(s=(e=o[a]).type)r[s]=Rs(r[s],e.name,t);else if(t==null)for(s in r)r[s]=Rs(r[s],e.name,null);return this},copy:function(){var e={},t=this._;for(var r in t)e[r]=t[r].slice();return new co(e)},call:function(e,t){if((s=arguments.length-2)>0)for(var r=new Array(s),o=0,s,a;o<s;++o)r[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(a=this._[e],o=0,s=a.length;o<s;++o)a[o].value.apply(t,r)},apply:function(e,t,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var o=this._[e],s=0,a=o.length;s<a;++s)o[s].value.apply(t,r)}};function ul(e,t){for(var r=0,o=e.length,s;r<o;++r)if((s=e[r]).name===t)return s.value}function Rs(e,t,r){for(var o=0,s=e.length;o<s;++o)if(e[o].name===t){e[o]=al,e=e.slice(0,o).concat(e.slice(o+1));break}return r!=null&&e.push({name:t,value:r}),e}var bi="http://www.w3.org/1999/xhtml";const $s={svg:"http://www.w3.org/2000/svg",xhtml:bi,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function So(e){var t=e+="",r=t.indexOf(":");return r>=0&&(t=e.slice(0,r))!=="xmlns"&&(e=e.slice(r+1)),$s.hasOwnProperty(t)?{space:$s[t],local:e}:e}function ll(e){return function(){var t=this.ownerDocument,r=this.namespaceURI;return r===bi&&t.documentElement.namespaceURI===bi?t.createElement(e):t.createElementNS(r,e)}}function fl(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Da(e){var t=So(e);return(t.local?fl:ll)(t)}function dl(){}function Hi(e){return e==null?dl:function(){return this.querySelector(e)}}function hl(e){typeof e!="function"&&(e=Hi(e));for(var t=this._groups,r=t.length,o=new Array(r),s=0;s<r;++s)for(var a=t[s],u=a.length,l=o[s]=new Array(u),d,p,m=0;m<u;++m)(d=a[m])&&(p=e.call(d,d.__data__,m,a))&&("__data__"in d&&(p.__data__=d.__data__),l[m]=p);return new mt(o,this._parents)}function pl(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function ml(){return[]}function Ra(e){return e==null?ml:function(){return this.querySelectorAll(e)}}function yl(e){return function(){return pl(e.apply(this,arguments))}}function gl(e){typeof e=="function"?e=yl(e):e=Ra(e);for(var t=this._groups,r=t.length,o=[],s=[],a=0;a<r;++a)for(var u=t[a],l=u.length,d,p=0;p<l;++p)(d=u[p])&&(o.push(e.call(d,d.__data__,p,u)),s.push(d));return new mt(o,s)}function $a(e){return function(){return this.matches(e)}}function Oa(e){return function(t){return t.matches(e)}}var vl=Array.prototype.find;function wl(e){return function(){return vl.call(this.children,e)}}function xl(){return this.firstElementChild}function bl(e){return this.select(e==null?xl:wl(typeof e=="function"?e:Oa(e)))}var _l=Array.prototype.filter;function El(){return Array.from(this.children)}function kl(e){return function(){return _l.call(this.children,e)}}function Sl(e){return this.selectAll(e==null?El:kl(typeof e=="function"?e:Oa(e)))}function Nl(e){typeof e!="function"&&(e=$a(e));for(var t=this._groups,r=t.length,o=new Array(r),s=0;s<r;++s)for(var a=t[s],u=a.length,l=o[s]=[],d,p=0;p<u;++p)(d=a[p])&&e.call(d,d.__data__,p,a)&&l.push(d);return new mt(o,this._parents)}function ja(e){return new Array(e.length)}function Cl(){return new mt(this._enter||this._groups.map(ja),this._parents)}function ho(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}ho.prototype={constructor:ho,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Al(e){return function(){return e}}function Tl(e,t,r,o,s,a){for(var u=0,l,d=t.length,p=a.length;u<p;++u)(l=t[u])?(l.__data__=a[u],o[u]=l):r[u]=new ho(e,a[u]);for(;u<d;++u)(l=t[u])&&(s[u]=l)}function Il(e,t,r,o,s,a,u){var l,d,p=new Map,m=t.length,v=a.length,w=new Array(m),g;for(l=0;l<m;++l)(d=t[l])&&(w[l]=g=u.call(d,d.__data__,l,t)+"",p.has(g)?s[l]=d:p.set(g,d));for(l=0;l<v;++l)g=u.call(e,a[l],l,a)+"",(d=p.get(g))?(o[l]=d,d.__data__=a[l],p.delete(g)):r[l]=new ho(e,a[l]);for(l=0;l<m;++l)(d=t[l])&&p.get(w[l])===d&&(s[l]=d)}function Ml(e){return e.__data__}function Pl(e,t){if(!arguments.length)return Array.from(this,Ml);var r=t?Il:Tl,o=this._parents,s=this._groups;typeof e!="function"&&(e=Al(e));for(var a=s.length,u=new Array(a),l=new Array(a),d=new Array(a),p=0;p<a;++p){var m=o[p],v=s[p],w=v.length,g=Dl(e.call(m,m&&m.__data__,p,o)),k=g.length,S=l[p]=new Array(k),O=u[p]=new Array(k),T=d[p]=new Array(w);r(m,v,S,O,T,g,t);for(var K=0,z=0,C,U;K<k;++K)if(C=S[K]){for(K>=z&&(z=K+1);!(U=O[z])&&++z<k;);C._next=U||null}}return u=new mt(u,o),u._enter=l,u._exit=d,u}function Dl(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Rl(){return new mt(this._exit||this._groups.map(ja),this._parents)}function $l(e,t,r){var o=this.enter(),s=this,a=this.exit();return typeof e=="function"?(o=e(o),o&&(o=o.selection())):o=o.append(e+""),t!=null&&(s=t(s),s&&(s=s.selection())),r==null?a.remove():r(a),o&&s?o.merge(s).order():s}function Ol(e){for(var t=e.selection?e.selection():e,r=this._groups,o=t._groups,s=r.length,a=o.length,u=Math.min(s,a),l=new Array(s),d=0;d<u;++d)for(var p=r[d],m=o[d],v=p.length,w=l[d]=new Array(v),g,k=0;k<v;++k)(g=p[k]||m[k])&&(w[k]=g);for(;d<s;++d)l[d]=r[d];return new mt(l,this._parents)}function jl(){for(var e=this._groups,t=-1,r=e.length;++t<r;)for(var o=e[t],s=o.length-1,a=o[s],u;--s>=0;)(u=o[s])&&(a&&u.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(u,a),a=u);return this}function Bl(e){e||(e=Fl);function t(v,w){return v&&w?e(v.__data__,w.__data__):!v-!w}for(var r=this._groups,o=r.length,s=new Array(o),a=0;a<o;++a){for(var u=r[a],l=u.length,d=s[a]=new Array(l),p,m=0;m<l;++m)(p=u[m])&&(d[m]=p);d.sort(t)}return new mt(s,this._parents).order()}function Fl(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function zl(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Ll(){return Array.from(this)}function Kl(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var o=e[t],s=0,a=o.length;s<a;++s){var u=o[s];if(u)return u}return null}function Hl(){let e=0;for(const t of this)++e;return e}function ql(){return!this.node()}function Wl(e){for(var t=this._groups,r=0,o=t.length;r<o;++r)for(var s=t[r],a=0,u=s.length,l;a<u;++a)(l=s[a])&&e.call(l,l.__data__,a,s);return this}function Vl(e){return function(){this.removeAttribute(e)}}function Yl(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Ul(e,t){return function(){this.setAttribute(e,t)}}function Xl(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Gl(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttribute(e):this.setAttribute(e,r)}}function Zl(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}}function Ql(e,t){var r=So(e);if(arguments.length<2){var o=this.node();return r.local?o.getAttributeNS(r.space,r.local):o.getAttribute(r)}return this.each((t==null?r.local?Yl:Vl:typeof t=="function"?r.local?Zl:Gl:r.local?Xl:Ul)(r,t))}function Ba(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Jl(e){return function(){this.style.removeProperty(e)}}function ef(e,t,r){return function(){this.style.setProperty(e,t,r)}}function tf(e,t,r){return function(){var o=t.apply(this,arguments);o==null?this.style.removeProperty(e):this.style.setProperty(e,o,r)}}function nf(e,t,r){return arguments.length>1?this.each((t==null?Jl:typeof t=="function"?tf:ef)(e,t,r??"")):Yn(this.node(),e)}function Yn(e,t){return e.style.getPropertyValue(t)||Ba(e).getComputedStyle(e,null).getPropertyValue(t)}function rf(e){return function(){delete this[e]}}function of(e,t){return function(){this[e]=t}}function sf(e,t){return function(){var r=t.apply(this,arguments);r==null?delete this[e]:this[e]=r}}function af(e,t){return arguments.length>1?this.each((t==null?rf:typeof t=="function"?sf:of)(e,t)):this.node()[e]}function Fa(e){return e.trim().split(/^|\s+/)}function qi(e){return e.classList||new za(e)}function za(e){this._node=e,this._names=Fa(e.getAttribute("class")||"")}za.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function La(e,t){for(var r=qi(e),o=-1,s=t.length;++o<s;)r.add(t[o])}function Ka(e,t){for(var r=qi(e),o=-1,s=t.length;++o<s;)r.remove(t[o])}function cf(e){return function(){La(this,e)}}function uf(e){return function(){Ka(this,e)}}function lf(e,t){return function(){(t.apply(this,arguments)?La:Ka)(this,e)}}function ff(e,t){var r=Fa(e+"");if(arguments.length<2){for(var o=qi(this.node()),s=-1,a=r.length;++s<a;)if(!o.contains(r[s]))return!1;return!0}return this.each((typeof t=="function"?lf:t?cf:uf)(r,t))}function df(){this.textContent=""}function hf(e){return function(){this.textContent=e}}function pf(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function mf(e){return arguments.length?this.each(e==null?df:(typeof e=="function"?pf:hf)(e)):this.node().textContent}function yf(){this.innerHTML=""}function gf(e){return function(){this.innerHTML=e}}function vf(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function wf(e){return arguments.length?this.each(e==null?yf:(typeof e=="function"?vf:gf)(e)):this.node().innerHTML}function xf(){this.nextSibling&&this.parentNode.appendChild(this)}function bf(){return this.each(xf)}function _f(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Ef(){return this.each(_f)}function kf(e){var t=typeof e=="function"?e:Da(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Sf(){return null}function Nf(e,t){var r=typeof e=="function"?e:Da(e),o=t==null?Sf:typeof t=="function"?t:Hi(t);return this.select(function(){return this.insertBefore(r.apply(this,arguments),o.apply(this,arguments)||null)})}function Cf(){var e=this.parentNode;e&&e.removeChild(this)}function Af(){return this.each(Cf)}function Tf(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function If(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Mf(e){return this.select(e?If:Tf)}function Pf(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Df(e){return function(t){e.call(this,t,this.__data__)}}function Rf(e){return e.trim().split(/^|\s+/).map(function(t){var r="",o=t.indexOf(".");return o>=0&&(r=t.slice(o+1),t=t.slice(0,o)),{type:t,name:r}})}function $f(e){return function(){var t=this.__on;if(t){for(var r=0,o=-1,s=t.length,a;r<s;++r)a=t[r],(!e.type||a.type===e.type)&&a.name===e.name?this.removeEventListener(a.type,a.listener,a.options):t[++o]=a;++o?t.length=o:delete this.__on}}}function Of(e,t,r){return function(){var o=this.__on,s,a=Df(t);if(o){for(var u=0,l=o.length;u<l;++u)if((s=o[u]).type===e.type&&s.name===e.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=a,s.options=r),s.value=t;return}}this.addEventListener(e.type,a,r),s={type:e.type,name:e.name,value:t,listener:a,options:r},o?o.push(s):this.__on=[s]}}function jf(e,t,r){var o=Rf(e+""),s,a=o.length,u;if(arguments.length<2){var l=this.node().__on;if(l){for(var d=0,p=l.length,m;d<p;++d)for(s=0,m=l[d];s<a;++s)if((u=o[s]).type===m.type&&u.name===m.name)return m.value}return}for(l=t?Of:$f,s=0;s<a;++s)this.each(l(o[s],t,r));return this}function Ha(e,t,r){var o=Ba(e),s=o.CustomEvent;typeof s=="function"?s=new s(t,r):(s=o.document.createEvent("Event"),r?(s.initEvent(t,r.bubbles,r.cancelable),s.detail=r.detail):s.initEvent(t,!1,!1)),e.dispatchEvent(s)}function Bf(e,t){return function(){return Ha(this,e,t)}}function Ff(e,t){return function(){return Ha(this,e,t.apply(this,arguments))}}function zf(e,t){return this.each((typeof t=="function"?Ff:Bf)(e,t))}function*Lf(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var o=e[t],s=0,a=o.length,u;s<a;++s)(u=o[s])&&(yield u)}var qa=[null];function mt(e,t){this._groups=e,this._parents=t}function Nr(){return new mt([[document.documentElement]],qa)}function Kf(){return this}mt.prototype=Nr.prototype={constructor:mt,select:hl,selectAll:gl,selectChild:bl,selectChildren:Sl,filter:Nl,data:Pl,enter:Cl,exit:Rl,join:$l,merge:Ol,selection:Kf,order:jl,sort:Bl,call:zl,nodes:Ll,node:Kl,size:Hl,empty:ql,each:Wl,attr:Ql,style:nf,property:af,classed:ff,text:mf,html:wf,raise:bf,lower:Ef,append:kf,insert:Nf,remove:Af,clone:Mf,datum:Pf,on:jf,dispatch:zf,[Symbol.iterator]:Lf};function bt(e){return typeof e=="string"?new mt([[document.querySelector(e)]],[document.documentElement]):new mt([[e]],qa)}function Hf(e){let t;for(;t=e.sourceEvent;)e=t;return e}function Ct(e,t){if(e=Hf(e),t===void 0&&(t=e.currentTarget),t){var r=t.ownerSVGElement||t;if(r.createSVGPoint){var o=r.createSVGPoint();return o.x=e.clientX,o.y=e.clientY,o=o.matrixTransform(t.getScreenCTM().inverse()),[o.x,o.y]}if(t.getBoundingClientRect){var s=t.getBoundingClientRect();return[e.clientX-s.left-t.clientLeft,e.clientY-s.top-t.clientTop]}}return[e.pageX,e.pageY]}const qf={passive:!1},vr={capture:!0,passive:!1};function fi(e){e.stopImmediatePropagation()}function Hn(e){e.preventDefault(),e.stopImmediatePropagation()}function Wa(e){var t=e.document.documentElement,r=bt(e).on("dragstart.drag",Hn,vr);"onselectstart"in t?r.on("selectstart.drag",Hn,vr):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Va(e,t){var r=e.document.documentElement,o=bt(e).on("dragstart.drag",null);t&&(o.on("click.drag",Hn,vr),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in r?o.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}const Qr=e=>()=>e;function _i(e,{sourceEvent:t,subject:r,target:o,identifier:s,active:a,x:u,y:l,dx:d,dy:p,dispatch:m}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:a,enumerable:!0,configurable:!0},x:{value:u,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:d,enumerable:!0,configurable:!0},dy:{value:p,enumerable:!0,configurable:!0},_:{value:m}})}_i.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Wf(e){return!e.ctrlKey&&!e.button}function Vf(){return this.parentNode}function Yf(e,t){return t??{x:e.x,y:e.y}}function Uf(){return navigator.maxTouchPoints||"ontouchstart"in this}function Xf(){var e=Wf,t=Vf,r=Yf,o=Uf,s={},a=ko("start","drag","end"),u=0,l,d,p,m,v=0;function w(C){C.on("mousedown.drag",g).filter(o).on("touchstart.drag",O).on("touchmove.drag",T,qf).on("touchend.drag touchcancel.drag",K).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function g(C,U){if(!(m||!e.call(this,C,U))){var Q=z(this,t.call(this,C,U),C,U,"mouse");Q&&(bt(C.view).on("mousemove.drag",k,vr).on("mouseup.drag",S,vr),Wa(C.view),fi(C),p=!1,l=C.clientX,d=C.clientY,Q("start",C))}}function k(C){if(Hn(C),!p){var U=C.clientX-l,Q=C.clientY-d;p=U*U+Q*Q>v}s.mouse("drag",C)}function S(C){bt(C.view).on("mousemove.drag mouseup.drag",null),Va(C.view,p),Hn(C),s.mouse("end",C)}function O(C,U){if(e.call(this,C,U)){var Q=C.changedTouches,Y=t.call(this,C,U),ee=Q.length,G,ne;for(G=0;G<ee;++G)(ne=z(this,Y,C,U,Q[G].identifier,Q[G]))&&(fi(C),ne("start",C,Q[G]))}}function T(C){var U=C.changedTouches,Q=U.length,Y,ee;for(Y=0;Y<Q;++Y)(ee=s[U[Y].identifier])&&(Hn(C),ee("drag",C,U[Y]))}function K(C){var U=C.changedTouches,Q=U.length,Y,ee;for(m&&clearTimeout(m),m=setTimeout(function(){m=null},500),Y=0;Y<Q;++Y)(ee=s[U[Y].identifier])&&(fi(C),ee("end",C,U[Y]))}function z(C,U,Q,Y,ee,G){var ne=a.copy(),oe=Ct(G||Q,U),le,se,b;if((b=r.call(C,new _i("beforestart",{sourceEvent:Q,target:w,identifier:ee,active:u,x:oe[0],y:oe[1],dx:0,dy:0,dispatch:ne}),Y))!=null)return le=b.x-oe[0]||0,se=b.y-oe[1]||0,function q(j,re,J){var L=oe,Z;switch(j){case"start":s[ee]=q,Z=u++;break;case"end":delete s[ee],--u;case"drag":oe=Ct(J||re,U),Z=u;break}ne.call(j,C,new _i(j,{sourceEvent:re,subject:b,target:w,identifier:ee,active:Z,x:oe[0]+le,y:oe[1]+se,dx:oe[0]-L[0],dy:oe[1]-L[1],dispatch:ne}),Y)}}return w.filter=function(C){return arguments.length?(e=typeof C=="function"?C:Qr(!!C),w):e},w.container=function(C){return arguments.length?(t=typeof C=="function"?C:Qr(C),w):t},w.subject=function(C){return arguments.length?(r=typeof C=="function"?C:Qr(C),w):r},w.touchable=function(C){return arguments.length?(o=typeof C=="function"?C:Qr(!!C),w):o},w.on=function(){var C=a.on.apply(a,arguments);return C===a?w:C},w.clickDistance=function(C){return arguments.length?(v=(C=+C)*C,w):Math.sqrt(v)},w}function Wi(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function Ya(e,t){var r=Object.create(e.prototype);for(var o in t)r[o]=t[o];return r}function Cr(){}var wr=.7,po=1/wr,qn="\\s*([+-]?\\d+)\\s*",xr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Lt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Gf=/^#([0-9a-f]{3,8})$/,Zf=new RegExp(`^rgb\\(${qn},${qn},${qn}\\)$`),Qf=new RegExp(`^rgb\\(${Lt},${Lt},${Lt}\\)$`),Jf=new RegExp(`^rgba\\(${qn},${qn},${qn},${xr}\\)$`),ed=new RegExp(`^rgba\\(${Lt},${Lt},${Lt},${xr}\\)$`),td=new RegExp(`^hsl\\(${xr},${Lt},${Lt}\\)$`),nd=new RegExp(`^hsla\\(${xr},${Lt},${Lt},${xr}\\)$`),Os={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Wi(Cr,br,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:js,formatHex:js,formatHex8:rd,formatHsl:od,formatRgb:Bs,toString:Bs});function js(){return this.rgb().formatHex()}function rd(){return this.rgb().formatHex8()}function od(){return Ua(this).formatHsl()}function Bs(){return this.rgb().formatRgb()}function br(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=Gf.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?Fs(t):r===3?new ft(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Jr(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Jr(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Zf.exec(e))?new ft(t[1],t[2],t[3],1):(t=Qf.exec(e))?new ft(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Jf.exec(e))?Jr(t[1],t[2],t[3],t[4]):(t=ed.exec(e))?Jr(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=td.exec(e))?Ks(t[1],t[2]/100,t[3]/100,1):(t=nd.exec(e))?Ks(t[1],t[2]/100,t[3]/100,t[4]):Os.hasOwnProperty(e)?Fs(Os[e]):e==="transparent"?new ft(NaN,NaN,NaN,0):null}function Fs(e){return new ft(e>>16&255,e>>8&255,e&255,1)}function Jr(e,t,r,o){return o<=0&&(e=t=r=NaN),new ft(e,t,r,o)}function id(e){return e instanceof Cr||(e=br(e)),e?(e=e.rgb(),new ft(e.r,e.g,e.b,e.opacity)):new ft}function Ei(e,t,r,o){return arguments.length===1?id(e):new ft(e,t,r,o??1)}function ft(e,t,r,o){this.r=+e,this.g=+t,this.b=+r,this.opacity=+o}Wi(ft,Ei,Ya(Cr,{brighter(e){return e=e==null?po:Math.pow(po,e),new ft(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?wr:Math.pow(wr,e),new ft(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ft(bn(this.r),bn(this.g),bn(this.b),mo(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:zs,formatHex:zs,formatHex8:sd,formatRgb:Ls,toString:Ls}));function zs(){return`#${wn(this.r)}${wn(this.g)}${wn(this.b)}`}function sd(){return`#${wn(this.r)}${wn(this.g)}${wn(this.b)}${wn((isNaN(this.opacity)?1:this.opacity)*255)}`}function Ls(){const e=mo(this.opacity);return`${e===1?"rgb(":"rgba("}${bn(this.r)}, ${bn(this.g)}, ${bn(this.b)}${e===1?")":`, ${e})`}`}function mo(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function bn(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function wn(e){return e=bn(e),(e<16?"0":"")+e.toString(16)}function Ks(e,t,r,o){return o<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new At(e,t,r,o)}function Ua(e){if(e instanceof At)return new At(e.h,e.s,e.l,e.opacity);if(e instanceof Cr||(e=br(e)),!e)return new At;if(e instanceof At)return e;e=e.rgb();var t=e.r/255,r=e.g/255,o=e.b/255,s=Math.min(t,r,o),a=Math.max(t,r,o),u=NaN,l=a-s,d=(a+s)/2;return l?(t===a?u=(r-o)/l+(r<o)*6:r===a?u=(o-t)/l+2:u=(t-r)/l+4,l/=d<.5?a+s:2-a-s,u*=60):l=d>0&&d<1?0:u,new At(u,l,d,e.opacity)}function ad(e,t,r,o){return arguments.length===1?Ua(e):new At(e,t,r,o??1)}function At(e,t,r,o){this.h=+e,this.s=+t,this.l=+r,this.opacity=+o}Wi(At,ad,Ya(Cr,{brighter(e){return e=e==null?po:Math.pow(po,e),new At(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?wr:Math.pow(wr,e),new At(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,o=r+(r<.5?r:1-r)*t,s=2*r-o;return new ft(di(e>=240?e-240:e+120,s,o),di(e,s,o),di(e<120?e+240:e-120,s,o),this.opacity)},clamp(){return new At(Hs(this.h),eo(this.s),eo(this.l),mo(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=mo(this.opacity);return`${e===1?"hsl(":"hsla("}${Hs(this.h)}, ${eo(this.s)*100}%, ${eo(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Hs(e){return e=(e||0)%360,e<0?e+360:e}function eo(e){return Math.max(0,Math.min(1,e||0))}function di(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const Xa=e=>()=>e;function cd(e,t){return function(r){return e+r*t}}function ud(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(o){return Math.pow(e+o*t,r)}}function ld(e){return(e=+e)==1?Ga:function(t,r){return r-t?ud(t,r,e):Xa(isNaN(t)?r:t)}}function Ga(e,t){var r=t-e;return r?cd(e,r):Xa(isNaN(e)?t:e)}const qs=function e(t){var r=ld(t);function o(s,a){var u=r((s=Ei(s)).r,(a=Ei(a)).r),l=r(s.g,a.g),d=r(s.b,a.b),p=Ga(s.opacity,a.opacity);return function(m){return s.r=u(m),s.g=l(m),s.b=d(m),s.opacity=p(m),s+""}}return o.gamma=e,o}(1);function ln(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}var ki=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,hi=new RegExp(ki.source,"g");function fd(e){return function(){return e}}function dd(e){return function(t){return e(t)+""}}function hd(e,t){var r=ki.lastIndex=hi.lastIndex=0,o,s,a,u=-1,l=[],d=[];for(e=e+"",t=t+"";(o=ki.exec(e))&&(s=hi.exec(t));)(a=s.index)>r&&(a=t.slice(r,a),l[u]?l[u]+=a:l[++u]=a),(o=o[0])===(s=s[0])?l[u]?l[u]+=s:l[++u]=s:(l[++u]=null,d.push({i:u,x:ln(o,s)})),r=hi.lastIndex;return r<t.length&&(a=t.slice(r),l[u]?l[u]+=a:l[++u]=a),l.length<2?d[0]?dd(d[0].x):fd(t):(t=d.length,function(p){for(var m=0,v;m<t;++m)l[(v=d[m]).i]=v.x(p);return l.join("")})}var Ws=180/Math.PI,Si={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Za(e,t,r,o,s,a){var u,l,d;return(u=Math.sqrt(e*e+t*t))&&(e/=u,t/=u),(d=e*r+t*o)&&(r-=e*d,o-=t*d),(l=Math.sqrt(r*r+o*o))&&(r/=l,o/=l,d/=l),e*o<t*r&&(e=-e,t=-t,d=-d,u=-u),{translateX:s,translateY:a,rotate:Math.atan2(t,e)*Ws,skewX:Math.atan(d)*Ws,scaleX:u,scaleY:l}}var to;function pd(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Si:Za(t.a,t.b,t.c,t.d,t.e,t.f)}function md(e){return e==null||(to||(to=document.createElementNS("http://www.w3.org/2000/svg","g")),to.setAttribute("transform",e),!(e=to.transform.baseVal.consolidate()))?Si:(e=e.matrix,Za(e.a,e.b,e.c,e.d,e.e,e.f))}function Qa(e,t,r,o){function s(p){return p.length?p.pop()+" ":""}function a(p,m,v,w,g,k){if(p!==v||m!==w){var S=g.push("translate(",null,t,null,r);k.push({i:S-4,x:ln(p,v)},{i:S-2,x:ln(m,w)})}else(v||w)&&g.push("translate("+v+t+w+r)}function u(p,m,v,w){p!==m?(p-m>180?m+=360:m-p>180&&(p+=360),w.push({i:v.push(s(v)+"rotate(",null,o)-2,x:ln(p,m)})):m&&v.push(s(v)+"rotate("+m+o)}function l(p,m,v,w){p!==m?w.push({i:v.push(s(v)+"skewX(",null,o)-2,x:ln(p,m)}):m&&v.push(s(v)+"skewX("+m+o)}function d(p,m,v,w,g,k){if(p!==v||m!==w){var S=g.push(s(g)+"scale(",null,",",null,")");k.push({i:S-4,x:ln(p,v)},{i:S-2,x:ln(m,w)})}else(v!==1||w!==1)&&g.push(s(g)+"scale("+v+","+w+")")}return function(p,m){var v=[],w=[];return p=e(p),m=e(m),a(p.translateX,p.translateY,m.translateX,m.translateY,v,w),u(p.rotate,m.rotate,v,w),l(p.skewX,m.skewX,v,w),d(p.scaleX,p.scaleY,m.scaleX,m.scaleY,v,w),p=m=null,function(g){for(var k=-1,S=w.length,O;++k<S;)v[(O=w[k]).i]=O.x(g);return v.join("")}}}var yd=Qa(pd,"px, ","px)","deg)"),gd=Qa(md,", ",")",")"),vd=1e-12;function Vs(e){return((e=Math.exp(e))+1/e)/2}function wd(e){return((e=Math.exp(e))-1/e)/2}function xd(e){return((e=Math.exp(2*e))-1)/(e+1)}const bd=function e(t,r,o){function s(a,u){var l=a[0],d=a[1],p=a[2],m=u[0],v=u[1],w=u[2],g=m-l,k=v-d,S=g*g+k*k,O,T;if(S<vd)T=Math.log(w/p)/t,O=function(Y){return[l+Y*g,d+Y*k,p*Math.exp(t*Y*T)]};else{var K=Math.sqrt(S),z=(w*w-p*p+o*S)/(2*p*r*K),C=(w*w-p*p-o*S)/(2*w*r*K),U=Math.log(Math.sqrt(z*z+1)-z),Q=Math.log(Math.sqrt(C*C+1)-C);T=(Q-U)/t,O=function(Y){var ee=Y*T,G=Vs(U),ne=p/(r*K)*(G*xd(t*ee+U)-wd(U));return[l+ne*g,d+ne*k,p*G/Vs(t*ee+U)]}}return O.duration=T*1e3*t/Math.SQRT2,O}return s.rho=function(a){var u=Math.max(.001,+a),l=u*u,d=l*l;return e(u,l,d)},s}(Math.SQRT2,2,4);var Un=0,mr=0,lr=0,Ja=1e3,yo,yr,go=0,En=0,No=0,_r=typeof performance=="object"&&performance.now?performance:Date,ec=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Vi(){return En||(ec(_d),En=_r.now()+No)}function _d(){En=0}function vo(){this._call=this._time=this._next=null}vo.prototype=tc.prototype={constructor:vo,restart:function(e,t,r){if(typeof e!="function")throw new TypeError("callback is not a function");r=(r==null?Vi():+r)+(t==null?0:+t),!this._next&&yr!==this&&(yr?yr._next=this:yo=this,yr=this),this._call=e,this._time=r,Ni()},stop:function(){this._call&&(this._call=null,this._time=1/0,Ni())}};function tc(e,t,r){var o=new vo;return o.restart(e,t,r),o}function Ed(){Vi(),++Un;for(var e=yo,t;e;)(t=En-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Un}function Ys(){En=(go=_r.now())+No,Un=mr=0;try{Ed()}finally{Un=0,Sd(),En=0}}function kd(){var e=_r.now(),t=e-go;t>Ja&&(No-=t,go=e)}function Sd(){for(var e,t=yo,r,o=1/0;t;)t._call?(o>t._time&&(o=t._time),e=t,t=t._next):(r=t._next,t._next=null,t=e?e._next=r:yo=r);yr=e,Ni(o)}function Ni(e){if(!Un){mr&&(mr=clearTimeout(mr));var t=e-En;t>24?(e<1/0&&(mr=setTimeout(Ys,e-_r.now()-No)),lr&&(lr=clearInterval(lr))):(lr||(go=_r.now(),lr=setInterval(kd,Ja)),Un=1,ec(Ys))}}function Us(e,t,r){var o=new vo;return t=t==null?0:+t,o.restart(s=>{o.stop(),e(s+t)},t,r),o}var Nd=ko("start","end","cancel","interrupt"),Cd=[],nc=0,Xs=1,Ci=2,uo=3,Gs=4,Ai=5,lo=6;function Co(e,t,r,o,s,a){var u=e.__transition;if(!u)e.__transition={};else if(r in u)return;Ad(e,r,{name:t,index:o,group:s,on:Nd,tween:Cd,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:nc})}function Yi(e,t){var r=It(e,t);if(r.state>nc)throw new Error("too late; already scheduled");return r}function Kt(e,t){var r=It(e,t);if(r.state>uo)throw new Error("too late; already running");return r}function It(e,t){var r=e.__transition;if(!r||!(r=r[t]))throw new Error("transition not found");return r}function Ad(e,t,r){var o=e.__transition,s;o[t]=r,r.timer=tc(a,0,r.time);function a(p){r.state=Xs,r.timer.restart(u,r.delay,r.time),r.delay<=p&&u(p-r.delay)}function u(p){var m,v,w,g;if(r.state!==Xs)return d();for(m in o)if(g=o[m],g.name===r.name){if(g.state===uo)return Us(u);g.state===Gs?(g.state=lo,g.timer.stop(),g.on.call("interrupt",e,e.__data__,g.index,g.group),delete o[m]):+m<t&&(g.state=lo,g.timer.stop(),g.on.call("cancel",e,e.__data__,g.index,g.group),delete o[m])}if(Us(function(){r.state===uo&&(r.state=Gs,r.timer.restart(l,r.delay,r.time),l(p))}),r.state=Ci,r.on.call("start",e,e.__data__,r.index,r.group),r.state===Ci){for(r.state=uo,s=new Array(w=r.tween.length),m=0,v=-1;m<w;++m)(g=r.tween[m].value.call(e,e.__data__,r.index,r.group))&&(s[++v]=g);s.length=v+1}}function l(p){for(var m=p<r.duration?r.ease.call(null,p/r.duration):(r.timer.restart(d),r.state=Ai,1),v=-1,w=s.length;++v<w;)s[v].call(e,m);r.state===Ai&&(r.on.call("end",e,e.__data__,r.index,r.group),d())}function d(){r.state=lo,r.timer.stop(),delete o[t];for(var p in o)return;delete e.__transition}}function fo(e,t){var r=e.__transition,o,s,a=!0,u;if(r){t=t==null?null:t+"";for(u in r){if((o=r[u]).name!==t){a=!1;continue}s=o.state>Ci&&o.state<Ai,o.state=lo,o.timer.stop(),o.on.call(s?"interrupt":"cancel",e,e.__data__,o.index,o.group),delete r[u]}a&&delete e.__transition}}function Td(e){return this.each(function(){fo(this,e)})}function Id(e,t){var r,o;return function(){var s=Kt(this,e),a=s.tween;if(a!==r){o=r=a;for(var u=0,l=o.length;u<l;++u)if(o[u].name===t){o=o.slice(),o.splice(u,1);break}}s.tween=o}}function Md(e,t,r){var o,s;if(typeof r!="function")throw new Error;return function(){var a=Kt(this,e),u=a.tween;if(u!==o){s=(o=u).slice();for(var l={name:t,value:r},d=0,p=s.length;d<p;++d)if(s[d].name===t){s[d]=l;break}d===p&&s.push(l)}a.tween=s}}function Pd(e,t){var r=this._id;if(e+="",arguments.length<2){for(var o=It(this.node(),r).tween,s=0,a=o.length,u;s<a;++s)if((u=o[s]).name===e)return u.value;return null}return this.each((t==null?Id:Md)(r,e,t))}function Ui(e,t,r){var o=e._id;return e.each(function(){var s=Kt(this,o);(s.value||(s.value={}))[t]=r.apply(this,arguments)}),function(s){return It(s,o).value[t]}}function rc(e,t){var r;return(typeof t=="number"?ln:t instanceof br?qs:(r=br(t))?(t=r,qs):hd)(e,t)}function Dd(e){return function(){this.removeAttribute(e)}}function Rd(e){return function(){this.removeAttributeNS(e.space,e.local)}}function $d(e,t,r){var o,s=r+"",a;return function(){var u=this.getAttribute(e);return u===s?null:u===o?a:a=t(o=u,r)}}function Od(e,t,r){var o,s=r+"",a;return function(){var u=this.getAttributeNS(e.space,e.local);return u===s?null:u===o?a:a=t(o=u,r)}}function jd(e,t,r){var o,s,a;return function(){var u,l=r(this),d;return l==null?void this.removeAttribute(e):(u=this.getAttribute(e),d=l+"",u===d?null:u===o&&d===s?a:(s=d,a=t(o=u,l)))}}function Bd(e,t,r){var o,s,a;return function(){var u,l=r(this),d;return l==null?void this.removeAttributeNS(e.space,e.local):(u=this.getAttributeNS(e.space,e.local),d=l+"",u===d?null:u===o&&d===s?a:(s=d,a=t(o=u,l)))}}function Fd(e,t){var r=So(e),o=r==="transform"?gd:rc;return this.attrTween(e,typeof t=="function"?(r.local?Bd:jd)(r,o,Ui(this,"attr."+e,t)):t==null?(r.local?Rd:Dd)(r):(r.local?Od:$d)(r,o,t))}function zd(e,t){return function(r){this.setAttribute(e,t.call(this,r))}}function Ld(e,t){return function(r){this.setAttributeNS(e.space,e.local,t.call(this,r))}}function Kd(e,t){var r,o;function s(){var a=t.apply(this,arguments);return a!==o&&(r=(o=a)&&Ld(e,a)),r}return s._value=t,s}function Hd(e,t){var r,o;function s(){var a=t.apply(this,arguments);return a!==o&&(r=(o=a)&&zd(e,a)),r}return s._value=t,s}function qd(e,t){var r="attr."+e;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;var o=So(e);return this.tween(r,(o.local?Kd:Hd)(o,t))}function Wd(e,t){return function(){Yi(this,e).delay=+t.apply(this,arguments)}}function Vd(e,t){return t=+t,function(){Yi(this,e).delay=t}}function Yd(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Wd:Vd)(t,e)):It(this.node(),t).delay}function Ud(e,t){return function(){Kt(this,e).duration=+t.apply(this,arguments)}}function Xd(e,t){return t=+t,function(){Kt(this,e).duration=t}}function Gd(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Ud:Xd)(t,e)):It(this.node(),t).duration}function Zd(e,t){if(typeof t!="function")throw new Error;return function(){Kt(this,e).ease=t}}function Qd(e){var t=this._id;return arguments.length?this.each(Zd(t,e)):It(this.node(),t).ease}function Jd(e,t){return function(){var r=t.apply(this,arguments);if(typeof r!="function")throw new Error;Kt(this,e).ease=r}}function eh(e){if(typeof e!="function")throw new Error;return this.each(Jd(this._id,e))}function th(e){typeof e!="function"&&(e=$a(e));for(var t=this._groups,r=t.length,o=new Array(r),s=0;s<r;++s)for(var a=t[s],u=a.length,l=o[s]=[],d,p=0;p<u;++p)(d=a[p])&&e.call(d,d.__data__,p,a)&&l.push(d);return new Qt(o,this._parents,this._name,this._id)}function nh(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,r=e._groups,o=t.length,s=r.length,a=Math.min(o,s),u=new Array(o),l=0;l<a;++l)for(var d=t[l],p=r[l],m=d.length,v=u[l]=new Array(m),w,g=0;g<m;++g)(w=d[g]||p[g])&&(v[g]=w);for(;l<o;++l)u[l]=t[l];return new Qt(u,this._parents,this._name,this._id)}function rh(e){return(e+"").trim().split(/^|\s+/).every(function(t){var r=t.indexOf(".");return r>=0&&(t=t.slice(0,r)),!t||t==="start"})}function oh(e,t,r){var o,s,a=rh(t)?Yi:Kt;return function(){var u=a(this,e),l=u.on;l!==o&&(s=(o=l).copy()).on(t,r),u.on=s}}function ih(e,t){var r=this._id;return arguments.length<2?It(this.node(),r).on.on(e):this.each(oh(r,e,t))}function sh(e){return function(){var t=this.parentNode;for(var r in this.__transition)if(+r!==e)return;t&&t.removeChild(this)}}function ah(){return this.on("end.remove",sh(this._id))}function ch(e){var t=this._name,r=this._id;typeof e!="function"&&(e=Hi(e));for(var o=this._groups,s=o.length,a=new Array(s),u=0;u<s;++u)for(var l=o[u],d=l.length,p=a[u]=new Array(d),m,v,w=0;w<d;++w)(m=l[w])&&(v=e.call(m,m.__data__,w,l))&&("__data__"in m&&(v.__data__=m.__data__),p[w]=v,Co(p[w],t,r,w,p,It(m,r)));return new Qt(a,this._parents,t,r)}function uh(e){var t=this._name,r=this._id;typeof e!="function"&&(e=Ra(e));for(var o=this._groups,s=o.length,a=[],u=[],l=0;l<s;++l)for(var d=o[l],p=d.length,m,v=0;v<p;++v)if(m=d[v]){for(var w=e.call(m,m.__data__,v,d),g,k=It(m,r),S=0,O=w.length;S<O;++S)(g=w[S])&&Co(g,t,r,S,w,k);a.push(w),u.push(m)}return new Qt(a,u,t,r)}var lh=Nr.prototype.constructor;function fh(){return new lh(this._groups,this._parents)}function dh(e,t){var r,o,s;return function(){var a=Yn(this,e),u=(this.style.removeProperty(e),Yn(this,e));return a===u?null:a===r&&u===o?s:s=t(r=a,o=u)}}function oc(e){return function(){this.style.removeProperty(e)}}function hh(e,t,r){var o,s=r+"",a;return function(){var u=Yn(this,e);return u===s?null:u===o?a:a=t(o=u,r)}}function ph(e,t,r){var o,s,a;return function(){var u=Yn(this,e),l=r(this),d=l+"";return l==null&&(d=l=(this.style.removeProperty(e),Yn(this,e))),u===d?null:u===o&&d===s?a:(s=d,a=t(o=u,l))}}function mh(e,t){var r,o,s,a="style."+t,u="end."+a,l;return function(){var d=Kt(this,e),p=d.on,m=d.value[a]==null?l||(l=oc(t)):void 0;(p!==r||s!==m)&&(o=(r=p).copy()).on(u,s=m),d.on=o}}function yh(e,t,r){var o=(e+="")=="transform"?yd:rc;return t==null?this.styleTween(e,dh(e,o)).on("end.style."+e,oc(e)):typeof t=="function"?this.styleTween(e,ph(e,o,Ui(this,"style."+e,t))).each(mh(this._id,e)):this.styleTween(e,hh(e,o,t),r).on("end.style."+e,null)}function gh(e,t,r){return function(o){this.style.setProperty(e,t.call(this,o),r)}}function vh(e,t,r){var o,s;function a(){var u=t.apply(this,arguments);return u!==s&&(o=(s=u)&&gh(e,u,r)),o}return a._value=t,a}function wh(e,t,r){var o="style."+(e+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(t==null)return this.tween(o,null);if(typeof t!="function")throw new Error;return this.tween(o,vh(e,t,r??""))}function xh(e){return function(){this.textContent=e}}function bh(e){return function(){var t=e(this);this.textContent=t??""}}function _h(e){return this.tween("text",typeof e=="function"?bh(Ui(this,"text",e)):xh(e==null?"":e+""))}function Eh(e){return function(t){this.textContent=e.call(this,t)}}function kh(e){var t,r;function o(){var s=e.apply(this,arguments);return s!==r&&(t=(r=s)&&Eh(s)),t}return o._value=e,o}function Sh(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,kh(e))}function Nh(){for(var e=this._name,t=this._id,r=ic(),o=this._groups,s=o.length,a=0;a<s;++a)for(var u=o[a],l=u.length,d,p=0;p<l;++p)if(d=u[p]){var m=It(d,t);Co(d,e,r,p,u,{time:m.time+m.delay+m.duration,delay:0,duration:m.duration,ease:m.ease})}return new Qt(o,this._parents,e,r)}function Ch(){var e,t,r=this,o=r._id,s=r.size();return new Promise(function(a,u){var l={value:u},d={value:function(){--s===0&&a()}};r.each(function(){var p=Kt(this,o),m=p.on;m!==e&&(t=(e=m).copy(),t._.cancel.push(l),t._.interrupt.push(l),t._.end.push(d)),p.on=t}),s===0&&a()})}var Ah=0;function Qt(e,t,r,o){this._groups=e,this._parents=t,this._name=r,this._id=o}function ic(){return++Ah}var Xt=Nr.prototype;Qt.prototype={constructor:Qt,select:ch,selectAll:uh,selectChild:Xt.selectChild,selectChildren:Xt.selectChildren,filter:th,merge:nh,selection:fh,transition:Nh,call:Xt.call,nodes:Xt.nodes,node:Xt.node,size:Xt.size,empty:Xt.empty,each:Xt.each,on:ih,attr:Fd,attrTween:qd,style:yh,styleTween:wh,text:_h,textTween:Sh,remove:ah,tween:Pd,delay:Yd,duration:Gd,ease:Qd,easeVarying:eh,end:Ch,[Symbol.iterator]:Xt[Symbol.iterator]};function Th(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Ih={time:null,delay:0,duration:250,ease:Th};function Mh(e,t){for(var r;!(r=e.__transition)||!(r=r[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return r}function Ph(e){var t,r;e instanceof Qt?(t=e._id,e=e._name):(t=ic(),(r=Ih).time=Vi(),e=e==null?null:e+"");for(var o=this._groups,s=o.length,a=0;a<s;++a)for(var u=o[a],l=u.length,d,p=0;p<l;++p)(d=u[p])&&Co(d,e,t,p,u,r||Mh(d,t));return new Qt(o,this._parents,e,t)}Nr.prototype.interrupt=Td;Nr.prototype.transition=Ph;const no=e=>()=>e;function Dh(e,{sourceEvent:t,target:r,transform:o,dispatch:s}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:s}})}function Gt(e,t,r){this.k=e,this.x=t,this.y=r}Gt.prototype={constructor:Gt,scale:function(e){return e===1?this:new Gt(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Gt(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Zt=new Gt(1,0,0);Gt.prototype;function pi(e){e.stopImmediatePropagation()}function fr(e){e.preventDefault(),e.stopImmediatePropagation()}function Rh(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function $h(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Zs(){return this.__zoom||Zt}function Oh(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function jh(){return navigator.maxTouchPoints||"ontouchstart"in this}function Bh(e,t,r){var o=e.invertX(t[0][0])-r[0][0],s=e.invertX(t[1][0])-r[1][0],a=e.invertY(t[0][1])-r[0][1],u=e.invertY(t[1][1])-r[1][1];return e.translate(s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s),u>a?(a+u)/2:Math.min(0,a)||Math.max(0,u))}function sc(){var e=Rh,t=$h,r=Bh,o=Oh,s=jh,a=[0,1/0],u=[[-1/0,-1/0],[1/0,1/0]],l=250,d=bd,p=ko("start","zoom","end"),m,v,w,g=500,k=150,S=0,O=10;function T(b){b.property("__zoom",Zs).on("wheel.zoom",ee,{passive:!1}).on("mousedown.zoom",G).on("dblclick.zoom",ne).filter(s).on("touchstart.zoom",oe).on("touchmove.zoom",le).on("touchend.zoom touchcancel.zoom",se).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}T.transform=function(b,q,j,re){var J=b.selection?b.selection():b;J.property("__zoom",Zs),b!==J?U(b,q,j,re):J.interrupt().each(function(){Q(this,arguments).event(re).start().zoom(null,typeof q=="function"?q.apply(this,arguments):q).end()})},T.scaleBy=function(b,q,j,re){T.scaleTo(b,function(){var J=this.__zoom.k,L=typeof q=="function"?q.apply(this,arguments):q;return J*L},j,re)},T.scaleTo=function(b,q,j,re){T.transform(b,function(){var J=t.apply(this,arguments),L=this.__zoom,Z=j==null?C(J):typeof j=="function"?j.apply(this,arguments):j,ie=L.invert(Z),ae=typeof q=="function"?q.apply(this,arguments):q;return r(z(K(L,ae),Z,ie),J,u)},j,re)},T.translateBy=function(b,q,j,re){T.transform(b,function(){return r(this.__zoom.translate(typeof q=="function"?q.apply(this,arguments):q,typeof j=="function"?j.apply(this,arguments):j),t.apply(this,arguments),u)},null,re)},T.translateTo=function(b,q,j,re,J){T.transform(b,function(){var L=t.apply(this,arguments),Z=this.__zoom,ie=re==null?C(L):typeof re=="function"?re.apply(this,arguments):re;return r(Zt.translate(ie[0],ie[1]).scale(Z.k).translate(typeof q=="function"?-q.apply(this,arguments):-q,typeof j=="function"?-j.apply(this,arguments):-j),L,u)},re,J)};function K(b,q){return q=Math.max(a[0],Math.min(a[1],q)),q===b.k?b:new Gt(q,b.x,b.y)}function z(b,q,j){var re=q[0]-j[0]*b.k,J=q[1]-j[1]*b.k;return re===b.x&&J===b.y?b:new Gt(b.k,re,J)}function C(b){return[(+b[0][0]+ +b[1][0])/2,(+b[0][1]+ +b[1][1])/2]}function U(b,q,j,re){b.on("start.zoom",function(){Q(this,arguments).event(re).start()}).on("interrupt.zoom end.zoom",function(){Q(this,arguments).event(re).end()}).tween("zoom",function(){var J=this,L=arguments,Z=Q(J,L).event(re),ie=t.apply(J,L),ae=j==null?C(ie):typeof j=="function"?j.apply(J,L):j,ve=Math.max(ie[1][0]-ie[0][0],ie[1][1]-ie[0][1]),ge=J.__zoom,be=typeof q=="function"?q.apply(J,L):q,Se=d(ge.invert(ae).concat(ve/ge.k),be.invert(ae).concat(ve/be.k));return function(Ae){if(Ae===1)Ae=be;else{var $e=Se(Ae),de=ve/$e[2];Ae=new Gt(de,ae[0]-$e[0]*de,ae[1]-$e[1]*de)}Z.zoom(null,Ae)}})}function Q(b,q,j){return!j&&b.__zooming||new Y(b,q)}function Y(b,q){this.that=b,this.args=q,this.active=0,this.sourceEvent=null,this.extent=t.apply(b,q),this.taps=0}Y.prototype={event:function(b){return b&&(this.sourceEvent=b),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(b,q){return this.mouse&&b!=="mouse"&&(this.mouse[1]=q.invert(this.mouse[0])),this.touch0&&b!=="touch"&&(this.touch0[1]=q.invert(this.touch0[0])),this.touch1&&b!=="touch"&&(this.touch1[1]=q.invert(this.touch1[0])),this.that.__zoom=q,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(b){var q=bt(this.that).datum();p.call(b,this.that,new Dh(b,{sourceEvent:this.sourceEvent,target:T,type:b,transform:this.that.__zoom,dispatch:p}),q)}};function ee(b,...q){if(!e.apply(this,arguments))return;var j=Q(this,q).event(b),re=this.__zoom,J=Math.max(a[0],Math.min(a[1],re.k*Math.pow(2,o.apply(this,arguments)))),L=Ct(b);if(j.wheel)(j.mouse[0][0]!==L[0]||j.mouse[0][1]!==L[1])&&(j.mouse[1]=re.invert(j.mouse[0]=L)),clearTimeout(j.wheel);else{if(re.k===J)return;j.mouse=[L,re.invert(L)],fo(this),j.start()}fr(b),j.wheel=setTimeout(Z,k),j.zoom("mouse",r(z(K(re,J),j.mouse[0],j.mouse[1]),j.extent,u));function Z(){j.wheel=null,j.end()}}function G(b,...q){if(w||!e.apply(this,arguments))return;var j=b.currentTarget,re=Q(this,q,!0).event(b),J=bt(b.view).on("mousemove.zoom",ae,!0).on("mouseup.zoom",ve,!0),L=Ct(b,j),Z=b.clientX,ie=b.clientY;Wa(b.view),pi(b),re.mouse=[L,this.__zoom.invert(L)],fo(this),re.start();function ae(ge){if(fr(ge),!re.moved){var be=ge.clientX-Z,Se=ge.clientY-ie;re.moved=be*be+Se*Se>S}re.event(ge).zoom("mouse",r(z(re.that.__zoom,re.mouse[0]=Ct(ge,j),re.mouse[1]),re.extent,u))}function ve(ge){J.on("mousemove.zoom mouseup.zoom",null),Va(ge.view,re.moved),fr(ge),re.event(ge).end()}}function ne(b,...q){if(e.apply(this,arguments)){var j=this.__zoom,re=Ct(b.changedTouches?b.changedTouches[0]:b,this),J=j.invert(re),L=j.k*(b.shiftKey?.5:2),Z=r(z(K(j,L),re,J),t.apply(this,q),u);fr(b),l>0?bt(this).transition().duration(l).call(U,Z,re,b):bt(this).call(T.transform,Z,re,b)}}function oe(b,...q){if(e.apply(this,arguments)){var j=b.touches,re=j.length,J=Q(this,q,b.changedTouches.length===re).event(b),L,Z,ie,ae;for(pi(b),Z=0;Z<re;++Z)ie=j[Z],ae=Ct(ie,this),ae=[ae,this.__zoom.invert(ae),ie.identifier],J.touch0?!J.touch1&&J.touch0[2]!==ae[2]&&(J.touch1=ae,J.taps=0):(J.touch0=ae,L=!0,J.taps=1+!!m);m&&(m=clearTimeout(m)),L&&(J.taps<2&&(v=ae[0],m=setTimeout(function(){m=null},g)),fo(this),J.start())}}function le(b,...q){if(this.__zooming){var j=Q(this,q).event(b),re=b.changedTouches,J=re.length,L,Z,ie,ae;for(fr(b),L=0;L<J;++L)Z=re[L],ie=Ct(Z,this),j.touch0&&j.touch0[2]===Z.identifier?j.touch0[0]=ie:j.touch1&&j.touch1[2]===Z.identifier&&(j.touch1[0]=ie);if(Z=j.that.__zoom,j.touch1){var ve=j.touch0[0],ge=j.touch0[1],be=j.touch1[0],Se=j.touch1[1],Ae=(Ae=be[0]-ve[0])*Ae+(Ae=be[1]-ve[1])*Ae,$e=($e=Se[0]-ge[0])*$e+($e=Se[1]-ge[1])*$e;Z=K(Z,Math.sqrt(Ae/$e)),ie=[(ve[0]+be[0])/2,(ve[1]+be[1])/2],ae=[(ge[0]+Se[0])/2,(ge[1]+Se[1])/2]}else if(j.touch0)ie=j.touch0[0],ae=j.touch0[1];else return;j.zoom("touch",r(z(Z,ie,ae),j.extent,u))}}function se(b,...q){if(this.__zooming){var j=Q(this,q).event(b),re=b.changedTouches,J=re.length,L,Z;for(pi(b),w&&clearTimeout(w),w=setTimeout(function(){w=null},g),L=0;L<J;++L)Z=re[L],j.touch0&&j.touch0[2]===Z.identifier?delete j.touch0:j.touch1&&j.touch1[2]===Z.identifier&&delete j.touch1;if(j.touch1&&!j.touch0&&(j.touch0=j.touch1,delete j.touch1),j.touch0)j.touch0[1]=this.__zoom.invert(j.touch0[0]);else if(j.end(),j.taps===2&&(Z=Ct(Z,this),Math.hypot(v[0]-Z[0],v[1]-Z[1])<O)){var ie=bt(this).on("dblclick.zoom");ie&&ie.apply(this,arguments)}}}return T.wheelDelta=function(b){return arguments.length?(o=typeof b=="function"?b:no(+b),T):o},T.filter=function(b){return arguments.length?(e=typeof b=="function"?b:no(!!b),T):e},T.touchable=function(b){return arguments.length?(s=typeof b=="function"?b:no(!!b),T):s},T.extent=function(b){return arguments.length?(t=typeof b=="function"?b:no([[+b[0][0],+b[0][1]],[+b[1][0],+b[1][1]]]),T):t},T.scaleExtent=function(b){return arguments.length?(a[0]=+b[0],a[1]=+b[1],T):[a[0],a[1]]},T.translateExtent=function(b){return arguments.length?(u[0][0]=+b[0][0],u[1][0]=+b[1][0],u[0][1]=+b[0][1],u[1][1]=+b[1][1],T):[[u[0][0],u[0][1]],[u[1][0],u[1][1]]]},T.constrain=function(b){return arguments.length?(r=b,T):r},T.duration=function(b){return arguments.length?(l=+b,T):l},T.interpolate=function(b){return arguments.length?(d=b,T):d},T.on=function(){var b=p.on.apply(p,arguments);return b===p?T:b},T.clickDistance=function(b){return arguments.length?(S=(b=+b)*b,T):Math.sqrt(S)},T.tapDistance=function(b){return arguments.length?(O=+b,T):O},T}const Ao=$.createContext(null),Fh=Ao.Provider,Jt={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},ac=Jt.error001();function Fe(e,t){const r=$.useContext(Ao);if(r===null)throw new Error(ac);return Pa(r,e,t)}const Ue=()=>{const e=$.useContext(Ao);if(e===null)throw new Error(ac);return $.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},zh=e=>e.userSelectionActive?"none":"all";function To({position:e,children:t,className:r,style:o,...s}){const a=Fe(zh),u=`${e}`.split("-");return X.createElement("div",{className:et(["react-flow__panel",r,...u]),style:{...o,pointerEvents:a},...s},t)}function Lh({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:X.createElement(To,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},X.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const Kh=({x:e,y:t,label:r,labelStyle:o={},labelShowBg:s=!0,labelBgStyle:a={},labelBgPadding:u=[2,4],labelBgBorderRadius:l=2,children:d,className:p,...m})=>{const v=$.useRef(null),[w,g]=$.useState({x:0,y:0,width:0,height:0}),k=et(["react-flow__edge-textwrapper",p]);return $.useEffect(()=>{if(v.current){const S=v.current.getBBox();g({x:S.x,y:S.y,width:S.width,height:S.height})}},[r]),typeof r>"u"||!r?null:X.createElement("g",{transform:`translate(${e-w.width/2} ${t-w.height/2})`,className:k,visibility:w.width?"visible":"hidden",...m},s&&X.createElement("rect",{width:w.width+2*u[0],x:-u[0],y:-u[1],height:w.height+2*u[1],className:"react-flow__edge-textbg",style:a,rx:l,ry:l}),X.createElement("text",{className:"react-flow__edge-text",y:w.height/2,dy:"0.3em",ref:v,style:o},r),d)};var Hh=$.memo(Kh);const Xi=e=>({width:e.offsetWidth,height:e.offsetHeight}),Xn=(e,t=0,r=1)=>Math.min(Math.max(e,t),r),Gi=(e={x:0,y:0},t)=>({x:Xn(e.x,t[0][0],t[1][0]),y:Xn(e.y,t[0][1],t[1][1])}),Qs=(e,t,r)=>e<t?Xn(Math.abs(e-t),1,50)/50:e>r?-Xn(Math.abs(e-r),1,50)/50:0,cc=(e,t)=>{const r=Qs(e.x,35,t.width-35)*20,o=Qs(e.y,35,t.height-35)*20;return[r,o]},uc=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},lc=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Er=({x:e,y:t,width:r,height:o})=>({x:e,y:t,x2:e+r,y2:t+o}),fc=({x:e,y:t,x2:r,y2:o})=>({x:e,y:t,width:r-e,height:o-t}),Js=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),qh=(e,t)=>fc(lc(Er(e),Er(t))),Ti=(e,t)=>{const r=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),o=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(r*o)},Wh=e=>_t(e.width)&&_t(e.height)&&_t(e.x)&&_t(e.y),_t=e=>!isNaN(e)&&isFinite(e),qe=Symbol.for("internals"),dc=["Enter"," ","Escape"],Vh=(e,t)=>{},Yh=e=>"nativeEvent"in e;function Ii(e){var s,a;const t=Yh(e)?e.nativeEvent:e,r=((a=(s=t.composedPath)==null?void 0:s.call(t))==null?void 0:a[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(r==null?void 0:r.nodeName)||(r==null?void 0:r.hasAttribute("contenteditable"))||!!(r!=null&&r.closest(".nokey"))}const hc=e=>"clientX"in e,pn=(e,t)=>{var a,u;const r=hc(e),o=r?e.clientX:(a=e.touches)==null?void 0:a[0].clientX,s=r?e.clientY:(u=e.touches)==null?void 0:u[0].clientY;return{x:o-((t==null?void 0:t.left)??0),y:s-((t==null?void 0:t.top)??0)}},wo=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0},Ar=({id:e,path:t,labelX:r,labelY:o,label:s,labelStyle:a,labelShowBg:u,labelBgStyle:l,labelBgPadding:d,labelBgBorderRadius:p,style:m,markerEnd:v,markerStart:w,interactionWidth:g=20})=>X.createElement(X.Fragment,null,X.createElement("path",{id:e,style:m,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:v,markerStart:w}),g&&X.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:g,className:"react-flow__edge-interaction"}),s&&_t(r)&&_t(o)?X.createElement(Hh,{x:r,y:o,label:s,labelStyle:a,labelShowBg:u,labelBgStyle:l,labelBgPadding:d,labelBgBorderRadius:p}):null);Ar.displayName="BaseEdge";function dr(e,t,r){return r===void 0?r:o=>{const s=t().edges.find(a=>a.id===e);s&&r(o,{...s})}}function pc({sourceX:e,sourceY:t,targetX:r,targetY:o}){const s=Math.abs(r-e)/2,a=r<e?r+s:r-s,u=Math.abs(o-t)/2,l=o<t?o+u:o-u;return[a,l,s,u]}function mc({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:s,sourceControlY:a,targetControlX:u,targetControlY:l}){const d=e*.125+s*.375+u*.375+r*.125,p=t*.125+a*.375+l*.375+o*.125,m=Math.abs(d-e),v=Math.abs(p-t);return[d,p,m,v]}var kn;(function(e){e.Strict="strict",e.Loose="loose"})(kn||(kn={}));var xn;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(xn||(xn={}));var kr;(function(e){e.Partial="partial",e.Full="full"})(kr||(kr={}));var dn;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(dn||(dn={}));var xo;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(xo||(xo={}));var _e;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(_e||(_e={}));function ea({pos:e,x1:t,y1:r,x2:o,y2:s}){return e===_e.Left||e===_e.Right?[.5*(t+o),r]:[t,.5*(r+s)]}function yc({sourceX:e,sourceY:t,sourcePosition:r=_e.Bottom,targetX:o,targetY:s,targetPosition:a=_e.Top}){const[u,l]=ea({pos:r,x1:e,y1:t,x2:o,y2:s}),[d,p]=ea({pos:a,x1:o,y1:s,x2:e,y2:t}),[m,v,w,g]=mc({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:u,sourceControlY:l,targetControlX:d,targetControlY:p});return[`M${e},${t} C${u},${l} ${d},${p} ${o},${s}`,m,v,w,g]}const Zi=$.memo(({sourceX:e,sourceY:t,targetX:r,targetY:o,sourcePosition:s=_e.Bottom,targetPosition:a=_e.Top,label:u,labelStyle:l,labelShowBg:d,labelBgStyle:p,labelBgPadding:m,labelBgBorderRadius:v,style:w,markerEnd:g,markerStart:k,interactionWidth:S})=>{const[O,T,K]=yc({sourceX:e,sourceY:t,sourcePosition:s,targetX:r,targetY:o,targetPosition:a});return X.createElement(Ar,{path:O,labelX:T,labelY:K,label:u,labelStyle:l,labelShowBg:d,labelBgStyle:p,labelBgPadding:m,labelBgBorderRadius:v,style:w,markerEnd:g,markerStart:k,interactionWidth:S})});Zi.displayName="SimpleBezierEdge";const ta={[_e.Left]:{x:-1,y:0},[_e.Right]:{x:1,y:0},[_e.Top]:{x:0,y:-1},[_e.Bottom]:{x:0,y:1}},Uh=({source:e,sourcePosition:t=_e.Bottom,target:r})=>t===_e.Left||t===_e.Right?e.x<r.x?{x:1,y:0}:{x:-1,y:0}:e.y<r.y?{x:0,y:1}:{x:0,y:-1},na=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Xh({source:e,sourcePosition:t=_e.Bottom,target:r,targetPosition:o=_e.Top,center:s,offset:a}){const u=ta[t],l=ta[o],d={x:e.x+u.x*a,y:e.y+u.y*a},p={x:r.x+l.x*a,y:r.y+l.y*a},m=Uh({source:d,sourcePosition:t,target:p}),v=m.x!==0?"x":"y",w=m[v];let g=[],k,S;const O={x:0,y:0},T={x:0,y:0},[K,z,C,U]=pc({sourceX:e.x,sourceY:e.y,targetX:r.x,targetY:r.y});if(u[v]*l[v]===-1){k=s.x??K,S=s.y??z;const Y=[{x:k,y:d.y},{x:k,y:p.y}],ee=[{x:d.x,y:S},{x:p.x,y:S}];u[v]===w?g=v==="x"?Y:ee:g=v==="x"?ee:Y}else{const Y=[{x:d.x,y:p.y}],ee=[{x:p.x,y:d.y}];if(v==="x"?g=u.x===w?ee:Y:g=u.y===w?Y:ee,t===o){const se=Math.abs(e[v]-r[v]);if(se<=a){const b=Math.min(a-1,a-se);u[v]===w?O[v]=(d[v]>e[v]?-1:1)*b:T[v]=(p[v]>r[v]?-1:1)*b}}if(t!==o){const se=v==="x"?"y":"x",b=u[v]===l[se],q=d[se]>p[se],j=d[se]<p[se];(u[v]===1&&(!b&&q||b&&j)||u[v]!==1&&(!b&&j||b&&q))&&(g=v==="x"?Y:ee)}const G={x:d.x+O.x,y:d.y+O.y},ne={x:p.x+T.x,y:p.y+T.y},oe=Math.max(Math.abs(G.x-g[0].x),Math.abs(ne.x-g[0].x)),le=Math.max(Math.abs(G.y-g[0].y),Math.abs(ne.y-g[0].y));oe>=le?(k=(G.x+ne.x)/2,S=g[0].y):(k=g[0].x,S=(G.y+ne.y)/2)}return[[e,{x:d.x+O.x,y:d.y+O.y},...g,{x:p.x+T.x,y:p.y+T.y},r],k,S,C,U]}function Gh(e,t,r,o){const s=Math.min(na(e,t)/2,na(t,r)/2,o),{x:a,y:u}=t;if(e.x===a&&a===r.x||e.y===u&&u===r.y)return`L${a} ${u}`;if(e.y===u){const p=e.x<r.x?-1:1,m=e.y<r.y?1:-1;return`L ${a+s*p},${u}Q ${a},${u} ${a},${u+s*m}`}const l=e.x<r.x?1:-1,d=e.y<r.y?-1:1;return`L ${a},${u+s*d}Q ${a},${u} ${a+s*l},${u}`}function Mi({sourceX:e,sourceY:t,sourcePosition:r=_e.Bottom,targetX:o,targetY:s,targetPosition:a=_e.Top,borderRadius:u=5,centerX:l,centerY:d,offset:p=20}){const[m,v,w,g,k]=Xh({source:{x:e,y:t},sourcePosition:r,target:{x:o,y:s},targetPosition:a,center:{x:l,y:d},offset:p});return[m.reduce((O,T,K)=>{let z="";return K>0&&K<m.length-1?z=Gh(m[K-1],T,m[K+1],u):z=`${K===0?"M":"L"}${T.x} ${T.y}`,O+=z,O},""),v,w,g,k]}const Io=$.memo(({sourceX:e,sourceY:t,targetX:r,targetY:o,label:s,labelStyle:a,labelShowBg:u,labelBgStyle:l,labelBgPadding:d,labelBgBorderRadius:p,style:m,sourcePosition:v=_e.Bottom,targetPosition:w=_e.Top,markerEnd:g,markerStart:k,pathOptions:S,interactionWidth:O})=>{const[T,K,z]=Mi({sourceX:e,sourceY:t,sourcePosition:v,targetX:r,targetY:o,targetPosition:w,borderRadius:S==null?void 0:S.borderRadius,offset:S==null?void 0:S.offset});return X.createElement(Ar,{path:T,labelX:K,labelY:z,label:s,labelStyle:a,labelShowBg:u,labelBgStyle:l,labelBgPadding:d,labelBgBorderRadius:p,style:m,markerEnd:g,markerStart:k,interactionWidth:O})});Io.displayName="SmoothStepEdge";const Qi=$.memo(e=>{var t;return X.createElement(Io,{...e,pathOptions:$.useMemo(()=>{var r;return{borderRadius:0,offset:(r=e.pathOptions)==null?void 0:r.offset}},[(t=e.pathOptions)==null?void 0:t.offset])})});Qi.displayName="StepEdge";function Zh({sourceX:e,sourceY:t,targetX:r,targetY:o}){const[s,a,u,l]=pc({sourceX:e,sourceY:t,targetX:r,targetY:o});return[`M ${e},${t}L ${r},${o}`,s,a,u,l]}const Ji=$.memo(({sourceX:e,sourceY:t,targetX:r,targetY:o,label:s,labelStyle:a,labelShowBg:u,labelBgStyle:l,labelBgPadding:d,labelBgBorderRadius:p,style:m,markerEnd:v,markerStart:w,interactionWidth:g})=>{const[k,S,O]=Zh({sourceX:e,sourceY:t,targetX:r,targetY:o});return X.createElement(Ar,{path:k,labelX:S,labelY:O,label:s,labelStyle:a,labelShowBg:u,labelBgStyle:l,labelBgPadding:d,labelBgBorderRadius:p,style:m,markerEnd:v,markerStart:w,interactionWidth:g})});Ji.displayName="StraightEdge";function ro(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function ra({pos:e,x1:t,y1:r,x2:o,y2:s,c:a}){switch(e){case _e.Left:return[t-ro(t-o,a),r];case _e.Right:return[t+ro(o-t,a),r];case _e.Top:return[t,r-ro(r-s,a)];case _e.Bottom:return[t,r+ro(s-r,a)]}}function gc({sourceX:e,sourceY:t,sourcePosition:r=_e.Bottom,targetX:o,targetY:s,targetPosition:a=_e.Top,curvature:u=.25}){const[l,d]=ra({pos:r,x1:e,y1:t,x2:o,y2:s,c:u}),[p,m]=ra({pos:a,x1:o,y1:s,x2:e,y2:t,c:u}),[v,w,g,k]=mc({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:l,sourceControlY:d,targetControlX:p,targetControlY:m});return[`M${e},${t} C${l},${d} ${p},${m} ${o},${s}`,v,w,g,k]}const bo=$.memo(({sourceX:e,sourceY:t,targetX:r,targetY:o,sourcePosition:s=_e.Bottom,targetPosition:a=_e.Top,label:u,labelStyle:l,labelShowBg:d,labelBgStyle:p,labelBgPadding:m,labelBgBorderRadius:v,style:w,markerEnd:g,markerStart:k,pathOptions:S,interactionWidth:O})=>{const[T,K,z]=gc({sourceX:e,sourceY:t,sourcePosition:s,targetX:r,targetY:o,targetPosition:a,curvature:S==null?void 0:S.curvature});return X.createElement(Ar,{path:T,labelX:K,labelY:z,label:u,labelStyle:l,labelShowBg:d,labelBgStyle:p,labelBgPadding:m,labelBgBorderRadius:v,style:w,markerEnd:g,markerStart:k,interactionWidth:O})});bo.displayName="BezierEdge";const es=$.createContext(null),Qh=es.Provider;es.Consumer;const Jh=()=>$.useContext(es),ep=e=>"id"in e&&"source"in e&&"target"in e,tp=({source:e,sourceHandle:t,target:r,targetHandle:o})=>`reactflow__edge-${e}${t||""}-${r}${o||""}`,Pi=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(o=>`${o}=${e[o]}`).join("&")}`,np=(e,t)=>t.some(r=>r.source===e.source&&r.target===e.target&&(r.sourceHandle===e.sourceHandle||!r.sourceHandle&&!e.sourceHandle)&&(r.targetHandle===e.targetHandle||!r.targetHandle&&!e.targetHandle)),rp=(e,t)=>{if(!e.source||!e.target)return t;let r;return ep(e)?r={...e}:r={...e,id:tp(e)},np(r,t)?t:t.concat(r)},Di=({x:e,y:t},[r,o,s],a,[u,l])=>{const d={x:(e-r)/s,y:(t-o)/s};return a?{x:u*Math.round(d.x/u),y:l*Math.round(d.y/l)}:d},vc=({x:e,y:t},[r,o,s])=>({x:e*s+r,y:t*s+o}),_n=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const r=(e.width??0)*t[0],o=(e.height??0)*t[1],s={x:e.position.x-r,y:e.position.y-o};return{...s,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-r,y:e.positionAbsolute.y-o}:s}},Mo=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const r=e.reduce((o,s)=>{const{x:a,y:u}=_n(s,t).positionAbsolute;return lc(o,Er({x:a,y:u,width:s.width||0,height:s.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return fc(r)},wc=(e,t,[r,o,s]=[0,0,1],a=!1,u=!1,l=[0,0])=>{const d={x:(t.x-r)/s,y:(t.y-o)/s,width:t.width/s,height:t.height/s},p=[];return e.forEach(m=>{const{width:v,height:w,selectable:g=!0,hidden:k=!1}=m;if(u&&!g||k)return!1;const{positionAbsolute:S}=_n(m,l),O={x:S.x,y:S.y,width:v||0,height:w||0},T=Ti(d,O),K=typeof v>"u"||typeof w>"u"||v===null||w===null,z=a&&T>0,C=(v||0)*(w||0);(K||z||T>=C||m.dragging)&&p.push(m)}),p},xc=(e,t)=>{const r=e.map(o=>o.id);return t.filter(o=>r.includes(o.source)||r.includes(o.target))},bc=(e,t,r,o,s,a=.1)=>{const u=t/(e.width*(1+a)),l=r/(e.height*(1+a)),d=Math.min(u,l),p=Xn(d,o,s),m=e.x+e.width/2,v=e.y+e.height/2,w=t/2-m*p,g=r/2-v*p;return{x:w,y:g,zoom:p}},vn=(e,t=0)=>e.transition().duration(t);function oa(e,t,r,o){return(t[r]||[]).reduce((s,a)=>{var u,l;return`${e.id}-${a.id}-${r}`!==o&&s.push({id:a.id||null,type:r,nodeId:e.id,x:(((u=e.positionAbsolute)==null?void 0:u.x)??0)+a.x+a.width/2,y:(((l=e.positionAbsolute)==null?void 0:l.y)??0)+a.y+a.height/2}),s},[])}function op(e,t,r,o,s,a){const{x:u,y:l}=pn(e),p=t.elementsFromPoint(u,l).find(k=>k.classList.contains("react-flow__handle"));if(p){const k=p.getAttribute("data-nodeid");if(k){const S=ts(void 0,p),O=p.getAttribute("data-handleid"),T=a({nodeId:k,id:O,type:S});if(T){const K=s.find(z=>z.nodeId===k&&z.type===S&&z.id===O);return{handle:{id:O,type:S,nodeId:k,x:(K==null?void 0:K.x)||r.x,y:(K==null?void 0:K.y)||r.y},validHandleResult:T}}}}let m=[],v=1/0;if(s.forEach(k=>{const S=Math.sqrt((k.x-r.x)**2+(k.y-r.y)**2);if(S<=o){const O=a(k);S<=v&&(S<v?m=[{handle:k,validHandleResult:O}]:S===v&&m.push({handle:k,validHandleResult:O}),v=S)}}),!m.length)return{handle:null,validHandleResult:_c()};if(m.length===1)return m[0];const w=m.some(({validHandleResult:k})=>k.isValid),g=m.some(({handle:k})=>k.type==="target");return m.find(({handle:k,validHandleResult:S})=>g?k.type==="target":w?S.isValid:!0)||m[0]}const ip={source:null,target:null,sourceHandle:null,targetHandle:null},_c=()=>({handleDomNode:null,isValid:!1,connection:ip,endHandle:null});function Ec(e,t,r,o,s,a,u){const l=s==="target",d=u.querySelector(`.react-flow__handle[data-id="${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`),p={..._c(),handleDomNode:d};if(d){const m=ts(void 0,d),v=d.getAttribute("data-nodeid"),w=d.getAttribute("data-handleid"),g=d.classList.contains("connectable"),k=d.classList.contains("connectableend"),S={source:l?v:r,sourceHandle:l?w:o,target:l?r:v,targetHandle:l?o:w};p.connection=S,g&&k&&(t===kn.Strict?l&&m==="source"||!l&&m==="target":v!==r||w!==o)&&(p.endHandle={nodeId:v,handleId:w,type:m},p.isValid=a(S))}return p}function sp({nodes:e,nodeId:t,handleId:r,handleType:o}){return e.reduce((s,a)=>{if(a[qe]){const{handleBounds:u}=a[qe];let l=[],d=[];u&&(l=oa(a,u,"source",`${t}-${r}-${o}`),d=oa(a,u,"target",`${t}-${r}-${o}`)),s.push(...l,...d)}return s},[])}function ts(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function mi(e){e==null||e.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function ap(e,t){let r=null;return t?r="valid":e&&!t&&(r="invalid"),r}function kc({event:e,handleId:t,nodeId:r,onConnect:o,isTarget:s,getState:a,setState:u,isValidConnection:l,edgeUpdaterType:d,onReconnectEnd:p}){const m=uc(e.target),{connectionMode:v,domNode:w,autoPanOnConnect:g,connectionRadius:k,onConnectStart:S,panBy:O,getNodes:T,cancelConnection:K}=a();let z=0,C;const{x:U,y:Q}=pn(e),Y=m==null?void 0:m.elementFromPoint(U,Q),ee=ts(d,Y),G=w==null?void 0:w.getBoundingClientRect();if(!G||!ee)return;let ne,oe=pn(e,G),le=!1,se=null,b=!1,q=null;const j=sp({nodes:T(),nodeId:r,handleId:t,handleType:ee}),re=()=>{if(!g)return;const[Z,ie]=cc(oe,G);O({x:Z,y:ie}),z=requestAnimationFrame(re)};u({connectionPosition:oe,connectionStatus:null,connectionNodeId:r,connectionHandleId:t,connectionHandleType:ee,connectionStartHandle:{nodeId:r,handleId:t,type:ee},connectionEndHandle:null}),S==null||S(e,{nodeId:r,handleId:t,handleType:ee});function J(Z){const{transform:ie}=a();oe=pn(Z,G);const{handle:ae,validHandleResult:ve}=op(Z,m,Di(oe,ie,!1,[1,1]),k,j,ge=>Ec(ge,v,r,t,s?"target":"source",l,m));if(C=ae,le||(re(),le=!0),q=ve.handleDomNode,se=ve.connection,b=ve.isValid,u({connectionPosition:C&&b?vc({x:C.x,y:C.y},ie):oe,connectionStatus:ap(!!C,b),connectionEndHandle:ve.endHandle}),!C&&!b&&!q)return mi(ne);se.source!==se.target&&q&&(mi(ne),ne=q,q.classList.add("connecting","react-flow__handle-connecting"),q.classList.toggle("valid",b),q.classList.toggle("react-flow__handle-valid",b))}function L(Z){var ie,ae;(C||q)&&se&&b&&(o==null||o(se)),(ae=(ie=a()).onConnectEnd)==null||ae.call(ie,Z),d&&(p==null||p(Z)),mi(ne),K(),cancelAnimationFrame(z),le=!1,b=!1,se=null,q=null,m.removeEventListener("mousemove",J),m.removeEventListener("mouseup",L),m.removeEventListener("touchmove",J),m.removeEventListener("touchend",L)}m.addEventListener("mousemove",J),m.addEventListener("mouseup",L),m.addEventListener("touchmove",J),m.addEventListener("touchend",L)}const ia=()=>!0,cp=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),up=(e,t,r)=>o=>{const{connectionStartHandle:s,connectionEndHandle:a,connectionClickStartHandle:u}=o;return{connecting:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.handleId)===t&&(s==null?void 0:s.type)===r||(a==null?void 0:a.nodeId)===e&&(a==null?void 0:a.handleId)===t&&(a==null?void 0:a.type)===r,clickConnecting:(u==null?void 0:u.nodeId)===e&&(u==null?void 0:u.handleId)===t&&(u==null?void 0:u.type)===r}},Sc=$.forwardRef(({type:e="source",position:t=_e.Top,isValidConnection:r,isConnectable:o=!0,isConnectableStart:s=!0,isConnectableEnd:a=!0,id:u,onConnect:l,children:d,className:p,onMouseDown:m,onTouchStart:v,...w},g)=>{var G,ne;const k=u||null,S=e==="target",O=Ue(),T=Jh(),{connectOnClick:K,noPanClassName:z}=Fe(cp,Qe),{connecting:C,clickConnecting:U}=Fe(up(T,k,e),Qe);T||(ne=(G=O.getState()).onError)==null||ne.call(G,"010",Jt.error010());const Q=oe=>{const{defaultEdgeOptions:le,onConnect:se,hasDefaultEdges:b}=O.getState(),q={...le,...oe};if(b){const{edges:j,setEdges:re}=O.getState();re(rp(q,j))}se==null||se(q),l==null||l(q)},Y=oe=>{if(!T)return;const le=hc(oe);s&&(le&&oe.button===0||!le)&&kc({event:oe,handleId:k,nodeId:T,onConnect:Q,isTarget:S,getState:O.getState,setState:O.setState,isValidConnection:r||O.getState().isValidConnection||ia}),le?m==null||m(oe):v==null||v(oe)},ee=oe=>{const{onClickConnectStart:le,onClickConnectEnd:se,connectionClickStartHandle:b,connectionMode:q,isValidConnection:j}=O.getState();if(!T||!b&&!s)return;if(!b){le==null||le(oe,{nodeId:T,handleId:k,handleType:e}),O.setState({connectionClickStartHandle:{nodeId:T,type:e,handleId:k}});return}const re=uc(oe.target),J=r||j||ia,{connection:L,isValid:Z}=Ec({nodeId:T,id:k,type:e},q,b.nodeId,b.handleId||null,b.type,J,re);Z&&Q(L),se==null||se(oe),O.setState({connectionClickStartHandle:null})};return X.createElement("div",{"data-handleid":k,"data-nodeid":T,"data-handlepos":t,"data-id":`${T}-${k}-${e}`,className:et(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",z,p,{source:!S,target:S,connectable:o,connectablestart:s,connectableend:a,connecting:U,connectionindicator:o&&(s&&!C||a&&C)}]),onMouseDown:Y,onTouchStart:Y,onClick:K?ee:void 0,ref:g,...w},d)});Sc.displayName="Handle";var hn=$.memo(Sc);const Nc=({data:e,isConnectable:t,targetPosition:r=_e.Top,sourcePosition:o=_e.Bottom})=>X.createElement(X.Fragment,null,X.createElement(hn,{type:"target",position:r,isConnectable:t}),e==null?void 0:e.label,X.createElement(hn,{type:"source",position:o,isConnectable:t}));Nc.displayName="DefaultNode";var Ri=$.memo(Nc);const Cc=({data:e,isConnectable:t,sourcePosition:r=_e.Bottom})=>X.createElement(X.Fragment,null,e==null?void 0:e.label,X.createElement(hn,{type:"source",position:r,isConnectable:t}));Cc.displayName="InputNode";var Ac=$.memo(Cc);const Tc=({data:e,isConnectable:t,targetPosition:r=_e.Top})=>X.createElement(X.Fragment,null,X.createElement(hn,{type:"target",position:r,isConnectable:t}),e==null?void 0:e.label);Tc.displayName="OutputNode";var Ic=$.memo(Tc);const ns=()=>null;ns.displayName="GroupNode";const lp=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>({...t}))}),oo=e=>e.id;function fp(e,t){return Qe(e.selectedNodes.map(oo),t.selectedNodes.map(oo))&&Qe(e.selectedEdges.map(oo),t.selectedEdges.map(oo))}const Mc=$.memo(({onSelectionChange:e})=>{const t=Ue(),{selectedNodes:r,selectedEdges:o}=Fe(lp,fp);return $.useEffect(()=>{const s={nodes:r,edges:o};e==null||e(s),t.getState().onSelectionChange.forEach(a=>a(s))},[r,o,e]),null});Mc.displayName="SelectionListener";const dp=e=>!!e.onSelectionChange;function hp({onSelectionChange:e}){const t=Fe(dp);return e||t?X.createElement(Mc,{onSelectionChange:e}):null}const pp=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function jn(e,t){$.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function Pe(e,t,r){$.useEffect(()=>{typeof t<"u"&&r({[e]:t})},[t])}const mp=({nodes:e,edges:t,defaultNodes:r,defaultEdges:o,onConnect:s,onConnectStart:a,onConnectEnd:u,onClickConnectStart:l,onClickConnectEnd:d,nodesDraggable:p,nodesConnectable:m,nodesFocusable:v,edgesFocusable:w,edgesUpdatable:g,elevateNodesOnSelect:k,minZoom:S,maxZoom:O,nodeExtent:T,onNodesChange:K,onEdgesChange:z,elementsSelectable:C,connectionMode:U,snapGrid:Q,snapToGrid:Y,translateExtent:ee,connectOnClick:G,defaultEdgeOptions:ne,fitView:oe,fitViewOptions:le,onNodesDelete:se,onEdgesDelete:b,onNodeDrag:q,onNodeDragStart:j,onNodeDragStop:re,onSelectionDrag:J,onSelectionDragStart:L,onSelectionDragStop:Z,noPanClassName:ie,nodeOrigin:ae,rfId:ve,autoPanOnConnect:ge,autoPanOnNodeDrag:be,onError:Se,connectionRadius:Ae,isValidConnection:$e,nodeDragThreshold:de})=>{const{setNodes:De,setEdges:He,setDefaultNodesAndEdges:ke,setMinZoom:We,setMaxZoom:Xe,setTranslateExtent:je,setNodeExtent:at,reset:Oe}=Fe(pp,Qe),Ee=Ue();return $.useEffect(()=>{const Je=o==null?void 0:o.map(dt=>({...dt,...ne}));return ke(r,Je),()=>{Oe()}},[]),Pe("defaultEdgeOptions",ne,Ee.setState),Pe("connectionMode",U,Ee.setState),Pe("onConnect",s,Ee.setState),Pe("onConnectStart",a,Ee.setState),Pe("onConnectEnd",u,Ee.setState),Pe("onClickConnectStart",l,Ee.setState),Pe("onClickConnectEnd",d,Ee.setState),Pe("nodesDraggable",p,Ee.setState),Pe("nodesConnectable",m,Ee.setState),Pe("nodesFocusable",v,Ee.setState),Pe("edgesFocusable",w,Ee.setState),Pe("edgesUpdatable",g,Ee.setState),Pe("elementsSelectable",C,Ee.setState),Pe("elevateNodesOnSelect",k,Ee.setState),Pe("snapToGrid",Y,Ee.setState),Pe("snapGrid",Q,Ee.setState),Pe("onNodesChange",K,Ee.setState),Pe("onEdgesChange",z,Ee.setState),Pe("connectOnClick",G,Ee.setState),Pe("fitViewOnInit",oe,Ee.setState),Pe("fitViewOnInitOptions",le,Ee.setState),Pe("onNodesDelete",se,Ee.setState),Pe("onEdgesDelete",b,Ee.setState),Pe("onNodeDrag",q,Ee.setState),Pe("onNodeDragStart",j,Ee.setState),Pe("onNodeDragStop",re,Ee.setState),Pe("onSelectionDrag",J,Ee.setState),Pe("onSelectionDragStart",L,Ee.setState),Pe("onSelectionDragStop",Z,Ee.setState),Pe("noPanClassName",ie,Ee.setState),Pe("nodeOrigin",ae,Ee.setState),Pe("rfId",ve,Ee.setState),Pe("autoPanOnConnect",ge,Ee.setState),Pe("autoPanOnNodeDrag",be,Ee.setState),Pe("onError",Se,Ee.setState),Pe("connectionRadius",Ae,Ee.setState),Pe("isValidConnection",$e,Ee.setState),Pe("nodeDragThreshold",de,Ee.setState),jn(e,De),jn(t,He),jn(S,We),jn(O,Xe),jn(ee,je),jn(T,at),null},sa={display:"none"},yp={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Pc="react-flow__node-desc",Dc="react-flow__edge-desc",gp="react-flow__aria-live",vp=e=>e.ariaLiveMessage;function wp({rfId:e}){const t=Fe(vp);return X.createElement("div",{id:`${gp}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:yp},t)}function xp({rfId:e,disableKeyboardA11y:t}){return X.createElement(X.Fragment,null,X.createElement("div",{id:`${Pc}-${e}`,style:sa},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),X.createElement("div",{id:`${Dc}-${e}`,style:sa},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&X.createElement(wp,{rfId:e}))}var Sr=(e=null,t={actInsideInputWithModifier:!0})=>{const[r,o]=$.useState(!1),s=$.useRef(!1),a=$.useRef(new Set([])),[u,l]=$.useMemo(()=>{if(e!==null){const p=(Array.isArray(e)?e:[e]).filter(v=>typeof v=="string").map(v=>v.split("+")),m=p.reduce((v,w)=>v.concat(...w),[]);return[p,m]}return[[],[]]},[e]);return $.useEffect(()=>{const d=typeof document<"u"?document:null,p=(t==null?void 0:t.target)||d;if(e!==null){const m=g=>{if(s.current=g.ctrlKey||g.metaKey||g.shiftKey,(!s.current||s.current&&!t.actInsideInputWithModifier)&&Ii(g))return!1;const S=ca(g.code,l);a.current.add(g[S]),aa(u,a.current,!1)&&(g.preventDefault(),o(!0))},v=g=>{if((!s.current||s.current&&!t.actInsideInputWithModifier)&&Ii(g))return!1;const S=ca(g.code,l);aa(u,a.current,!0)?(o(!1),a.current.clear()):a.current.delete(g[S]),g.key==="Meta"&&a.current.clear(),s.current=!1},w=()=>{a.current.clear(),o(!1)};return p==null||p.addEventListener("keydown",m),p==null||p.addEventListener("keyup",v),window.addEventListener("blur",w),()=>{p==null||p.removeEventListener("keydown",m),p==null||p.removeEventListener("keyup",v),window.removeEventListener("blur",w)}}},[e,o]),r};function aa(e,t,r){return e.filter(o=>r||o.length===t.size).some(o=>o.every(s=>t.has(s)))}function ca(e,t){return t.includes(e)?"code":"key"}function Rc(e,t,r,o){var l,d;const s=e.parentNode||e.parentId;if(!s)return r;const a=t.get(s),u=_n(a,o);return Rc(a,t,{x:(r.x??0)+u.x,y:(r.y??0)+u.y,z:(((l=a[qe])==null?void 0:l.z)??0)>(r.z??0)?((d=a[qe])==null?void 0:d.z)??0:r.z??0},o)}function $c(e,t,r){e.forEach(o=>{var a;const s=o.parentNode||o.parentId;if(s&&!e.has(s))throw new Error(`Parent node ${s} not found`);if(s||r!=null&&r[o.id]){const{x:u,y:l,z:d}=Rc(o,e,{...o.position,z:((a=o[qe])==null?void 0:a.z)??0},t);o.positionAbsolute={x:u,y:l},o[qe].z=d,r!=null&&r[o.id]&&(o[qe].isParent=!0)}})}function yi(e,t,r,o){const s=new Map,a={},u=o?1e3:0;return e.forEach(l=>{var g;const d=(_t(l.zIndex)?l.zIndex:0)+(l.selected?u:0),p=t.get(l.id),m={...l,positionAbsolute:{x:l.position.x,y:l.position.y}},v=l.parentNode||l.parentId;v&&(a[v]=!0);const w=(p==null?void 0:p.type)&&(p==null?void 0:p.type)!==l.type;Object.defineProperty(m,qe,{enumerable:!1,value:{handleBounds:w||(g=p==null?void 0:p[qe])==null?void 0:g.handleBounds,z:d}}),s.set(l.id,m)}),$c(s,r,a),s}function Oc(e,t={}){const{getNodes:r,width:o,height:s,minZoom:a,maxZoom:u,d3Zoom:l,d3Selection:d,fitViewOnInitDone:p,fitViewOnInit:m,nodeOrigin:v}=e(),w=t.initial&&!p&&m;if(l&&d&&(w||!t.initial)){const k=r().filter(O=>{var K;const T=t.includeHiddenNodes?O.width&&O.height:!O.hidden;return(K=t.nodes)!=null&&K.length?T&&t.nodes.some(z=>z.id===O.id):T}),S=k.every(O=>O.width&&O.height);if(k.length>0&&S){const O=Mo(k,v),{x:T,y:K,zoom:z}=bc(O,o,s,t.minZoom??a,t.maxZoom??u,t.padding??.1),C=Zt.translate(T,K).scale(z);return typeof t.duration=="number"&&t.duration>0?l.transform(vn(d,t.duration),C):l.transform(d,C),!0}}return!1}function bp(e,t){return e.forEach(r=>{const o=t.get(r.id);o&&t.set(o.id,{...o,[qe]:o[qe],selected:r.selected})}),new Map(t)}function _p(e,t){return t.map(r=>{const o=e.find(s=>s.id===r.id);return o&&(r.selected=o.selected),r})}function io({changedNodes:e,changedEdges:t,get:r,set:o}){const{nodeInternals:s,edges:a,onNodesChange:u,onEdgesChange:l,hasDefaultNodes:d,hasDefaultEdges:p}=r();e!=null&&e.length&&(d&&o({nodeInternals:bp(e,s)}),u==null||u(e)),t!=null&&t.length&&(p&&o({edges:_p(t,a)}),l==null||l(t))}const Bn=()=>{},Ep={zoomIn:Bn,zoomOut:Bn,zoomTo:Bn,getZoom:()=>1,setViewport:Bn,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:Bn,fitBounds:Bn,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},kp=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),Sp=()=>{const e=Ue(),{d3Zoom:t,d3Selection:r}=Fe(kp,Qe);return $.useMemo(()=>r&&t?{zoomIn:s=>t.scaleBy(vn(r,s==null?void 0:s.duration),1.2),zoomOut:s=>t.scaleBy(vn(r,s==null?void 0:s.duration),1/1.2),zoomTo:(s,a)=>t.scaleTo(vn(r,a==null?void 0:a.duration),s),getZoom:()=>e.getState().transform[2],setViewport:(s,a)=>{const[u,l,d]=e.getState().transform,p=Zt.translate(s.x??u,s.y??l).scale(s.zoom??d);t.transform(vn(r,a==null?void 0:a.duration),p)},getViewport:()=>{const[s,a,u]=e.getState().transform;return{x:s,y:a,zoom:u}},fitView:s=>Oc(e.getState,s),setCenter:(s,a,u)=>{const{width:l,height:d,maxZoom:p}=e.getState(),m=typeof(u==null?void 0:u.zoom)<"u"?u.zoom:p,v=l/2-s*m,w=d/2-a*m,g=Zt.translate(v,w).scale(m);t.transform(vn(r,u==null?void 0:u.duration),g)},fitBounds:(s,a)=>{const{width:u,height:l,minZoom:d,maxZoom:p}=e.getState(),{x:m,y:v,zoom:w}=bc(s,u,l,d,p,(a==null?void 0:a.padding)??.1),g=Zt.translate(m,v).scale(w);t.transform(vn(r,a==null?void 0:a.duration),g)},project:s=>{const{transform:a,snapToGrid:u,snapGrid:l}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),Di(s,a,u,l)},screenToFlowPosition:s=>{const{transform:a,snapToGrid:u,snapGrid:l,domNode:d}=e.getState();if(!d)return s;const{x:p,y:m}=d.getBoundingClientRect(),v={x:s.x-p,y:s.y-m};return Di(v,a,u,l)},flowToScreenPosition:s=>{const{transform:a,domNode:u}=e.getState();if(!u)return s;const{x:l,y:d}=u.getBoundingClientRect(),p=vc(s,a);return{x:p.x+l,y:p.y+d}},viewportInitialized:!0}:Ep,[t,r])};function rs(){const e=Sp(),t=Ue(),r=$.useCallback(()=>t.getState().getNodes().map(S=>({...S})),[]),o=$.useCallback(S=>t.getState().nodeInternals.get(S),[]),s=$.useCallback(()=>{const{edges:S=[]}=t.getState();return S.map(O=>({...O}))},[]),a=$.useCallback(S=>{const{edges:O=[]}=t.getState();return O.find(T=>T.id===S)},[]),u=$.useCallback(S=>{const{getNodes:O,setNodes:T,hasDefaultNodes:K,onNodesChange:z}=t.getState(),C=O(),U=typeof S=="function"?S(C):S;if(K)T(U);else if(z){const Q=U.length===0?C.map(Y=>({type:"remove",id:Y.id})):U.map(Y=>({item:Y,type:"reset"}));z(Q)}},[]),l=$.useCallback(S=>{const{edges:O=[],setEdges:T,hasDefaultEdges:K,onEdgesChange:z}=t.getState(),C=typeof S=="function"?S(O):S;if(K)T(C);else if(z){const U=C.length===0?O.map(Q=>({type:"remove",id:Q.id})):C.map(Q=>({item:Q,type:"reset"}));z(U)}},[]),d=$.useCallback(S=>{const O=Array.isArray(S)?S:[S],{getNodes:T,setNodes:K,hasDefaultNodes:z,onNodesChange:C}=t.getState();if(z){const Q=[...T(),...O];K(Q)}else if(C){const U=O.map(Q=>({item:Q,type:"add"}));C(U)}},[]),p=$.useCallback(S=>{const O=Array.isArray(S)?S:[S],{edges:T=[],setEdges:K,hasDefaultEdges:z,onEdgesChange:C}=t.getState();if(z)K([...T,...O]);else if(C){const U=O.map(Q=>({item:Q,type:"add"}));C(U)}},[]),m=$.useCallback(()=>{const{getNodes:S,edges:O=[],transform:T}=t.getState(),[K,z,C]=T;return{nodes:S().map(U=>({...U})),edges:O.map(U=>({...U})),viewport:{x:K,y:z,zoom:C}}},[]),v=$.useCallback(({nodes:S,edges:O})=>{const{nodeInternals:T,getNodes:K,edges:z,hasDefaultNodes:C,hasDefaultEdges:U,onNodesDelete:Q,onEdgesDelete:Y,onNodesChange:ee,onEdgesChange:G}=t.getState(),ne=(S||[]).map(q=>q.id),oe=(O||[]).map(q=>q.id),le=K().reduce((q,j)=>{const re=j.parentNode||j.parentId,J=!ne.includes(j.id)&&re&&q.find(Z=>Z.id===re);return(typeof j.deletable=="boolean"?j.deletable:!0)&&(ne.includes(j.id)||J)&&q.push(j),q},[]),se=z.filter(q=>typeof q.deletable=="boolean"?q.deletable:!0),b=se.filter(q=>oe.includes(q.id));if(le||b){const q=xc(le,se),j=[...b,...q],re=j.reduce((J,L)=>(J.includes(L.id)||J.push(L.id),J),[]);if((U||C)&&(U&&t.setState({edges:z.filter(J=>!re.includes(J.id))}),C&&(le.forEach(J=>{T.delete(J.id)}),t.setState({nodeInternals:new Map(T)}))),re.length>0&&(Y==null||Y(j),G&&G(re.map(J=>({id:J,type:"remove"})))),le.length>0&&(Q==null||Q(le),ee)){const J=le.map(L=>({id:L.id,type:"remove"}));ee(J)}}},[]),w=$.useCallback(S=>{const O=Wh(S),T=O?null:t.getState().nodeInternals.get(S.id);return!O&&!T?[null,null,O]:[O?S:Js(T),T,O]},[]),g=$.useCallback((S,O=!0,T)=>{const[K,z,C]=w(S);return K?(T||t.getState().getNodes()).filter(U=>{if(!C&&(U.id===z.id||!U.positionAbsolute))return!1;const Q=Js(U),Y=Ti(Q,K);return O&&Y>0||Y>=K.width*K.height}):[]},[]),k=$.useCallback((S,O,T=!0)=>{const[K]=w(S);if(!K)return!1;const z=Ti(K,O);return T&&z>0||z>=K.width*K.height},[]);return $.useMemo(()=>({...e,getNodes:r,getNode:o,getEdges:s,getEdge:a,setNodes:u,setEdges:l,addNodes:d,addEdges:p,toObject:m,deleteElements:v,getIntersectingNodes:g,isNodeIntersecting:k}),[e,r,o,s,a,u,l,d,p,m,v,g,k])}const Np={actInsideInputWithModifier:!1};var Cp=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const r=Ue(),{deleteElements:o}=rs(),s=Sr(e,Np),a=Sr(t);$.useEffect(()=>{if(s){const{edges:u,getNodes:l}=r.getState(),d=l().filter(m=>m.selected),p=u.filter(m=>m.selected);o({nodes:d,edges:p}),r.setState({nodesSelectionActive:!1})}},[s]),$.useEffect(()=>{r.setState({multiSelectionActive:a})},[a])};function Ap(e){const t=Ue();$.useEffect(()=>{let r;const o=()=>{var a,u;if(!e.current)return;const s=Xi(e.current);(s.height===0||s.width===0)&&((u=(a=t.getState()).onError)==null||u.call(a,"004",Jt.error004())),t.setState({width:s.width||500,height:s.height||500})};return o(),window.addEventListener("resize",o),e.current&&(r=new ResizeObserver(()=>o()),r.observe(e.current)),()=>{window.removeEventListener("resize",o),r&&e.current&&r.unobserve(e.current)}},[])}const os={position:"absolute",width:"100%",height:"100%",top:0,left:0},Tp=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,so=e=>({x:e.x,y:e.y,zoom:e.k}),Fn=(e,t)=>e.target.closest(`.${t}`),ua=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),la=e=>{const t=e.ctrlKey&&wo()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},Ip=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),Mp=({onMove:e,onMoveStart:t,onMoveEnd:r,onPaneContextMenu:o,zoomOnScroll:s=!0,zoomOnPinch:a=!0,panOnScroll:u=!1,panOnScrollSpeed:l=.5,panOnScrollMode:d=xn.Free,zoomOnDoubleClick:p=!0,elementsSelectable:m,panOnDrag:v=!0,defaultViewport:w,translateExtent:g,minZoom:k,maxZoom:S,zoomActivationKeyCode:O,preventScrolling:T=!0,children:K,noWheelClassName:z,noPanClassName:C})=>{const U=$.useRef(),Q=Ue(),Y=$.useRef(!1),ee=$.useRef(!1),G=$.useRef(null),ne=$.useRef({x:0,y:0,zoom:0}),{d3Zoom:oe,d3Selection:le,d3ZoomHandler:se,userSelectionActive:b}=Fe(Ip,Qe),q=Sr(O),j=$.useRef(0),re=$.useRef(!1),J=$.useRef();return Ap(G),$.useEffect(()=>{if(G.current){const L=G.current.getBoundingClientRect(),Z=sc().scaleExtent([k,S]).translateExtent(g),ie=bt(G.current).call(Z),ae=Zt.translate(w.x,w.y).scale(Xn(w.zoom,k,S)),ve=[[0,0],[L.width,L.height]],ge=Z.constrain()(ae,ve,g);Z.transform(ie,ge),Z.wheelDelta(la),Q.setState({d3Zoom:Z,d3Selection:ie,d3ZoomHandler:ie.on("wheel.zoom"),transform:[ge.x,ge.y,ge.k],domNode:G.current.closest(".react-flow")})}},[]),$.useEffect(()=>{le&&oe&&(u&&!q&&!b?le.on("wheel.zoom",L=>{if(Fn(L,z))return!1;L.preventDefault(),L.stopImmediatePropagation();const Z=le.property("__zoom").k||1;if(L.ctrlKey&&a){const $e=Ct(L),de=la(L),De=Z*Math.pow(2,de);oe.scaleTo(le,De,$e,L);return}const ie=L.deltaMode===1?20:1;let ae=d===xn.Vertical?0:L.deltaX*ie,ve=d===xn.Horizontal?0:L.deltaY*ie;!wo()&&L.shiftKey&&d!==xn.Vertical&&(ae=L.deltaY*ie,ve=0),oe.translateBy(le,-(ae/Z)*l,-(ve/Z)*l,{internal:!0});const ge=so(le.property("__zoom")),{onViewportChangeStart:be,onViewportChange:Se,onViewportChangeEnd:Ae}=Q.getState();clearTimeout(J.current),re.current||(re.current=!0,t==null||t(L,ge),be==null||be(ge)),re.current&&(e==null||e(L,ge),Se==null||Se(ge),J.current=setTimeout(()=>{r==null||r(L,ge),Ae==null||Ae(ge),re.current=!1},150))},{passive:!1}):typeof se<"u"&&le.on("wheel.zoom",function(L,Z){if(!T&&L.type==="wheel"&&!L.ctrlKey||Fn(L,z))return null;L.preventDefault(),se.call(this,L,Z)},{passive:!1}))},[b,u,d,le,oe,se,q,a,T,z,t,e,r]),$.useEffect(()=>{oe&&oe.on("start",L=>{var ae,ve;if(!L.sourceEvent||L.sourceEvent.internal)return null;j.current=(ae=L.sourceEvent)==null?void 0:ae.button;const{onViewportChangeStart:Z}=Q.getState(),ie=so(L.transform);Y.current=!0,ne.current=ie,((ve=L.sourceEvent)==null?void 0:ve.type)==="mousedown"&&Q.setState({paneDragging:!0}),Z==null||Z(ie),t==null||t(L.sourceEvent,ie)})},[oe,t]),$.useEffect(()=>{oe&&(b&&!Y.current?oe.on("zoom",null):b||oe.on("zoom",L=>{var ie;const{onViewportChange:Z}=Q.getState();if(Q.setState({transform:[L.transform.x,L.transform.y,L.transform.k]}),ee.current=!!(o&&ua(v,j.current??0)),(e||Z)&&!((ie=L.sourceEvent)!=null&&ie.internal)){const ae=so(L.transform);Z==null||Z(ae),e==null||e(L.sourceEvent,ae)}}))},[b,oe,e,v,o]),$.useEffect(()=>{oe&&oe.on("end",L=>{if(!L.sourceEvent||L.sourceEvent.internal)return null;const{onViewportChangeEnd:Z}=Q.getState();if(Y.current=!1,Q.setState({paneDragging:!1}),o&&ua(v,j.current??0)&&!ee.current&&o(L.sourceEvent),ee.current=!1,(r||Z)&&Tp(ne.current,L.transform)){const ie=so(L.transform);ne.current=ie,clearTimeout(U.current),U.current=setTimeout(()=>{Z==null||Z(ie),r==null||r(L.sourceEvent,ie)},u?150:0)}})},[oe,u,v,r,o]),$.useEffect(()=>{oe&&oe.filter(L=>{const Z=q||s,ie=a&&L.ctrlKey;if((v===!0||Array.isArray(v)&&v.includes(1))&&L.button===1&&L.type==="mousedown"&&(Fn(L,"react-flow__node")||Fn(L,"react-flow__edge")))return!0;if(!v&&!Z&&!u&&!p&&!a||b||!p&&L.type==="dblclick"||Fn(L,z)&&L.type==="wheel"||Fn(L,C)&&(L.type!=="wheel"||u&&L.type==="wheel"&&!q)||!a&&L.ctrlKey&&L.type==="wheel"||!Z&&!u&&!ie&&L.type==="wheel"||!v&&(L.type==="mousedown"||L.type==="touchstart")||Array.isArray(v)&&!v.includes(L.button)&&L.type==="mousedown")return!1;const ae=Array.isArray(v)&&v.includes(L.button)||!L.button||L.button<=1;return(!L.ctrlKey||L.type==="wheel")&&ae})},[b,oe,s,a,u,p,v,m,q]),X.createElement("div",{className:"react-flow__renderer",ref:G,style:os},K)},Pp=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function Dp(){const{userSelectionActive:e,userSelectionRect:t}=Fe(Pp,Qe);return e&&t?X.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function fa(e,t){const r=t.parentNode||t.parentId,o=e.find(s=>s.id===r);if(o){const s=t.position.x+t.width-o.width,a=t.position.y+t.height-o.height;if(s>0||a>0||t.position.x<0||t.position.y<0){if(o.style={...o.style},o.style.width=o.style.width??o.width,o.style.height=o.style.height??o.height,s>0&&(o.style.width+=s),a>0&&(o.style.height+=a),t.position.x<0){const u=Math.abs(t.position.x);o.position.x=o.position.x-u,o.style.width+=u,t.position.x=0}if(t.position.y<0){const u=Math.abs(t.position.y);o.position.y=o.position.y-u,o.style.height+=u,t.position.y=0}o.width=o.style.width,o.height=o.style.height}}}function Rp(e,t){if(e.some(o=>o.type==="reset"))return e.filter(o=>o.type==="reset").map(o=>o.item);const r=e.filter(o=>o.type==="add").map(o=>o.item);return t.reduce((o,s)=>{const a=e.filter(l=>l.id===s.id);if(a.length===0)return o.push(s),o;const u={...s};for(const l of a)if(l)switch(l.type){case"select":{u.selected=l.selected;break}case"position":{typeof l.position<"u"&&(u.position=l.position),typeof l.positionAbsolute<"u"&&(u.positionAbsolute=l.positionAbsolute),typeof l.dragging<"u"&&(u.dragging=l.dragging),u.expandParent&&fa(o,u);break}case"dimensions":{typeof l.dimensions<"u"&&(u.width=l.dimensions.width,u.height=l.dimensions.height),typeof l.updateStyle<"u"&&(u.style={...u.style||{},...l.dimensions}),typeof l.resizing=="boolean"&&(u.resizing=l.resizing),u.expandParent&&fa(o,u);break}case"remove":return o}return o.push(u),o},r)}function jc(e,t){return Rp(e,t)}const fn=(e,t)=>({id:e,type:"select",selected:t});function Kn(e,t){return e.reduce((r,o)=>{const s=t.includes(o.id);return!o.selected&&s?(o.selected=!0,r.push(fn(o.id,!0))):o.selected&&!s&&(o.selected=!1,r.push(fn(o.id,!1))),r},[])}const gi=(e,t)=>r=>{r.target===t.current&&(e==null||e(r))},$p=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),Bc=$.memo(({isSelecting:e,selectionMode:t=kr.Full,panOnDrag:r,onSelectionStart:o,onSelectionEnd:s,onPaneClick:a,onPaneContextMenu:u,onPaneScroll:l,onPaneMouseEnter:d,onPaneMouseMove:p,onPaneMouseLeave:m,children:v})=>{const w=$.useRef(null),g=Ue(),k=$.useRef(0),S=$.useRef(0),O=$.useRef(),{userSelectionActive:T,elementsSelectable:K,dragging:z}=Fe($p,Qe),C=()=>{g.setState({userSelectionActive:!1,userSelectionRect:null}),k.current=0,S.current=0},U=se=>{a==null||a(se),g.getState().resetSelectedElements(),g.setState({nodesSelectionActive:!1})},Q=se=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){se.preventDefault();return}u==null||u(se)},Y=l?se=>l(se):void 0,ee=se=>{const{resetSelectedElements:b,domNode:q}=g.getState();if(O.current=q==null?void 0:q.getBoundingClientRect(),!K||!e||se.button!==0||se.target!==w.current||!O.current)return;const{x:j,y:re}=pn(se,O.current);b(),g.setState({userSelectionRect:{width:0,height:0,startX:j,startY:re,x:j,y:re}}),o==null||o(se)},G=se=>{const{userSelectionRect:b,nodeInternals:q,edges:j,transform:re,onNodesChange:J,onEdgesChange:L,nodeOrigin:Z,getNodes:ie}=g.getState();if(!e||!O.current||!b)return;g.setState({userSelectionActive:!0,nodesSelectionActive:!1});const ae=pn(se,O.current),ve=b.startX??0,ge=b.startY??0,be={...b,x:ae.x<ve?ae.x:ve,y:ae.y<ge?ae.y:ge,width:Math.abs(ae.x-ve),height:Math.abs(ae.y-ge)},Se=ie(),Ae=wc(q,be,re,t===kr.Partial,!0,Z),$e=xc(Ae,j).map(De=>De.id),de=Ae.map(De=>De.id);if(k.current!==de.length){k.current=de.length;const De=Kn(Se,de);De.length&&(J==null||J(De))}if(S.current!==$e.length){S.current=$e.length;const De=Kn(j,$e);De.length&&(L==null||L(De))}g.setState({userSelectionRect:be})},ne=se=>{if(se.button!==0)return;const{userSelectionRect:b}=g.getState();!T&&b&&se.target===w.current&&(U==null||U(se)),g.setState({nodesSelectionActive:k.current>0}),C(),s==null||s(se)},oe=se=>{T&&(g.setState({nodesSelectionActive:k.current>0}),s==null||s(se)),C()},le=K&&(e||T);return X.createElement("div",{className:et(["react-flow__pane",{dragging:z,selection:e}]),onClick:le?void 0:gi(U,w),onContextMenu:gi(Q,w),onWheel:gi(Y,w),onMouseEnter:le?void 0:d,onMouseDown:le?ee:void 0,onMouseMove:le?G:p,onMouseUp:le?ne:void 0,onMouseLeave:le?oe:m,ref:w,style:os},v,X.createElement(Dp,null))});Bc.displayName="Pane";function Fc(e,t){const r=e.parentNode||e.parentId;if(!r)return!1;const o=t.get(r);return o?o.selected?!0:Fc(o,t):!1}function da(e,t,r){let o=e;do{if(o!=null&&o.matches(t))return!0;if(o===r.current)return!1;o=o.parentElement}while(o);return!1}function Op(e,t,r,o){return Array.from(e.values()).filter(s=>(s.selected||s.id===o)&&(!s.parentNode||s.parentId||!Fc(s,e))&&(s.draggable||t&&typeof s.draggable>"u")).map(s=>{var a,u;return{id:s.id,position:s.position||{x:0,y:0},positionAbsolute:s.positionAbsolute||{x:0,y:0},distance:{x:r.x-(((a=s.positionAbsolute)==null?void 0:a.x)??0),y:r.y-(((u=s.positionAbsolute)==null?void 0:u.y)??0)},delta:{x:0,y:0},extent:s.extent,parentNode:s.parentNode||s.parentId,parentId:s.parentNode||s.parentId,width:s.width,height:s.height,expandParent:s.expandParent}})}function jp(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function zc(e,t,r,o,s=[0,0],a){const u=jp(e,e.extent||o);let l=u;const d=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(d&&e.width&&e.height){const v=r.get(d),{x:w,y:g}=_n(v,s).positionAbsolute;l=v&&_t(w)&&_t(g)&&_t(v.width)&&_t(v.height)?[[w+e.width*s[0],g+e.height*s[1]],[w+v.width-e.width+e.width*s[0],g+v.height-e.height+e.height*s[1]]]:l}else a==null||a("005",Jt.error005()),l=u;else if(e.extent&&d&&e.extent!=="parent"){const v=r.get(d),{x:w,y:g}=_n(v,s).positionAbsolute;l=[[e.extent[0][0]+w,e.extent[0][1]+g],[e.extent[1][0]+w,e.extent[1][1]+g]]}let p={x:0,y:0};if(d){const v=r.get(d);p=_n(v,s).positionAbsolute}const m=l&&l!=="parent"?Gi(t,l):t;return{position:{x:m.x-p.x,y:m.y-p.y},positionAbsolute:m}}function vi({nodeId:e,dragItems:t,nodeInternals:r}){const o=t.map(s=>({...r.get(s.id),position:s.position,positionAbsolute:s.positionAbsolute}));return[e?o.find(s=>s.id===e):o[0],o]}const ha=(e,t,r,o)=>{const s=t.querySelectorAll(e);if(!s||!s.length)return null;const a=Array.from(s),u=t.getBoundingClientRect(),l={x:u.width*o[0],y:u.height*o[1]};return a.map(d=>{const p=d.getBoundingClientRect();return{id:d.getAttribute("data-handleid"),position:d.getAttribute("data-handlepos"),x:(p.left-u.left-l.x)/r,y:(p.top-u.top-l.y)/r,...Xi(d)}})};function hr(e,t,r){return r===void 0?r:o=>{const s=t().nodeInternals.get(e);s&&r(o,{...s})}}function $i({id:e,store:t,unselect:r=!1,nodeRef:o}){const{addSelectedNodes:s,unselectNodesAndEdges:a,multiSelectionActive:u,nodeInternals:l,onError:d}=t.getState(),p=l.get(e);if(!p){d==null||d("012",Jt.error012(e));return}t.setState({nodesSelectionActive:!1}),p.selected?(r||p.selected&&u)&&(a({nodes:[p],edges:[]}),requestAnimationFrame(()=>{var m;return(m=o==null?void 0:o.current)==null?void 0:m.blur()})):s([e])}function Bp(){const e=Ue();return $.useCallback(({sourceEvent:r})=>{const{transform:o,snapGrid:s,snapToGrid:a}=e.getState(),u=r.touches?r.touches[0].clientX:r.clientX,l=r.touches?r.touches[0].clientY:r.clientY,d={x:(u-o[0])/o[2],y:(l-o[1])/o[2]};return{xSnapped:a?s[0]*Math.round(d.x/s[0]):d.x,ySnapped:a?s[1]*Math.round(d.y/s[1]):d.y,...d}},[])}function wi(e){return(t,r,o)=>e==null?void 0:e(t,o)}function Lc({nodeRef:e,disabled:t=!1,noDragClassName:r,handleSelector:o,nodeId:s,isSelectable:a,selectNodesOnDrag:u}){const l=Ue(),[d,p]=$.useState(!1),m=$.useRef([]),v=$.useRef({x:null,y:null}),w=$.useRef(0),g=$.useRef(null),k=$.useRef({x:0,y:0}),S=$.useRef(null),O=$.useRef(!1),T=$.useRef(!1),K=$.useRef(!1),z=Bp();return $.useEffect(()=>{if(e!=null&&e.current){const C=bt(e.current),U=({x:ee,y:G})=>{const{nodeInternals:ne,onNodeDrag:oe,onSelectionDrag:le,updateNodePositions:se,nodeExtent:b,snapGrid:q,snapToGrid:j,nodeOrigin:re,onError:J}=l.getState();v.current={x:ee,y:G};let L=!1,Z={x:0,y:0,x2:0,y2:0};if(m.current.length>1&&b){const ae=Mo(m.current,re);Z=Er(ae)}if(m.current=m.current.map(ae=>{const ve={x:ee-ae.distance.x,y:G-ae.distance.y};j&&(ve.x=q[0]*Math.round(ve.x/q[0]),ve.y=q[1]*Math.round(ve.y/q[1]));const ge=[[b[0][0],b[0][1]],[b[1][0],b[1][1]]];m.current.length>1&&b&&!ae.extent&&(ge[0][0]=ae.positionAbsolute.x-Z.x+b[0][0],ge[1][0]=ae.positionAbsolute.x+(ae.width??0)-Z.x2+b[1][0],ge[0][1]=ae.positionAbsolute.y-Z.y+b[0][1],ge[1][1]=ae.positionAbsolute.y+(ae.height??0)-Z.y2+b[1][1]);const be=zc(ae,ve,ne,ge,re,J);return L=L||ae.position.x!==be.position.x||ae.position.y!==be.position.y,ae.position=be.position,ae.positionAbsolute=be.positionAbsolute,ae}),!L)return;se(m.current,!0,!0),p(!0);const ie=s?oe:wi(le);if(ie&&S.current){const[ae,ve]=vi({nodeId:s,dragItems:m.current,nodeInternals:ne});ie(S.current,ae,ve)}},Q=()=>{if(!g.current)return;const[ee,G]=cc(k.current,g.current);if(ee!==0||G!==0){const{transform:ne,panBy:oe}=l.getState();v.current.x=(v.current.x??0)-ee/ne[2],v.current.y=(v.current.y??0)-G/ne[2],oe({x:ee,y:G})&&U(v.current)}w.current=requestAnimationFrame(Q)},Y=ee=>{var re;const{nodeInternals:G,multiSelectionActive:ne,nodesDraggable:oe,unselectNodesAndEdges:le,onNodeDragStart:se,onSelectionDragStart:b}=l.getState();T.current=!0;const q=s?se:wi(b);(!u||!a)&&!ne&&s&&((re=G.get(s))!=null&&re.selected||le()),s&&a&&u&&$i({id:s,store:l,nodeRef:e});const j=z(ee);if(v.current=j,m.current=Op(G,oe,j,s),q&&m.current){const[J,L]=vi({nodeId:s,dragItems:m.current,nodeInternals:G});q(ee.sourceEvent,J,L)}};if(t)C.on(".drag",null);else{const ee=Xf().on("start",G=>{const{domNode:ne,nodeDragThreshold:oe}=l.getState();oe===0&&Y(G),K.current=!1;const le=z(G);v.current=le,g.current=(ne==null?void 0:ne.getBoundingClientRect())||null,k.current=pn(G.sourceEvent,g.current)}).on("drag",G=>{var se,b;const ne=z(G),{autoPanOnNodeDrag:oe,nodeDragThreshold:le}=l.getState();if(G.sourceEvent.type==="touchmove"&&G.sourceEvent.touches.length>1&&(K.current=!0),!K.current){if(!O.current&&T.current&&oe&&(O.current=!0,Q()),!T.current){const q=ne.xSnapped-(((se=v==null?void 0:v.current)==null?void 0:se.x)??0),j=ne.ySnapped-(((b=v==null?void 0:v.current)==null?void 0:b.y)??0);Math.sqrt(q*q+j*j)>le&&Y(G)}(v.current.x!==ne.xSnapped||v.current.y!==ne.ySnapped)&&m.current&&T.current&&(S.current=G.sourceEvent,k.current=pn(G.sourceEvent,g.current),U(ne))}}).on("end",G=>{if(!(!T.current||K.current)&&(p(!1),O.current=!1,T.current=!1,cancelAnimationFrame(w.current),m.current)){const{updateNodePositions:ne,nodeInternals:oe,onNodeDragStop:le,onSelectionDragStop:se}=l.getState(),b=s?le:wi(se);if(ne(m.current,!1,!1),b){const[q,j]=vi({nodeId:s,dragItems:m.current,nodeInternals:oe});b(G.sourceEvent,q,j)}}}).filter(G=>{const ne=G.target;return!G.button&&(!r||!da(ne,`.${r}`,e))&&(!o||da(ne,o,e))});return C.call(ee),()=>{C.on(".drag",null)}}}},[e,t,r,o,a,l,s,u,z]),d}function Kc(){const e=Ue();return $.useCallback(r=>{const{nodeInternals:o,nodeExtent:s,updateNodePositions:a,getNodes:u,snapToGrid:l,snapGrid:d,onError:p,nodesDraggable:m}=e.getState(),v=u().filter(K=>K.selected&&(K.draggable||m&&typeof K.draggable>"u")),w=l?d[0]:5,g=l?d[1]:5,k=r.isShiftPressed?4:1,S=r.x*w*k,O=r.y*g*k,T=v.map(K=>{if(K.positionAbsolute){const z={x:K.positionAbsolute.x+S,y:K.positionAbsolute.y+O};l&&(z.x=d[0]*Math.round(z.x/d[0]),z.y=d[1]*Math.round(z.y/d[1]));const{positionAbsolute:C,position:U}=zc(K,z,o,s,void 0,p);K.position=U,K.positionAbsolute=C}return K});a(T,!0,!1)},[])}const Wn={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var pr=e=>{const t=({id:r,type:o,data:s,xPos:a,yPos:u,xPosOrigin:l,yPosOrigin:d,selected:p,onClick:m,onMouseEnter:v,onMouseMove:w,onMouseLeave:g,onContextMenu:k,onDoubleClick:S,style:O,className:T,isDraggable:K,isSelectable:z,isConnectable:C,isFocusable:U,selectNodesOnDrag:Q,sourcePosition:Y,targetPosition:ee,hidden:G,resizeObserver:ne,dragHandle:oe,zIndex:le,isParent:se,noDragClassName:b,noPanClassName:q,initialized:j,disableKeyboardA11y:re,ariaLabel:J,rfId:L,hasHandleBounds:Z})=>{const ie=Ue(),ae=$.useRef(null),ve=$.useRef(null),ge=$.useRef(Y),be=$.useRef(ee),Se=$.useRef(o),Ae=z||K||m||v||w||g,$e=Kc(),de=hr(r,ie.getState,v),De=hr(r,ie.getState,w),He=hr(r,ie.getState,g),ke=hr(r,ie.getState,k),We=hr(r,ie.getState,S),Xe=Oe=>{const{nodeDragThreshold:Ee}=ie.getState();if(z&&(!Q||!K||Ee>0)&&$i({id:r,store:ie,nodeRef:ae}),m){const Je=ie.getState().nodeInternals.get(r);Je&&m(Oe,{...Je})}},je=Oe=>{if(!Ii(Oe)&&!re)if(dc.includes(Oe.key)&&z){const Ee=Oe.key==="Escape";$i({id:r,store:ie,unselect:Ee,nodeRef:ae})}else K&&p&&Object.prototype.hasOwnProperty.call(Wn,Oe.key)&&(ie.setState({ariaLiveMessage:`Moved selected node ${Oe.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~a}, y: ${~~u}`}),$e({x:Wn[Oe.key].x,y:Wn[Oe.key].y,isShiftPressed:Oe.shiftKey}))};$.useEffect(()=>()=>{ve.current&&(ne==null||ne.unobserve(ve.current),ve.current=null)},[]),$.useEffect(()=>{if(ae.current&&!G){const Oe=ae.current;(!j||!Z||ve.current!==Oe)&&(ve.current&&(ne==null||ne.unobserve(ve.current)),ne==null||ne.observe(Oe),ve.current=Oe)}},[G,j,Z]),$.useEffect(()=>{const Oe=Se.current!==o,Ee=ge.current!==Y,Je=be.current!==ee;ae.current&&(Oe||Ee||Je)&&(Oe&&(Se.current=o),Ee&&(ge.current=Y),Je&&(be.current=ee),ie.getState().updateNodeDimensions([{id:r,nodeElement:ae.current,forceUpdate:!0}]))},[r,o,Y,ee]);const at=Lc({nodeRef:ae,disabled:G||!K,noDragClassName:b,handleSelector:oe,nodeId:r,isSelectable:z,selectNodesOnDrag:Q});return G?null:X.createElement("div",{className:et(["react-flow__node",`react-flow__node-${o}`,{[q]:K},T,{selected:p,selectable:z,parent:se,dragging:at}]),ref:ae,style:{zIndex:le,transform:`translate(${l}px,${d}px)`,pointerEvents:Ae?"all":"none",visibility:j?"visible":"hidden",...O},"data-id":r,"data-testid":`rf__node-${r}`,onMouseEnter:de,onMouseMove:De,onMouseLeave:He,onContextMenu:ke,onClick:Xe,onDoubleClick:We,onKeyDown:U?je:void 0,tabIndex:U?0:void 0,role:U?"button":void 0,"aria-describedby":re?void 0:`${Pc}-${L}`,"aria-label":J},X.createElement(Qh,{value:r},X.createElement(e,{id:r,data:s,type:o,xPos:a,yPos:u,selected:p,isConnectable:C,sourcePosition:Y,targetPosition:ee,dragging:at,dragHandle:oe,zIndex:le})))};return t.displayName="NodeWrapper",$.memo(t)};const Fp=e=>{const t=e.getNodes().filter(r=>r.selected);return{...Mo(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function zp({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:r}){const o=Ue(),{width:s,height:a,x:u,y:l,transformString:d,userSelectionActive:p}=Fe(Fp,Qe),m=Kc(),v=$.useRef(null);if($.useEffect(()=>{var k;r||(k=v.current)==null||k.focus({preventScroll:!0})},[r]),Lc({nodeRef:v}),p||!s||!a)return null;const w=e?k=>{const S=o.getState().getNodes().filter(O=>O.selected);e(k,S)}:void 0,g=k=>{Object.prototype.hasOwnProperty.call(Wn,k.key)&&m({x:Wn[k.key].x,y:Wn[k.key].y,isShiftPressed:k.shiftKey})};return X.createElement("div",{className:et(["react-flow__nodesselection","react-flow__container",t]),style:{transform:d}},X.createElement("div",{ref:v,className:"react-flow__nodesselection-rect",onContextMenu:w,tabIndex:r?void 0:-1,onKeyDown:r?void 0:g,style:{width:s,height:a,top:l,left:u}}))}var Lp=$.memo(zp);const Kp=e=>e.nodesSelectionActive,Hc=({children:e,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:a,onPaneScroll:u,deleteKeyCode:l,onMove:d,onMoveStart:p,onMoveEnd:m,selectionKeyCode:v,selectionOnDrag:w,selectionMode:g,onSelectionStart:k,onSelectionEnd:S,multiSelectionKeyCode:O,panActivationKeyCode:T,zoomActivationKeyCode:K,elementsSelectable:z,zoomOnScroll:C,zoomOnPinch:U,panOnScroll:Q,panOnScrollSpeed:Y,panOnScrollMode:ee,zoomOnDoubleClick:G,panOnDrag:ne,defaultViewport:oe,translateExtent:le,minZoom:se,maxZoom:b,preventScrolling:q,onSelectionContextMenu:j,noWheelClassName:re,noPanClassName:J,disableKeyboardA11y:L})=>{const Z=Fe(Kp),ie=Sr(v),ae=Sr(T),ve=ae||ne,ge=ae||Q,be=ie||w&&ve!==!0;return Cp({deleteKeyCode:l,multiSelectionKeyCode:O}),X.createElement(Mp,{onMove:d,onMoveStart:p,onMoveEnd:m,onPaneContextMenu:a,elementsSelectable:z,zoomOnScroll:C,zoomOnPinch:U,panOnScroll:ge,panOnScrollSpeed:Y,panOnScrollMode:ee,zoomOnDoubleClick:G,panOnDrag:!ie&&ve,defaultViewport:oe,translateExtent:le,minZoom:se,maxZoom:b,zoomActivationKeyCode:K,preventScrolling:q,noWheelClassName:re,noPanClassName:J},X.createElement(Bc,{onSelectionStart:k,onSelectionEnd:S,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:a,onPaneScroll:u,panOnDrag:ve,isSelecting:!!be,selectionMode:g},e,Z&&X.createElement(Lp,{onSelectionContextMenu:j,noPanClassName:J,disableKeyboardA11y:L})))};Hc.displayName="FlowRenderer";var Hp=$.memo(Hc);function qp(e){return Fe($.useCallback(r=>e?wc(r.nodeInternals,{x:0,y:0,width:r.width,height:r.height},r.transform,!0):r.getNodes(),[e]))}function Wp(e){const t={input:pr(e.input||Ac),default:pr(e.default||Ri),output:pr(e.output||Ic),group:pr(e.group||ns)},r={},o=Object.keys(e).filter(s=>!["input","default","output","group"].includes(s)).reduce((s,a)=>(s[a]=pr(e[a]||Ri),s),r);return{...t,...o}}const Vp=({x:e,y:t,width:r,height:o,origin:s})=>!r||!o?{x:e,y:t}:s[0]<0||s[1]<0||s[0]>1||s[1]>1?{x:e,y:t}:{x:e-r*s[0],y:t-o*s[1]},Yp=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),qc=e=>{const{nodesDraggable:t,nodesConnectable:r,nodesFocusable:o,elementsSelectable:s,updateNodeDimensions:a,onError:u}=Fe(Yp,Qe),l=qp(e.onlyRenderVisibleElements),d=$.useRef(),p=$.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const m=new ResizeObserver(v=>{const w=v.map(g=>({id:g.target.getAttribute("data-id"),nodeElement:g.target,forceUpdate:!0}));a(w)});return d.current=m,m},[]);return $.useEffect(()=>()=>{var m;(m=d==null?void 0:d.current)==null||m.disconnect()},[]),X.createElement("div",{className:"react-flow__nodes",style:os},l.map(m=>{var U,Q,Y;let v=m.type||"default";e.nodeTypes[v]||(u==null||u("003",Jt.error003(v)),v="default");const w=e.nodeTypes[v]||e.nodeTypes.default,g=!!(m.draggable||t&&typeof m.draggable>"u"),k=!!(m.selectable||s&&typeof m.selectable>"u"),S=!!(m.connectable||r&&typeof m.connectable>"u"),O=!!(m.focusable||o&&typeof m.focusable>"u"),T=e.nodeExtent?Gi(m.positionAbsolute,e.nodeExtent):m.positionAbsolute,K=(T==null?void 0:T.x)??0,z=(T==null?void 0:T.y)??0,C=Vp({x:K,y:z,width:m.width??0,height:m.height??0,origin:e.nodeOrigin});return X.createElement(w,{key:m.id,id:m.id,className:m.className,style:m.style,type:v,data:m.data,sourcePosition:m.sourcePosition||_e.Bottom,targetPosition:m.targetPosition||_e.Top,hidden:m.hidden,xPos:K,yPos:z,xPosOrigin:C.x,yPosOrigin:C.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!m.selected,isDraggable:g,isSelectable:k,isConnectable:S,isFocusable:O,resizeObserver:p,dragHandle:m.dragHandle,zIndex:((U=m[qe])==null?void 0:U.z)??0,isParent:!!((Q=m[qe])!=null&&Q.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!m.width&&!!m.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:m.ariaLabel,hasHandleBounds:!!((Y=m[qe])!=null&&Y.handleBounds)})}))};qc.displayName="NodeRenderer";var Up=$.memo(qc);const Xp=(e,t,r)=>r===_e.Left?e-t:r===_e.Right?e+t:e,Gp=(e,t,r)=>r===_e.Top?e-t:r===_e.Bottom?e+t:e,pa="react-flow__edgeupdater",ma=({position:e,centerX:t,centerY:r,radius:o=10,onMouseDown:s,onMouseEnter:a,onMouseOut:u,type:l})=>X.createElement("circle",{onMouseDown:s,onMouseEnter:a,onMouseOut:u,className:et([pa,`${pa}-${l}`]),cx:Xp(t,o,e),cy:Gp(r,o,e),r:o,stroke:"transparent",fill:"transparent"}),Zp=()=>!0;var zn=e=>{const t=({id:r,className:o,type:s,data:a,onClick:u,onEdgeDoubleClick:l,selected:d,animated:p,label:m,labelStyle:v,labelShowBg:w,labelBgStyle:g,labelBgPadding:k,labelBgBorderRadius:S,style:O,source:T,target:K,sourceX:z,sourceY:C,targetX:U,targetY:Q,sourcePosition:Y,targetPosition:ee,elementsSelectable:G,hidden:ne,sourceHandleId:oe,targetHandleId:le,onContextMenu:se,onMouseEnter:b,onMouseMove:q,onMouseLeave:j,reconnectRadius:re,onReconnect:J,onReconnectStart:L,onReconnectEnd:Z,markerEnd:ie,markerStart:ae,rfId:ve,ariaLabel:ge,isFocusable:be,isReconnectable:Se,pathOptions:Ae,interactionWidth:$e,disableKeyboardA11y:de})=>{const De=$.useRef(null),[He,ke]=$.useState(!1),[We,Xe]=$.useState(!1),je=Ue(),at=$.useMemo(()=>`url('#${Pi(ae,ve)}')`,[ae,ve]),Oe=$.useMemo(()=>`url('#${Pi(ie,ve)}')`,[ie,ve]);if(ne)return null;const Ee=Le=>{var Ge;const{edges:nt,addSelectedEdges:kt,unselectNodesAndEdges:rt,multiSelectionActive:xe}=je.getState(),ut=nt.find(Dt=>Dt.id===r);ut&&(G&&(je.setState({nodesSelectionActive:!1}),ut.selected&&xe?(rt({nodes:[],edges:[ut]}),(Ge=De.current)==null||Ge.blur()):kt([r])),u&&u(Le,ut))},Je=dr(r,je.getState,l),dt=dr(r,je.getState,se),tt=dr(r,je.getState,b),qt=dr(r,je.getState,q),yt=dr(r,je.getState,j),gt=(Le,nt)=>{if(Le.button!==0)return;const{edges:kt,isValidConnection:rt}=je.getState(),xe=nt?K:T,ut=(nt?le:oe)||null,Ge=nt?"target":"source",Dt=rt||Zp,me=nt,Wt=kt.find(Rt=>Rt.id===r);Xe(!0),L==null||L(Le,Wt,Ge);const Sn=Rt=>{Xe(!1),Z==null||Z(Rt,Wt,Ge)};kc({event:Le,handleId:ut,nodeId:xe,onConnect:Rt=>J==null?void 0:J(Wt,Rt),isTarget:me,getState:je.getState,setState:je.setState,isValidConnection:Dt,edgeUpdaterType:Ge,onReconnectEnd:Sn})},vt=Le=>gt(Le,!0),ct=Le=>gt(Le,!1),Et=()=>ke(!0),wt=()=>ke(!1),Mt=!G&&!u,Pt=Le=>{var nt;if(!de&&dc.includes(Le.key)&&G){const{unselectNodesAndEdges:kt,addSelectedEdges:rt,edges:xe}=je.getState();Le.key==="Escape"?((nt=De.current)==null||nt.blur(),kt({edges:[xe.find(Ge=>Ge.id===r)]})):rt([r])}};return X.createElement("g",{className:et(["react-flow__edge",`react-flow__edge-${s}`,o,{selected:d,animated:p,inactive:Mt,updating:He}]),onClick:Ee,onDoubleClick:Je,onContextMenu:dt,onMouseEnter:tt,onMouseMove:qt,onMouseLeave:yt,onKeyDown:be?Pt:void 0,tabIndex:be?0:void 0,role:be?"button":"img","data-testid":`rf__edge-${r}`,"aria-label":ge===null?void 0:ge||`Edge from ${T} to ${K}`,"aria-describedby":be?`${Dc}-${ve}`:void 0,ref:De},!We&&X.createElement(e,{id:r,source:T,target:K,selected:d,animated:p,label:m,labelStyle:v,labelShowBg:w,labelBgStyle:g,labelBgPadding:k,labelBgBorderRadius:S,data:a,style:O,sourceX:z,sourceY:C,targetX:U,targetY:Q,sourcePosition:Y,targetPosition:ee,sourceHandleId:oe,targetHandleId:le,markerStart:at,markerEnd:Oe,pathOptions:Ae,interactionWidth:$e}),Se&&X.createElement(X.Fragment,null,(Se==="source"||Se===!0)&&X.createElement(ma,{position:Y,centerX:z,centerY:C,radius:re,onMouseDown:vt,onMouseEnter:Et,onMouseOut:wt,type:"source"}),(Se==="target"||Se===!0)&&X.createElement(ma,{position:ee,centerX:U,centerY:Q,radius:re,onMouseDown:ct,onMouseEnter:Et,onMouseOut:wt,type:"target"})))};return t.displayName="EdgeWrapper",$.memo(t)};function Qp(e){const t={default:zn(e.default||bo),straight:zn(e.bezier||Ji),step:zn(e.step||Qi),smoothstep:zn(e.step||Io),simplebezier:zn(e.simplebezier||Zi)},r={},o=Object.keys(e).filter(s=>!["default","bezier"].includes(s)).reduce((s,a)=>(s[a]=zn(e[a]||bo),s),r);return{...t,...o}}function ya(e,t,r=null){const o=((r==null?void 0:r.x)||0)+t.x,s=((r==null?void 0:r.y)||0)+t.y,a=(r==null?void 0:r.width)||t.width,u=(r==null?void 0:r.height)||t.height;switch(e){case _e.Top:return{x:o+a/2,y:s};case _e.Right:return{x:o+a,y:s+u/2};case _e.Bottom:return{x:o+a/2,y:s+u};case _e.Left:return{x:o,y:s+u/2}}}function ga(e,t){return e?e.length===1||!t?e[0]:t&&e.find(r=>r.id===t)||null:null}const Jp=(e,t,r,o,s,a)=>{const u=ya(r,e,t),l=ya(a,o,s);return{sourceX:u.x,sourceY:u.y,targetX:l.x,targetY:l.y}};function em({sourcePos:e,targetPos:t,sourceWidth:r,sourceHeight:o,targetWidth:s,targetHeight:a,width:u,height:l,transform:d}){const p={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+r,t.x+s),y2:Math.max(e.y+o,t.y+a)};p.x===p.x2&&(p.x2+=1),p.y===p.y2&&(p.y2+=1);const m=Er({x:(0-d[0])/d[2],y:(0-d[1])/d[2],width:u/d[2],height:l/d[2]}),v=Math.max(0,Math.min(m.x2,p.x2)-Math.max(m.x,p.x)),w=Math.max(0,Math.min(m.y2,p.y2)-Math.max(m.y,p.y));return Math.ceil(v*w)>0}function va(e){var o,s,a,u,l;const t=((o=e==null?void 0:e[qe])==null?void 0:o.handleBounds)||null,r=t&&(e==null?void 0:e.width)&&(e==null?void 0:e.height)&&typeof((s=e==null?void 0:e.positionAbsolute)==null?void 0:s.x)<"u"&&typeof((a=e==null?void 0:e.positionAbsolute)==null?void 0:a.y)<"u";return[{x:((u=e==null?void 0:e.positionAbsolute)==null?void 0:u.x)||0,y:((l=e==null?void 0:e.positionAbsolute)==null?void 0:l.y)||0,width:(e==null?void 0:e.width)||0,height:(e==null?void 0:e.height)||0},t,!!r]}const tm=[{level:0,isMaxLevel:!0,edges:[]}];function nm(e,t,r=!1){let o=-1;const s=e.reduce((u,l)=>{var m,v;const d=_t(l.zIndex);let p=d?l.zIndex:0;if(r){const w=t.get(l.target),g=t.get(l.source),k=l.selected||(w==null?void 0:w.selected)||(g==null?void 0:g.selected),S=Math.max(((m=g==null?void 0:g[qe])==null?void 0:m.z)||0,((v=w==null?void 0:w[qe])==null?void 0:v.z)||0,1e3);p=(d?l.zIndex:0)+(k?S:0)}return u[p]?u[p].push(l):u[p]=[l],o=p>o?p:o,u},{}),a=Object.entries(s).map(([u,l])=>{const d=+u;return{edges:l,level:d,isMaxLevel:d===o}});return a.length===0?tm:a}function rm(e,t,r){const o=Fe($.useCallback(s=>e?s.edges.filter(a=>{const u=t.get(a.source),l=t.get(a.target);return(u==null?void 0:u.width)&&(u==null?void 0:u.height)&&(l==null?void 0:l.width)&&(l==null?void 0:l.height)&&em({sourcePos:u.positionAbsolute||{x:0,y:0},targetPos:l.positionAbsolute||{x:0,y:0},sourceWidth:u.width,sourceHeight:u.height,targetWidth:l.width,targetHeight:l.height,width:s.width,height:s.height,transform:s.transform})}):s.edges,[e,t]));return nm(o,t,r)}const om=({color:e="none",strokeWidth:t=1})=>X.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),im=({color:e="none",strokeWidth:t=1})=>X.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),wa={[xo.Arrow]:om,[xo.ArrowClosed]:im};function sm(e){const t=Ue();return $.useMemo(()=>{var s,a;return Object.prototype.hasOwnProperty.call(wa,e)?wa[e]:((a=(s=t.getState()).onError)==null||a.call(s,"009",Jt.error009(e)),null)},[e])}const am=({id:e,type:t,color:r,width:o=12.5,height:s=12.5,markerUnits:a="strokeWidth",strokeWidth:u,orient:l="auto-start-reverse"})=>{const d=sm(t);return d?X.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${o}`,markerHeight:`${s}`,viewBox:"-10 -10 20 20",markerUnits:a,orient:l,refX:"0",refY:"0"},X.createElement(d,{color:r,strokeWidth:u})):null},cm=({defaultColor:e,rfId:t})=>r=>{const o=[];return r.edges.reduce((s,a)=>([a.markerStart,a.markerEnd].forEach(u=>{if(u&&typeof u=="object"){const l=Pi(u,t);o.includes(l)||(s.push({id:l,color:u.color||e,...u}),o.push(l))}}),s),[]).sort((s,a)=>s.id.localeCompare(a.id))},Wc=({defaultColor:e,rfId:t})=>{const r=Fe($.useCallback(cm({defaultColor:e,rfId:t}),[e,t]),(o,s)=>!(o.length!==s.length||o.some((a,u)=>a.id!==s[u].id)));return X.createElement("defs",null,r.map(o=>X.createElement(am,{id:o.id,key:o.id,type:o.type,color:o.color,width:o.width,height:o.height,markerUnits:o.markerUnits,strokeWidth:o.strokeWidth,orient:o.orient})))};Wc.displayName="MarkerDefinitions";var um=$.memo(Wc);const lm=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),Vc=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:r,rfId:o,edgeTypes:s,noPanClassName:a,onEdgeContextMenu:u,onEdgeMouseEnter:l,onEdgeMouseMove:d,onEdgeMouseLeave:p,onEdgeClick:m,onEdgeDoubleClick:v,onReconnect:w,onReconnectStart:g,onReconnectEnd:k,reconnectRadius:S,children:O,disableKeyboardA11y:T})=>{const{edgesFocusable:K,edgesUpdatable:z,elementsSelectable:C,width:U,height:Q,connectionMode:Y,nodeInternals:ee,onError:G}=Fe(lm,Qe),ne=rm(t,ee,r);return U?X.createElement(X.Fragment,null,ne.map(({level:oe,edges:le,isMaxLevel:se})=>X.createElement("svg",{key:oe,style:{zIndex:oe},width:U,height:Q,className:"react-flow__edges react-flow__container"},se&&X.createElement(um,{defaultColor:e,rfId:o}),X.createElement("g",null,le.map(b=>{const[q,j,re]=va(ee.get(b.source)),[J,L,Z]=va(ee.get(b.target));if(!re||!Z)return null;let ie=b.type||"default";s[ie]||(G==null||G("011",Jt.error011(ie)),ie="default");const ae=s[ie]||s.default,ve=Y===kn.Strict?L.target:(L.target??[]).concat(L.source??[]),ge=ga(j.source,b.sourceHandle),be=ga(ve,b.targetHandle),Se=(ge==null?void 0:ge.position)||_e.Bottom,Ae=(be==null?void 0:be.position)||_e.Top,$e=!!(b.focusable||K&&typeof b.focusable>"u"),de=b.reconnectable||b.updatable,De=typeof w<"u"&&(de||z&&typeof de>"u");if(!ge||!be)return G==null||G("008",Jt.error008(ge,b)),null;const{sourceX:He,sourceY:ke,targetX:We,targetY:Xe}=Jp(q,ge,Se,J,be,Ae);return X.createElement(ae,{key:b.id,id:b.id,className:et([b.className,a]),type:ie,data:b.data,selected:!!b.selected,animated:!!b.animated,hidden:!!b.hidden,label:b.label,labelStyle:b.labelStyle,labelShowBg:b.labelShowBg,labelBgStyle:b.labelBgStyle,labelBgPadding:b.labelBgPadding,labelBgBorderRadius:b.labelBgBorderRadius,style:b.style,source:b.source,target:b.target,sourceHandleId:b.sourceHandle,targetHandleId:b.targetHandle,markerEnd:b.markerEnd,markerStart:b.markerStart,sourceX:He,sourceY:ke,targetX:We,targetY:Xe,sourcePosition:Se,targetPosition:Ae,elementsSelectable:C,onContextMenu:u,onMouseEnter:l,onMouseMove:d,onMouseLeave:p,onClick:m,onEdgeDoubleClick:v,onReconnect:w,onReconnectStart:g,onReconnectEnd:k,reconnectRadius:S,rfId:o,ariaLabel:b.ariaLabel,isFocusable:$e,isReconnectable:De,pathOptions:"pathOptions"in b?b.pathOptions:void 0,interactionWidth:b.interactionWidth,disableKeyboardA11y:T})})))),O):null};Vc.displayName="EdgeRenderer";var fm=$.memo(Vc);const dm=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function hm({children:e}){const t=Fe(dm);return X.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function pm(e){const t=rs(),r=$.useRef(!1);$.useEffect(()=>{!r.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),r.current=!0)},[e,t.viewportInitialized])}const mm={[_e.Left]:_e.Right,[_e.Right]:_e.Left,[_e.Top]:_e.Bottom,[_e.Bottom]:_e.Top},Yc=({nodeId:e,handleType:t,style:r,type:o=dn.Bezier,CustomComponent:s,connectionStatus:a})=>{var Q,Y,ee;const{fromNode:u,handleId:l,toX:d,toY:p,connectionMode:m}=Fe($.useCallback(G=>({fromNode:G.nodeInternals.get(e),handleId:G.connectionHandleId,toX:(G.connectionPosition.x-G.transform[0])/G.transform[2],toY:(G.connectionPosition.y-G.transform[1])/G.transform[2],connectionMode:G.connectionMode}),[e]),Qe),v=(Q=u==null?void 0:u[qe])==null?void 0:Q.handleBounds;let w=v==null?void 0:v[t];if(m===kn.Loose&&(w=w||(v==null?void 0:v[t==="source"?"target":"source"])),!u||!w)return null;const g=l?w.find(G=>G.id===l):w[0],k=g?g.x+g.width/2:(u.width??0)/2,S=g?g.y+g.height/2:u.height??0,O=(((Y=u.positionAbsolute)==null?void 0:Y.x)??0)+k,T=(((ee=u.positionAbsolute)==null?void 0:ee.y)??0)+S,K=g==null?void 0:g.position,z=K?mm[K]:null;if(!K||!z)return null;if(s)return X.createElement(s,{connectionLineType:o,connectionLineStyle:r,fromNode:u,fromHandle:g,fromX:O,fromY:T,toX:d,toY:p,fromPosition:K,toPosition:z,connectionStatus:a});let C="";const U={sourceX:O,sourceY:T,sourcePosition:K,targetX:d,targetY:p,targetPosition:z};return o===dn.Bezier?[C]=gc(U):o===dn.Step?[C]=Mi({...U,borderRadius:0}):o===dn.SmoothStep?[C]=Mi(U):o===dn.SimpleBezier?[C]=yc(U):C=`M${O},${T} ${d},${p}`,X.createElement("path",{d:C,fill:"none",className:"react-flow__connection-path",style:r})};Yc.displayName="ConnectionLine";const ym=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function gm({containerStyle:e,style:t,type:r,component:o}){const{nodeId:s,handleType:a,nodesConnectable:u,width:l,height:d,connectionStatus:p}=Fe(ym,Qe);return!(s&&a&&l&&u)?null:X.createElement("svg",{style:e,width:l,height:d,className:"react-flow__edges react-flow__connectionline react-flow__container"},X.createElement("g",{className:et(["react-flow__connection",p])},X.createElement(Yc,{nodeId:s,handleType:a,style:t,type:r,CustomComponent:o,connectionStatus:p})))}function xa(e,t){return $.useRef(null),Ue(),$.useMemo(()=>t(e),[e])}const Uc=({nodeTypes:e,edgeTypes:t,onMove:r,onMoveStart:o,onMoveEnd:s,onInit:a,onNodeClick:u,onEdgeClick:l,onNodeDoubleClick:d,onEdgeDoubleClick:p,onNodeMouseEnter:m,onNodeMouseMove:v,onNodeMouseLeave:w,onNodeContextMenu:g,onSelectionContextMenu:k,onSelectionStart:S,onSelectionEnd:O,connectionLineType:T,connectionLineStyle:K,connectionLineComponent:z,connectionLineContainerStyle:C,selectionKeyCode:U,selectionOnDrag:Q,selectionMode:Y,multiSelectionKeyCode:ee,panActivationKeyCode:G,zoomActivationKeyCode:ne,deleteKeyCode:oe,onlyRenderVisibleElements:le,elementsSelectable:se,selectNodesOnDrag:b,defaultViewport:q,translateExtent:j,minZoom:re,maxZoom:J,preventScrolling:L,defaultMarkerColor:Z,zoomOnScroll:ie,zoomOnPinch:ae,panOnScroll:ve,panOnScrollSpeed:ge,panOnScrollMode:be,zoomOnDoubleClick:Se,panOnDrag:Ae,onPaneClick:$e,onPaneMouseEnter:de,onPaneMouseMove:De,onPaneMouseLeave:He,onPaneScroll:ke,onPaneContextMenu:We,onEdgeContextMenu:Xe,onEdgeMouseEnter:je,onEdgeMouseMove:at,onEdgeMouseLeave:Oe,onReconnect:Ee,onReconnectStart:Je,onReconnectEnd:dt,reconnectRadius:tt,noDragClassName:qt,noWheelClassName:yt,noPanClassName:gt,elevateEdgesOnSelect:vt,disableKeyboardA11y:ct,nodeOrigin:Et,nodeExtent:wt,rfId:Mt})=>{const Pt=xa(e,Wp),Le=xa(t,Qp);return pm(a),X.createElement(Hp,{onPaneClick:$e,onPaneMouseEnter:de,onPaneMouseMove:De,onPaneMouseLeave:He,onPaneContextMenu:We,onPaneScroll:ke,deleteKeyCode:oe,selectionKeyCode:U,selectionOnDrag:Q,selectionMode:Y,onSelectionStart:S,onSelectionEnd:O,multiSelectionKeyCode:ee,panActivationKeyCode:G,zoomActivationKeyCode:ne,elementsSelectable:se,onMove:r,onMoveStart:o,onMoveEnd:s,zoomOnScroll:ie,zoomOnPinch:ae,zoomOnDoubleClick:Se,panOnScroll:ve,panOnScrollSpeed:ge,panOnScrollMode:be,panOnDrag:Ae,defaultViewport:q,translateExtent:j,minZoom:re,maxZoom:J,onSelectionContextMenu:k,preventScrolling:L,noDragClassName:qt,noWheelClassName:yt,noPanClassName:gt,disableKeyboardA11y:ct},X.createElement(hm,null,X.createElement(fm,{edgeTypes:Le,onEdgeClick:l,onEdgeDoubleClick:p,onlyRenderVisibleElements:le,onEdgeContextMenu:Xe,onEdgeMouseEnter:je,onEdgeMouseMove:at,onEdgeMouseLeave:Oe,onReconnect:Ee,onReconnectStart:Je,onReconnectEnd:dt,reconnectRadius:tt,defaultMarkerColor:Z,noPanClassName:gt,elevateEdgesOnSelect:!!vt,disableKeyboardA11y:ct,rfId:Mt},X.createElement(gm,{style:K,type:T,component:z,containerStyle:C})),X.createElement("div",{className:"react-flow__edgelabel-renderer"}),X.createElement(Up,{nodeTypes:Pt,onNodeClick:u,onNodeDoubleClick:d,onNodeMouseEnter:m,onNodeMouseMove:v,onNodeMouseLeave:w,onNodeContextMenu:g,selectNodesOnDrag:b,onlyRenderVisibleElements:le,noPanClassName:gt,noDragClassName:qt,disableKeyboardA11y:ct,nodeOrigin:Et,nodeExtent:wt,rfId:Mt})))};Uc.displayName="GraphView";var vm=$.memo(Uc);const Oi=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],cn={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:Oi,nodeExtent:Oi,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:kn.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:Vh,isValidConnection:void 0},wm=()=>sl((e,t)=>({...cn,setNodes:r=>{const{nodeInternals:o,nodeOrigin:s,elevateNodesOnSelect:a}=t();e({nodeInternals:yi(r,o,s,a)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:r=>{const{defaultEdgeOptions:o={}}=t();e({edges:r.map(s=>({...o,...s}))})},setDefaultNodesAndEdges:(r,o)=>{const s=typeof r<"u",a=typeof o<"u",u=s?yi(r,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:u,edges:a?o:[],hasDefaultNodes:s,hasDefaultEdges:a})},updateNodeDimensions:r=>{const{onNodesChange:o,nodeInternals:s,fitViewOnInit:a,fitViewOnInitDone:u,fitViewOnInitOptions:l,domNode:d,nodeOrigin:p}=t(),m=d==null?void 0:d.querySelector(".react-flow__viewport");if(!m)return;const v=window.getComputedStyle(m),{m22:w}=new window.DOMMatrixReadOnly(v.transform),g=r.reduce((S,O)=>{const T=s.get(O.id);if(T!=null&&T.hidden)s.set(T.id,{...T,[qe]:{...T[qe],handleBounds:void 0}});else if(T){const K=Xi(O.nodeElement);!!(K.width&&K.height&&(T.width!==K.width||T.height!==K.height||O.forceUpdate))&&(s.set(T.id,{...T,[qe]:{...T[qe],handleBounds:{source:ha(".source",O.nodeElement,w,p),target:ha(".target",O.nodeElement,w,p)}},...K}),S.push({id:T.id,type:"dimensions",dimensions:K}))}return S},[]);$c(s,p);const k=u||a&&!u&&Oc(t,{initial:!0,...l});e({nodeInternals:new Map(s),fitViewOnInitDone:k}),(g==null?void 0:g.length)>0&&(o==null||o(g))},updateNodePositions:(r,o=!0,s=!1)=>{const{triggerNodeChanges:a}=t(),u=r.map(l=>{const d={id:l.id,type:"position",dragging:s};return o&&(d.positionAbsolute=l.positionAbsolute,d.position=l.position),d});a(u)},triggerNodeChanges:r=>{const{onNodesChange:o,nodeInternals:s,hasDefaultNodes:a,nodeOrigin:u,getNodes:l,elevateNodesOnSelect:d}=t();if(r!=null&&r.length){if(a){const p=jc(r,l()),m=yi(p,s,u,d);e({nodeInternals:m})}o==null||o(r)}},addSelectedNodes:r=>{const{multiSelectionActive:o,edges:s,getNodes:a}=t();let u,l=null;o?u=r.map(d=>fn(d,!0)):(u=Kn(a(),r),l=Kn(s,[])),io({changedNodes:u,changedEdges:l,get:t,set:e})},addSelectedEdges:r=>{const{multiSelectionActive:o,edges:s,getNodes:a}=t();let u,l=null;o?u=r.map(d=>fn(d,!0)):(u=Kn(s,r),l=Kn(a(),[])),io({changedNodes:l,changedEdges:u,get:t,set:e})},unselectNodesAndEdges:({nodes:r,edges:o}={})=>{const{edges:s,getNodes:a}=t(),u=r||a(),l=o||s,d=u.map(m=>(m.selected=!1,fn(m.id,!1))),p=l.map(m=>fn(m.id,!1));io({changedNodes:d,changedEdges:p,get:t,set:e})},setMinZoom:r=>{const{d3Zoom:o,maxZoom:s}=t();o==null||o.scaleExtent([r,s]),e({minZoom:r})},setMaxZoom:r=>{const{d3Zoom:o,minZoom:s}=t();o==null||o.scaleExtent([s,r]),e({maxZoom:r})},setTranslateExtent:r=>{var o;(o=t().d3Zoom)==null||o.translateExtent(r),e({translateExtent:r})},resetSelectedElements:()=>{const{edges:r,getNodes:o}=t(),a=o().filter(l=>l.selected).map(l=>fn(l.id,!1)),u=r.filter(l=>l.selected).map(l=>fn(l.id,!1));io({changedNodes:a,changedEdges:u,get:t,set:e})},setNodeExtent:r=>{const{nodeInternals:o}=t();o.forEach(s=>{s.positionAbsolute=Gi(s.position,r)}),e({nodeExtent:r,nodeInternals:new Map(o)})},panBy:r=>{const{transform:o,width:s,height:a,d3Zoom:u,d3Selection:l,translateExtent:d}=t();if(!u||!l||!r.x&&!r.y)return!1;const p=Zt.translate(o[0]+r.x,o[1]+r.y).scale(o[2]),m=[[0,0],[s,a]],v=u==null?void 0:u.constrain()(p,m,d);return u.transform(l,v),o[0]!==v.x||o[1]!==v.y||o[2]!==v.k},cancelConnection:()=>e({connectionNodeId:cn.connectionNodeId,connectionHandleId:cn.connectionHandleId,connectionHandleType:cn.connectionHandleType,connectionStatus:cn.connectionStatus,connectionStartHandle:cn.connectionStartHandle,connectionEndHandle:cn.connectionEndHandle}),reset:()=>e({...cn})}),Object.is),Xc=({children:e})=>{const t=$.useRef(null);return t.current||(t.current=wm()),X.createElement(Fh,{value:t.current},e)};Xc.displayName="ReactFlowProvider";const Gc=({children:e})=>$.useContext(Ao)?X.createElement(X.Fragment,null,e):X.createElement(Xc,null,e);Gc.displayName="ReactFlowWrapper";const xm={input:Ac,default:Ri,output:Ic,group:ns},bm={default:bo,straight:Ji,step:Qi,smoothstep:Io,simplebezier:Zi},_m=[0,0],Em=[15,15],km={x:0,y:0,zoom:1},Sm={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},Zc=$.forwardRef(({nodes:e,edges:t,defaultNodes:r,defaultEdges:o,className:s,nodeTypes:a=xm,edgeTypes:u=bm,onNodeClick:l,onEdgeClick:d,onInit:p,onMove:m,onMoveStart:v,onMoveEnd:w,onConnect:g,onConnectStart:k,onConnectEnd:S,onClickConnectStart:O,onClickConnectEnd:T,onNodeMouseEnter:K,onNodeMouseMove:z,onNodeMouseLeave:C,onNodeContextMenu:U,onNodeDoubleClick:Q,onNodeDragStart:Y,onNodeDrag:ee,onNodeDragStop:G,onNodesDelete:ne,onEdgesDelete:oe,onSelectionChange:le,onSelectionDragStart:se,onSelectionDrag:b,onSelectionDragStop:q,onSelectionContextMenu:j,onSelectionStart:re,onSelectionEnd:J,connectionMode:L=kn.Strict,connectionLineType:Z=dn.Bezier,connectionLineStyle:ie,connectionLineComponent:ae,connectionLineContainerStyle:ve,deleteKeyCode:ge="Backspace",selectionKeyCode:be="Shift",selectionOnDrag:Se=!1,selectionMode:Ae=kr.Full,panActivationKeyCode:$e="Space",multiSelectionKeyCode:de=wo()?"Meta":"Control",zoomActivationKeyCode:De=wo()?"Meta":"Control",snapToGrid:He=!1,snapGrid:ke=Em,onlyRenderVisibleElements:We=!1,selectNodesOnDrag:Xe=!0,nodesDraggable:je,nodesConnectable:at,nodesFocusable:Oe,nodeOrigin:Ee=_m,edgesFocusable:Je,edgesUpdatable:dt,elementsSelectable:tt,defaultViewport:qt=km,minZoom:yt=.5,maxZoom:gt=2,translateExtent:vt=Oi,preventScrolling:ct=!0,nodeExtent:Et,defaultMarkerColor:wt="#b1b1b7",zoomOnScroll:Mt=!0,zoomOnPinch:Pt=!0,panOnScroll:Le=!1,panOnScrollSpeed:nt=.5,panOnScrollMode:kt=xn.Free,zoomOnDoubleClick:rt=!0,panOnDrag:xe=!0,onPaneClick:ut,onPaneMouseEnter:Ge,onPaneMouseMove:Dt,onPaneMouseLeave:me,onPaneScroll:Wt,onPaneContextMenu:Sn,children:Nn,onEdgeContextMenu:Rt,onEdgeDoubleClick:Gn,onEdgeMouseEnter:Ro,onEdgeMouseMove:$o,onEdgeMouseLeave:en,onEdgeUpdate:tn,onEdgeUpdateStart:Zn,onEdgeUpdateEnd:Cn,onReconnect:Be,onReconnectStart:Ye,onReconnectEnd:Oo,reconnectRadius:An=10,edgeUpdaterRadius:Tn=10,onNodesChange:In,onEdgesChange:jo,noDragClassName:$t="nodrag",noWheelClassName:nn="nowheel",noPanClassName:St="nopan",fitView:Mn=!1,fitViewOptions:Bo,connectOnClick:Ot=!0,attributionPosition:Mr,proOptions:Vt,defaultEdgeOptions:Pr,elevateNodesOnSelect:Qn=!0,elevateEdgesOnSelect:Ke=!1,disableKeyboardA11y:jt=!1,autoPanOnConnect:Nt=!0,autoPanOnNodeDrag:Dr=!0,connectionRadius:rn=20,isValidConnection:Pn,onError:Jn,style:er,id:Bt,nodeDragThreshold:Rr,...Dn},$r)=>{const Te=Bt||"1";return X.createElement("div",{...Dn,style:{...er,...Sm},ref:$r,className:et(["react-flow",s]),"data-testid":"rf__wrapper",id:Bt},X.createElement(Gc,null,X.createElement(vm,{onInit:p,onMove:m,onMoveStart:v,onMoveEnd:w,onNodeClick:l,onEdgeClick:d,onNodeMouseEnter:K,onNodeMouseMove:z,onNodeMouseLeave:C,onNodeContextMenu:U,onNodeDoubleClick:Q,nodeTypes:a,edgeTypes:u,connectionLineType:Z,connectionLineStyle:ie,connectionLineComponent:ae,connectionLineContainerStyle:ve,selectionKeyCode:be,selectionOnDrag:Se,selectionMode:Ae,deleteKeyCode:ge,multiSelectionKeyCode:de,panActivationKeyCode:$e,zoomActivationKeyCode:De,onlyRenderVisibleElements:We,selectNodesOnDrag:Xe,defaultViewport:qt,translateExtent:vt,minZoom:yt,maxZoom:gt,preventScrolling:ct,zoomOnScroll:Mt,zoomOnPinch:Pt,zoomOnDoubleClick:rt,panOnScroll:Le,panOnScrollSpeed:nt,panOnScrollMode:kt,panOnDrag:xe,onPaneClick:ut,onPaneMouseEnter:Ge,onPaneMouseMove:Dt,onPaneMouseLeave:me,onPaneScroll:Wt,onPaneContextMenu:Sn,onSelectionContextMenu:j,onSelectionStart:re,onSelectionEnd:J,onEdgeContextMenu:Rt,onEdgeDoubleClick:Gn,onEdgeMouseEnter:Ro,onEdgeMouseMove:$o,onEdgeMouseLeave:en,onReconnect:Be??tn,onReconnectStart:Ye??Zn,onReconnectEnd:Oo??Cn,reconnectRadius:An??Tn,defaultMarkerColor:wt,noDragClassName:$t,noWheelClassName:nn,noPanClassName:St,elevateEdgesOnSelect:Ke,rfId:Te,disableKeyboardA11y:jt,nodeOrigin:Ee,nodeExtent:Et}),X.createElement(mp,{nodes:e,edges:t,defaultNodes:r,defaultEdges:o,onConnect:g,onConnectStart:k,onConnectEnd:S,onClickConnectStart:O,onClickConnectEnd:T,nodesDraggable:je,nodesConnectable:at,nodesFocusable:Oe,edgesFocusable:Je,edgesUpdatable:dt,elementsSelectable:tt,elevateNodesOnSelect:Qn,minZoom:yt,maxZoom:gt,nodeExtent:Et,onNodesChange:In,onEdgesChange:jo,snapToGrid:He,snapGrid:ke,connectionMode:L,translateExtent:vt,connectOnClick:Ot,defaultEdgeOptions:Pr,fitView:Mn,fitViewOptions:Bo,onNodesDelete:ne,onEdgesDelete:oe,onNodeDragStart:Y,onNodeDrag:ee,onNodeDragStop:G,onSelectionDrag:b,onSelectionDragStart:se,onSelectionDragStop:q,noPanClassName:St,nodeOrigin:Ee,rfId:Te,autoPanOnConnect:Nt,autoPanOnNodeDrag:Dr,onError:Jn,connectionRadius:rn,isValidConnection:Pn,nodeDragThreshold:Rr}),X.createElement(hp,{onSelectionChange:le}),Nn,X.createElement(Lh,{proOptions:Vt,position:Mr}),X.createElement(xp,{rfId:Te,disableKeyboardA11y:jt})))});Zc.displayName="ReactFlow";const Qc=({id:e,x:t,y:r,width:o,height:s,style:a,color:u,strokeColor:l,strokeWidth:d,className:p,borderRadius:m,shapeRendering:v,onClick:w,selected:g})=>{const{background:k,backgroundColor:S}=a||{},O=u||k||S;return X.createElement("rect",{className:et(["react-flow__minimap-node",{selected:g},p]),x:t,y:r,rx:m,ry:m,width:o,height:s,fill:O,stroke:l,strokeWidth:d,shapeRendering:v,onClick:w?T=>w(T,e):void 0})};Qc.displayName="MiniMapNode";var Nm=$.memo(Qc);const Cm=e=>e.nodeOrigin,Am=e=>e.getNodes().filter(t=>!t.hidden&&t.width&&t.height),xi=e=>e instanceof Function?e:()=>e;function Tm({nodeStrokeColor:e="transparent",nodeColor:t="#e2e2e2",nodeClassName:r="",nodeBorderRadius:o=5,nodeStrokeWidth:s=2,nodeComponent:a=Nm,onClick:u}){const l=Fe(Am,Qe),d=Fe(Cm),p=xi(t),m=xi(e),v=xi(r),w=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return X.createElement(X.Fragment,null,l.map(g=>{const{x:k,y:S}=_n(g,d).positionAbsolute;return X.createElement(a,{key:g.id,x:k,y:S,width:g.width,height:g.height,style:g.style,selected:g.selected,className:v(g),color:p(g),borderRadius:o,strokeColor:m(g),strokeWidth:s,shapeRendering:w,onClick:u,id:g.id})}))}var Im=$.memo(Tm);const Mm=200,Pm=150,Dm=e=>{const t=e.getNodes(),r={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:r,boundingRect:t.length>0?qh(Mo(t,e.nodeOrigin),r):r,rfId:e.rfId}},Rm="react-flow__minimap-desc";function Jc({style:e,className:t,nodeStrokeColor:r="transparent",nodeColor:o="#e2e2e2",nodeClassName:s="",nodeBorderRadius:a=5,nodeStrokeWidth:u=2,nodeComponent:l,maskColor:d="rgb(240, 240, 240, 0.6)",maskStrokeColor:p="none",maskStrokeWidth:m=1,position:v="bottom-right",onClick:w,onNodeClick:g,pannable:k=!1,zoomable:S=!1,ariaLabel:O="React Flow mini map",inversePan:T=!1,zoomStep:K=10,offsetScale:z=5}){const C=Ue(),U=$.useRef(null),{boundingRect:Q,viewBB:Y,rfId:ee}=Fe(Dm,Qe),G=(e==null?void 0:e.width)??Mm,ne=(e==null?void 0:e.height)??Pm,oe=Q.width/G,le=Q.height/ne,se=Math.max(oe,le),b=se*G,q=se*ne,j=z*se,re=Q.x-(b-Q.width)/2-j,J=Q.y-(q-Q.height)/2-j,L=b+j*2,Z=q+j*2,ie=`${Rm}-${ee}`,ae=$.useRef(0);ae.current=se,$.useEffect(()=>{if(U.current){const be=bt(U.current),Se=de=>{const{transform:De,d3Selection:He,d3Zoom:ke}=C.getState();if(de.sourceEvent.type!=="wheel"||!He||!ke)return;const We=-de.sourceEvent.deltaY*(de.sourceEvent.deltaMode===1?.05:de.sourceEvent.deltaMode?1:.002)*K,Xe=De[2]*Math.pow(2,We);ke.scaleTo(He,Xe)},Ae=de=>{const{transform:De,d3Selection:He,d3Zoom:ke,translateExtent:We,width:Xe,height:je}=C.getState();if(de.sourceEvent.type!=="mousemove"||!He||!ke)return;const at=ae.current*Math.max(1,De[2])*(T?-1:1),Oe={x:De[0]-de.sourceEvent.movementX*at,y:De[1]-de.sourceEvent.movementY*at},Ee=[[0,0],[Xe,je]],Je=Zt.translate(Oe.x,Oe.y).scale(De[2]),dt=ke.constrain()(Je,Ee,We);ke.transform(He,dt)},$e=sc().on("zoom",k?Ae:null).on("zoom.wheel",S?Se:null);return be.call($e),()=>{be.on("zoom",null)}}},[k,S,T,K]);const ve=w?be=>{const Se=Ct(be);w(be,{x:Se[0],y:Se[1]})}:void 0,ge=g?(be,Se)=>{const Ae=C.getState().nodeInternals.get(Se);g(be,Ae)}:void 0;return X.createElement(To,{position:v,style:e,className:et(["react-flow__minimap",t]),"data-testid":"rf__minimap"},X.createElement("svg",{width:G,height:ne,viewBox:`${re} ${J} ${L} ${Z}`,role:"img","aria-labelledby":ie,ref:U,onClick:ve},O&&X.createElement("title",{id:ie},O),X.createElement(Im,{onClick:ge,nodeColor:o,nodeStrokeColor:r,nodeBorderRadius:a,nodeClassName:s,nodeStrokeWidth:u,nodeComponent:l}),X.createElement("path",{className:"react-flow__minimap-mask",d:`M${re-j},${J-j}h${L+j*2}v${Z+j*2}h${-L-j*2}z
        M${Y.x},${Y.y}h${Y.width}v${Y.height}h${-Y.width}z`,fill:d,fillRule:"evenodd",stroke:p,strokeWidth:m,pointerEvents:"none"})))}Jc.displayName="MiniMap";var $m=$.memo(Jc);function Om(){return X.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},X.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function jm(){return X.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},X.createElement("path",{d:"M0 0h32v4.2H0z"}))}function Bm(){return X.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},X.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function Fm(){return X.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},X.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function zm(){return X.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},X.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}const gr=({children:e,className:t,...r})=>X.createElement("button",{type:"button",className:et(["react-flow__controls-button",t]),...r},e);gr.displayName="ControlButton";const Lm=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom}),eu=({style:e,showZoom:t=!0,showFitView:r=!0,showInteractive:o=!0,fitViewOptions:s,onZoomIn:a,onZoomOut:u,onFitView:l,onInteractiveChange:d,className:p,children:m,position:v="bottom-left"})=>{const w=Ue(),[g,k]=$.useState(!1),{isInteractive:S,minZoomReached:O,maxZoomReached:T}=Fe(Lm,Qe),{zoomIn:K,zoomOut:z,fitView:C}=rs();if($.useEffect(()=>{k(!0)},[]),!g)return null;const U=()=>{K(),a==null||a()},Q=()=>{z(),u==null||u()},Y=()=>{C(s),l==null||l()},ee=()=>{w.setState({nodesDraggable:!S,nodesConnectable:!S,elementsSelectable:!S}),d==null||d(!S)};return X.createElement(To,{className:et(["react-flow__controls",p]),position:v,style:e,"data-testid":"rf__controls"},t&&X.createElement(X.Fragment,null,X.createElement(gr,{onClick:U,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:T},X.createElement(Om,null)),X.createElement(gr,{onClick:Q,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:O},X.createElement(jm,null))),r&&X.createElement(gr,{className:"react-flow__controls-fitview",onClick:Y,title:"fit view","aria-label":"fit view"},X.createElement(Bm,null)),o&&X.createElement(gr,{className:"react-flow__controls-interactive",onClick:ee,title:"toggle interactivity","aria-label":"toggle interactivity"},S?X.createElement(zm,null):X.createElement(Fm,null)),m)};eu.displayName="Controls";var Km=$.memo(eu),Tt;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(Tt||(Tt={}));function Hm({color:e,dimensions:t,lineWidth:r}){return X.createElement("path",{stroke:e,strokeWidth:r,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`})}function qm({color:e,radius:t}){return X.createElement("circle",{cx:t,cy:t,r:t,fill:e})}const Wm={[Tt.Dots]:"#91919a",[Tt.Lines]:"#eee",[Tt.Cross]:"#e2e2e2"},Vm={[Tt.Dots]:1,[Tt.Lines]:1,[Tt.Cross]:6},Ym=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function tu({id:e,variant:t=Tt.Dots,gap:r=20,size:o,lineWidth:s=1,offset:a=2,color:u,style:l,className:d}){const p=$.useRef(null),{transform:m,patternId:v}=Fe(Ym,Qe),w=u||Wm[t],g=o||Vm[t],k=t===Tt.Dots,S=t===Tt.Cross,O=Array.isArray(r)?r:[r,r],T=[O[0]*m[2]||1,O[1]*m[2]||1],K=g*m[2],z=S?[K,K]:T,C=k?[K/a,K/a]:[z[0]/a,z[1]/a];return X.createElement("svg",{className:et(["react-flow__background",d]),style:{...l,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:p,"data-testid":"rf__background"},X.createElement("pattern",{id:v+e,x:m[0]%T[0],y:m[1]%T[1],width:T[0],height:T[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${C[0]},-${C[1]})`},k?X.createElement(qm,{color:w,radius:K/a}):X.createElement(Hm,{dimensions:z,color:w,lineWidth:s})),X.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${v+e})`}))}tu.displayName="Background";var Um=$.memo(tu);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Xm={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gm=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Po=(e,t)=>{const r=$.forwardRef(({color:o="currentColor",size:s=24,strokeWidth:a=2,absoluteStrokeWidth:u,className:l="",children:d,...p},m)=>$.createElement("svg",{ref:m,...Xm,width:s,height:s,stroke:o,strokeWidth:u?Number(a)*24/Number(s):a,className:["lucide",`lucide-${Gm(e)}`,l].join(" "),...p},[...t.map(([v,w])=>$.createElement(v,w)),...Array.isArray(d)?d:[d]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zm=Po("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qm=Po("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jm=Po("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Do=Po("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function nu(e){var t,r,o="";if(typeof e=="string"||typeof e=="number")o+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(r=nu(e[t]))&&(o&&(o+=" "),o+=r)}else for(r in e)e[r]&&(o&&(o+=" "),o+=r);return o}function Ln(){for(var e,t,r=0,o="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=nu(e))&&(o&&(o+=" "),o+=t);return o}const ey=e=>{var t;switch((t=e.status)==null?void 0:t.toLowerCase()){case"completed":return"border-green-500";case"running":return"border-blue-500";case"retrying":return"border-orange-600";case"pending":return"border-purple-600";case"terminated":return"border-yellow-500";case"failed":return"border-red-600";default:return"border-gray-500"}},ty=(e,t=40)=>e?e.length<=t?e:e.slice(0,t)+"...":"",ny=e=>{switch(e==null?void 0:e.toLowerCase()){case"completed":return"text-green-600 bg-green-50";case"retrying":return"text-orange-700 bg-orange-100";case"running":return"text-blue-600 bg-blue-50";case"pending":return"text-purple-700 bg-purple-100";case"terminated":return"text-yellow-600 bg-yellow-50";case"failed":return"text-red-700 bg-red-100";default:return"text-gray-600 bg-gray-50"}};function ry({id:e,data:t,expandChildWorkflowNode:r,collapseChildWorkflowNode:o,onShowNodeData:s,onSpreadBatchNodes:a}){var p;const u=t.type==="workflow"||t.type==="childWorkflow",l=`${e}-${t.type}-${t.workflowId||""}-${t.runId||""}`,d=async()=>{u&&!t.isLoading&&(t.isExpanded?await o(e):await r(e))};return N.jsxs("div",{className:"relative",children:[N.jsx(hn,{type:"source",position:_e.Right,id:`${e}-right`,style:{top:"50%",transform:"translateY(-50%)"}}),N.jsx(hn,{type:"target",position:_e.Left,id:`${e}-left`,style:{top:"50%",transform:"translateY(-50%)"}}),N.jsx(hn,{type:"source",position:_e.Bottom,id:`${e}-bottom`,style:{left:"25px"}}),N.jsx(hn,{type:"target",position:_e.Top,id:`${e}-top`,style:{left:"25px"}}),N.jsx("div",{className:Ln("rounded-lg shadow-lg border-2 transition-all duration-300 relative",ey(t),t.isLoading&&"opacity-75"),children:N.jsxs("div",{className:Ln("p-4 relative bg-white",u&&!t.isLoading&&"cursor-pointer",t.isLoading&&"pointer-events-none"),onClick:d,children:[N.jsxs("div",{className:"absolute -top-2.5 -right-2.5 flex gap-1",children:[t.count&&t.count>1&&N.jsx("div",{onClick:m=>{m.stopPropagation(),a==null||a(e)},className:"w-6 h-6 flex items-center justify-center bg-blue-500 hover:bg-blue-600 rounded-full text-white shadow-lg z-10 cursor-pointer",children:N.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",strokeWidth:2,viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11 4.5a6.5 6.5 0 1 0 4.135 11.286l3.572 3.572a1 1 0 0 0 1.414-1.414l-3.572-3.572A6.5 6.5 0 0 0 11 4.5z"})})}),N.jsx("div",{onClick:m=>{m.stopPropagation(),s(t)},className:"w-6 h-6 flex items-center justify-center bg-gray-500 hover:bg-gray-600 rounded-full text-white shadow-lg z-10 cursor-pointer",children:N.jsx(Qm,{className:"w-3 h-3"})})]}),N.jsxs("div",{className:"flex items-center gap-3",children:[N.jsx("div",{className:Ln("w-8 h-8 rounded flex items-center justify-center flex-shrink-0","bg-blue-50"),children:u?N.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[N.jsx("rect",{x:"9",y:"3",width:"6",height:"6",rx:"1"}),N.jsx("rect",{x:"3",y:"15",width:"6",height:"6",rx:"1"}),N.jsx("rect",{x:"15",y:"15",width:"6",height:"6",rx:"1"}),N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3M6 15v-3h12v3"})]}):N.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:N.jsx("path",{d:"M5 12L12 5L19 12L12 19L5 12Z"})})}),N.jsxs("div",{className:Ln("min-w-0",u?"":"flex items-center h-[2.5rem]"),children:[N.jsx("h3",{className:"font-semibold text-gray-800 truncate",children:t.title}),u&&N.jsx("p",{className:"text-xs text-gray-500 overflow-hidden text-ellipsis",children:ty(e)})]})]}),N.jsxs("div",{className:"absolute -top-3 left-3 flex gap-2",children:[N.jsx("div",{className:"px-2 py-0.5 rounded text-xs font-medium shadow-sm z-10",style:{backgroundColor:"rgba(243, 244, 246, 0.9)",color:"#374151"},children:u?"workflow":"activity"}),N.jsx("div",{className:Ln("px-2 py-0.5 rounded text-xs font-medium shadow-sm z-10",ny(t.status)),children:((p=t.status)==null?void 0:p.toLowerCase())||"unknown"}),t.count&&t.count>1&&N.jsxs("div",{className:"px-2 py-0.5 rounded text-xs font-medium shadow-sm z-10",style:{backgroundColor:"rgba(224, 242, 254, 0.9)",color:"#0369a1"},children:["batch: ",t.count]})]}),t.isLoading&&N.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-50 flex items-center justify-center z-20",children:N.jsx("div",{className:"bg-white p-2 rounded-full shadow-lg",children:N.jsx(Zm,{className:"w-5 h-5 text-blue-500 animate-spin"})})})]})})]},l)}function oy({nodes:e,onFocusChange:t,selectedWorkflow:r,onReset:o,onClose:s}){const[a,u]=$.useState(288),l=$.useRef(null),d=$.useRef(null),p=$.useRef(!1),m=e.filter(g=>g.data.type==="workflow"||g.data.type==="childWorkflow"),v=g=>{t(r===g?null:g)};$.useEffect(()=>{const g=S=>{if(!p.current||!d.current)return;const O=S.clientX-d.current.getBoundingClientRect().left;O>200&&O<600&&u(O)},k=()=>{p.current&&(p.current=!1,document.body.style.cursor="default")};return window.addEventListener("mousemove",g),window.addEventListener("mouseup",k),()=>{window.removeEventListener("mousemove",g),window.removeEventListener("mouseup",k)}},[]);const w=g=>{g.preventDefault(),p.current=!0,document.body.style.cursor="col-resize"};return N.jsxs("div",{ref:d,className:"absolute left-0 top-0 bottom-0 bg-white shadow-lg border-r z-10",style:{width:`${a}px`},children:[N.jsxs("div",{className:"p-4 border-b flex items-center justify-between bg-gray-50",children:[N.jsx("h3",{className:"font-semibold text-gray-800",children:"Focus Workflow"}),N.jsx("button",{onClick:s,className:"p-1 hover:bg-gray-200 rounded-full transition-colors",children:N.jsx(Do,{className:"w-5 h-5 text-gray-600"})})]}),N.jsxs("div",{className:"p-4 overflow-y-auto",children:[N.jsx("button",{onClick:o,className:"w-full mb-4 px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-md transition-colors",children:"Reset View"}),N.jsx("div",{className:"space-y-2",children:m.map(g=>N.jsx("button",{onClick:()=>v(g.id),className:Ln("w-full px-3 py-2 text-left rounded-md transition-colors","text-sm",r===g.id?"bg-blue-50 text-blue-700 font-medium":"text-gray-700 hover:bg-gray-50"),children:g.data.title},g.id))})]}),N.jsx("div",{ref:l,onMouseDown:w,className:"w-1 cursor-col-resize hover:bg-gray-300 absolute top-0 right-0 bottom-0"})]})}var ru={exports:{}};(function(e,t){(function(r,o){e.exports=o()})(Is,function(){var r=function(n,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var h in f)Object.prototype.hasOwnProperty.call(f,h)&&(c[h]=f[h])})(n,i)},o=function(){return(o=Object.assign||function(n){for(var i,c=1,f=arguments.length;c<f;c++)for(var h in i=arguments[c])Object.prototype.hasOwnProperty.call(i,h)&&(n[h]=i[h]);return n}).apply(this,arguments)};function s(n,i,c){for(var f,h=0,y=i.length;h<y;h++)!f&&h in i||((f=f||Array.prototype.slice.call(i,0,h))[h]=i[h]);return n.concat(f||Array.prototype.slice.call(i))}var a=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Is,u=Object.keys,l=Array.isArray;function d(n,i){return typeof i!="object"||u(i).forEach(function(c){n[c]=i[c]}),n}typeof Promise>"u"||a.Promise||(a.Promise=Promise);var p=Object.getPrototypeOf,m={}.hasOwnProperty;function v(n,i){return m.call(n,i)}function w(n,i){typeof i=="function"&&(i=i(p(n))),(typeof Reflect>"u"?u:Reflect.ownKeys)(i).forEach(function(c){k(n,c,i[c])})}var g=Object.defineProperty;function k(n,i,c,f){g(n,i,d(c&&v(c,"get")&&typeof c.get=="function"?{get:c.get,set:c.set,configurable:!0}:{value:c,configurable:!0,writable:!0},f))}function S(n){return{from:function(i){return n.prototype=Object.create(i.prototype),k(n.prototype,"constructor",n),{extend:w.bind(null,n.prototype)}}}}var O=Object.getOwnPropertyDescriptor,T=[].slice;function K(n,i,c){return T.call(n,i,c)}function z(n,i){return i(n)}function C(n){if(!n)throw new Error("Assertion Failed")}function U(n){a.setImmediate?setImmediate(n):setTimeout(n,0)}function Q(n,i){if(typeof i=="string"&&v(n,i))return n[i];if(!i)return n;if(typeof i!="string"){for(var c=[],f=0,h=i.length;f<h;++f){var y=Q(n,i[f]);c.push(y)}return c}var x=i.indexOf(".");if(x!==-1){var _=n[i.substr(0,x)];return _==null?void 0:Q(_,i.substr(x+1))}}function Y(n,i,c){if(n&&i!==void 0&&!("isFrozen"in Object&&Object.isFrozen(n)))if(typeof i!="string"&&"length"in i){C(typeof c!="string"&&"length"in c);for(var f=0,h=i.length;f<h;++f)Y(n,i[f],c[f])}else{var y,x,_=i.indexOf(".");_!==-1?(y=i.substr(0,_),(x=i.substr(_+1))===""?c===void 0?l(n)&&!isNaN(parseInt(y))?n.splice(y,1):delete n[y]:n[y]=c:Y(_=!(_=n[y])||!v(n,y)?n[y]={}:_,x,c)):c===void 0?l(n)&&!isNaN(parseInt(i))?n.splice(i,1):delete n[i]:n[i]=c}}function ee(n){var i,c={};for(i in n)v(n,i)&&(c[i]=n[i]);return c}var G=[].concat;function ne(n){return G.apply([],n)}var Yt="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(ne([8,16,32,64].map(function(n){return["Int","Uint","Float"].map(function(i){return i+n+"Array"})}))).filter(function(n){return a[n]}),oe=new Set(Yt.map(function(n){return a[n]})),le=null;function se(n){return le=new WeakMap,n=function i(c){if(!c||typeof c!="object")return c;var f=le.get(c);if(f)return f;if(l(c)){f=[],le.set(c,f);for(var h=0,y=c.length;h<y;++h)f.push(i(c[h]))}else if(oe.has(c.constructor))f=c;else{var x,_=p(c);for(x in f=_===Object.prototype?{}:Object.create(_),le.set(c,f),c)v(c,x)&&(f[x]=i(c[x]))}return f}(n),le=null,n}var b={}.toString;function q(n){return b.call(n).slice(8,-1)}var j=typeof Symbol<"u"?Symbol.iterator:"@@iterator",re=typeof j=="symbol"?function(n){var i;return n!=null&&(i=n[j])&&i.apply(n)}:function(){return null};function J(n,i){return i=n.indexOf(i),0<=i&&n.splice(i,1),0<=i}var L={};function Z(n){var i,c,f,h;if(arguments.length===1){if(l(n))return n.slice();if(this===L&&typeof n=="string")return[n];if(h=re(n)){for(c=[];!(f=h.next()).done;)c.push(f.value);return c}if(n==null)return[n];if(typeof(i=n.length)!="number")return[n];for(c=new Array(i);i--;)c[i]=n[i];return c}for(i=arguments.length,c=new Array(i);i--;)c[i]=arguments[i];return c}var ie=typeof Symbol<"u"?function(n){return n[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},vt=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],xt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(vt),ae={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function ve(n,i){this.name=n,this.message=i}function ge(n,i){return n+". Errors: "+Object.keys(i).map(function(c){return i[c].toString()}).filter(function(c,f,h){return h.indexOf(c)===f}).join(`
`)}function be(n,i,c,f){this.failures=i,this.failedKeys=f,this.successCount=c,this.message=ge(n,i)}function Se(n,i){this.name="BulkError",this.failures=Object.keys(i).map(function(c){return i[c]}),this.failuresByPos=i,this.message=ge(n,this.failures)}S(ve).from(Error).extend({toString:function(){return this.name+": "+this.message}}),S(be).from(ve),S(Se).from(ve);var Ae=xt.reduce(function(n,i){return n[i]=i+"Error",n},{}),$e=ve,de=xt.reduce(function(n,i){var c=i+"Error";function f(h,y){this.name=c,h?typeof h=="string"?(this.message="".concat(h).concat(y?`
 `+y:""),this.inner=y||null):typeof h=="object"&&(this.message="".concat(h.name," ").concat(h.message),this.inner=h):(this.message=ae[i]||c,this.inner=null)}return S(f).from($e),n[i]=f,n},{});de.Syntax=SyntaxError,de.Type=TypeError,de.Range=RangeError;var De=vt.reduce(function(n,i){return n[i+"Error"]=de[i],n},{}),He=xt.reduce(function(n,i){return["Syntax","Type","Range"].indexOf(i)===-1&&(n[i+"Error"]=de[i]),n},{});function ke(){}function We(n){return n}function Xe(n,i){return n==null||n===We?i:function(c){return i(n(c))}}function je(n,i){return function(){n.apply(this,arguments),i.apply(this,arguments)}}function at(n,i){return n===ke?i:function(){var c=n.apply(this,arguments);c!==void 0&&(arguments[0]=c);var f=this.onsuccess,h=this.onerror;this.onsuccess=null,this.onerror=null;var y=i.apply(this,arguments);return f&&(this.onsuccess=this.onsuccess?je(f,this.onsuccess):f),h&&(this.onerror=this.onerror?je(h,this.onerror):h),y!==void 0?y:c}}function Oe(n,i){return n===ke?i:function(){n.apply(this,arguments);var c=this.onsuccess,f=this.onerror;this.onsuccess=this.onerror=null,i.apply(this,arguments),c&&(this.onsuccess=this.onsuccess?je(c,this.onsuccess):c),f&&(this.onerror=this.onerror?je(f,this.onerror):f)}}function Ee(n,i){return n===ke?i:function(c){var f=n.apply(this,arguments);d(c,f);var h=this.onsuccess,y=this.onerror;return this.onsuccess=null,this.onerror=null,c=i.apply(this,arguments),h&&(this.onsuccess=this.onsuccess?je(h,this.onsuccess):h),y&&(this.onerror=this.onerror?je(y,this.onerror):y),f===void 0?c===void 0?void 0:c:d(f,c)}}function Je(n,i){return n===ke?i:function(){return i.apply(this,arguments)!==!1&&n.apply(this,arguments)}}function dt(n,i){return n===ke?i:function(){var c=n.apply(this,arguments);if(c&&typeof c.then=="function"){for(var f=this,h=arguments.length,y=new Array(h);h--;)y[h]=arguments[h];return c.then(function(){return i.apply(f,y)})}return i.apply(this,arguments)}}He.ModifyError=be,He.DexieError=ve,He.BulkError=Se;var tt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function qt(n){tt=n}var yt={},gt=100,Yt=typeof Promise>"u"?[]:function(){var n=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[n,p(n),n];var i=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[i,p(i),n]}(),vt=Yt[0],xt=Yt[1],Yt=Yt[2],xt=xt&&xt.then,ct=vt&&vt.constructor,Et=!!Yt,wt=function(n,i){ut.push([n,i]),Pt&&(queueMicrotask($o),Pt=!1)},Mt=!0,Pt=!0,Le=[],nt=[],kt=We,rt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ke,pgp:!1,env:{},finalize:ke},xe=rt,ut=[],Ge=0,Dt=[];function me(n){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var i=this._PSD=xe;if(typeof n!="function"){if(n!==yt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Nn(this,this._value))}this._state=null,this._value=null,++i.ref,function c(f,h){try{h(function(y){if(f._state===null){if(y===f)throw new TypeError("A promise cannot be resolved with itself.");var x=f._lib&&en();y&&typeof y.then=="function"?c(f,function(_,A){y instanceof me?y._then(_,A):y.then(_,A)}):(f._state=!0,f._value=y,Rt(f)),x&&tn()}},Nn.bind(null,f))}catch(y){Nn(f,y)}}(this,n)}var Wt={get:function(){var n=xe,i=In;function c(f,h){var y=this,x=!n.global&&(n!==xe||i!==In),_=x&&!St(),A=new me(function(M,R){Gn(y,new Sn(Pr(f,n,x,_),Pr(h,n,x,_),M,R,n))});return this._consoleTask&&(A._consoleTask=this._consoleTask),A}return c.prototype=yt,c},set:function(n){k(this,"then",n&&n.prototype===yt?Wt:{get:function(){return n},set:Wt.set})}};function Sn(n,i,c,f,h){this.onFulfilled=typeof n=="function"?n:null,this.onRejected=typeof i=="function"?i:null,this.resolve=c,this.reject=f,this.psd=h}function Nn(n,i){var c,f;nt.push(i),n._state===null&&(c=n._lib&&en(),i=kt(i),n._state=!1,n._value=i,f=n,Le.some(function(h){return h._value===f._value})||Le.push(f),Rt(n),c&&tn())}function Rt(n){var i=n._listeners;n._listeners=[];for(var c=0,f=i.length;c<f;++c)Gn(n,i[c]);var h=n._PSD;--h.ref||h.finalize(),Ge===0&&(++Ge,wt(function(){--Ge==0&&Zn()},[]))}function Gn(n,i){if(n._state!==null){var c=n._state?i.onFulfilled:i.onRejected;if(c===null)return(n._state?i.resolve:i.reject)(n._value);++i.psd.ref,++Ge,wt(Ro,[c,n,i])}else n._listeners.push(i)}function Ro(n,i,c){try{var f,h=i._value;!i._state&&nt.length&&(nt=[]),f=tt&&i._consoleTask?i._consoleTask.run(function(){return n(h)}):n(h),i._state||nt.indexOf(h)!==-1||function(y){for(var x=Le.length;x;)if(Le[--x]._value===y._value)return Le.splice(x,1)}(i),c.resolve(f)}catch(y){c.reject(y)}finally{--Ge==0&&Zn(),--c.psd.ref||c.psd.finalize()}}function $o(){Vt(rt,function(){en()&&tn()})}function en(){var n=Mt;return Pt=Mt=!1,n}function tn(){var n,i,c;do for(;0<ut.length;)for(n=ut,ut=[],c=n.length,i=0;i<c;++i){var f=n[i];f[0].apply(null,f[1])}while(0<ut.length);Pt=Mt=!0}function Zn(){var n=Le;Le=[],n.forEach(function(f){f._PSD.onunhandled.call(null,f._value,f)});for(var i=Dt.slice(0),c=i.length;c;)i[--c]()}function Cn(n){return new me(yt,!1,n)}function Be(n,i){var c=xe;return function(){var f=en(),h=xe;try{return Ot(c,!0),n.apply(this,arguments)}catch(y){i&&i(y)}finally{Ot(h,!1),f&&tn()}}}w(me.prototype,{then:Wt,_then:function(n,i){Gn(this,new Sn(null,null,n,i,xe))},catch:function(n){if(arguments.length===1)return this.then(null,n);var i=n,c=arguments[1];return typeof i=="function"?this.then(null,function(f){return(f instanceof i?c:Cn)(f)}):this.then(null,function(f){return(f&&f.name===i?c:Cn)(f)})},finally:function(n){return this.then(function(i){return me.resolve(n()).then(function(){return i})},function(i){return me.resolve(n()).then(function(){return Cn(i)})})},timeout:function(n,i){var c=this;return n<1/0?new me(function(f,h){var y=setTimeout(function(){return h(new de.Timeout(i))},n);c.then(f,h).finally(clearTimeout.bind(null,y))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&k(me.prototype,Symbol.toStringTag,"Dexie.Promise"),rt.env=Mr(),w(me,{all:function(){var n=Z.apply(null,arguments).map(Mn);return new me(function(i,c){n.length===0&&i([]);var f=n.length;n.forEach(function(h,y){return me.resolve(h).then(function(x){n[y]=x,--f||i(n)},c)})})},resolve:function(n){return n instanceof me?n:n&&typeof n.then=="function"?new me(function(i,c){n.then(i,c)}):new me(yt,!0,n)},reject:Cn,race:function(){var n=Z.apply(null,arguments).map(Mn);return new me(function(i,c){n.map(function(f){return me.resolve(f).then(i,c)})})},PSD:{get:function(){return xe},set:function(n){return xe=n}},totalEchoes:{get:function(){return In}},newPSD:$t,usePSD:Vt,scheduler:{get:function(){return wt},set:function(n){wt=n}},rejectionMapper:{get:function(){return kt},set:function(n){kt=n}},follow:function(n,i){return new me(function(c,f){return $t(function(h,y){var x=xe;x.unhandleds=[],x.onunhandled=y,x.finalize=je(function(){var _,A=this;_=function(){A.unhandleds.length===0?h():y(A.unhandleds[0])},Dt.push(function M(){_(),Dt.splice(Dt.indexOf(M),1)}),++Ge,wt(function(){--Ge==0&&Zn()},[])},x.finalize),n()},i,c,f)})}}),ct&&(ct.allSettled&&k(me,"allSettled",function(){var n=Z.apply(null,arguments).map(Mn);return new me(function(i){n.length===0&&i([]);var c=n.length,f=new Array(c);n.forEach(function(h,y){return me.resolve(h).then(function(x){return f[y]={status:"fulfilled",value:x}},function(x){return f[y]={status:"rejected",reason:x}}).then(function(){return--c||i(f)})})})}),ct.any&&typeof AggregateError<"u"&&k(me,"any",function(){var n=Z.apply(null,arguments).map(Mn);return new me(function(i,c){n.length===0&&c(new AggregateError([]));var f=n.length,h=new Array(f);n.forEach(function(y,x){return me.resolve(y).then(function(_){return i(_)},function(_){h[x]=_,--f||c(new AggregateError(h))})})})}),ct.withResolvers&&(me.withResolvers=ct.withResolvers));var Ye={awaits:0,echoes:0,id:0},Oo=0,An=[],Tn=0,In=0,jo=0;function $t(n,i,c,f){var h=xe,y=Object.create(h);return y.parent=h,y.ref=0,y.global=!1,y.id=++jo,rt.env,y.env=Et?{Promise:me,PromiseProp:{value:me,configurable:!0,writable:!0},all:me.all,race:me.race,allSettled:me.allSettled,any:me.any,resolve:me.resolve,reject:me.reject}:{},i&&d(y,i),++h.ref,y.finalize=function(){--this.parent.ref||this.parent.finalize()},f=Vt(y,n,c,f),y.ref===0&&y.finalize(),f}function nn(){return Ye.id||(Ye.id=++Oo),++Ye.awaits,Ye.echoes+=gt,Ye.id}function St(){return!!Ye.awaits&&(--Ye.awaits==0&&(Ye.id=0),Ye.echoes=Ye.awaits*gt,!0)}function Mn(n){return Ye.echoes&&n&&n.constructor===ct?(nn(),n.then(function(i){return St(),i},function(i){return St(),Ke(i)})):n}function Bo(){var n=An[An.length-1];An.pop(),Ot(n,!1)}function Ot(n,i){var c,f=xe;(i?!Ye.echoes||Tn++&&n===xe:!Tn||--Tn&&n===xe)||queueMicrotask(i?(function(h){++In,Ye.echoes&&--Ye.echoes!=0||(Ye.echoes=Ye.awaits=Ye.id=0),An.push(xe),Ot(h,!0)}).bind(null,n):Bo),n!==xe&&(xe=n,f===rt&&(rt.env=Mr()),Et&&(c=rt.env.Promise,i=n.env,(f.global||n.global)&&(Object.defineProperty(a,"Promise",i.PromiseProp),c.all=i.all,c.race=i.race,c.resolve=i.resolve,c.reject=i.reject,i.allSettled&&(c.allSettled=i.allSettled),i.any&&(c.any=i.any))))}function Mr(){var n=a.Promise;return Et?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(a,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject}:{}}function Vt(n,i,c,f,h){var y=xe;try{return Ot(n,!0),i(c,f,h)}finally{Ot(y,!1)}}function Pr(n,i,c,f){return typeof n!="function"?n:function(){var h=xe;c&&nn(),Ot(i,!0);try{return n.apply(this,arguments)}finally{Ot(h,!1),f&&queueMicrotask(St)}}}function Qn(n){Promise===ct&&Ye.echoes===0?Tn===0?n():enqueueNativeMicroTask(n):setTimeout(n,0)}(""+xt).indexOf("[native code]")===-1&&(nn=St=ke);var Ke=me.reject,jt="",Nt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Dr="String expected.",rn=[],Pn="__dbnames",Jn="readonly",er="readwrite";function Bt(n,i){return n?i?function(){return n.apply(this,arguments)&&i.apply(this,arguments)}:n:i}var Rr={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Dn(n){return typeof n!="string"||/\./.test(n)?function(i){return i}:function(i){return i[n]===void 0&&n in i&&delete(i=se(i))[n],i}}function $r(){throw de.Type()}function Te(n,i){try{var c=ss(n),f=ss(i);if(c!==f)return c==="Array"?1:f==="Array"?-1:c==="binary"?1:f==="binary"?-1:c==="string"?1:f==="string"?-1:c==="Date"?1:f!=="Date"?NaN:-1;switch(c){case"number":case"Date":case"string":return i<n?1:n<i?-1:0;case"binary":return function(h,y){for(var x=h.length,_=y.length,A=x<_?x:_,M=0;M<A;++M)if(h[M]!==y[M])return h[M]<y[M]?-1:1;return x===_?0:x<_?-1:1}(as(n),as(i));case"Array":return function(h,y){for(var x=h.length,_=y.length,A=x<_?x:_,M=0;M<A;++M){var R=Te(h[M],y[M]);if(R!==0)return R}return x===_?0:x<_?-1:1}(n,i)}}catch{}return NaN}function ss(n){var i=typeof n;return i!="object"?i:ArrayBuffer.isView(n)?"binary":(n=q(n),n==="ArrayBuffer"?"binary":n)}function as(n){return n instanceof Uint8Array?n:ArrayBuffer.isView(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n)}var cs=(ze.prototype._trans=function(n,i,c){var f=this._tx||xe.trans,h=this.name,y=tt&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(n==="readonly"?"read":"write"," ").concat(this.name));function x(M,R,E){if(!E.schema[h])throw new de.NotFound("Table "+h+" not part of transaction");return i(E.idbtrans,E)}var _=en();try{var A=f&&f.db._novip===this.db._novip?f===xe.trans?f._promise(n,x,c):$t(function(){return f._promise(n,x,c)},{trans:f,transless:xe.transless||xe}):function M(R,E,F,I){if(R.idbdb&&(R._state.openComplete||xe.letThrough||R._vip)){var D=R._createTransaction(E,F,R._dbSchema);try{D.create(),R._state.PR1398_maxLoop=3}catch(B){return B.name===Ae.InvalidState&&R.isOpen()&&0<--R._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),R.close({disableAutoOpen:!1}),R.open().then(function(){return M(R,E,F,I)})):Ke(B)}return D._promise(E,function(B,P){return $t(function(){return xe.trans=D,I(B,P,D)})}).then(function(B){if(E==="readwrite")try{D.idbtrans.commit()}catch{}return E==="readonly"?B:D._completion.then(function(){return B})})}if(R._state.openComplete)return Ke(new de.DatabaseClosed(R._state.dbOpenError));if(!R._state.isBeingOpened){if(!R._state.autoOpen)return Ke(new de.DatabaseClosed);R.open().catch(ke)}return R._state.dbReadyPromise.then(function(){return M(R,E,F,I)})}(this.db,n,[this.name],x);return y&&(A._consoleTask=y,A=A.catch(function(M){return console.trace(M),Ke(M)})),A}finally{_&&tn()}},ze.prototype.get=function(n,i){var c=this;return n&&n.constructor===Object?this.where(n).first(i):n==null?Ke(new de.Type("Invalid argument to Table.get()")):this._trans("readonly",function(f){return c.core.get({trans:f,key:n}).then(function(h){return c.hook.reading.fire(h)})}).then(i)},ze.prototype.where=function(n){if(typeof n=="string")return new this.db.WhereClause(this,n);if(l(n))return new this.db.WhereClause(this,"[".concat(n.join("+"),"]"));var i=u(n);if(i.length===1)return this.where(i[0]).equals(n[i[0]]);var c=this.schema.indexes.concat(this.schema.primKey).filter(function(_){if(_.compound&&i.every(function(M){return 0<=_.keyPath.indexOf(M)})){for(var A=0;A<i.length;++A)if(i.indexOf(_.keyPath[A])===-1)return!1;return!0}return!1}).sort(function(_,A){return _.keyPath.length-A.keyPath.length})[0];if(c&&this.db._maxKey!==jt){var y=c.keyPath.slice(0,i.length);return this.where(y).equals(y.map(function(A){return n[A]}))}!c&&tt&&console.warn("The query ".concat(JSON.stringify(n)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(i.join("+"),"]"));var f=this.schema.idxByName;function h(_,A){return Te(_,A)===0}var x=i.reduce(function(E,A){var M=E[0],R=E[1],E=f[A],F=n[A];return[M||E,M||!E?Bt(R,E&&E.multi?function(I){return I=Q(I,A),l(I)&&I.some(function(D){return h(F,D)})}:function(I){return h(F,Q(I,A))}):R]},[null,null]),y=x[0],x=x[1];return y?this.where(y.name).equals(n[y.keyPath]).filter(x):c?this.filter(x):this.where(i).equals("")},ze.prototype.filter=function(n){return this.toCollection().and(n)},ze.prototype.count=function(n){return this.toCollection().count(n)},ze.prototype.offset=function(n){return this.toCollection().offset(n)},ze.prototype.limit=function(n){return this.toCollection().limit(n)},ze.prototype.each=function(n){return this.toCollection().each(n)},ze.prototype.toArray=function(n){return this.toCollection().toArray(n)},ze.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},ze.prototype.orderBy=function(n){return new this.db.Collection(new this.db.WhereClause(this,l(n)?"[".concat(n.join("+"),"]"):n))},ze.prototype.reverse=function(){return this.toCollection().reverse()},ze.prototype.mapToClass=function(n){var i,c=this.db,f=this.name;function h(){return i!==null&&i.apply(this,arguments)||this}(this.schema.mappedClass=n).prototype instanceof $r&&(function(A,M){if(typeof M!="function"&&M!==null)throw new TypeError("Class extends value "+String(M)+" is not a constructor or null");function R(){this.constructor=A}r(A,M),A.prototype=M===null?Object.create(M):(R.prototype=M.prototype,new R)}(h,i=n),Object.defineProperty(h.prototype,"db",{get:function(){return c},enumerable:!1,configurable:!0}),h.prototype.table=function(){return f},n=h);for(var y=new Set,x=n.prototype;x;x=p(x))Object.getOwnPropertyNames(x).forEach(function(A){return y.add(A)});function _(A){if(!A)return A;var M,R=Object.create(n.prototype);for(M in A)if(!y.has(M))try{R[M]=A[M]}catch{}return R}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=_,this.hook("reading",_),n},ze.prototype.defineClass=function(){return this.mapToClass(function(n){d(this,n)})},ze.prototype.add=function(n,i){var c=this,f=this.schema.primKey,h=f.auto,y=f.keyPath,x=n;return y&&h&&(x=Dn(y)(n)),this._trans("readwrite",function(_){return c.core.mutate({trans:_,type:"add",keys:i!=null?[i]:null,values:[x]})}).then(function(_){return _.numFailures?me.reject(_.failures[0]):_.lastResult}).then(function(_){if(y)try{Y(n,y,_)}catch{}return _})},ze.prototype.update=function(n,i){return typeof n!="object"||l(n)?this.where(":id").equals(n).modify(i):(n=Q(n,this.schema.primKey.keyPath),n===void 0?Ke(new de.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(i))},ze.prototype.put=function(n,i){var c=this,f=this.schema.primKey,h=f.auto,y=f.keyPath,x=n;return y&&h&&(x=Dn(y)(n)),this._trans("readwrite",function(_){return c.core.mutate({trans:_,type:"put",values:[x],keys:i!=null?[i]:null})}).then(function(_){return _.numFailures?me.reject(_.failures[0]):_.lastResult}).then(function(_){if(y)try{Y(n,y,_)}catch{}return _})},ze.prototype.delete=function(n){var i=this;return this._trans("readwrite",function(c){return i.core.mutate({trans:c,type:"delete",keys:[n]})}).then(function(c){return c.numFailures?me.reject(c.failures[0]):void 0})},ze.prototype.clear=function(){var n=this;return this._trans("readwrite",function(i){return n.core.mutate({trans:i,type:"deleteRange",range:Rr})}).then(function(i){return i.numFailures?me.reject(i.failures[0]):void 0})},ze.prototype.bulkGet=function(n){var i=this;return this._trans("readonly",function(c){return i.core.getMany({keys:n,trans:c}).then(function(f){return f.map(function(h){return i.hook.reading.fire(h)})})})},ze.prototype.bulkAdd=function(n,i,c){var f=this,h=Array.isArray(i)?i:void 0,y=(c=c||(h?void 0:i))?c.allKeys:void 0;return this._trans("readwrite",function(x){var M=f.schema.primKey,_=M.auto,M=M.keyPath;if(M&&h)throw new de.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(h&&h.length!==n.length)throw new de.InvalidArgument("Arguments objects and keys must have the same length");var A=n.length,M=M&&_?n.map(Dn(M)):n;return f.core.mutate({trans:x,type:"add",keys:h,values:M,wantResults:y}).then(function(D){var E=D.numFailures,F=D.results,I=D.lastResult,D=D.failures;if(E===0)return y?F:I;throw new Se("".concat(f.name,".bulkAdd(): ").concat(E," of ").concat(A," operations failed"),D)})})},ze.prototype.bulkPut=function(n,i,c){var f=this,h=Array.isArray(i)?i:void 0,y=(c=c||(h?void 0:i))?c.allKeys:void 0;return this._trans("readwrite",function(x){var M=f.schema.primKey,_=M.auto,M=M.keyPath;if(M&&h)throw new de.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(h&&h.length!==n.length)throw new de.InvalidArgument("Arguments objects and keys must have the same length");var A=n.length,M=M&&_?n.map(Dn(M)):n;return f.core.mutate({trans:x,type:"put",keys:h,values:M,wantResults:y}).then(function(D){var E=D.numFailures,F=D.results,I=D.lastResult,D=D.failures;if(E===0)return y?F:I;throw new Se("".concat(f.name,".bulkPut(): ").concat(E," of ").concat(A," operations failed"),D)})})},ze.prototype.bulkUpdate=function(n){var i=this,c=this.core,f=n.map(function(x){return x.key}),h=n.map(function(x){return x.changes}),y=[];return this._trans("readwrite",function(x){return c.getMany({trans:x,keys:f,cache:"clone"}).then(function(_){var A=[],M=[];n.forEach(function(E,F){var I=E.key,D=E.changes,B=_[F];if(B){for(var P=0,H=Object.keys(D);P<H.length;P++){var W=H[P],V=D[W];if(W===i.schema.primKey.keyPath){if(Te(V,I)!==0)throw new de.Constraint("Cannot update primary key in bulkUpdate()")}else Y(B,W,V)}y.push(F),A.push(I),M.push(B)}});var R=A.length;return c.mutate({trans:x,type:"put",keys:A,values:M,updates:{keys:f,changeSpecs:h}}).then(function(E){var F=E.numFailures,I=E.failures;if(F===0)return R;for(var D=0,B=Object.keys(I);D<B.length;D++){var P,H=B[D],W=y[Number(H)];W!=null&&(P=I[H],delete I[H],I[W]=P)}throw new Se("".concat(i.name,".bulkUpdate(): ").concat(F," of ").concat(R," operations failed"),I)})})})},ze.prototype.bulkDelete=function(n){var i=this,c=n.length;return this._trans("readwrite",function(f){return i.core.mutate({trans:f,type:"delete",keys:n})}).then(function(x){var h=x.numFailures,y=x.lastResult,x=x.failures;if(h===0)return y;throw new Se("".concat(i.name,".bulkDelete(): ").concat(h," of ").concat(c," operations failed"),x)})},ze);function ze(){}function tr(n){function i(x,_){if(_){for(var A=arguments.length,M=new Array(A-1);--A;)M[A-1]=arguments[A];return c[x].subscribe.apply(null,M),n}if(typeof x=="string")return c[x]}var c={};i.addEventType=y;for(var f=1,h=arguments.length;f<h;++f)y(arguments[f]);return i;function y(x,_,A){if(typeof x!="object"){var M;_=_||Je;var R={subscribers:[],fire:A=A||ke,subscribe:function(E){R.subscribers.indexOf(E)===-1&&(R.subscribers.push(E),R.fire=_(R.fire,E))},unsubscribe:function(E){R.subscribers=R.subscribers.filter(function(F){return F!==E}),R.fire=R.subscribers.reduce(_,A)}};return c[x]=i[x]=R}u(M=x).forEach(function(E){var F=M[E];if(l(F))y(E,M[E][0],M[E][1]);else{if(F!=="asap")throw new de.InvalidArgument("Invalid event config");var I=y(E,We,function(){for(var D=arguments.length,B=new Array(D);D--;)B[D]=arguments[D];I.subscribers.forEach(function(P){U(function(){P.apply(null,B)})})})}})}}function nr(n,i){return S(i).from({prototype:n}),i}function Rn(n,i){return!(n.filter||n.algorithm||n.or)&&(i?n.justLimit:!n.replayFilter)}function Fo(n,i){n.filter=Bt(n.filter,i)}function zo(n,i,c){var f=n.replayFilter;n.replayFilter=f?function(){return Bt(f(),i())}:i,n.justLimit=c&&!f}function Or(n,i){if(n.isPrimKey)return i.primaryKey;var c=i.getIndexByKeyPath(n.index);if(!c)throw new de.Schema("KeyPath "+n.index+" on object store "+i.name+" is not indexed");return c}function us(n,i,c){var f=Or(n,i.schema);return i.openCursor({trans:c,values:!n.keysOnly,reverse:n.dir==="prev",unique:!!n.unique,query:{index:f,range:n.range}})}function jr(n,i,c,f){var h=n.replayFilter?Bt(n.filter,n.replayFilter()):n.filter;if(n.or){var y={},x=function(_,A,M){var R,E;h&&!h(A,M,function(F){return A.stop(F)},function(F){return A.fail(F)})||((E=""+(R=A.primaryKey))=="[object ArrayBuffer]"&&(E=""+new Uint8Array(R)),v(y,E)||(y[E]=!0,i(_,A,M)))};return Promise.all([n.or._iterate(x,c),ls(us(n,f,c),n.algorithm,x,!n.keysOnly&&n.valueMapper)])}return ls(us(n,f,c),Bt(n.algorithm,h),i,!n.keysOnly&&n.valueMapper)}function ls(n,i,c,f){var h=Be(f?function(y,x,_){return c(f(y),x,_)}:c);return n.then(function(y){if(y)return y.start(function(){var x=function(){return y.continue()};i&&!i(y,function(_){return x=_},function(_){y.stop(_),x=ke},function(_){y.fail(_),x=ke})||h(y.value,y,function(_){return x=_}),x()})})}var Yt=Symbol(),rr=(fs.prototype.execute=function(n){if(this.add!==void 0){var i=this.add;if(l(i))return s(s([],l(n)?n:[],!0),i).sort();if(typeof i=="number")return(Number(n)||0)+i;if(typeof i=="bigint")try{return BigInt(n)+i}catch{return BigInt(0)+i}throw new TypeError("Invalid term ".concat(i))}if(this.remove!==void 0){var c=this.remove;if(l(c))return l(n)?n.filter(function(f){return!c.includes(f)}).sort():[];if(typeof c=="number")return Number(n)-c;if(typeof c=="bigint")try{return BigInt(n)-c}catch{return BigInt(0)-c}throw new TypeError("Invalid subtrahend ".concat(c))}return i=(i=this.replacePrefix)===null||i===void 0?void 0:i[0],i&&typeof n=="string"&&n.startsWith(i)?this.replacePrefix[1]+n.substring(i.length):n},fs);function fs(n){Object.assign(this,n)}var cu=(Re.prototype._read=function(n,i){var c=this._ctx;return c.error?c.table._trans(null,Ke.bind(null,c.error)):c.table._trans("readonly",n).then(i)},Re.prototype._write=function(n){var i=this._ctx;return i.error?i.table._trans(null,Ke.bind(null,i.error)):i.table._trans("readwrite",n,"locked")},Re.prototype._addAlgorithm=function(n){var i=this._ctx;i.algorithm=Bt(i.algorithm,n)},Re.prototype._iterate=function(n,i){return jr(this._ctx,n,i,this._ctx.table.core)},Re.prototype.clone=function(n){var i=Object.create(this.constructor.prototype),c=Object.create(this._ctx);return n&&d(c,n),i._ctx=c,i},Re.prototype.raw=function(){return this._ctx.valueMapper=null,this},Re.prototype.each=function(n){var i=this._ctx;return this._read(function(c){return jr(i,n,c,i.table.core)})},Re.prototype.count=function(n){var i=this;return this._read(function(c){var f=i._ctx,h=f.table.core;if(Rn(f,!0))return h.count({trans:c,query:{index:Or(f,h.schema),range:f.range}}).then(function(x){return Math.min(x,f.limit)});var y=0;return jr(f,function(){return++y,!1},c,h).then(function(){return y})}).then(n)},Re.prototype.sortBy=function(n,i){var c=n.split(".").reverse(),f=c[0],h=c.length-1;function y(A,M){return M?y(A[c[M]],M-1):A[f]}var x=this._ctx.dir==="next"?1:-1;function _(A,M){return Te(y(A,h),y(M,h))*x}return this.toArray(function(A){return A.sort(_)}).then(i)},Re.prototype.toArray=function(n){var i=this;return this._read(function(c){var f=i._ctx;if(f.dir==="next"&&Rn(f,!0)&&0<f.limit){var h=f.valueMapper,y=Or(f,f.table.core.schema);return f.table.core.query({trans:c,limit:f.limit,values:!0,query:{index:y,range:f.range}}).then(function(_){return _=_.result,h?_.map(h):_})}var x=[];return jr(f,function(_){return x.push(_)},c,f.table.core).then(function(){return x})},n)},Re.prototype.offset=function(n){var i=this._ctx;return n<=0||(i.offset+=n,Rn(i)?zo(i,function(){var c=n;return function(f,h){return c===0||(c===1?--c:h(function(){f.advance(c),c=0}),!1)}}):zo(i,function(){var c=n;return function(){return--c<0}})),this},Re.prototype.limit=function(n){return this._ctx.limit=Math.min(this._ctx.limit,n),zo(this._ctx,function(){var i=n;return function(c,f,h){return--i<=0&&f(h),0<=i}},!0),this},Re.prototype.until=function(n,i){return Fo(this._ctx,function(c,f,h){return!n(c.value)||(f(h),i)}),this},Re.prototype.first=function(n){return this.limit(1).toArray(function(i){return i[0]}).then(n)},Re.prototype.last=function(n){return this.reverse().first(n)},Re.prototype.filter=function(n){var i;return Fo(this._ctx,function(c){return n(c.value)}),(i=this._ctx).isMatch=Bt(i.isMatch,n),this},Re.prototype.and=function(n){return this.filter(n)},Re.prototype.or=function(n){return new this.db.WhereClause(this._ctx.table,n,this)},Re.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Re.prototype.desc=function(){return this.reverse()},Re.prototype.eachKey=function(n){var i=this._ctx;return i.keysOnly=!i.isMatch,this.each(function(c,f){n(f.key,f)})},Re.prototype.eachUniqueKey=function(n){return this._ctx.unique="unique",this.eachKey(n)},Re.prototype.eachPrimaryKey=function(n){var i=this._ctx;return i.keysOnly=!i.isMatch,this.each(function(c,f){n(f.primaryKey,f)})},Re.prototype.keys=function(n){var i=this._ctx;i.keysOnly=!i.isMatch;var c=[];return this.each(function(f,h){c.push(h.key)}).then(function(){return c}).then(n)},Re.prototype.primaryKeys=function(n){var i=this._ctx;if(i.dir==="next"&&Rn(i,!0)&&0<i.limit)return this._read(function(f){var h=Or(i,i.table.core.schema);return i.table.core.query({trans:f,values:!1,limit:i.limit,query:{index:h,range:i.range}})}).then(function(f){return f.result}).then(n);i.keysOnly=!i.isMatch;var c=[];return this.each(function(f,h){c.push(h.primaryKey)}).then(function(){return c}).then(n)},Re.prototype.uniqueKeys=function(n){return this._ctx.unique="unique",this.keys(n)},Re.prototype.firstKey=function(n){return this.limit(1).keys(function(i){return i[0]}).then(n)},Re.prototype.lastKey=function(n){return this.reverse().firstKey(n)},Re.prototype.distinct=function(){var n=this._ctx,n=n.index&&n.table.schema.idxByName[n.index];if(!n||!n.multi)return this;var i={};return Fo(this._ctx,function(h){var f=h.primaryKey.toString(),h=v(i,f);return i[f]=!0,!h}),this},Re.prototype.modify=function(n){var i=this,c=this._ctx;return this._write(function(f){var h,y,x;x=typeof n=="function"?n:(h=u(n),y=h.length,function(P){for(var H=!1,W=0;W<y;++W){var V=h[W],te=n[V],ce=Q(P,V);te instanceof rr?(Y(P,V,te.execute(ce)),H=!0):ce!==te&&(Y(P,V,te),H=!0)}return H});var _=c.table.core,E=_.schema.primaryKey,A=E.outbound,M=E.extractKey,R=200,E=i.db._options.modifyChunkSize;E&&(R=typeof E=="object"?E[_.name]||E["*"]||200:E);function F(P,V){var W=V.failures,V=V.numFailures;D+=P-V;for(var te=0,ce=u(W);te<ce.length;te++){var pe=ce[te];I.push(W[pe])}}var I=[],D=0,B=[];return i.clone().primaryKeys().then(function(P){function H(V){var te=Math.min(R,P.length-V);return _.getMany({trans:f,keys:P.slice(V,V+te),cache:"immutable"}).then(function(ce){for(var pe=[],ue=[],fe=A?[]:null,ye=[],he=0;he<te;++he){var we=ce[he],Ce={value:se(we),primKey:P[V+he]};x.call(Ce,Ce.value,Ce)!==!1&&(Ce.value==null?ye.push(P[V+he]):A||Te(M(we),M(Ce.value))===0?(ue.push(Ce.value),A&&fe.push(P[V+he])):(ye.push(P[V+he]),pe.push(Ce.value)))}return Promise.resolve(0<pe.length&&_.mutate({trans:f,type:"add",values:pe}).then(function(Ie){for(var Me in Ie.failures)ye.splice(parseInt(Me),1);F(pe.length,Ie)})).then(function(){return(0<ue.length||W&&typeof n=="object")&&_.mutate({trans:f,type:"put",keys:fe,values:ue,criteria:W,changeSpec:typeof n!="function"&&n,isAdditionalChunk:0<V}).then(function(Ie){return F(ue.length,Ie)})}).then(function(){return(0<ye.length||W&&n===Lo)&&_.mutate({trans:f,type:"delete",keys:ye,criteria:W,isAdditionalChunk:0<V}).then(function(Ie){return F(ye.length,Ie)})}).then(function(){return P.length>V+te&&H(V+R)})})}var W=Rn(c)&&c.limit===1/0&&(typeof n!="function"||n===Lo)&&{index:c.index,range:c.range};return H(0).then(function(){if(0<I.length)throw new be("Error modifying one or more objects",I,D,B);return P.length})})})},Re.prototype.delete=function(){var n=this._ctx,i=n.range;return Rn(n)&&(n.isPrimKey||i.type===3)?this._write(function(c){var f=n.table.core.schema.primaryKey,h=i;return n.table.core.count({trans:c,query:{index:f,range:h}}).then(function(y){return n.table.core.mutate({trans:c,type:"deleteRange",range:h}).then(function(x){var _=x.failures;if(x.lastResult,x.results,x=x.numFailures,x)throw new be("Could not delete some values",Object.keys(_).map(function(A){return _[A]}),y-x);return y-x})})}):this.modify(Lo)},Re);function Re(){}var Lo=function(n,i){return i.value=null};function uu(n,i){return n<i?-1:n===i?0:1}function lu(n,i){return i<n?-1:n===i?0:1}function ht(n,i,c){return n=n instanceof hs?new n.Collection(n):n,n._ctx.error=new(c||TypeError)(i),n}function $n(n){return new n.Collection(n,function(){return ds("")}).limit(0)}function Br(n,i,c,f){var h,y,x,_,A,M,R,E=c.length;if(!c.every(function(D){return typeof D=="string"}))return ht(n,Dr);function F(D){h=D==="next"?function(P){return P.toUpperCase()}:function(P){return P.toLowerCase()},y=D==="next"?function(P){return P.toLowerCase()}:function(P){return P.toUpperCase()},x=D==="next"?uu:lu;var B=c.map(function(P){return{lower:y(P),upper:h(P)}}).sort(function(P,H){return x(P.lower,H.lower)});_=B.map(function(P){return P.upper}),A=B.map(function(P){return P.lower}),R=(M=D)==="next"?"":f}F("next"),n=new n.Collection(n,function(){return on(_[0],A[E-1]+f)}),n._ondirectionchange=function(D){F(D)};var I=0;return n._addAlgorithm(function(D,B,P){var H=D.key;if(typeof H!="string")return!1;var W=y(H);if(i(W,A,I))return!0;for(var V=null,te=I;te<E;++te){var ce=function(pe,ue,fe,ye,he,we){for(var Ce=Math.min(pe.length,ye.length),Ie=-1,Me=0;Me<Ce;++Me){var pt=ue[Me];if(pt!==ye[Me])return he(pe[Me],fe[Me])<0?pe.substr(0,Me)+fe[Me]+fe.substr(Me+1):he(pe[Me],ye[Me])<0?pe.substr(0,Me)+ye[Me]+fe.substr(Me+1):0<=Ie?pe.substr(0,Ie)+ue[Ie]+fe.substr(Ie+1):null;he(pe[Me],pt)<0&&(Ie=Me)}return Ce<ye.length&&we==="next"?pe+fe.substr(pe.length):Ce<pe.length&&we==="prev"?pe.substr(0,fe.length):Ie<0?null:pe.substr(0,Ie)+ye[Ie]+fe.substr(Ie+1)}(H,W,_[te],A[te],x,M);ce===null&&V===null?I=te+1:(V===null||0<x(V,ce))&&(V=ce)}return B(V!==null?function(){D.continue(V+R)}:P),!1}),n}function on(n,i,c,f){return{type:2,lower:n,upper:i,lowerOpen:c,upperOpen:f}}function ds(n){return{type:1,lower:n,upper:n}}var hs=(Object.defineProperty(Ze.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Ze.prototype.between=function(n,i,c,f){c=c!==!1,f=f===!0;try{return 0<this._cmp(n,i)||this._cmp(n,i)===0&&(c||f)&&(!c||!f)?$n(this):new this.Collection(this,function(){return on(n,i,!c,!f)})}catch{return ht(this,Nt)}},Ze.prototype.equals=function(n){return n==null?ht(this,Nt):new this.Collection(this,function(){return ds(n)})},Ze.prototype.above=function(n){return n==null?ht(this,Nt):new this.Collection(this,function(){return on(n,void 0,!0)})},Ze.prototype.aboveOrEqual=function(n){return n==null?ht(this,Nt):new this.Collection(this,function(){return on(n,void 0,!1)})},Ze.prototype.below=function(n){return n==null?ht(this,Nt):new this.Collection(this,function(){return on(void 0,n,!1,!0)})},Ze.prototype.belowOrEqual=function(n){return n==null?ht(this,Nt):new this.Collection(this,function(){return on(void 0,n)})},Ze.prototype.startsWith=function(n){return typeof n!="string"?ht(this,Dr):this.between(n,n+jt,!0,!0)},Ze.prototype.startsWithIgnoreCase=function(n){return n===""?this.startsWith(n):Br(this,function(i,c){return i.indexOf(c[0])===0},[n],jt)},Ze.prototype.equalsIgnoreCase=function(n){return Br(this,function(i,c){return i===c[0]},[n],"")},Ze.prototype.anyOfIgnoreCase=function(){var n=Z.apply(L,arguments);return n.length===0?$n(this):Br(this,function(i,c){return c.indexOf(i)!==-1},n,"")},Ze.prototype.startsWithAnyOfIgnoreCase=function(){var n=Z.apply(L,arguments);return n.length===0?$n(this):Br(this,function(i,c){return c.some(function(f){return i.indexOf(f)===0})},n,jt)},Ze.prototype.anyOf=function(){var n=this,i=Z.apply(L,arguments),c=this._cmp;try{i.sort(c)}catch{return ht(this,Nt)}if(i.length===0)return $n(this);var f=new this.Collection(this,function(){return on(i[0],i[i.length-1])});f._ondirectionchange=function(y){c=y==="next"?n._ascending:n._descending,i.sort(c)};var h=0;return f._addAlgorithm(function(y,x,_){for(var A=y.key;0<c(A,i[h]);)if(++h===i.length)return x(_),!1;return c(A,i[h])===0||(x(function(){y.continue(i[h])}),!1)}),f},Ze.prototype.notEqual=function(n){return this.inAnyRange([[-1/0,n],[n,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Ze.prototype.noneOf=function(){var n=Z.apply(L,arguments);if(n.length===0)return new this.Collection(this);try{n.sort(this._ascending)}catch{return ht(this,Nt)}var i=n.reduce(function(c,f){return c?c.concat([[c[c.length-1][1],f]]):[[-1/0,f]]},null);return i.push([n[n.length-1],this.db._maxKey]),this.inAnyRange(i,{includeLowers:!1,includeUppers:!1})},Ze.prototype.inAnyRange=function(H,i){var c=this,f=this._cmp,h=this._ascending,y=this._descending,x=this._min,_=this._max;if(H.length===0)return $n(this);if(!H.every(function(W){return W[0]!==void 0&&W[1]!==void 0&&h(W[0],W[1])<=0}))return ht(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",de.InvalidArgument);var A=!i||i.includeLowers!==!1,M=i&&i.includeUppers===!0,R,E=h;function F(W,V){return E(W[0],V[0])}try{(R=H.reduce(function(W,V){for(var te=0,ce=W.length;te<ce;++te){var pe=W[te];if(f(V[0],pe[1])<0&&0<f(V[1],pe[0])){pe[0]=x(pe[0],V[0]),pe[1]=_(pe[1],V[1]);break}}return te===ce&&W.push(V),W},[])).sort(F)}catch{return ht(this,Nt)}var I=0,D=M?function(W){return 0<h(W,R[I][1])}:function(W){return 0<=h(W,R[I][1])},B=A?function(W){return 0<y(W,R[I][0])}:function(W){return 0<=y(W,R[I][0])},P=D,H=new this.Collection(this,function(){return on(R[0][0],R[R.length-1][1],!A,!M)});return H._ondirectionchange=function(W){E=W==="next"?(P=D,h):(P=B,y),R.sort(F)},H._addAlgorithm(function(W,V,te){for(var ce,pe=W.key;P(pe);)if(++I===R.length)return V(te),!1;return!D(ce=pe)&&!B(ce)||(c._cmp(pe,R[I][1])===0||c._cmp(pe,R[I][0])===0||V(function(){E===h?W.continue(R[I][0]):W.continue(R[I][1])}),!1)}),H},Ze.prototype.startsWithAnyOf=function(){var n=Z.apply(L,arguments);return n.every(function(i){return typeof i=="string"})?n.length===0?$n(this):this.inAnyRange(n.map(function(i){return[i,i+jt]})):ht(this,"startsWithAnyOf() only works with strings")},Ze);function Ze(){}function Ft(n){return Be(function(i){return or(i),n(i.target.error),!1})}function or(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}var ir="storagemutated",Ko="x-storagemutated-1",sn=tr(null,ir),fu=(zt.prototype._lock=function(){return C(!xe.global),++this._reculock,this._reculock!==1||xe.global||(xe.lockOwnerFor=this),this},zt.prototype._unlock=function(){if(C(!xe.global),--this._reculock==0)for(xe.global||(xe.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var n=this._blockedFuncs.shift();try{Vt(n[1],n[0])}catch{}}return this},zt.prototype._locked=function(){return this._reculock&&xe.lockOwnerFor!==this},zt.prototype.create=function(n){var i=this;if(!this.mode)return this;var c=this.db.idbdb,f=this.db._state.dbOpenError;if(C(!this.idbtrans),!n&&!c)switch(f&&f.name){case"DatabaseClosedError":throw new de.DatabaseClosed(f);case"MissingAPIError":throw new de.MissingAPI(f.message,f);default:throw new de.OpenFailed(f)}if(!this.active)throw new de.TransactionInactive;return C(this._completion._state===null),(n=this.idbtrans=n||(this.db.core||c).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Be(function(h){or(h),i._reject(n.error)}),n.onabort=Be(function(h){or(h),i.active&&i._reject(new de.Abort(n.error)),i.active=!1,i.on("abort").fire(h)}),n.oncomplete=Be(function(){i.active=!1,i._resolve(),"mutatedParts"in n&&sn.storagemutated.fire(n.mutatedParts)}),this},zt.prototype._promise=function(n,i,c){var f=this;if(n==="readwrite"&&this.mode!=="readwrite")return Ke(new de.ReadOnly("Transaction is readonly"));if(!this.active)return Ke(new de.TransactionInactive);if(this._locked())return new me(function(y,x){f._blockedFuncs.push([function(){f._promise(n,i,c).then(y,x)},xe])});if(c)return $t(function(){var y=new me(function(x,_){f._lock();var A=i(x,_,f);A&&A.then&&A.then(x,_)});return y.finally(function(){return f._unlock()}),y._lib=!0,y});var h=new me(function(y,x){var _=i(y,x,f);_&&_.then&&_.then(y,x)});return h._lib=!0,h},zt.prototype._root=function(){return this.parent?this.parent._root():this},zt.prototype.waitFor=function(n){var i,c=this._root(),f=me.resolve(n);c._waitingFor?c._waitingFor=c._waitingFor.then(function(){return f}):(c._waitingFor=f,c._waitingQueue=[],i=c.idbtrans.objectStore(c.storeNames[0]),function y(){for(++c._spinCount;c._waitingQueue.length;)c._waitingQueue.shift()();c._waitingFor&&(i.get(-1/0).onsuccess=y)}());var h=c._waitingFor;return new me(function(y,x){f.then(function(_){return c._waitingQueue.push(Be(y.bind(null,_)))},function(_){return c._waitingQueue.push(Be(x.bind(null,_)))}).finally(function(){c._waitingFor===h&&(c._waitingFor=null)})})},zt.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new de.Abort))},zt.prototype.table=function(n){var i=this._memoizedTables||(this._memoizedTables={});if(v(i,n))return i[n];var c=this.schema[n];if(!c)throw new de.NotFound("Table "+n+" not part of transaction");return c=new this.db.Table(n,c,this),c.core=this.db.core.table(n),i[n]=c},zt);function zt(){}function Ho(n,i,c,f,h,y,x){return{name:n,keyPath:i,unique:c,multi:f,auto:h,compound:y,src:(c&&!x?"&":"")+(f?"*":"")+(h?"++":"")+ps(i)}}function ps(n){return typeof n=="string"?n:n?"["+[].join.call(n,"+")+"]":""}function qo(n,i,c){return{name:n,primKey:i,indexes:c,mappedClass:null,idxByName:(f=function(h){return[h.name,h]},c.reduce(function(h,y,x){return x=f(y,x),x&&(h[x[0]]=x[1]),h},{}))};var f}var sr=function(n){try{return n.only([[]]),sr=function(){return[[]]},[[]]}catch{return sr=function(){return jt},jt}};function Wo(n){return n==null?function(){}:typeof n=="string"?(i=n).split(".").length===1?function(c){return c[i]}:function(c){return Q(c,i)}:function(c){return Q(c,n)};var i}function ms(n){return[].slice.call(n)}var du=0;function ar(n){return n==null?":id":typeof n=="string"?n:"[".concat(n.join("+"),"]")}function hu(n,i,A){function f(P){if(P.type===3)return null;if(P.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var I=P.lower,D=P.upper,B=P.lowerOpen,P=P.upperOpen;return I===void 0?D===void 0?null:i.upperBound(D,!!P):D===void 0?i.lowerBound(I,!!B):i.bound(I,D,!!B,!!P)}function h(F){var I,D=F.name;return{name:D,schema:F,mutate:function(B){var P=B.trans,H=B.type,W=B.keys,V=B.values,te=B.range;return new Promise(function(ce,pe){ce=Be(ce);var ue=P.objectStore(D),fe=ue.keyPath==null,ye=H==="put"||H==="add";if(!ye&&H!=="delete"&&H!=="deleteRange")throw new Error("Invalid operation type: "+H);var he,we=(W||V||{length:1}).length;if(W&&V&&W.length!==V.length)throw new Error("Given keys array must have same length as given values array.");if(we===0)return ce({numFailures:0,failures:{},results:[],lastResult:void 0});function Ce(lt){++pt,or(lt)}var Ie=[],Me=[],pt=0;if(H==="deleteRange"){if(te.type===4)return ce({numFailures:pt,failures:Me,results:[],lastResult:void 0});te.type===3?Ie.push(he=ue.clear()):Ie.push(he=ue.delete(f(te)))}else{var fe=ye?fe?[V,W]:[V,null]:[W,null],Ne=fe[0],it=fe[1];if(ye)for(var st=0;st<we;++st)Ie.push(he=it&&it[st]!==void 0?ue[H](Ne[st],it[st]):ue[H](Ne[st])),he.onerror=Ce;else for(st=0;st<we;++st)Ie.push(he=ue[H](Ne[st])),he.onerror=Ce}function Zr(lt){lt=lt.target.result,Ie.forEach(function(gn,ui){return gn.error!=null&&(Me[ui]=gn.error)}),ce({numFailures:pt,failures:Me,results:H==="delete"?W:Ie.map(function(gn){return gn.result}),lastResult:lt})}he.onerror=function(lt){Ce(lt),Zr(lt)},he.onsuccess=Zr})},getMany:function(B){var P=B.trans,H=B.keys;return new Promise(function(W,V){W=Be(W);for(var te,ce=P.objectStore(D),pe=H.length,ue=new Array(pe),fe=0,ye=0,he=function(Ie){Ie=Ie.target,ue[Ie._pos]=Ie.result,++ye===fe&&W(ue)},we=Ft(V),Ce=0;Ce<pe;++Ce)H[Ce]!=null&&((te=ce.get(H[Ce]))._pos=Ce,te.onsuccess=he,te.onerror=we,++fe);fe===0&&W(ue)})},get:function(B){var P=B.trans,H=B.key;return new Promise(function(W,V){W=Be(W);var te=P.objectStore(D).get(H);te.onsuccess=function(ce){return W(ce.target.result)},te.onerror=Ft(V)})},query:(I=M,function(B){return new Promise(function(P,H){P=Be(P);var W,V,te,fe=B.trans,ce=B.values,pe=B.limit,he=B.query,ue=pe===1/0?void 0:pe,ye=he.index,he=he.range,fe=fe.objectStore(D),ye=ye.isPrimaryKey?fe:fe.index(ye.name),he=f(he);if(pe===0)return P({result:[]});I?((ue=ce?ye.getAll(he,ue):ye.getAllKeys(he,ue)).onsuccess=function(we){return P({result:we.target.result})},ue.onerror=Ft(H)):(W=0,V=!ce&&"openKeyCursor"in ye?ye.openKeyCursor(he):ye.openCursor(he),te=[],V.onsuccess=function(we){var Ce=V.result;return Ce?(te.push(ce?Ce.value:Ce.primaryKey),++W===pe?P({result:te}):void Ce.continue()):P({result:te})},V.onerror=Ft(H))})}),openCursor:function(B){var P=B.trans,H=B.values,W=B.query,V=B.reverse,te=B.unique;return new Promise(function(ce,pe){ce=Be(ce);var ye=W.index,ue=W.range,fe=P.objectStore(D),fe=ye.isPrimaryKey?fe:fe.index(ye.name),ye=V?te?"prevunique":"prev":te?"nextunique":"next",he=!H&&"openKeyCursor"in fe?fe.openKeyCursor(f(ue),ye):fe.openCursor(f(ue),ye);he.onerror=Ft(pe),he.onsuccess=Be(function(we){var Ce,Ie,Me,pt,Ne=he.result;Ne?(Ne.___id=++du,Ne.done=!1,Ce=Ne.continue.bind(Ne),Ie=(Ie=Ne.continuePrimaryKey)&&Ie.bind(Ne),Me=Ne.advance.bind(Ne),pt=function(){throw new Error("Cursor not stopped")},Ne.trans=P,Ne.stop=Ne.continue=Ne.continuePrimaryKey=Ne.advance=function(){throw new Error("Cursor not started")},Ne.fail=Be(pe),Ne.next=function(){var it=this,st=1;return this.start(function(){return st--?it.continue():it.stop()}).then(function(){return it})},Ne.start=function(it){function st(){if(he.result)try{it()}catch(lt){Ne.fail(lt)}else Ne.done=!0,Ne.start=function(){throw new Error("Cursor behind last entry")},Ne.stop()}var Zr=new Promise(function(lt,gn){lt=Be(lt),he.onerror=Ft(gn),Ne.fail=gn,Ne.stop=function(ui){Ne.stop=Ne.continue=Ne.continuePrimaryKey=Ne.advance=pt,lt(ui)}});return he.onsuccess=Be(function(lt){he.onsuccess=st,st()}),Ne.continue=Ce,Ne.continuePrimaryKey=Ie,Ne.advance=Me,st(),Zr},ce(Ne)):ce(null)},pe)})},count:function(B){var P=B.query,H=B.trans,W=P.index,V=P.range;return new Promise(function(te,ce){var pe=H.objectStore(D),ue=W.isPrimaryKey?pe:pe.index(W.name),pe=f(V),ue=pe?ue.count(pe):ue.count();ue.onsuccess=Be(function(fe){return te(fe.target.result)}),ue.onerror=Ft(ce)})}}}var y,x,_,R=(x=A,_=ms((y=n).objectStoreNames),{schema:{name:y.name,tables:_.map(function(F){return x.objectStore(F)}).map(function(F){var I=F.keyPath,P=F.autoIncrement,D=l(I),B={},P={name:F.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:I==null,compound:D,keyPath:I,autoIncrement:P,unique:!0,extractKey:Wo(I)},indexes:ms(F.indexNames).map(function(H){return F.index(H)}).map(function(te){var W=te.name,V=te.unique,ce=te.multiEntry,te=te.keyPath,ce={name:W,compound:l(te),keyPath:te,unique:V,multiEntry:ce,extractKey:Wo(te)};return B[ar(te)]=ce}),getIndexByKeyPath:function(H){return B[ar(H)]}};return B[":id"]=P.primaryKey,I!=null&&(B[ar(I)]=P.primaryKey),P})},hasGetAll:0<_.length&&"getAll"in x.objectStore(_[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),A=R.schema,M=R.hasGetAll,R=A.tables.map(h),E={};return R.forEach(function(F){return E[F.name]=F}),{stack:"dbcore",transaction:n.transaction.bind(n),table:function(F){if(!E[F])throw new Error("Table '".concat(F,"' not found"));return E[F]},MIN_KEY:-1/0,MAX_KEY:sr(i),schema:A}}function pu(n,i,c,f){var h=c.IDBKeyRange;return c.indexedDB,{dbcore:(f=hu(i,h,f),n.dbcore.reduce(function(y,x){return x=x.create,o(o({},y),x(y))},f))}}function Fr(n,f){var c=f.db,f=pu(n._middlewares,c,n._deps,f);n.core=f.dbcore,n.tables.forEach(function(h){var y=h.name;n.core.schema.tables.some(function(x){return x.name===y})&&(h.core=n.core.table(y),n[y]instanceof n.Table&&(n[y].core=h.core))})}function zr(n,i,c,f){c.forEach(function(h){var y=f[h];i.forEach(function(x){var _=function A(M,R){return O(M,R)||(M=p(M))&&A(M,R)}(x,h);(!_||"value"in _&&_.value===void 0)&&(x===n.Transaction.prototype||x instanceof n.Transaction?k(x,h,{get:function(){return this.table(h)},set:function(A){g(this,h,{value:A,writable:!0,configurable:!0,enumerable:!0})}}):x[h]=new n.Table(h,y))})})}function Vo(n,i){i.forEach(function(c){for(var f in c)c[f]instanceof n.Table&&delete c[f]})}function mu(n,i){return n._cfg.version-i._cfg.version}function yu(n,i,c,f){var h=n._dbSchema;c.objectStoreNames.contains("$meta")&&!h.$meta&&(h.$meta=qo("$meta",gs("")[0],[]),n._storeNames.push("$meta"));var y=n._createTransaction("readwrite",n._storeNames,h);y.create(c),y._completion.catch(f);var x=y._reject.bind(y),_=xe.transless||xe;$t(function(){return xe.trans=y,xe.transless=_,i!==0?(Fr(n,c),M=i,((A=y).storeNames.includes("$meta")?A.table("$meta").get("version").then(function(R){return R??M}):me.resolve(M)).then(function(R){return F=R,I=y,D=c,B=[],R=(E=n)._versions,P=E._dbSchema=Kr(0,E.idbdb,D),(R=R.filter(function(H){return H._cfg.version>=F})).length!==0?(R.forEach(function(H){B.push(function(){var W=P,V=H._cfg.dbschema;Hr(E,W,D),Hr(E,V,D),P=E._dbSchema=V;var te=Yo(W,V);te.add.forEach(function(ye){Uo(D,ye[0],ye[1].primKey,ye[1].indexes)}),te.change.forEach(function(ye){if(ye.recreate)throw new de.Upgrade("Not yet support for changing primary key");var he=D.objectStore(ye.name);ye.add.forEach(function(we){return Lr(he,we)}),ye.change.forEach(function(we){he.deleteIndex(we.name),Lr(he,we)}),ye.del.forEach(function(we){return he.deleteIndex(we)})});var ce=H._cfg.contentUpgrade;if(ce&&H._cfg.version>F){Fr(E,D),I._memoizedTables={};var pe=ee(V);te.del.forEach(function(ye){pe[ye]=W[ye]}),Vo(E,[E.Transaction.prototype]),zr(E,[E.Transaction.prototype],u(pe),pe),I.schema=pe;var ue,fe=ie(ce);return fe&&nn(),te=me.follow(function(){var ye;(ue=ce(I))&&fe&&(ye=St.bind(null,null),ue.then(ye,ye))}),ue&&typeof ue.then=="function"?me.resolve(ue):te.then(function(){return ue})}}),B.push(function(W){var V,te,ce=H._cfg.dbschema;V=ce,te=W,[].slice.call(te.db.objectStoreNames).forEach(function(pe){return V[pe]==null&&te.db.deleteObjectStore(pe)}),Vo(E,[E.Transaction.prototype]),zr(E,[E.Transaction.prototype],E._storeNames,E._dbSchema),I.schema=E._dbSchema}),B.push(function(W){E.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(E.idbdb.version/10)===H._cfg.version?(E.idbdb.deleteObjectStore("$meta"),delete E._dbSchema.$meta,E._storeNames=E._storeNames.filter(function(V){return V!=="$meta"})):W.objectStore("$meta").put(H._cfg.version,"version"))})}),function H(){return B.length?me.resolve(B.shift()(I.idbtrans)).then(H):me.resolve()}().then(function(){ys(P,D)})):me.resolve();var E,F,I,D,B,P}).catch(x)):(u(h).forEach(function(R){Uo(c,R,h[R].primKey,h[R].indexes)}),Fr(n,c),void me.follow(function(){return n.on.populate.fire(y)}).catch(x));var A,M})}function gu(n,i){ys(n._dbSchema,i),i.db.version%10!=0||i.objectStoreNames.contains("$meta")||i.db.createObjectStore("$meta").add(Math.ceil(i.db.version/10-1),"version");var c=Kr(0,n.idbdb,i);Hr(n,n._dbSchema,i);for(var f=0,h=Yo(c,n._dbSchema).change;f<h.length;f++){var y=function(x){if(x.change.length||x.recreate)return console.warn("Unable to patch indexes of table ".concat(x.name," because it has changes on the type of index or primary key.")),{value:void 0};var _=i.objectStore(x.name);x.add.forEach(function(A){tt&&console.debug("Dexie upgrade patch: Creating missing index ".concat(x.name,".").concat(A.src)),Lr(_,A)})}(h[f]);if(typeof y=="object")return y.value}}function Yo(n,i){var c,f={del:[],add:[],change:[]};for(c in n)i[c]||f.del.push(c);for(c in i){var h=n[c],y=i[c];if(h){var x={name:c,def:y,recreate:!1,del:[],add:[],change:[]};if(""+(h.primKey.keyPath||"")!=""+(y.primKey.keyPath||"")||h.primKey.auto!==y.primKey.auto)x.recreate=!0,f.change.push(x);else{var _=h.idxByName,A=y.idxByName,M=void 0;for(M in _)A[M]||x.del.push(M);for(M in A){var R=_[M],E=A[M];R?R.src!==E.src&&x.change.push(E):x.add.push(E)}(0<x.del.length||0<x.add.length||0<x.change.length)&&f.change.push(x)}}else f.add.push([c,y])}return f}function Uo(n,i,c,f){var h=n.db.createObjectStore(i,c.keyPath?{keyPath:c.keyPath,autoIncrement:c.auto}:{autoIncrement:c.auto});return f.forEach(function(y){return Lr(h,y)}),h}function ys(n,i){u(n).forEach(function(c){i.db.objectStoreNames.contains(c)||(tt&&console.debug("Dexie: Creating missing table",c),Uo(i,c,n[c].primKey,n[c].indexes))})}function Lr(n,i){n.createIndex(i.name,i.keyPath,{unique:i.unique,multiEntry:i.multi})}function Kr(n,i,c){var f={};return K(i.objectStoreNames,0).forEach(function(h){for(var y=c.objectStore(h),x=Ho(ps(M=y.keyPath),M||"",!0,!1,!!y.autoIncrement,M&&typeof M!="string",!0),_=[],A=0;A<y.indexNames.length;++A){var R=y.index(y.indexNames[A]),M=R.keyPath,R=Ho(R.name,M,!!R.unique,!!R.multiEntry,!1,M&&typeof M!="string",!1);_.push(R)}f[h]=qo(h,x,_)}),f}function Hr(n,i,c){for(var f=c.db.objectStoreNames,h=0;h<f.length;++h){var y=f[h],x=c.objectStore(y);n._hasGetAll="getAll"in x;for(var _=0;_<x.indexNames.length;++_){var A=x.indexNames[_],M=x.index(A).keyPath,R=typeof M=="string"?M:"["+K(M).join("+")+"]";!i[y]||(M=i[y].idxByName[R])&&(M.name=A,delete i[y].idxByName[R],i[y].idxByName[A]=M)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&a.WorkerGlobalScope&&a instanceof a.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}function gs(n){return n.split(",").map(function(i,c){var f=(i=i.trim()).replace(/([&*]|\+\+)/g,""),h=/^\[/.test(f)?f.match(/^\[(.*)\]$/)[1].split("+"):f;return Ho(f,h||null,/\&/.test(i),/\*/.test(i),/\+\+/.test(i),l(h),c===0)})}var vu=(qr.prototype._parseStoresSpec=function(n,i){u(n).forEach(function(c){if(n[c]!==null){var f=gs(n[c]),h=f.shift();if(h.unique=!0,h.multi)throw new de.Schema("Primary key cannot be multi-valued");f.forEach(function(y){if(y.auto)throw new de.Schema("Only primary key can be marked as autoIncrement (++)");if(!y.keyPath)throw new de.Schema("Index must have a name and cannot be an empty string")}),i[c]=qo(c,h,f)}})},qr.prototype.stores=function(c){var i=this.db;this._cfg.storesSource=this._cfg.storesSource?d(this._cfg.storesSource,c):c;var c=i._versions,f={},h={};return c.forEach(function(y){d(f,y._cfg.storesSource),h=y._cfg.dbschema={},y._parseStoresSpec(f,h)}),i._dbSchema=h,Vo(i,[i._allTables,i,i.Transaction.prototype]),zr(i,[i._allTables,i,i.Transaction.prototype,this._cfg.tables],u(h),h),i._storeNames=u(h),this},qr.prototype.upgrade=function(n){return this._cfg.contentUpgrade=dt(this._cfg.contentUpgrade||ke,n),this},qr);function qr(){}function Xo(n,i){var c=n._dbNamesDB;return c||(c=n._dbNamesDB=new Ut(Pn,{addons:[],indexedDB:n,IDBKeyRange:i})).version(1).stores({dbnames:"name"}),c.table("dbnames")}function Go(n){return n&&typeof n.databases=="function"}function Zo(n){return $t(function(){return xe.letThrough=!0,n()})}function Qo(n){return!("from"in n)}var ot=function(n,i){if(!this){var c=new ot;return n&&"d"in n&&d(c,n),c}d(this,arguments.length?{d:1,from:n,to:1<arguments.length?i:n}:{d:0})};function cr(n,i,c){var f=Te(i,c);if(!isNaN(f)){if(0<f)throw RangeError();if(Qo(n))return d(n,{from:i,to:c,d:1});var h=n.l,f=n.r;if(Te(c,n.from)<0)return h?cr(h,i,c):n.l={from:i,to:c,d:1,l:null,r:null},ws(n);if(0<Te(i,n.to))return f?cr(f,i,c):n.r={from:i,to:c,d:1,l:null,r:null},ws(n);Te(i,n.from)<0&&(n.from=i,n.l=null,n.d=f?f.d+1:1),0<Te(c,n.to)&&(n.to=c,n.r=null,n.d=n.l?n.l.d+1:1),c=!n.r,h&&!n.l&&ur(n,h),f&&c&&ur(n,f)}}function ur(n,i){Qo(i)||function c(f,A){var y=A.from,x=A.to,_=A.l,A=A.r;cr(f,y,x),_&&c(f,_),A&&c(f,A)}(n,i)}function vs(n,i){var c=Wr(i),f=c.next();if(f.done)return!1;for(var h=f.value,y=Wr(n),x=y.next(h.from),_=x.value;!f.done&&!x.done;){if(Te(_.from,h.to)<=0&&0<=Te(_.to,h.from))return!0;Te(h.from,_.from)<0?h=(f=c.next(_.from)).value:_=(x=y.next(h.from)).value}return!1}function Wr(n){var i=Qo(n)?null:{s:0,n};return{next:function(c){for(var f=0<arguments.length;i;)switch(i.s){case 0:if(i.s=1,f)for(;i.n.l&&Te(c,i.n.from)<0;)i={up:i,n:i.n.l,s:1};else for(;i.n.l;)i={up:i,n:i.n.l,s:1};case 1:if(i.s=2,!f||Te(c,i.n.to)<=0)return{value:i.n,done:!1};case 2:if(i.n.r){i.s=3,i={up:i,n:i.n.r,s:0};continue}case 3:i=i.up}return{done:!0}}}}function ws(n){var i,c,f=(((i=n.r)===null||i===void 0?void 0:i.d)||0)-(((c=n.l)===null||c===void 0?void 0:c.d)||0),h=1<f?"r":f<-1?"l":"";h&&(i=h=="r"?"l":"r",c=o({},n),f=n[h],n.from=f.from,n.to=f.to,n[h]=f[h],c[h]=f[i],(n[i]=c).d=xs(c)),n.d=xs(n)}function xs(c){var i=c.r,c=c.l;return(i?c?Math.max(i.d,c.d):i.d:c?c.d:0)+1}function Vr(n,i){return u(i).forEach(function(c){n[c]?ur(n[c],i[c]):n[c]=function f(h){var y,x,_={};for(y in h)v(h,y)&&(x=h[y],_[y]=!x||typeof x!="object"||oe.has(x.constructor)?x:f(x));return _}(i[c])}),n}function Jo(n,i){return n.all||i.all||Object.keys(n).some(function(c){return i[c]&&vs(i[c],n[c])})}w(ot.prototype,((xt={add:function(n){return ur(this,n),this},addKey:function(n){return cr(this,n,n),this},addKeys:function(n){var i=this;return n.forEach(function(c){return cr(i,c,c)}),this},hasKey:function(n){var i=Wr(this).next(n).value;return i&&Te(i.from,n)<=0&&0<=Te(i.to,n)}})[j]=function(){return Wr(this)},xt));var mn={},ei={},ti=!1;function Yr(n){Vr(ei,n),ti||(ti=!0,setTimeout(function(){ti=!1,ni(ei,!(ei={}))},0))}function ni(n,i){i===void 0&&(i=!1);var c=new Set;if(n.all)for(var f=0,h=Object.values(mn);f<h.length;f++)bs(x=h[f],n,c,i);else for(var y in n){var x,_=/^idb\:\/\/(.*)\/(.*)\//.exec(y);_&&(y=_[1],_=_[2],(x=mn["idb://".concat(y,"/").concat(_)])&&bs(x,n,c,i))}c.forEach(function(A){return A()})}function bs(n,i,c,f){for(var h=[],y=0,x=Object.entries(n.queries.query);y<x.length;y++){for(var _=x[y],A=_[0],M=[],R=0,E=_[1];R<E.length;R++){var F=E[R];Jo(i,F.obsSet)?F.subscribers.forEach(function(P){return c.add(P)}):f&&M.push(F)}f&&h.push([A,M])}if(f)for(var I=0,D=h;I<D.length;I++){var B=D[I],A=B[0],M=B[1];n.queries.query[A]=M}}function wu(n){var i=n._state,c=n._deps.indexedDB;if(i.isBeingOpened||n.idbdb)return i.dbReadyPromise.then(function(){return i.dbOpenError?Ke(i.dbOpenError):n});i.isBeingOpened=!0,i.dbOpenError=null,i.openComplete=!1;var f=i.openCanceller,h=Math.round(10*n.verno),y=!1;function x(){if(i.openCanceller!==f)throw new de.DatabaseClosed("db.open() was cancelled")}function _(){return new me(function(F,I){if(x(),!c)throw new de.MissingAPI;var D=n.name,B=i.autoSchema||!h?c.open(D):c.open(D,h);if(!B)throw new de.MissingAPI;B.onerror=Ft(I),B.onblocked=Be(n._fireOnBlocked),B.onupgradeneeded=Be(function(P){var H;R=B.transaction,i.autoSchema&&!n._options.allowEmptyDB?(B.onerror=or,R.abort(),B.result.close(),(H=c.deleteDatabase(D)).onsuccess=H.onerror=Be(function(){I(new de.NoSuchDatabase("Database ".concat(D," doesnt exist")))})):(R.onerror=Ft(I),P=P.oldVersion>Math.pow(2,62)?0:P.oldVersion,E=P<1,n.idbdb=B.result,y&&gu(n,R),yu(n,P/10,R,I))},I),B.onsuccess=Be(function(){R=null;var P,H,W,V,te,ce=n.idbdb=B.result,pe=K(ce.objectStoreNames);if(0<pe.length)try{var ue=ce.transaction((V=pe).length===1?V[0]:V,"readonly");if(i.autoSchema)H=ce,W=ue,(P=n).verno=H.version/10,W=P._dbSchema=Kr(0,H,W),P._storeNames=K(H.objectStoreNames,0),zr(P,[P._allTables],u(W),W);else if(Hr(n,n._dbSchema,ue),((te=Yo(Kr(0,(te=n).idbdb,ue),te._dbSchema)).add.length||te.change.some(function(fe){return fe.add.length||fe.change.length}))&&!y)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),ce.close(),h=ce.version+1,y=!0,F(_());Fr(n,ue)}catch{}rn.push(n),ce.onversionchange=Be(function(fe){i.vcFired=!0,n.on("versionchange").fire(fe)}),ce.onclose=Be(function(fe){n.on("close").fire(fe)}),E&&(te=n._deps,ue=D,ce=te.indexedDB,te=te.IDBKeyRange,Go(ce)||ue===Pn||Xo(ce,te).put({name:ue}).catch(ke)),F()},I)}).catch(function(F){switch(F==null?void 0:F.name){case"UnknownError":if(0<i.PR1398_maxLoop)return i.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),_();break;case"VersionError":if(0<h)return h=0,_()}return me.reject(F)})}var A,M=i.dbReadyResolve,R=null,E=!1;return me.race([f,(typeof navigator>"u"?me.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(F){function I(){return indexedDB.databases().finally(F)}A=setInterval(I,100),I()}).finally(function(){return clearInterval(A)}):Promise.resolve()).then(_)]).then(function(){return x(),i.onReadyBeingFired=[],me.resolve(Zo(function(){return n.on.ready.fire(n.vip)})).then(function F(){if(0<i.onReadyBeingFired.length){var I=i.onReadyBeingFired.reduce(dt,ke);return i.onReadyBeingFired=[],me.resolve(Zo(function(){return I(n.vip)})).then(F)}})}).finally(function(){i.openCanceller===f&&(i.onReadyBeingFired=null,i.isBeingOpened=!1)}).catch(function(F){i.dbOpenError=F;try{R&&R.abort()}catch{}return f===i.openCanceller&&n._close(),Ke(F)}).finally(function(){i.openComplete=!0,M()}).then(function(){var F;return E&&(F={},n.tables.forEach(function(I){I.schema.indexes.forEach(function(D){D.name&&(F["idb://".concat(n.name,"/").concat(I.name,"/").concat(D.name)]=new ot(-1/0,[[[]]]))}),F["idb://".concat(n.name,"/").concat(I.name,"/")]=F["idb://".concat(n.name,"/").concat(I.name,"/:dels")]=new ot(-1/0,[[[]]])}),sn(ir).fire(F),ni(F,!0)),n})}function ri(n){function i(y){return n.next(y)}var c=h(i),f=h(function(y){return n.throw(y)});function h(y){return function(A){var _=y(A),A=_.value;return _.done?A:A&&typeof A.then=="function"?A.then(c,f):l(A)?Promise.all(A).then(c,f):c(A)}}return h(i)()}function Ur(n,i,c){for(var f=l(n)?n.slice():[n],h=0;h<c;++h)f.push(i);return f}var xu={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(n){return o(o({},n),{table:function(i){var c=n.table(i),f=c.schema,h={},y=[];function x(E,F,I){var D=ar(E),B=h[D]=h[D]||[],P=E==null?0:typeof E=="string"?1:E.length,H=0<F,H=o(o({},I),{name:H?"".concat(D,"(virtual-from:").concat(I.name,")"):I.name,lowLevelIndex:I,isVirtual:H,keyTail:F,keyLength:P,extractKey:Wo(E),unique:!H&&I.unique});return B.push(H),H.isPrimaryKey||y.push(H),1<P&&x(P===2?E[0]:E.slice(0,P-1),F+1,I),B.sort(function(W,V){return W.keyTail-V.keyTail}),H}i=x(f.primaryKey.keyPath,0,f.primaryKey),h[":id"]=[i];for(var _=0,A=f.indexes;_<A.length;_++){var M=A[_];x(M.keyPath,0,M)}function R(E){var F,I=E.query.index;return I.isVirtual?o(o({},E),{query:{index:I.lowLevelIndex,range:(F=E.query.range,I=I.keyTail,{type:F.type===1?2:F.type,lower:Ur(F.lower,F.lowerOpen?n.MAX_KEY:n.MIN_KEY,I),lowerOpen:!0,upper:Ur(F.upper,F.upperOpen?n.MIN_KEY:n.MAX_KEY,I),upperOpen:!0})}}):E}return o(o({},c),{schema:o(o({},f),{primaryKey:i,indexes:y,getIndexByKeyPath:function(E){return(E=h[ar(E)])&&E[0]}}),count:function(E){return c.count(R(E))},query:function(E){return c.query(R(E))},openCursor:function(E){var F=E.query.index,I=F.keyTail,D=F.isVirtual,B=F.keyLength;return D?c.openCursor(R(E)).then(function(H){return H&&P(H)}):c.openCursor(E);function P(H){return Object.create(H,{continue:{value:function(W){W!=null?H.continue(Ur(W,E.reverse?n.MAX_KEY:n.MIN_KEY,I)):E.unique?H.continue(H.key.slice(0,B).concat(E.reverse?n.MIN_KEY:n.MAX_KEY,I)):H.continue()}},continuePrimaryKey:{value:function(W,V){H.continuePrimaryKey(Ur(W,n.MAX_KEY,I),V)}},primaryKey:{get:function(){return H.primaryKey}},key:{get:function(){var W=H.key;return B===1?W[0]:W.slice(0,B)}},value:{get:function(){return H.value}}})}}})}})}};function oi(n,i,c,f){return c=c||{},f=f||"",u(n).forEach(function(h){var y,x,_;v(i,h)?(y=n[h],x=i[h],typeof y=="object"&&typeof x=="object"&&y&&x?(_=q(y))!==q(x)?c[f+h]=i[h]:_==="Object"?oi(y,x,c,f+h+"."):y!==x&&(c[f+h]=i[h]):y!==x&&(c[f+h]=i[h])):c[f+h]=void 0}),u(i).forEach(function(h){v(n,h)||(c[f+h]=i[h])}),c}function ii(n,i){return i.type==="delete"?i.keys:i.keys||i.values.map(n.extractKey)}var bu={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(n){return o(o({},n),{table:function(i){var c=n.table(i),f=c.schema.primaryKey;return o(o({},c),{mutate:function(h){var y=xe.trans,x=y.table(i).hook,_=x.deleting,A=x.creating,M=x.updating;switch(h.type){case"add":if(A.fire===ke)break;return y._promise("readwrite",function(){return R(h)},!0);case"put":if(A.fire===ke&&M.fire===ke)break;return y._promise("readwrite",function(){return R(h)},!0);case"delete":if(_.fire===ke)break;return y._promise("readwrite",function(){return R(h)},!0);case"deleteRange":if(_.fire===ke)break;return y._promise("readwrite",function(){return function E(F,I,D){return c.query({trans:F,values:!1,query:{index:f,range:I},limit:D}).then(function(B){var P=B.result;return R({type:"delete",keys:P,trans:F}).then(function(H){return 0<H.numFailures?Promise.reject(H.failures[0]):P.length<D?{failures:[],numFailures:0,lastResult:void 0}:E(F,o(o({},I),{lower:P[P.length-1],lowerOpen:!0}),D)})})}(h.trans,h.range,1e4)},!0)}return c.mutate(h);function R(E){var F,I,D,B=xe.trans,P=E.keys||ii(f,E);if(!P)throw new Error("Keys missing");return(E=E.type==="add"||E.type==="put"?o(o({},E),{keys:P}):o({},E)).type!=="delete"&&(E.values=s([],E.values)),E.keys&&(E.keys=s([],E.keys)),F=c,D=P,((I=E).type==="add"?Promise.resolve([]):F.getMany({trans:I.trans,keys:D,cache:"immutable"})).then(function(H){var W=P.map(function(V,te){var ce,pe,ue,fe=H[te],ye={onerror:null,onsuccess:null};return E.type==="delete"?_.fire.call(ye,V,fe,B):E.type==="add"||fe===void 0?(ce=A.fire.call(ye,V,E.values[te],B),V==null&&ce!=null&&(E.keys[te]=V=ce,f.outbound||Y(E.values[te],f.keyPath,V))):(ce=oi(fe,E.values[te]),(pe=M.fire.call(ye,ce,V,fe,B))&&(ue=E.values[te],Object.keys(pe).forEach(function(he){v(ue,he)?ue[he]=pe[he]:Y(ue,he,pe[he])}))),ye});return c.mutate(E).then(function(V){for(var te=V.failures,ce=V.results,pe=V.numFailures,V=V.lastResult,ue=0;ue<P.length;++ue){var fe=(ce||P)[ue],ye=W[ue];fe==null?ye.onerror&&ye.onerror(te[ue]):ye.onsuccess&&ye.onsuccess(E.type==="put"&&H[ue]?E.values[ue]:fe)}return{failures:te,results:ce,numFailures:pe,lastResult:V}}).catch(function(V){return W.forEach(function(te){return te.onerror&&te.onerror(V)}),Promise.reject(V)})})}}})}})}};function _s(n,i,c){try{if(!i||i.keys.length<n.length)return null;for(var f=[],h=0,y=0;h<i.keys.length&&y<n.length;++h)Te(i.keys[h],n[y])===0&&(f.push(c?se(i.values[h]):i.values[h]),++y);return f.length===n.length?f:null}catch{return null}}var _u={stack:"dbcore",level:-1,create:function(n){return{table:function(i){var c=n.table(i);return o(o({},c),{getMany:function(f){if(!f.cache)return c.getMany(f);var h=_s(f.keys,f.trans._cache,f.cache==="clone");return h?me.resolve(h):c.getMany(f).then(function(y){return f.trans._cache={keys:f.keys,values:f.cache==="clone"?se(y):y},y})},mutate:function(f){return f.type!=="add"&&(f.trans._cache=null),c.mutate(f)}})}}}};function Es(n,i){return n.trans.mode==="readonly"&&!!n.subscr&&!n.trans.explicit&&n.trans.db._options.cache!=="disabled"&&!i.schema.primaryKey.outbound}function ks(n,i){switch(n){case"query":return i.values&&!i.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Eu={stack:"dbcore",level:0,name:"Observability",create:function(n){var i=n.schema.name,c=new ot(n.MIN_KEY,n.MAX_KEY);return o(o({},n),{transaction:function(f,h,y){if(xe.subscr&&h!=="readonly")throw new de.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(xe.querier));return n.transaction(f,h,y)},table:function(f){var h=n.table(f),y=h.schema,x=y.primaryKey,E=y.indexes,_=x.extractKey,A=x.outbound,M=x.autoIncrement&&E.filter(function(I){return I.compound&&I.keyPath.includes(x.keyPath)}),R=o(o({},h),{mutate:function(I){function D(he){return he="idb://".concat(i,"/").concat(f,"/").concat(he),V[he]||(V[he]=new ot)}var B,P,H,W=I.trans,V=I.mutatedParts||(I.mutatedParts={}),te=D(""),ce=D(":dels"),pe=I.type,ye=I.type==="deleteRange"?[I.range]:I.type==="delete"?[I.keys]:I.values.length<50?[ii(x,I).filter(function(he){return he}),I.values]:[],ue=ye[0],fe=ye[1],ye=I.trans._cache;return l(ue)?(te.addKeys(ue),(ye=pe==="delete"||ue.length===fe.length?_s(ue,ye):null)||ce.addKeys(ue),(ye||fe)&&(B=D,P=ye,H=fe,y.indexes.forEach(function(he){var we=B(he.name||"");function Ce(Me){return Me!=null?he.extractKey(Me):null}function Ie(Me){return he.multiEntry&&l(Me)?Me.forEach(function(pt){return we.addKey(pt)}):we.addKey(Me)}(P||H).forEach(function(Me,it){var Ne=P&&Ce(P[it]),it=H&&Ce(H[it]);Te(Ne,it)!==0&&(Ne!=null&&Ie(Ne),it!=null&&Ie(it))})}))):ue?(fe={from:(fe=ue.lower)!==null&&fe!==void 0?fe:n.MIN_KEY,to:(fe=ue.upper)!==null&&fe!==void 0?fe:n.MAX_KEY},ce.add(fe),te.add(fe)):(te.add(c),ce.add(c),y.indexes.forEach(function(he){return D(he.name).add(c)})),h.mutate(I).then(function(he){return!ue||I.type!=="add"&&I.type!=="put"||(te.addKeys(he.results),M&&M.forEach(function(we){for(var Ce=I.values.map(function(Ne){return we.extractKey(Ne)}),Ie=we.keyPath.findIndex(function(Ne){return Ne===x.keyPath}),Me=0,pt=he.results.length;Me<pt;++Me)Ce[Me][Ie]=he.results[Me];D(we.name).addKeys(Ce)})),W.mutatedParts=Vr(W.mutatedParts||{},V),he})}}),E=function(D){var B=D.query,D=B.index,B=B.range;return[D,new ot((D=B.lower)!==null&&D!==void 0?D:n.MIN_KEY,(B=B.upper)!==null&&B!==void 0?B:n.MAX_KEY)]},F={get:function(I){return[x,new ot(I.key)]},getMany:function(I){return[x,new ot().addKeys(I.keys)]},count:E,query:E,openCursor:E};return u(F).forEach(function(I){R[I]=function(D){var B=xe.subscr,P=!!B,H=Es(xe,h)&&ks(I,D)?D.obsSet={}:B;if(P){var W=function(fe){return fe="idb://".concat(i,"/").concat(f,"/").concat(fe),H[fe]||(H[fe]=new ot)},V=W(""),te=W(":dels"),B=F[I](D),P=B[0],B=B[1];if((I==="query"&&P.isPrimaryKey&&!D.values?te:W(P.name||"")).add(B),!P.isPrimaryKey){if(I!=="count"){var ce=I==="query"&&A&&D.values&&h.query(o(o({},D),{values:!1}));return h[I].apply(this,arguments).then(function(fe){if(I==="query"){if(A&&D.values)return ce.then(function(Ce){return Ce=Ce.result,V.addKeys(Ce),fe});var ye=D.values?fe.result.map(_):fe.result;(D.values?V:te).addKeys(ye)}else if(I==="openCursor"){var he=fe,we=D.values;return he&&Object.create(he,{key:{get:function(){return te.addKey(he.primaryKey),he.key}},primaryKey:{get:function(){var Ce=he.primaryKey;return te.addKey(Ce),Ce}},value:{get:function(){return we&&V.addKey(he.primaryKey),he.value}}})}return fe})}te.add(c)}}return h[I].apply(this,arguments)}}),R}})}};function Ss(n,i,c){if(c.numFailures===0)return i;if(i.type==="deleteRange")return null;var f=i.keys?i.keys.length:"values"in i&&i.values?i.values.length:1;return c.numFailures===f?null:(i=o({},i),l(i.keys)&&(i.keys=i.keys.filter(function(h,y){return!(y in c.failures)})),"values"in i&&l(i.values)&&(i.values=i.values.filter(function(h,y){return!(y in c.failures)})),i)}function si(n,i){return c=n,((f=i).lower===void 0||(f.lowerOpen?0<Te(c,f.lower):0<=Te(c,f.lower)))&&(n=n,(i=i).upper===void 0||(i.upperOpen?Te(n,i.upper)<0:Te(n,i.upper)<=0));var c,f}function Ns(n,i,F,f,h,y){if(!F||F.length===0)return n;var x=i.query.index,_=x.multiEntry,A=i.query.range,M=f.schema.primaryKey.extractKey,R=x.extractKey,E=(x.lowLevelIndex||x).extractKey,F=F.reduce(function(I,D){var B=I,P=[];if(D.type==="add"||D.type==="put")for(var H=new ot,W=D.values.length-1;0<=W;--W){var V,te=D.values[W],ce=M(te);H.hasKey(ce)||(V=R(te),(_&&l(V)?V.some(function(he){return si(he,A)}):si(V,A))&&(H.addKey(ce),P.push(te)))}switch(D.type){case"add":var pe=new ot().addKeys(i.values?I.map(function(we){return M(we)}):I),B=I.concat(i.values?P.filter(function(we){return we=M(we),!pe.hasKey(we)&&(pe.addKey(we),!0)}):P.map(function(we){return M(we)}).filter(function(we){return!pe.hasKey(we)&&(pe.addKey(we),!0)}));break;case"put":var ue=new ot().addKeys(D.values.map(function(we){return M(we)}));B=I.filter(function(we){return!ue.hasKey(i.values?M(we):we)}).concat(i.values?P:P.map(function(we){return M(we)}));break;case"delete":var fe=new ot().addKeys(D.keys);B=I.filter(function(we){return!fe.hasKey(i.values?M(we):we)});break;case"deleteRange":var ye=D.range;B=I.filter(function(we){return!si(M(we),ye)})}return B},n);return F===n?n:(F.sort(function(I,D){return Te(E(I),E(D))||Te(M(I),M(D))}),i.limit&&i.limit<1/0&&(F.length>i.limit?F.length=i.limit:n.length===i.limit&&F.length<i.limit&&(h.dirty=!0)),y?Object.freeze(F):F)}function Cs(n,i){return Te(n.lower,i.lower)===0&&Te(n.upper,i.upper)===0&&!!n.lowerOpen==!!i.lowerOpen&&!!n.upperOpen==!!i.upperOpen}function ku(n,i){return function(c,f,h,y){if(c===void 0)return f!==void 0?-1:0;if(f===void 0)return 1;if((f=Te(c,f))===0){if(h&&y)return 0;if(h)return 1;if(y)return-1}return f}(n.lower,i.lower,n.lowerOpen,i.lowerOpen)<=0&&0<=function(c,f,h,y){if(c===void 0)return f!==void 0?1:0;if(f===void 0)return-1;if((f=Te(c,f))===0){if(h&&y)return 0;if(h)return-1;if(y)return 1}return f}(n.upper,i.upper,n.upperOpen,i.upperOpen)}function Su(n,i,c,f){n.subscribers.add(c),f.addEventListener("abort",function(){var h,y;n.subscribers.delete(c),n.subscribers.size===0&&(h=n,y=i,setTimeout(function(){h.subscribers.size===0&&J(y,h)},3e3))})}var Nu={stack:"dbcore",level:0,name:"Cache",create:function(n){var i=n.schema.name;return o(o({},n),{transaction:function(c,f,h){var y,x,_=n.transaction(c,f,h);return f==="readwrite"&&(x=(y=new AbortController).signal,h=function(A){return function(){if(y.abort(),f==="readwrite"){for(var M=new Set,R=0,E=c;R<E.length;R++){var F=E[R],I=mn["idb://".concat(i,"/").concat(F)];if(I){var D=n.table(F),B=I.optimisticOps.filter(function(we){return we.trans===_});if(_._explicit&&A&&_.mutatedParts)for(var P=0,H=Object.values(I.queries.query);P<H.length;P++)for(var W=0,V=(pe=H[P]).slice();W<V.length;W++)Jo((ue=V[W]).obsSet,_.mutatedParts)&&(J(pe,ue),ue.subscribers.forEach(function(we){return M.add(we)}));else if(0<B.length){I.optimisticOps=I.optimisticOps.filter(function(we){return we.trans!==_});for(var te=0,ce=Object.values(I.queries.query);te<ce.length;te++)for(var pe,ue,fe,ye=0,he=(pe=ce[te]).slice();ye<he.length;ye++)(ue=he[ye]).res!=null&&_.mutatedParts&&(A&&!ue.dirty?(fe=Object.isFrozen(ue.res),fe=Ns(ue.res,ue.req,B,D,ue,fe),ue.dirty?(J(pe,ue),ue.subscribers.forEach(function(we){return M.add(we)})):fe!==ue.res&&(ue.res=fe,ue.promise=me.resolve({result:fe}))):(ue.dirty&&J(pe,ue),ue.subscribers.forEach(function(we){return M.add(we)})))}}}M.forEach(function(we){return we()})}}},_.addEventListener("abort",h(!1),{signal:x}),_.addEventListener("error",h(!1),{signal:x}),_.addEventListener("complete",h(!0),{signal:x})),_},table:function(c){var f=n.table(c),h=f.schema.primaryKey;return o(o({},f),{mutate:function(y){var x=xe.trans;if(h.outbound||x.db._options.cache==="disabled"||x.explicit||x.idbtrans.mode!=="readwrite")return f.mutate(y);var _=mn["idb://".concat(i,"/").concat(c)];return _?(x=f.mutate(y),y.type!=="add"&&y.type!=="put"||!(50<=y.values.length||ii(h,y).some(function(A){return A==null}))?(_.optimisticOps.push(y),y.mutatedParts&&Yr(y.mutatedParts),x.then(function(A){0<A.numFailures&&(J(_.optimisticOps,y),(A=Ss(0,y,A))&&_.optimisticOps.push(A),y.mutatedParts&&Yr(y.mutatedParts))}),x.catch(function(){J(_.optimisticOps,y),y.mutatedParts&&Yr(y.mutatedParts)})):x.then(function(A){var M=Ss(0,o(o({},y),{values:y.values.map(function(R,E){var F;return A.failures[E]?R:(R=(F=h.keyPath)!==null&&F!==void 0&&F.includes(".")?se(R):o({},R),Y(R,h.keyPath,A.results[E]),R)})}),A);_.optimisticOps.push(M),queueMicrotask(function(){return y.mutatedParts&&Yr(y.mutatedParts)})}),x):f.mutate(y)},query:function(y){if(!Es(xe,f)||!ks("query",y))return f.query(y);var x=((M=xe.trans)===null||M===void 0?void 0:M.db._options.cache)==="immutable",E=xe,_=E.requery,A=E.signal,M=function(D,B,P,H){var W=mn["idb://".concat(D,"/").concat(B)];if(!W)return[];if(!(B=W.queries[P]))return[null,!1,W,null];var V=B[(H.query?H.query.index.name:null)||""];if(!V)return[null,!1,W,null];switch(P){case"query":var te=V.find(function(ce){return ce.req.limit===H.limit&&ce.req.values===H.values&&Cs(ce.req.query.range,H.query.range)});return te?[te,!0,W,V]:[V.find(function(ce){return("limit"in ce.req?ce.req.limit:1/0)>=H.limit&&(!H.values||ce.req.values)&&ku(ce.req.query.range,H.query.range)}),!1,W,V];case"count":return te=V.find(function(ce){return Cs(ce.req.query.range,H.query.range)}),[te,!!te,W,V]}}(i,c,"query",y),R=M[0],E=M[1],F=M[2],I=M[3];return R&&E?R.obsSet=y.obsSet:(E=f.query(y).then(function(D){var B=D.result;if(R&&(R.res=B),x){for(var P=0,H=B.length;P<H;++P)Object.freeze(B[P]);Object.freeze(B)}else D.result=se(B);return D}).catch(function(D){return I&&R&&J(I,R),Promise.reject(D)}),R={obsSet:y.obsSet,promise:E,subscribers:new Set,type:"query",req:y,dirty:!1},I?I.push(R):(I=[R],(F=F||(mn["idb://".concat(i,"/").concat(c)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[y.query.index.name||""]=I)),Su(R,I,_,A),R.promise.then(function(D){return{result:Ns(D.result,y,F==null?void 0:F.optimisticOps,f,R,x)}})}})}})}};function Xr(n,i){return new Proxy(n,{get:function(c,f,h){return f==="db"?i:Reflect.get(c,f,h)}})}var Ut=(Ve.prototype.version=function(n){if(isNaN(n)||n<.1)throw new de.Type("Given version is not a positive number");if(n=Math.round(10*n)/10,this.idbdb||this._state.isBeingOpened)throw new de.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var i=this._versions,c=i.filter(function(f){return f._cfg.version===n})[0];return c||(c=new this.Version(n),i.push(c),i.sort(mu),c.stores({}),this._state.autoSchema=!1,c)},Ve.prototype._whenReady=function(n){var i=this;return this.idbdb&&(this._state.openComplete||xe.letThrough||this._vip)?n():new me(function(c,f){if(i._state.openComplete)return f(new de.DatabaseClosed(i._state.dbOpenError));if(!i._state.isBeingOpened){if(!i._state.autoOpen)return void f(new de.DatabaseClosed);i.open().catch(ke)}i._state.dbReadyPromise.then(c,f)}).then(n)},Ve.prototype.use=function(n){var i=n.stack,c=n.create,f=n.level,h=n.name;return h&&this.unuse({stack:i,name:h}),n=this._middlewares[i]||(this._middlewares[i]=[]),n.push({stack:i,create:c,level:f??10,name:h}),n.sort(function(y,x){return y.level-x.level}),this},Ve.prototype.unuse=function(n){var i=n.stack,c=n.name,f=n.create;return i&&this._middlewares[i]&&(this._middlewares[i]=this._middlewares[i].filter(function(h){return f?h.create!==f:!!c&&h.name!==c})),this},Ve.prototype.open=function(){var n=this;return Vt(rt,function(){return wu(n)})},Ve.prototype._close=function(){var n=this._state,i=rn.indexOf(this);if(0<=i&&rn.splice(i,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}n.isBeingOpened||(n.dbReadyPromise=new me(function(c){n.dbReadyResolve=c}),n.openCanceller=new me(function(c,f){n.cancelOpen=f}))},Ve.prototype.close=function(c){var i=(c===void 0?{disableAutoOpen:!0}:c).disableAutoOpen,c=this._state;i?(c.isBeingOpened&&c.cancelOpen(new de.DatabaseClosed),this._close(),c.autoOpen=!1,c.dbOpenError=new de.DatabaseClosed):(this._close(),c.autoOpen=this._options.autoOpen||c.isBeingOpened,c.openComplete=!1,c.dbOpenError=null)},Ve.prototype.delete=function(n){var i=this;n===void 0&&(n={disableAutoOpen:!0});var c=0<arguments.length&&typeof arguments[0]!="object",f=this._state;return new me(function(h,y){function x(){i.close(n);var _=i._deps.indexedDB.deleteDatabase(i.name);_.onsuccess=Be(function(){var A,M,R;A=i._deps,M=i.name,R=A.indexedDB,A=A.IDBKeyRange,Go(R)||M===Pn||Xo(R,A).delete(M).catch(ke),h()}),_.onerror=Ft(y),_.onblocked=i._fireOnBlocked}if(c)throw new de.InvalidArgument("Invalid closeOptions argument to db.delete()");f.isBeingOpened?f.dbReadyPromise.then(x):x()})},Ve.prototype.backendDB=function(){return this.idbdb},Ve.prototype.isOpen=function(){return this.idbdb!==null},Ve.prototype.hasBeenClosed=function(){var n=this._state.dbOpenError;return n&&n.name==="DatabaseClosed"},Ve.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Ve.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Ve.prototype,"tables",{get:function(){var n=this;return u(this._allTables).map(function(i){return n._allTables[i]})},enumerable:!1,configurable:!0}),Ve.prototype.transaction=function(){var n=(function(i,c,f){var h=arguments.length;if(h<2)throw new de.InvalidArgument("Too few arguments");for(var y=new Array(h-1);--h;)y[h-1]=arguments[h];return f=y.pop(),[i,ne(y),f]}).apply(this,arguments);return this._transaction.apply(this,n)},Ve.prototype._transaction=function(n,i,c){var f=this,h=xe.trans;h&&h.db===this&&n.indexOf("!")===-1||(h=null);var y,x,_=n.indexOf("?")!==-1;n=n.replace("!","").replace("?","");try{if(x=i.map(function(M){if(M=M instanceof f.Table?M.name:M,typeof M!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return M}),n=="r"||n===Jn)y=Jn;else{if(n!="rw"&&n!=er)throw new de.InvalidArgument("Invalid transaction mode: "+n);y=er}if(h){if(h.mode===Jn&&y===er){if(!_)throw new de.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");h=null}h&&x.forEach(function(M){if(h&&h.storeNames.indexOf(M)===-1){if(!_)throw new de.SubTransaction("Table "+M+" not included in parent transaction.");h=null}}),_&&h&&!h.active&&(h=null)}}catch(M){return h?h._promise(null,function(R,E){E(M)}):Ke(M)}var A=(function M(R,E,F,I,D){return me.resolve().then(function(){var B=xe.transless||xe,P=R._createTransaction(E,F,R._dbSchema,I);if(P.explicit=!0,B={trans:P,transless:B},I)P.idbtrans=I.idbtrans;else try{P.create(),P.idbtrans._explicit=!0,R._state.PR1398_maxLoop=3}catch(V){return V.name===Ae.InvalidState&&R.isOpen()&&0<--R._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),R.close({disableAutoOpen:!1}),R.open().then(function(){return M(R,E,F,null,D)})):Ke(V)}var H,W=ie(D);return W&&nn(),B=me.follow(function(){var V;(H=D.call(P,P))&&(W?(V=St.bind(null,null),H.then(V,V)):typeof H.next=="function"&&typeof H.throw=="function"&&(H=ri(H)))},B),(H&&typeof H.then=="function"?me.resolve(H).then(function(V){return P.active?V:Ke(new de.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):B.then(function(){return H})).then(function(V){return I&&P._resolve(),P._completion.then(function(){return V})}).catch(function(V){return P._reject(V),Ke(V)})})}).bind(null,this,y,x,h,c);return h?h._promise(y,A,"lock"):xe.trans?Vt(xe.transless,function(){return f._whenReady(A)}):this._whenReady(A)},Ve.prototype.table=function(n){if(!v(this._allTables,n))throw new de.InvalidTable("Table ".concat(n," does not exist"));return this._allTables[n]},Ve);function Ve(n,i){var c=this;this._middlewares={},this.verno=0;var f=Ve.dependencies;this._options=i=o({addons:Ve.addons,autoOpen:!0,indexedDB:f.indexedDB,IDBKeyRange:f.IDBKeyRange,cache:"cloned"},i),this._deps={indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange},f=i.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var h,y,x,_,A,M={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ke,dbReadyPromise:null,cancelOpen:ke,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:i.autoOpen};M.dbReadyPromise=new me(function(E){M.dbReadyResolve=E}),M.openCanceller=new me(function(E,F){M.cancelOpen=F}),this._state=M,this.name=n,this.on=tr(this,"populate","blocked","versionchange","close",{ready:[dt,ke]}),this.on.ready.subscribe=z(this.on.ready.subscribe,function(E){return function(F,I){Ve.vip(function(){var D,B=c._state;B.openComplete?(B.dbOpenError||me.resolve().then(F),I&&E(F)):B.onReadyBeingFired?(B.onReadyBeingFired.push(F),I&&E(F)):(E(F),D=c,I||E(function P(){D.on.ready.unsubscribe(F),D.on.ready.unsubscribe(P)}))})}}),this.Collection=(h=this,nr(cu.prototype,function(H,P){this.db=h;var I=Rr,D=null;if(P)try{I=P()}catch(W){D=W}var B=H._ctx,P=B.table,H=P.hook.reading.fire;this._ctx={table:P,index:B.index,isPrimKey:!B.index||P.schema.primKey.keyPath&&B.index===P.schema.primKey.name,range:I,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:D,or:B.or,valueMapper:H!==We?H:null}})),this.Table=(y=this,nr(cs.prototype,function(E,F,I){this.db=y,this._tx=I,this.name=E,this.schema=F,this.hook=y._allTables[E]?y._allTables[E].hook:tr(null,{creating:[at,ke],reading:[Xe,We],updating:[Ee,ke],deleting:[Oe,ke]})})),this.Transaction=(x=this,nr(fu.prototype,function(E,F,I,D,B){var P=this;this.db=x,this.mode=E,this.storeNames=F,this.schema=I,this.chromeTransactionDurability=D,this.idbtrans=null,this.on=tr(this,"complete","error","abort"),this.parent=B||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new me(function(H,W){P._resolve=H,P._reject=W}),this._completion.then(function(){P.active=!1,P.on.complete.fire()},function(H){var W=P.active;return P.active=!1,P.on.error.fire(H),P.parent?P.parent._reject(H):W&&P.idbtrans&&P.idbtrans.abort(),Ke(H)})})),this.Version=(_=this,nr(vu.prototype,function(E){this.db=_,this._cfg={version:E,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(A=this,nr(hs.prototype,function(E,F,I){if(this.db=A,this._ctx={table:E,index:F===":id"?null:F,or:I},this._cmp=this._ascending=Te,this._descending=function(D,B){return Te(B,D)},this._max=function(D,B){return 0<Te(D,B)?D:B},this._min=function(D,B){return Te(D,B)<0?D:B},this._IDBKeyRange=A._deps.IDBKeyRange,!this._IDBKeyRange)throw new de.MissingAPI})),this.on("versionchange",function(E){0<E.newVersion?console.warn("Another connection wants to upgrade database '".concat(c.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(c.name,"'. Closing db now to resume the delete request.")),c.close({disableAutoOpen:!1})}),this.on("blocked",function(E){!E.newVersion||E.newVersion<E.oldVersion?console.warn("Dexie.delete('".concat(c.name,"') was blocked")):console.warn("Upgrade '".concat(c.name,"' blocked by other connection holding version ").concat(E.oldVersion/10))}),this._maxKey=sr(i.IDBKeyRange),this._createTransaction=function(E,F,I,D){return new c.Transaction(E,F,I,c._options.chromeTransactionDurability,D)},this._fireOnBlocked=function(E){c.on("blocked").fire(E),rn.filter(function(F){return F.name===c.name&&F!==c&&!F._state.vcFired}).map(function(F){return F.on("versionchange").fire(E)})},this.use(_u),this.use(Nu),this.use(Eu),this.use(xu),this.use(bu);var R=new Proxy(this,{get:function(E,F,I){if(F==="_vip")return!0;if(F==="table")return function(B){return Xr(c.table(B),R)};var D=Reflect.get(E,F,I);return D instanceof cs?Xr(D,R):F==="tables"?D.map(function(B){return Xr(B,R)}):F==="_createTransaction"?function(){return Xr(D.apply(this,arguments),R)}:D}});this.vip=R,f.forEach(function(E){return E(c)})}var Gr,xt=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Cu=(ai.prototype.subscribe=function(n,i,c){return this._subscribe(n&&typeof n!="function"?n:{next:n,error:i,complete:c})},ai.prototype[xt]=function(){return this},ai);function ai(n){this._subscribe=n}try{Gr={indexedDB:a.indexedDB||a.mozIndexedDB||a.webkitIndexedDB||a.msIndexedDB,IDBKeyRange:a.IDBKeyRange||a.webkitIDBKeyRange}}catch{Gr={indexedDB:null,IDBKeyRange:null}}function As(n){var i,c=!1,f=new Cu(function(h){var y=ie(n),x,_=!1,A={},M={},R={get closed(){return _},unsubscribe:function(){_||(_=!0,x&&x.abort(),E&&sn.storagemutated.unsubscribe(I))}};h.start&&h.start(R);var E=!1,F=function(){return Qn(D)},I=function(B){Vr(A,B),Jo(M,A)&&F()},D=function(){var B,P,H;!_&&Gr.indexedDB&&(A={},B={},x&&x.abort(),x=new AbortController,H=function(W){var V=en();try{y&&nn();var te=$t(n,W);return te=y?te.finally(St):te}finally{V&&tn()}}(P={subscr:B,signal:x.signal,requery:F,querier:n,trans:null}),Promise.resolve(H).then(function(W){c=!0,i=W,_||P.signal.aborted||(A={},function(V){for(var te in V)if(v(V,te))return;return 1}(M=B)||E||(sn(ir,I),E=!0),Qn(function(){return!_&&h.next&&h.next(W)}))},function(W){c=!1,["DatabaseClosedError","AbortError"].includes(W==null?void 0:W.name)||_||Qn(function(){_||h.error&&h.error(W)})}))};return setTimeout(F,0),R});return f.hasValue=function(){return c},f.getValue=function(){return i},f}var yn=Ut;function ci(n){var i=an;try{an=!0,sn.storagemutated.fire(n),ni(n,!0)}finally{an=i}}w(yn,o(o({},He),{delete:function(n){return new yn(n,{addons:[]}).delete()},exists:function(n){return new yn(n,{addons:[]}).open().then(function(i){return i.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(n){try{return i=yn.dependencies,c=i.indexedDB,i=i.IDBKeyRange,(Go(c)?Promise.resolve(c.databases()).then(function(f){return f.map(function(h){return h.name}).filter(function(h){return h!==Pn})}):Xo(c,i).toCollection().primaryKeys()).then(n)}catch{return Ke(new de.MissingAPI)}var i,c},defineClass:function(){return function(n){d(this,n)}},ignoreTransaction:function(n){return xe.trans?Vt(xe.transless,n):n()},vip:Zo,async:function(n){return function(){try{var i=ri(n.apply(this,arguments));return i&&typeof i.then=="function"?i:me.resolve(i)}catch(c){return Ke(c)}}},spawn:function(n,i,c){try{var f=ri(n.apply(c,i||[]));return f&&typeof f.then=="function"?f:me.resolve(f)}catch(h){return Ke(h)}},currentTransaction:{get:function(){return xe.trans||null}},waitFor:function(n,i){return i=me.resolve(typeof n=="function"?yn.ignoreTransaction(n):n).timeout(i||6e4),xe.trans?xe.trans.waitFor(i):i},Promise:me,debug:{get:function(){return tt},set:function(n){qt(n)}},derive:S,extend:d,props:w,override:z,Events:tr,on:sn,liveQuery:As,extendObservabilitySet:Vr,getByKeyPath:Q,setByKeyPath:Y,delByKeyPath:function(n,i){typeof i=="string"?Y(n,i,void 0):"length"in i&&[].map.call(i,function(c){Y(n,c,void 0)})},shallowClone:ee,deepClone:se,getObjectDiff:oi,cmp:Te,asap:U,minKey:-1/0,addons:[],connections:rn,errnames:Ae,dependencies:Gr,cache:mn,semVer:"4.0.10",version:"4.0.10".split(".").map(function(n){return parseInt(n)}).reduce(function(n,i,c){return n+i/Math.pow(10,2*c)})})),yn.maxKey=sr(yn.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(sn(ir,function(n){an||(n=new CustomEvent(Ko,{detail:n}),an=!0,dispatchEvent(n),an=!1)}),addEventListener(Ko,function(n){n=n.detail,an||ci(n)}));var On,an=!1,Ts=function(){};return typeof BroadcastChannel<"u"&&((Ts=function(){(On=new BroadcastChannel(Ko)).onmessage=function(n){return n.data&&ci(n.data)}})(),typeof On.unref=="function"&&On.unref(),sn(ir,function(n){an||On.postMessage(n)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(n){if(!Ut.disableBfCache&&n.persisted){tt&&console.debug("Dexie: handling persisted pagehide"),On!=null&&On.close();for(var i=0,c=rn;i<c.length;i++)c[i].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(n){!Ut.disableBfCache&&n.persisted&&(tt&&console.debug("Dexie: handling persisted pageshow"),Ts(),ci({all:new ot(-1/0,[[]])}))})),me.rejectionMapper=function(n,i){return!n||n instanceof ve||n instanceof TypeError||n instanceof SyntaxError||!n.name||!De[n.name]?n:(i=new De[n.name](i||n.message,n),"stack"in n&&k(i,"stack",{get:function(){return this.inner.stack}}),i)},qt(tt),o(Ut,Object.freeze({__proto__:null,Dexie:Ut,liveQuery:As,Entity:$r,cmp:Te,PropModSymbol:Yt,PropModification:rr,replacePrefix:function(n,i){return new rr({replacePrefix:[n,i]})},add:function(n){return new rr({add:n})},remove:function(n){return new rr({remove:n})},default:Ut,RangeSet:ot,mergeRanges:ur,rangesOverlap:vs}),{default:Ut}),Ut})})(ru);var iy=ru.exports;const ji=ka(iy),ba=Symbol.for("Dexie"),Bi=globalThis[ba]||(globalThis[ba]=ji);if(ji.semVer!==Bi.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${ji.semVer} and ${Bi.semVer}`);class sy extends Bi{constructor(){super("TemporalDB"),this.version(2).stores({workflows:"workflowId, parentWorkflowId",activities:"[activityId+workflowId], workflowId",settings:"id"})}}const Ht=new sy;async function Fi(e){try{await Ht.workflows.put(e),console.debug("Workflow added successfully:",e)}catch(t){console.error("Failed to add workflow:",t,e)}}async function Tr(e){try{const t=await Ht.workflows.get(e);return console.debug("Retrieved Workflow:",t),t}catch(t){console.error("Failed to retrieve workflow:",t);return}}async function ay(e){try{await Ht.workflows.delete(e),console.debug(`Deleted Workflow with ID: ${e}`)}catch(t){console.error("Failed to delete workflow:",t)}}async function ou(e){try{await Ht.activities.put(e),console.debug("Activity added successfully:",e)}catch(t){console.error("Failed to add activity:",t,e)}}async function cy(e){try{const t=await Ht.activities.get(e);return console.debug("Retrieved Activity:",t),t}catch(t){console.error("Failed to retrieve activity:",t);return}}async function uy(e){try{await Ht.activities.delete(e),console.debug(`Deleted Activity with ID: ${e}`)}catch(t){console.error("Failed to delete activity:",t)}}async function iu(e){try{return await Ht.activities.where("workflowId").equals(e).toArray()}catch(t){return console.error("Failed to retrieve activities by workflowId:",t),[]}}async function is(e){try{return await Ht.workflows.where("parentWorkflowId").equals(e).toArray()}catch(t){return console.error("Failed to retrieve child workflows:",t),[]}}async function ly(e){if(!e)return[];const t=[];for(const r of e)if(r.type==="workflow"||r.type==="childWorkflow"){const o=await Tr(r.id);o&&t.push(o)}else if(r.type==="activity"){const o=await cy(r.id);o&&t.push(o)}return t}async function fy(e){try{const t=await Ht.settings.get(e);return t==null?void 0:t.value}catch(t){console.error("Failed to retrieve setting:",t);return}}async function dy(e,t){try{await Ht.settings.put({id:e,value:t}),console.debug(`Setting ${e} updated successfully:`,t)}catch(r){console.error("Failed to update setting:",r)}}const un={name:"default-queue",kind:"TASK_QUEUE_KIND_NORMAL"},hy=()=>{const e="demo-order-processing-wf-001",t=new Date().toISOString(),r=new Date(Date.parse(t)+6e4).toISOString(),o=new Date(Date.parse(t)+12e4).toISOString(),s=new Date(Date.parse(t)+18e4).toISOString(),a="1",u="2",l="3",d={orderId:"ORD-001",customer:{id:"CUST-123",name:"John Doe",email:"john.doe@example.com"},items:[{id:"ITEM-1",name:"Gaming Laptop",price:1299.99,quantity:1},{id:"ITEM-2",name:"Wireless Mouse",price:49.99,quantity:2}],totalAmount:1399.97,shippingAddress:{street:"123 Tech Lane",city:"San Francisco",state:"CA",zipCode:"94105"}},p=[{type:"workflow",workflowId:e,workflowType:"OrderProcessingWorkflow",status:"RUNNING",startTime:t,endTime:void 0,taskQueue:un,input:JSON.stringify(d),workflowTaskCompletedEventId:a,memo:{description:"Process customer order with validation and fulfillment",priority:"HIGH"}},{type:"childWorkflow",workflowId:"demo-fulfillment-wf-001",workflowType:"OrderFulfillmentWorkflow",parentWorkflowId:e,status:"RUNNING",startTime:t,endTime:void 0,taskQueue:un,workflowTaskCompletedEventId:u,input:JSON.stringify({orderId:d.orderId,items:d.items,shippingAddress:d.shippingAddress,warehouseId:"WH-SF-001"})},...Array(5).fill(null).map((v,w)=>({type:"childWorkflow",workflowId:`demo-shipping-wf-00${w+1}`,workflowType:"ShippingWorkflow",parentWorkflowId:"demo-fulfillment-wf-001",status:"RUNNING",startTime:t,endTime:void 0,taskQueue:un,workflowTaskCompletedEventId:l,input:JSON.stringify({packageId:`PKG-00${w+1}`,orderId:d.orderId,item:d.items[w%2],shippingAddress:d.shippingAddress,carrier:"FastShip",trackingPrefix:"FS"})}))],m=[{type:"activity",activityId:"validate-order-001",activityType:"ValidateOrderActivity",workflowId:e,status:"COMPLETED",startTime:t,endTime:r,taskQueue:un,input:JSON.stringify({orderId:d.orderId,customerId:d.customer.id,items:d.items,totalAmount:d.totalAmount}),result:JSON.stringify({isValid:!0,validatedAt:t,checks:{inventory:!0,pricing:!0,customerStatus:"ACTIVE",fraudCheck:{passed:!0,score:.95,reasons:["Valid customer history","Normal order pattern"]}}}),workflowTaskCompletedEventId:a},{type:"activity",activityId:"process-payment-001",activityType:"ProcessPaymentActivity",workflowId:e,status:"COMPLETED",startTime:r,endTime:o,taskQueue:un,input:JSON.stringify({orderId:d.orderId,amount:d.totalAmount,customerId:d.customer.id,paymentMethod:{type:"CREDIT_CARD",last4:"4242",brand:"Visa",expiryMonth:12,expiryYear:2025}}),result:JSON.stringify({transactionId:"TX-789012",status:"APPROVED",processedAt:r,paymentDetails:{authorizationCode:"AUTH123",avsResult:"Y",cvvResult:"M",processorResponse:"Approved"}}),workflowTaskCompletedEventId:a},{type:"activity",activityId:"inventory-check-001",activityType:"CheckInventoryActivity",workflowId:"demo-fulfillment-wf-001",status:"COMPLETED",startTime:o,endTime:s,taskQueue:un,input:JSON.stringify({warehouseId:"WH-SF-001",items:d.items,reservationDuration:"30m"}),result:JSON.stringify({available:!0,itemsAvailability:d.items.map(v=>({itemId:v.id,available:!0,quantity:v.quantity,location:"Zone-A12",binNumber:"BIN-456",reservationId:`RES-${v.id}`,expiresAt:new Date(Date.parse(s)+18e5).toISOString()}))}),workflowTaskCompletedEventId:u},{type:"activity",activityId:"prepare-shipment-001",activityType:"PrepareShipmentActivity",workflowId:"demo-fulfillment-wf-001",status:"FAILED",startTime:s,endTime:new Date(Date.parse(s)+3e4).toISOString(),taskQueue:un,input:JSON.stringify({orderId:d.orderId,items:d.items,warehouseId:"WH-SF-001",packagingType:"STANDARD",packagingRequirements:{type:"BOX_MEDIUM",reinforced:!0,materials:["bubble_wrap","foam_padding"]}}),result:JSON.stringify({error:"PACKAGING_MATERIAL_UNAVAILABLE",message:"Required packaging material out of stock",details:{missingMaterials:["foam_padding"],availableAlternatives:["air_pillows"],nextRestockScheduled:new Date(Date.parse(t)+864e5).toISOString()},timestamp:s,errorCode:"PKG_001",severity:"MEDIUM"}),workflowTaskCompletedEventId:u},...Array(5).fill(null).map((v,w)=>({type:"activity",activityId:`process-shipping-00${w+1}`,activityType:"ProcessShippingActivity",workflowId:`demo-shipping-wf-00${w+1}`,status:"RUNNING",startTime:new Date(Date.parse(s)+w*1e4).toISOString(),endTime:void 0,taskQueue:un,input:JSON.stringify({packageId:`PKG-00${w+1}`,orderId:d.orderId,carrier:"FastShip",service:"NEXT_DAY",dimensions:{length:15,width:10,height:5,weight:2.5,unit:"IMPERIAL"},shippingAddress:d.shippingAddress,item:d.items[w%2],specialInstructions:"Handle with care",insurance:{required:!0,value:d.items[w%2].price}}),workflowTaskCompletedEventId:l}))];return{workflows:p,activities:m}},py=async()=>{const e="demo-order-processing-wf-001";try{const{workflows:t,activities:r}=hy();for(const o of t)await Fi(o);for(const o of r)await ou(o);return console.log("Demo data stored successfully"),e}catch(t){return console.error("Error storing demo data:",t),""}},my=({showFocus:e,setShowFocus:t,autoZoomEnabled:r,setAutoZoomEnabled:o,setIsTemporalModalOpen:s,refreshWorkflowData:a,isRefreshing:u=!1,currentWorkflowId:l,onTemporalRootWorkflowDataCollected:d})=>{$.useEffect(()=>{(async()=>{const g=await fy("autoZoomEnabled");g!==void 0&&o(g)})()},[o]);const p=async()=>{const w=!r;o(w),await dy("autoZoomEnabled",w)},m=()=>{if(console.log("Refreshing root workflow",l),!a){console.log("No refresh function provided");return}if(!l){console.log("No workflow ID provided");return}a(l)},v=async()=>{const w=await py();w&&await d(w)};return N.jsxs("div",{className:"flex gap-2 items-center",children:[N.jsx("button",{onClick:m,className:"p-2",title:"Refresh workflow data from Temporal",children:N.jsx(Jm,{className:"h-4 w-4"})}),N.jsx("button",{className:"px-3 py-1 rounded bg-green-500 text-white hover:bg-green-600",onClick:()=>s(!0),children:"Temporal"}),N.jsxs("button",{className:`px-3 py-1 rounded ${r?"bg-green-500 text-white":"bg-gray-200 text-gray-700"}`,onClick:p,children:["Auto Zoom ",r?"On":"Off"]}),N.jsxs("button",{className:"px-3 py-1 rounded bg-gray-200 text-gray-700 hover:bg-gray-300",onClick:()=>t(!e),children:[e?"Hide":"Show"," Focus"]}),N.jsx("button",{className:"px-3 py-1 rounded bg-gray-200 text-gray-700 hover:bg-gray-300",onClick:v,children:"Demo"})]})};function yy({data:e,onClose:t}){const r=$.useRef(null),[o,s]=$.useState(300),[a,u]=$.useState(!1),l=$.useRef(0),d=$.useRef(0);$.useEffect(()=>{const g=r.current;g&&(g.style.display="none",g.scrollTop=0,g.offsetHeight,g.style.display="")},[e]);const p=g=>{u(!0),l.current=g.clientY,d.current=o,document.body.style.userSelect="none",g.preventDefault()};if($.useEffect(()=>{const g=S=>{if(!a)return;const O=l.current-S.clientY,T=Math.min(Math.max(d.current+O,300),window.innerHeight*.5);requestAnimationFrame(()=>{s(T)})},k=()=>{u(!1),document.body.style.userSelect=""};return a&&(window.addEventListener("mousemove",g),window.addEventListener("mouseup",k)),()=>{window.removeEventListener("mousemove",g),window.removeEventListener("mouseup",k)}},[a]),!e)return null;const m=(g,k)=>k?N.jsxs("div",{children:[N.jsx("h4",{className:"font-medium text-gray-700",children:g}),N.jsx("p",{className:"text-gray-600",children:k})]}):null,v=(g,k)=>{if(!g||!k)return null;const S=new Date(g),T=new Date(k).getTime()-S.getTime(),K=Math.floor(T/1e3),z=Math.floor(K/60),C=Math.floor(z/60),U=[];return C>0&&U.push(`${C}h`),z%60>0&&U.push(`${z%60}m`),K%60>0&&U.push(`${K%60}s`),T%1e3>0&&U.push(`${T%1e3}ms`),U.join(" ")},w=g=>{var k;return g?N.jsxs("div",{children:[N.jsx("h4",{className:"font-medium text-gray-700",children:"Retry Policy"}),N.jsxs("div",{className:"pl-4 space-y-2",children:[N.jsxs("p",{className:"text-gray-600",children:["Initial Interval: ",g.initialInterval]}),N.jsxs("p",{className:"text-gray-600",children:["Backoff Coefficient: ",g.backoffCoefficient]}),N.jsxs("p",{className:"text-gray-600",children:["Maximum Interval: ",g.maximumInterval]}),N.jsxs("p",{className:"text-gray-600",children:["Maximum Attempts: ",g.maximumAttempts]}),((k=g.nonRetryableErrorTypes)==null?void 0:k.length)>0&&N.jsxs("div",{children:[N.jsx("p",{className:"text-gray-600",children:"Non-retryable Error Types:"}),N.jsx("ul",{className:"list-disc pl-4",children:g.nonRetryableErrorTypes.map((S,O)=>N.jsx("li",{className:"text-gray-600",children:S},O))})]})]})]}):null};return N.jsxs("div",{ref:r,className:"fixed bottom-0 left-0 right-0 bg-white shadow-lg overflow-y-auto scroll-top",style:{height:`${o}px`,scrollBehavior:"instant",transition:a?"none":"height 0.1s ease-out"},children:[N.jsx("div",{className:`absolute -top-2 left-0 right-0 h-4 cursor-ns-resize ${a?"bg-blue-100":"hover:bg-gray-100"} z-50`,onMouseDown:p}),N.jsxs("div",{className:"border-t-2 border-black p-4 bg-gray-50 flex justify-between items-center sticky top-0 z-10",children:[N.jsxs("div",{className:"flex flex-col",children:[N.jsx("h3",{className:"font-semibold text-gray-800",children:"Node Details"}),(e.type==="workflow"||e.type==="childWorkflow")&&e.namespace&&e.workflowId&&e.runId&&N.jsx("a",{href:`https://cloud.temporal.io/namespaces/${e.namespace}/workflows/${e.workflowId}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 text-sm",children:"View in Temporal"})]}),N.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-200 rounded-full transition-colors",children:N.jsx(Do,{className:"w-5 h-5 text-gray-600"})})]}),N.jsx("div",{className:"p-4 overflow-y-auto",style:{height:"calc(100% - 57px)"},children:N.jsxs("div",{className:"space-y-4",children:[N.jsxs("div",{children:[N.jsx("h4",{className:"font-medium text-gray-700",children:"Title"}),N.jsx("p",{className:"text-gray-600",children:e.title})]}),N.jsxs("div",{children:[N.jsx("h4",{className:"font-medium text-gray-700",children:"Type"}),N.jsx("p",{className:"text-gray-600",children:e.type})]}),e.type==="activity"?N.jsxs("div",{children:[N.jsx("h4",{className:"font-medium text-gray-700",children:"Activity ID"}),N.jsx("p",{className:"text-gray-600",children:e.activityId}),e.activityType&&N.jsxs("div",{children:[N.jsx("h4",{className:"font-medium text-gray-700",children:"Activity Type"}),N.jsx("p",{className:"text-gray-600",children:e.activityType})]})]}):N.jsxs("div",{children:[N.jsx("h4",{className:"font-medium text-gray-700",children:"Workflow ID"}),N.jsx("p",{className:"text-gray-600",children:e.workflowId}),e.workflowType&&N.jsxs("div",{children:[N.jsx("h4",{className:"font-medium text-gray-700",children:"Workflow Type"}),N.jsx("p",{className:"text-gray-600",children:e.workflowType})]})]}),m("Schedule Time",e.scheduleTime),m("Start Time",e.startTime),m("End Time",e.endTime),e.startTime&&e.endTime&&m("Duration",v(e.startTime,e.endTime)),e.status&&N.jsxs("div",{children:[N.jsx("h4",{className:"font-medium text-gray-700",children:"Status"}),N.jsx("p",{className:"text-gray-600",children:e.status})]}),e.taskQueue&&N.jsxs("div",{children:[N.jsx("h4",{className:"font-medium text-gray-700",children:"Task Queue"}),N.jsxs("p",{className:"text-gray-600",children:["Name: ",e.taskQueue.name]}),N.jsxs("p",{className:"text-gray-600",children:["Kind: ",e.taskQueue.kind]})]}),e.input&&N.jsxs("div",{children:[N.jsx("h4",{className:"font-medium text-gray-700",children:"Input"}),N.jsx("pre",{className:"text-xs text-gray-600 whitespace-pre-wrap bg-gray-50 p-2 rounded",children:JSON.stringify(JSON.parse(e.input),null,2)})]}),e.result&&N.jsxs("div",{children:[N.jsx("h4",{className:"font-medium text-gray-700",children:"Result"}),N.jsx("pre",{className:"text-xs text-gray-600 whitespace-pre-wrap bg-gray-50 p-2 rounded",children:JSON.stringify(JSON.parse(e.result),null,2)})]}),e.header&&Object.keys(e.header).length>0&&N.jsxs("div",{children:[N.jsx("h4",{className:"font-medium text-gray-700",children:"Headers"}),N.jsx("pre",{className:"text-xs text-gray-600 whitespace-pre-wrap bg-gray-50 p-2 rounded",children:JSON.stringify(e.header,null,2)})]}),w(e.retryPolicy),e.heartbeatTimeout&&N.jsxs("div",{children:[N.jsx("h4",{className:"font-medium text-gray-700",children:"Timeouts"}),N.jsxs("div",{className:"pl-4 space-y-2",children:[N.jsxs("p",{className:"text-gray-600",children:["Heartbeat: ",e.heartbeatTimeout]}),e.scheduleToCloseTimeout&&N.jsxs("p",{className:"text-gray-600",children:["Schedule to Close: ",e.scheduleToCloseTimeout]}),e.scheduleToStartTimeout&&N.jsxs("p",{className:"text-gray-600",children:["Schedule to Start: ",e.scheduleToStartTimeout]}),e.startToCloseTimeout&&N.jsxs("p",{className:"text-gray-600",children:["Start to Close: ",e.startToCloseTimeout]})]})]}),e.type==="workflow"&&N.jsxs(N.Fragment,{children:[e.namespace&&N.jsxs("div",{children:[N.jsx("h4",{className:"font-medium text-gray-700",children:"Namespace"}),N.jsx("p",{className:"text-gray-600",children:e.namespace})]}),e.memo&&Object.keys(e.memo).length>0&&N.jsxs("div",{children:[N.jsx("h4",{className:"font-medium text-gray-700",children:"Memo"}),N.jsx("pre",{className:"text-xs text-gray-600 whitespace-pre-wrap bg-gray-50 p-2 rounded",children:JSON.stringify(e.memo,null,2)})]}),e.searchAttributes&&Object.keys(e.searchAttributes).length>0&&N.jsxs("div",{children:[N.jsx("h4",{className:"font-medium text-gray-700",children:"Search Attributes"}),N.jsx("pre",{className:"text-xs text-gray-600 whitespace-pre-wrap bg-gray-50 p-2 rounded",children:JSON.stringify(e.searchAttributes,null,2)})]})]}),e.workflowTaskCompletedEventId&&N.jsxs("div",{children:[N.jsx("h4",{className:"font-medium text-gray-700",children:"Workflow Task Completed Event ID"}),N.jsx("p",{className:"text-gray-600",children:e.workflowTaskCompletedEventId})]}),e.attempts!==void 0&&N.jsxs("div",{children:[N.jsx("h4",{className:"font-medium text-gray-700",children:"Attempts"}),N.jsx("p",{className:"text-gray-600",children:e.attempts})]}),e.payload&&e.payload.length>0&&N.jsxs("div",{children:[N.jsx("h4",{className:"font-medium text-gray-700",children:"Payloads"}),N.jsx("div",{className:"space-y-2 mt-1",children:e.payload.map((g,k)=>N.jsx("div",{className:"bg-gray-50 p-2 rounded",children:N.jsx("pre",{className:"text-xs text-gray-600 whitespace-pre-wrap",children:g?JSON.stringify(JSON.parse(g),null,2):"No payload data"})},k))})]}),e.type==="activity"&&N.jsxs(N.Fragment,{children:[e.lastStartedTime&&N.jsxs("div",{children:[N.jsx("h4",{className:"font-medium text-gray-700",children:"Last Started Time"}),N.jsx("p",{className:"text-gray-600",children:e.lastStartedTime})]}),e.lastAttemptCompleteTime&&N.jsxs("div",{children:[N.jsx("h4",{className:"font-medium text-gray-700",children:"Last Attempt Complete Time"}),N.jsx("p",{className:"text-gray-600",children:e.lastAttemptCompleteTime})]}),e.lastWorkerIdentity&&N.jsxs("div",{children:[N.jsx("h4",{className:"font-medium text-gray-700",children:"Last Worker Identity"}),N.jsx("p",{className:"text-gray-600",children:e.lastWorkerIdentity})]}),e.lastFailureMessage&&N.jsxs("div",{children:[N.jsx("h4",{className:"font-medium text-gray-700",children:"Last Failure Message"}),N.jsx("p",{className:"text-gray-600",children:e.lastFailureMessage})]}),e.lastFailureStackTrace&&N.jsxs("div",{children:[N.jsx("h4",{className:"font-medium text-gray-700",children:"Last Failure Stack Trace"}),N.jsx("pre",{className:"text-xs text-gray-600 whitespace-pre-wrap bg-gray-50 p-2 rounded",children:e.lastFailureStackTrace})]}),e.lastFailureCause&&N.jsxs("div",{children:[N.jsx("h4",{className:"font-medium text-gray-700",children:"Last Failure Cause"}),N.jsx("p",{className:"text-gray-600",children:e.lastFailureCause})]}),e.lastFailureServerFailureInfo&&N.jsxs("div",{children:[N.jsx("h4",{className:"font-medium text-gray-700",children:"Last Failure Server Info"}),N.jsx("pre",{className:"text-xs text-gray-600 whitespace-pre-wrap bg-gray-50 p-2 rounded",children:JSON.stringify(e.lastFailureServerFailureInfo,null,2)})]}),e.lastFailureType&&N.jsxs("div",{children:[N.jsx("h4",{className:"font-medium text-gray-700",children:"Last Failure Type"}),N.jsx("p",{className:"text-gray-600",children:e.lastFailureType})]})]})]})},`${e.id}-${Date.now()}`)]})}const ao=500,zi=200,_a=8,gy=80;function Li(e){var l,d,p;const t=((l=e.data)==null?void 0:l.title)||"",r=e.id||"",o=r.length>40?r.slice(0,37)+"...":r,s=t.length*_a,a=o.length*(_a*.8),u=Math.max(s,a)+gy;return((d=e.data)==null?void 0:d.type)==="workflow"||((p=e.data)==null?void 0:p.type)==="childWorkflow",Math.max(Math.min(Math.max(u,ao*.75),ao),zi)}function vy(e,t=800,r=100){const o=Li(e),s=(t-o)/2-r;return e.position={x:s,y:0},e.style={...e.style,width:o},e}function Ea(e,t,r,o,s=200,a=40){var v,w;const u=[...e],l=[...t],d=u.find(g=>g.id===r);if(!d)return console.warn(`Parent node ${r} not found for layout.`),{nodes:u,edges:l};(v=d.style)!=null&&v.width||(d.style={...d.style,width:Li(d)});const p=d.position.x+(((w=d.style)==null?void 0:w.width)||zi);let m=d.position.y;return o.forEach((g,k)=>{const S=Li(g);if(g.style={...g.style,width:S},g.position={x:p+s,y:m},u.push(g),k===0)l.push({id:`${r}->${g.id}`,source:r,sourceHandle:`${r}-right`,target:g.id,targetHandle:`${g.id}-left`});else{const O=o[k-1];l.push({id:`${O.id}->${g.id}`,source:O.id,sourceHandle:`${O.id}-bottom`,target:g.id,targetHandle:`${g.id}-top`,type:"step",animated:!0})}m+=(g.height||80)+a}),{nodes:u,edges:l}}function wy(e,t,r,o,s=100){const a=[...e],u=[...t],l=e.find(w=>w.id===r);if(!l)return{nodes:a,edges:u};const d=o.map((w,g)=>{var k;return{...w,position:{x:l.position.x,y:l.position.y+(g+1)*s},style:{...w.style,width:(k=l.style)==null?void 0:k.width}}}),p=t.find(w=>w.source===r),m=p==null?void 0:p.target,v=d.map((w,g)=>({id:g===0?`${r}->${w.id}`:`${d[g-1].id}->${w.id}`,source:g===0?r:d[g-1].id,target:w.id,sourceHandle:g===0?`${r}-bottom`:`${d[g-1].id}-bottom`,targetHandle:`${w.id}-top`,type:"step",animated:!0}));if(m){const w=d[d.length-1];v.push({id:`${w.id}->${m}`,source:w.id,target:m,sourceHandle:`${w.id}-bottom`,targetHandle:`${m}-top`,type:"step",animated:!0});const g=u.findIndex(k=>k.id===p.id);g!==-1&&u.splice(g,1)}return a.push(...d),u.push(...v),{nodes:a,edges:u}}const xy=async e=>{var r,o;const t={nodes:[],edges:[]};for(const s of e)if(s.type==="activity")t.nodes.push({id:`${s.activityId}-${s.workflowId}`,position:{x:0,y:0},type:"workflowNode",data:{...s,title:s.activityType,description:"",type:"activity",parentNodeId:s.workflowId,payload:(r=s.payload)==null?void 0:r.map(a=>a.data?atob(a.data):void 0)}});else if(s.type==="workflow"||s.type==="childWorkflow")t.nodes.push({id:s.workflowId,position:{x:0,y:0},type:"workflowNode",data:{...s,title:s.workflowType,description:"",type:s.type,parentNodeId:s.parentWorkflowId,payload:(o=s.payload)==null?void 0:o.map(a=>a.data?atob(a.data):void 0)}});else throw new Error("Invalid item type "+s.type);return by(t),t};function by(e){const t={};for(const o of e.nodes){const s=o.data,a=s.type;let u=_y(a,s);const l=s.title,d=`${u}::${l}`;t[d]||(t[d]={batchKey:u,title:l,nodes:[]}),t[d].nodes.push(o)}const r=[];for(const o in t){const s=t[o],{batchKey:a,title:u,nodes:l}=s,d=l.length;let p=null;for(const g of l){const k=g.data,S=k.startTime??k.scheduleTime;S&&(p===null||S<p)&&(p=S)}const m=l[0],v=m.data,w={...m,position:{...m.position},data:{count:d,batchKey:a,groupComponentIds:s.nodes.map(g=>({type:g.data.type,id:g.data.workflowId||g.data.activityId})),nonCompletedStatusExists:s.nodes.some(g=>g.data.status!=="COMPLETED"),...v}};w._earliestTime=p,r.push(w)}r.sort((o,s)=>{const a=o._earliestTime,u=s._earliestTime;return!a&&!u?0:a?u?a.localeCompare(u):-1:1});for(const o of r)delete o._earliestTime;e.nodes=r}function _y(e,t){if(e==="workflow"||e==="childWorkflow"){if(!t.workflowId)throw new Error("Workflow node missing workflowId");return t.workflowTaskCompletedEventId?parseInt(t.workflowTaskCompletedEventId,10).toString().padStart(10,"0"):`WF-${t.workflowId}`}else{if(!t.workflowTaskCompletedEventId)throw new Error("Activity node missing workflowTaskCompletedEventId");return parseInt(t.workflowTaskCompletedEventId,10).toString().padStart(10,"0")}}const Ey=()=>{const[e,t]=$.useState(!0),r=$.useRef(null),o=$.useRef(!0),s=$.useCallback((p,m,v,w=.75,g=800)=>{!p||!o.current||p.setCenter(m,v,{zoom:w,duration:g})},[]),a=$.useCallback(p=>{!p||!o.current||p.fitView({padding:.2,duration:800,minZoom:.4})},[]),u=$.useCallback(p=>{r.current=p},[]),l=$.useCallback(()=>{!r.current||!o.current||r.current.fitView({padding:.2,duration:800,minZoom:.4})},[]),d=$.useCallback(p=>{o.current=p,t(p)},[]);return{autoZoomEnabled:e,setAutoZoomEnabled:d,handleZoom:s,fitView:a,onInit:u,onGraphLoad:l}},ky=async(e,t)=>{const r=await fetch(`http://localhost:7531/workflow?namespace=${e}&id=${t}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return await r.json()},Sy=async()=>{try{return(await fetch("http://localhost:7531/health",{method:"GET"})).status===200}catch{return!1}},Ir=new Set,su=e=>{Ir.add(e),window.dispatchEvent(new CustomEvent("workflow-loading-change",{detail:{workflowId:e,isLoading:!0}}))},au=e=>{Ir.delete(e),window.dispatchEvent(new CustomEvent("workflow-loading-change",{detail:{workflowId:e,isLoading:!1}}))};function Ny(e){return Ir.has(e)}async function Ki(e,t,r=0){if(Ir.has(t))return;const o=[{id:t,depth:r}],s=new Set;for(;o.length>0;){const{id:a,depth:u}=o.shift();if(s.has(a))continue;const l=await Tr(a);if(l&&!l.isPlaceholder){s.add(a);continue}su(a);try{const d=await ky(e,a);s.add(a);const p=[];for(const m of d)m.type==="workflow"?await Fi({...m,isPlaceholder:!1}):m.type==="childWorkflow"?(p.push(m.workflowId),await Fi({...m,type:"workflow",isPlaceholder:!0})):m.type==="activity"&&await ou(m);u>0&&p.length>0&&p.forEach(m=>{o.push({id:m,depth:u-1})})}catch(d){console.error("Error processing workflow:",d)}finally{au(a)}}}async function Cy(e,t){try{su(t);const r=await is(t),o=[];for(const a of r){const u=a.workflowId;if(Ir.has(u))continue;const l=await Tr(u);l&&!l.isPlaceholder||o.push(a)}const s=o.map(async a=>{try{await Ki(e,a.workflowId,1)}catch(u){console.error("Error loading workflow:",u)}});await Promise.all(s)}catch(r){console.error("Error checking child workflow data:",r)}finally{au(t)}}function Ay(){const[e,t]=$.useState({nodes:[],edges:[],rootWorkflowId:void 0}),[r,o]=X.useState(!1),s=$.useRef(e),a=$.useRef(null),u=.4,{autoZoomEnabled:l,setAutoZoomEnabled:d,handleZoom:p,fitView:m,onInit:v,onGraphLoad:w}=Ey();$.useEffect(()=>{s.current=e},[e]);const g=async z=>{const C=await T(z),U=C.nodes.find(ne=>ne.id===z);if(!U){console.error(`Root node ${z} not found in graph data.`);return}const Q=C.nodes.filter(ne=>ne.id!==z);U.data.isExpanded=!0;const Y=vy(U),{nodes:ee,edges:G}=Ea([Y],[],z,Q,150,20);t({nodes:ee,edges:G,rootWorkflowId:z}),o(!0),setTimeout(w,100)},k=$.useCallback(async z=>{const{nodes:C,edges:U}=await O(z);return new Promise(Q=>{t(Y=>{const ee=Y.nodes.filter(oe=>!C.includes(oe.id)).map(oe=>oe.id===z?{...oe,data:{...oe.data,isExpanded:!1}}:oe),G=Y.edges.filter(oe=>!U.includes(oe.id)),ne={nodes:ee,edges:G};return s.current=ne,Q(ne),ne})})},[]),S=$.useCallback(async z=>{try{const C=s.current,U=C.nodes.find(ee=>ee.id===z);if(!U)return;const Q=C.nodes.filter(ee=>ee.data.parentNodeId===U.data.parentNodeId&&ee.id!==z&&!U.data.groupComponentIds.some(G=>G.id===ee.id)&&ee.data.isExpanded);for(const ee of Q)await k(ee.id);const Y=await T(z);t(ee=>{const G=Y.nodes.filter(J=>J.id!==z).map(J=>({...J,data:{...J.data,parentNodeId:z}})),ne=ee.nodes.map(J=>J.id===z?{...J,data:{...J.data,isExpanded:!0}}:J),{nodes:oe,edges:le}=Ea(ne,ee.edges,z,G),se=Y.edges.map(J=>({...J,id:`${J.id}-${Date.now()}`})),q={nodes:oe.map(J=>J.id===z?{...J,data:{...J.data,isLoading:!1}}:J),edges:[...le,...se]};s.current=q;const j=oe.find(J=>J.id===z),re=oe.filter(J=>J.data.parentNodeId===z);return j&&setTimeout(()=>{const J=re.reduce((Z,ie)=>Math.max(Z,ie.position.x),j.position.x),L=(j.position.x+J)/2;p(a.current,L,j.position.y)},50),q})}catch(C){console.error("Error expanding child workflow:",C)}},[p,k]),O=async z=>{const C=s.current.nodes.find(G=>G.id===z);if(!C)return console.error(`Root node ${z} not found in graph data.`),{nodes:[],edges:[]};const U=new Set,Q=new Set,Y=new Set,ee=G=>{Y.has(G)||(Y.add(G),G!==z&&U.add(G),s.current.edges.forEach(ne=>{var oe;if(ne.source===G){const le=s.current.nodes.find(se=>se.id===ne.target);if(!le){console.error(`Target node ${ne.target} not found in graph data.`);return}(le.data.parentNodeId===z&&!((oe=C.data.groupComponentIds)!=null&&oe.some(se=>se.id===le.id))||U.has(le.data.parentNodeId))&&(Q.add(ne.id),ee(ne.target))}}))};return ee(z),{nodes:Array.from(U),edges:Array.from(Q)}},T=async z=>{const C=await Tr(z);if(!C)return console.error(`Workflow ${z} not found`),{nodes:[],edges:[]};const U=await iu(z),Q=await is(z),Y=[C,...U,...Q],ee=await xy(Y),G=Q.map(async ne=>{try{await Cy(ne.namespace,ne.workflowId)}catch(oe){console.error(`Error loading child workflow data for ${ne.workflowId}:`,oe)}});return ee.nodes=ee.nodes.map(ne=>({...ne,data:{...ne.data,isLoading:Ny(ne.id)}})),Promise.all(G).catch(ne=>console.error("Error loading child workflows:",ne)),ee},K=$.useCallback(async z=>{try{const C=s.current.nodes.find(Y=>Y.id===z);if(!C||!C.data.count)return;const Q=(await ly(C.data.groupComponentIds)).map(Y=>({id:Y.workflowId||`${z}-batch-${Y.id}`,type:"workflowNode",data:{...Y,parentNodeId:z,parentWorkflowId:C.data.parentWorkflowId,type:C.data.type,title:Y.title||Y.workflowType,workflowId:Y.workflowId,runId:Y.runId,count:1,groupComponentIds:[]},position:{x:0,y:0}}));t(Y=>{const ee=new Set,G=q=>{Y.edges.forEach(j=>{j.source===q&&(ee.add(j.target),G(j.target))})};G(z);const ne=Q.length*100;C.data.count=1;const{nodes:oe,edges:le}=wy(Y.nodes,Y.edges,z,Q),b={nodes:oe.map(q=>ee.has(q.id)?{...q,position:{...q.position,y:q.position.y+ne+100}}:q),edges:le};return s.current=b,setTimeout(()=>{p(a.current,C.position.x,C.position.y)},100),b})}catch(C){console.error("Error spreading batch nodes:",C)}},[p]);return $.useEffect(()=>{const z=({detail:{workflowId:C,isLoading:U}})=>{t(Q=>{const Y=Q.nodes.map(ee=>ee.id===C?{...ee,data:{...ee.data,isLoading:U}}:ee);return{...Q,nodes:Y}})};return window.addEventListener("workflow-loading-change",z),()=>window.removeEventListener("workflow-loading-change",z)},[]),{graphData:e,setGraphData:t,onTemporalRootWorkflowDataCollected:g,expandChildWorkflowNode:S,collapseChildWorkflowNode:k,isRootLoaded:r,flowInstance:a,MIN_ZOOM:u,onSpreadBatchNodes:K,autoZoomEnabled:l,setAutoZoomEnabled:d,onInit:v}}const Ty=(e,t)=>{const r=new Set,o=s=>{r.add(s),e.edges.forEach(a=>{a.source===s&&!r.has(a.target)&&o(a.target)})};return t.forEach(o),Array.from(r)};function Iy(e,t){const[r,o]=$.useState(!1),[s,a]=$.useState(null),u=$.useRef(null),l=.4,d=$.useCallback(w=>new Set(Ty(e,[w])),[e]),p=$.useCallback(w=>{if(!u.current||!w)return;const g=e.nodes.filter(ee=>ee.position.x>=w.position.x);if(g.length===0){u.current.setCenter(w.position.x,w.position.y,{zoom:1,duration:800});return}const k=g.reduce((ee,G)=>({minX:Math.min(ee.minX,G.position.x||0),minY:Math.min(ee.minY,G.position.y||0),maxX:Math.max(ee.maxX,G.position.x||0),maxY:Math.max(ee.maxY,G.position.y||0)}),{minX:w.position.x||0,minY:w.position.y||0,maxX:w.position.x||0,maxY:w.position.y||0});if(Object.values(k).some(isNaN)){console.warn("Invalid bounds detected, falling back to selected node"),u.current.setCenter(w.position.x,w.position.y,{zoom:1,duration:800});return}const S=(k.minX+k.maxX)/2,O=(k.minY+k.maxY)/2,T=100,K=Math.max(k.maxX-k.minX+T*2,100),z=Math.max(k.maxY-k.minY+T*2,100),C=u.current.getViewport(),U=C.width||1e3,Q=C.height||800;let Y=Math.min(U/K,Q/z);Y=Math.max(l,Math.min(isNaN(Y)?1:Y,1.5)),u.current.setCenter(isNaN(S)?w.position.x:S,isNaN(O)?w.position.y:O,{zoom:Y,duration:800})},[e.nodes]),m=$.useCallback(w=>{if(a(w),!w){t(S=>({...S,nodes:S.nodes.map(O=>({...O,style:{...O.style,opacity:1}}))})),u.current&&u.current.fitView({padding:.2,minZoom:l,duration:800});return}const g=d(w),k=e.nodes.find(S=>S.id===w);t(S=>({...S,nodes:S.nodes.map(O=>({...O,style:{...O.style,opacity:g.has(O.id)?1:.2}}))})),u.current&&k&&setTimeout(()=>{p(k)},50)},[e,t,d,p]),v=$.useCallback(()=>{a(null),t(w=>({...w,nodes:w.nodes.map(g=>({...g,style:{...g.style,opacity:1}}))})),u.current&&u.current.fitView({padding:.2,minZoom:l,duration:800})},[t]);return{showFocus:r,setShowFocus:o,selectedFocusedWorkflow:s,handleFocusChange:m,handleFocusReset:v,flowInstance:u}}function My({onTemporalRootWorkflowDataCollected:e}){const[t,r]=$.useState(!1),[o,s]=$.useState(!1),a=async d=>{const p=await is(d);for(const v of p)await a(v.workflowId);const m=await iu(d);for(const v of m)await uy(v.activityId);await ay(d)};return{isTemporalModalOpen:t,setIsTemporalModalOpen:r,onTemporalModalSubmit:async d=>{if(!await Sy())throw new Error("The server is not running. Please start the server and try again.");await Ki(d.namespace,d.workflowId,2),r(!1),await e(d.workflowId)},refreshWorkflowData:async d=>{try{s(!0);const p=await Tr(d);if(!p){console.error("Workflow not found for refresh");return}await a(d),await Ki(p.namespace,d,2),await e(d)}catch(p){console.error("Error refreshing workflow data:",p)}finally{s(!1)}},isRefreshing:o}}function Py({isOpen:e,onClose:t,onSubmit:r}){const[o,s]=$.useState({namespace:"",workflowId:""}),[a,u]=$.useState(!1),[l,d]=$.useState(null);if(!e)return null;const p=async m=>{m.preventDefault(),u(!0),d(null);try{await r(o),t()}catch(v){d(v instanceof Error?v.message:"An error occurred while fetching workflow data")}finally{u(!1)}};return N.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:N.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[N.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[N.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Temporal Workflow Data"}),N.jsx("button",{onClick:t,className:"p-1 hover:bg-gray-100 rounded-full transition-colors",children:N.jsx(Do,{className:"w-5 h-5 text-gray-500"})})]}),N.jsxs("form",{onSubmit:p,className:"p-4 space-y-4",children:[l&&N.jsx("div",{className:"p-3 bg-red-100 text-red-700 rounded-md text-sm",children:l}),N.jsxs("div",{children:[N.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Namespace"}),N.jsx("input",{type:"text",value:o.namespace,onChange:m=>s(v=>({...v,namespace:m.target.value})),className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,disabled:a})]}),N.jsxs("div",{children:[N.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Workflow ID"}),N.jsx("input",{type:"text",value:o.workflowId,onChange:m=>s(v=>({...v,workflowId:m.target.value})),className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,disabled:a})]}),N.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t mt-4",children:[N.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",disabled:a,children:"Cancel"}),N.jsx("button",{type:"submit",className:"px-4 py-2 text-white bg-blue-500 rounded-md hover:bg-blue-600 transition-colors disabled:bg-blue-300",disabled:a,children:a?"Loading...":"Get Data"})]})]})]})})}function Dy(){const{graphData:e,setGraphData:t,onTemporalRootWorkflowDataCollected:r,expandChildWorkflowNode:o,collapseChildWorkflowNode:s,isRootLoaded:a,flowInstance:u,MIN_ZOOM:l,onSpreadBatchNodes:d,autoZoomEnabled:p,setAutoZoomEnabled:m,onInit:v}=Ay(),{showFocus:w,setShowFocus:g,selectedFocusedWorkflow:k,handleFocusChange:S,handleFocusReset:O,flowInstance:T}=Iy(e,t),{isTemporalModalOpen:K,setIsTemporalModalOpen:z,onTemporalModalSubmit:C,refreshWorkflowData:U,isRefreshing:Q}=My({onTemporalRootWorkflowDataCollected:r}),[Y,ee]=X.useState(),[G,ne]=X.useState(!1),[oe,le]=X.useState(null),[se,b]=X.useState(!1),q=X.useRef(!1),j=Z=>{ee(Z),ne(!0)},re=()=>{ne(!1),ee(void 0)},J=$.useMemo(()=>({workflowNode:Z=>N.jsx(ry,{...Z,expandChildWorkflowNode:o,collapseChildWorkflowNode:s,onSpreadBatchNodes:d,onShowNodeData:j})}),[a]),L=X.useCallback(Z=>{t(ie=>({...ie,nodes:jc(Z,ie.nodes)}))},[t]);return X.useEffect(()=>{const Z=new URLSearchParams(window.location.search),ie=Z.get("id"),ae=Z.get("namespace");(async()=>{if(ie&&ae&&!q.current){q.current=!0,b(!0);try{await C({workflowId:ie,namespace:ae})}catch(ge){console.error("Error loading workflow from URL params:",ge),le(ge instanceof Error?ge.message:"An error occurred while loading the workflow")}finally{b(!1)}}})()},[]),N.jsxs("div",{className:"w-screen h-screen flex flex-col bg-gray-50",children:[se&&N.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:N.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-xl flex items-center space-x-3",children:[N.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),N.jsx("div",{className:"text-gray-700",children:"Loading workflow data..."})]})}),oe&&N.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert",children:[N.jsx("strong",{className:"font-bold",children:"Error: "}),N.jsx("span",{className:"block sm:inline",children:oe}),N.jsxs("button",{className:"absolute top-0 bottom-0 right-0 px-4 py-3",onClick:()=>le(null),children:[N.jsx("span",{className:"sr-only",children:"Dismiss"}),N.jsx(Do,{className:"h-5 w-5"})]})]}),N.jsx("div",{className:`flex-grow ${G?"h-[calc(100vh-300px)]":"h-full"}`,children:N.jsxs(Zc,{nodes:e.nodes,edges:e.edges,onNodesChange:L,nodeTypes:J,fitView:!1,minZoom:l,className:"bg-gray-50",onInit:Z=>{u.current=Z,T.current=Z,v(Z)},nodesDraggable:!1,edgesUpdatable:!1,children:[N.jsx(Um,{}),N.jsx(Km,{}),N.jsx($m,{zoomable:!0,pannable:!0,className:"bg-white rounded-lg shadow-lg",style:{backgroundColor:"white",width:300,height:200},maskColor:"rgba(0, 0, 0, 0.1)",nodeColor:"#aaa",nodeStrokeWidth:3,nodeBorderRadius:2}),N.jsx(To,{position:"top-right",className:"bg-white p-2 rounded-lg shadow-lg",children:N.jsx(my,{showFocus:w,setShowFocus:g,autoZoomEnabled:p,setAutoZoomEnabled:m,setIsTemporalModalOpen:z,refreshWorkflowData:U,currentWorkflowId:e.rootWorkflowId,isRefreshing:Q,onTemporalRootWorkflowDataCollected:r})})]})}),N.jsx(yy,{data:Y,isOpen:G,onClose:re}),w&&N.jsx(oy,{nodes:e.nodes,onFocusChange:S,selectedWorkflow:k,onReset:O,onClose:()=>g(!1)}),N.jsx(Py,{isOpen:K,onClose:()=>z(!1),onSubmit:C})]})}Ca(document.getElementById("root")).render(N.jsx($.StrictMode,{children:N.jsx(Dy,{})}));
